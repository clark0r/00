<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>[WSO SHELL] XOR encrypt and decrypt - Cryptology - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Hello guys, 
A friend of me sent this  and asked me to make it compatible 
with the latest version of wso shell the 4v and above. 
After downloading the wso file, we have these first lines that show us everything happen &amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="14720.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;[WSO SHELL] XOR encrypt and decrypt&#39;" href="14720.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/1/1a80e2e9c9d9f7d515ebaf25879eab3d9a2d3634.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/1/1a80e2e9c9d9f7d515ebaf25879eab3d9a2d3634.png" />
<meta property="og:url" content="https://0x00sec.org/t/wso-shell-xor-encrypt-and-decrypt/14720" />
<meta name="twitter:url" content="https://0x00sec.org/t/wso-shell-xor-encrypt-and-decrypt/14720" />
<meta property="og:title" content="[WSO SHELL] XOR encrypt and decrypt" />
<meta name="twitter:title" content="[WSO SHELL] XOR encrypt and decrypt" />
<meta property="og:description" content="Hello guys,  A friend of me sent this  and asked me to make it compatible  with the latest version of wso shell the 4v and above.  After downloading the wso file, we have these first lines that show us everything happen when  there is a POST Request:    We notice something weird ! a decrypt() function in each REQUEST  Let‚Äôs see what we have  function decrypt($str,$pwd){ 	$pwd=base64_encode($pwd); 	$str=base64_decode($str); 	$enc_chr=&quot;&quot;; 	$enc_str=&quot;&quot;; 	$i=0; 	while($i&lt;strlen($str)){ 	for($j=0;$j&lt;s..." />
<meta name="twitter:description" content="Hello guys,  A friend of me sent this  and asked me to make it compatible  with the latest version of wso shell the 4v and above.  After downloading the wso file, we have these first lines that show us everything happen when  there is a POST Request:    We notice something weird ! a decrypt() function in each REQUEST  Let‚Äôs see what we have  function decrypt($str,$pwd){ 	$pwd=base64_encode($pwd); 	$str=base64_decode($str); 	$enc_chr=&quot;&quot;; 	$enc_str=&quot;&quot;; 	$i=0; 	while($i&lt;strlen($str)){ 	for($j=0;$j&lt;s..." />
<meta property="og:article:section" content="Cryptology" />
<meta property="og:article:section:color" content="9EB83B" />
<meta property="og:article:tag" content="xor" />
<meta property="og:article:tag" content="shell" />
<meta property="og:article:tag" content="php" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="2 ‚ù§" />
<meta property="article:published_time" content="2019-07-03T14:14:58+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="14720.html">[WSO SHELL] XOR encrypt and decrypt</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/cryptology/57.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #9EB83B"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Cryptology</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/xor.html" class="discourse-tag" rel="tag">xor</a>,
<a href="../../tag/shell.html" class="discourse-tag" rel="tag">shell</a>,
<a href="../../tag/php.html" class="discourse-tag" rel="tag">php</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="[WSO SHELL] XOR encrypt and decrypt">
<meta itemprop="articleSection" content="Cryptology">
<meta itemprop="keywords" content="xor, shell, php">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/DamaneDz"><span itemprop="name">DamaneDz</span></a>
(DamaneDz)
</span>
<link itemprop="mainEntityOfPage" href="14720.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/1/1a80e2e9c9d9f7d515ebaf25879eab3d9a2d3634.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-03T14:14:58Z" class="post-time">
July 3, 2019, 2:14pm
</time>
<meta itemprop="dateModified" content="2019-07-04T14:04:19Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Hello guys,</p>
<p>A friend of me sent <a href="https://pastebin.com/RbVzimQz" rel="noopener nofollow ugc">this</a> and asked me to make it compatible</p>
<p>with the latest version of <a href="https://github.com/tennc/webshell/tree/master/php/wso" rel="noopener nofollow ugc">wso shell</a> the 4v and above.</p>
<p>After downloading the wso file, we have these first lines that show us everything happen when</p>
<p>there is a POST Request:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/1/1a80e2e9c9d9f7d515ebaf25879eab3d9a2d3634.png" alt="Screenshot_4" data-base62-sha1="3MsydZtkyllorAn0wN2BLIRzTmc" width="690" height="221"></p>
<p>We notice something weird ! a decrypt() function in each REQUEST</p>
<p>Let‚Äôs see what we have</p>
<pre><code>function decrypt($str,$pwd){
	$pwd=base64_encode($pwd);
	$str=base64_decode($str);
	$enc_chr="";
	$enc_str="";
	$i=0;
	while($i&lt;strlen($str)){
	for($j=0;$j&lt;strlen($pwd);$j++){
	$enc_chr=chr(ord($str[$i])^ord($pwd[$j]));
	$enc_str.=$enc_chr;
	$i++;
	if($i&gt;=strlen($str))break;
	}
	}
return base64_decode($enc_str);
}
</code></pre>
<p>It‚Äôs looks like an XOR encryption what I can quote from someone is :</p>
<blockquote>
<p>XOR is symmetric, we use the same method to encrypt and decrypt.</p>
</blockquote>
<p>I‚Äôll put the wso shell in my localhost and open burpsuite so I‚Äôll understand more how stuff works .</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/4/42387a111500377d1d5e70e409e8081f4e9ac0ad.png" alt="Screenshot_5" data-base62-sha1="9rOvS8TtepS67ARnmuGca4eSGZf" width="659" height="315"></p>
<p>We have an encrypted values for some requests let‚Äôs take the a value</p>
<p><code>GBMlAA==</code></p>
<p>Using the decrypt function we‚Äôll get</p>
<p><code>Php</code></p>
<p>Everything is okay for now, and by googling the function I found something in <a href="https://www.reddit.com/r/Malware/comments/8hiaz6/encoded_malware_what_encoding/" rel="noopener nofollow ugc">REDDIT</a></p>
<p>The only discussion about it in the whole internet.</p>
<p>So how to go from</p>
<p><code>Php</code> To <code>GBMlAA==</code></p>
<p>The key in our function is called pwd and we get the value of pwd from this:</p>
<blockquote>
<p>$_COOKIE[md5($_SERVER[‚ÄòHTTP_HOST‚Äô]).‚Äúkey‚Äù]</p>
</blockquote>
<p>Means:</p>
<p><code>$‚ñô = md5($_SERVER['HTTP_USER_AGENT']);</code></p>
<p>So for the encoding function will always base64 encode the ‚Äúpwd‚Äù value</p>
<p>My Final PHP script can run a specified command in many uploaded shells</p>
<p>Before the gist link</p>
<blockquote>
<p>This Script used for authorized testing and/or educational purposes only.<br>
Run it on your own localhost or your server.<br>
I take no responsibility for the abuse of the script.</p>
</blockquote>
<aside class="onebox githubgist">
<header class="source">
<a href="https://gist.github.com/DamaneDz/f41ef7c340daa8d47ca54b7ce4d1e3f8" target="_blank" rel="noopener nofollow ugc">gist.github.com</a>
</header>
<article class="onebox-body">
<h4><a href="https://gist.github.com/DamaneDz/f41ef7c340daa8d47ca54b7ce4d1e3f8" target="_blank" rel="noopener nofollow ugc">https://gist.github.com/DamaneDz/f41ef7c340daa8d47ca54b7ce4d1e3f8</a></h4>
<h5>wso_cmd.php</h5>
<pre><code class="PHP">&lt;?php
/*

 Mass COMMAND EXCUTER For WSO Shell 4.*.*
 Modified and Made on 26/06/2019 By DamaneDz
 
 This Script used for authorized testing and/or educational purposes only.
 Run it on your own localhost or your server.
 I take no responsibility for the abuse of the script.
 </code></pre>
This file has been truncated. <a href="https://gist.github.com/DamaneDz/f41ef7c340daa8d47ca54b7ce4d1e3f8" target="_blank" rel="noopener nofollow ugc">show original</a>
<p>
</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/scylla"><span itemprop="name">scylla</span></a>
(scylla)
</span>
<link itemprop="mainEntityOfPage" href="14720.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-04T04:06:02Z" class="post-time">
July 4, 2019, 4:06am
</time>
<meta itemprop="dateModified" content="2019-07-04T04:06:02Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hey,<br>
I don‚Äôt really understand what you are trying to achieve, but i‚Äôll answer to this :</p>
<blockquote>
<p>How to go from <code>Php</code> To <code>GBMlAA==</code> ?</p>
</blockquote>
<p>You have the encoding and decoding routines, just use them, no ? Just like that :</p>
<pre><code>&lt;?php
function encrypt($str, $pwd) {
    $str=base64_encode($str);
    $pwd=base64_encode($pwd);
    $enc_chr='';
    $enc_str='';
    $i=0;
    while ($i &lt; strlen($str)) {
        for($j=0; $j &lt; strlen($pwd); $j++){
            $enc_str .= chr(ord($str[$i]) ^ ord($pwd[$j]));
            $i++;
            if($i &gt;= strlen($str)) break;
        }
    }
    return base64_encode($enc_str);
}

function decrypt($str,$pwd){
	$pwd=base64_encode($pwd);
	$str=base64_decode($str);
	$enc_chr="";
	$enc_str="";
	$i=0;
	while($i&lt;strlen($str)){
		for($j=0;$j&lt;strlen($pwd);$j++){
		$enc_chr=chr(ord($str[$i])^ord($pwd[$j]));
		$enc_str.=$enc_chr;
		$i++;
			if($i&gt;=strlen($str))break;
		}
	}
	return base64_decode($enc_str);
}

$key = md5('Mozilla/5.0 (Windows NT 6.1; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0');

echo "Encoded value : " . encrypt('Php', $key); //returns GBMlAA==
echo "&lt;br&gt;";
echo "Decoded value : " . decrypt('GBMlAA==', $key); //returns Php
</code></pre>
<p>Regards</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/DamaneDz"><span itemprop="name">DamaneDz</span></a>
(DamaneDz)
</span>
<link itemprop="mainEntityOfPage" href="14720.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-04T13:32:41Z" class="post-time">
July 4, 2019, 1:32pm
</time>
<meta itemprop="dateModified" content="2019-07-04T13:32:41Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Where is the encoding routine you talking about in wso shell ?</p>
<p>My Topic wasn‚Äôt clear and I ignored many things but I think people now understand these basics<br>
stuff but there were no solution in net for that now when someone will google that he will find an<br>
answer <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="14720.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-08-02T14:15:00Z" class="post-time">
August 2, 2019, 2:15pm
</time>
<meta itemprop="dateModified" content="2019-08-02T14:15:00Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
