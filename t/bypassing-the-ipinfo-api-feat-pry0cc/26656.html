<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Bypassing the IPinfo API (feat. pry0cc) - Web Hacking - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Around October 2020, I was pretty active in the bug hunting community. And of course, I was hunting too, as a form of training and learning process. Around that time, my friend @pry0cc made a utility named ipi 
  
As exp&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="26656.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Bypassing the IPinfo API (feat. pry0cc)&#39;" href="26656.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/3X/7/e/7ea3943b939d0acdf846c69e62499558d14f3c98.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/3X/7/e/7ea3943b939d0acdf846c69e62499558d14f3c98.png" />
<meta property="og:url" content="https://0x00sec.org/t/bypassing-the-ipinfo-api-feat-pry0cc/26656" />
<meta name="twitter:url" content="https://0x00sec.org/t/bypassing-the-ipinfo-api-feat-pry0cc/26656" />
<meta property="og:title" content="Bypassing the IPinfo API (feat. pry0cc)" />
<meta name="twitter:title" content="Bypassing the IPinfo API (feat. pry0cc)" />
<meta property="og:description" content="Around October 2020, I was pretty active in the bug hunting community. And of course, I was hunting too, as a form of training and learning process. Around that time, my friend @pry0cc made a utility named ipi     As explained in the README file, this utility was based on the ipinfo.io API. IPinfo is a company providing trusted ASN and IP address data. Its usage is pretty simple: you purchase a subscription and then you use the API, along with the token they provide you when you subscribe.  # Ta..." />
<meta name="twitter:description" content="Around October 2020, I was pretty active in the bug hunting community. And of course, I was hunting too, as a form of training and learning process. Around that time, my friend @pry0cc made a utility named ipi     As explained in the README file, this utility was based on the ipinfo.io API. IPinfo is a company providing trusted ASN and IP address data. Its usage is pretty simple: you purchase a subscription and then you use the API, along with the token they provide you when you subscribe.  # Ta..." />
<meta property="og:article:section" content="Web Hacking" />
<meta property="og:article:section:color" content="0E76BD" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="10 ❤" />
<meta property="article:published_time" content="2021-07-24T08:39:39+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="26656.html">Bypassing the IPinfo API (feat. pry0cc)</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/web-hacking/59.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #0E76BD"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Web Hacking</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Bypassing the IPinfo API (feat. pry0cc)">
<meta itemprop="articleSection" content="Web Hacking">
<meta itemprop="keywords" content>
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/vict0ni"><span itemprop="name">vict0ni</span></a>
</span>
<link itemprop="mainEntityOfPage" href="26656.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/3X/7/e/7ea3943b939d0acdf846c69e62499558d14f3c98.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-07-24T08:39:39Z" class="post-time">
July 24, 2021, 8:39am
</time>
<meta itemprop="dateModified" content="2021-07-24T08:46:45Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Around October 2020, I was pretty active in the bug hunting community. And of course, I was hunting too, as a form of training and learning process. Around that time, my friend <a href="https://twitter.com/pry0cc">@pry0cc</a> made a utility named <a href="https://github.com/pry0cc/ipi">ipi</a></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/7/e/7ea3943b939d0acdf846c69e62499558d14f3c98.png" data-download-href="/uploads/short-url/i4iCV2c1ws1Z16bvyENLxBgMvHi.png?dl=1" title="ipi README"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/7/e/7ea3943b939d0acdf846c69e62499558d14f3c98_2_690x82.png" alt="ipi README" data-base62-sha1="i4iCV2c1ws1Z16bvyENLxBgMvHi" width="690" height="82" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/7/e/7ea3943b939d0acdf846c69e62499558d14f3c98_2_690x82.png, https://0x00sec.s3.amazonaws.com/original/3X/7/e/7ea3943b939d0acdf846c69e62499558d14f3c98.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/7/e/7ea3943b939d0acdf846c69e62499558d14f3c98.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/7/e/7ea3943b939d0acdf846c69e62499558d14f3c98_2_10x10.png"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">ipi README</span><span class="informations">869×104 7.86 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>As explained in the README file, this utility was based on the <a href="http://ipinfo.io">ipinfo.io</a> API. IPinfo is a company providing trusted ASN and IP address data. Its usage is pretty simple: you purchase a subscription and then you use the API, along with the token they provide you when you subscribe.</p>
<pre><code class="lang-bash"># Taken from https://ipinfo.io/developers:

# With Basic Auth
$ curl -u $TOKEN: ipinfo.io

# With Bearer token
$ curl -H "Authorization: Bearer $TOKEN" ipinfo.io

# With token query parameter
$ curl ipinfo.io?token=$TOKEN

# E.g. $ curl ipinfo.io/8.8.8.8?token=$TOKEN
</code></pre>
<p>There’s also a widget on their website for everyone to test out the API.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/8/6/864a1fbb972fb50bcf1368a48dca1970670850a3.png" data-download-href="/uploads/short-url/j9YN29KWqA98miABctttcSiC7jZ.png?dl=1" title="widget"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/8/6/864a1fbb972fb50bcf1368a48dca1970670850a3_2_690x311.png" alt="widget" data-base62-sha1="j9YN29KWqA98miABctttcSiC7jZ" width="690" height="311" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/8/6/864a1fbb972fb50bcf1368a48dca1970670850a3_2_690x311.png, https://0x00sec.s3.amazonaws.com/optimized/3X/8/6/864a1fbb972fb50bcf1368a48dca1970670850a3_2_1035x466.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/8/6/864a1fbb972fb50bcf1368a48dca1970670850a3.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/8/6/864a1fbb972fb50bcf1368a48dca1970670850a3_2_10x10.png"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">widget</span><span class="informations">1182×533 119 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>This is the part where I thought: if the widget is not secure enough, then that’s free IPinfo API, right? Well, after tweaking it, there were two problems with that:</p>
<ol>
<li>There had to be a way to make a request to access the widget from the terminal</li>
<li>The widget was heavily rate-limited</li>
</ol>
<p>Resolving the first issue was quite easy. All I had to do is to see how the request was made to the widget, so I can move it to my terminal.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/9/a/9a4a181ffcf4ed1355ad996604dfb56f76601e33.png" data-download-href="/uploads/short-url/m0Uh9kNSXP3WfcCOGZLMEgKb32z.png?dl=1" title="request"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/9/a/9a4a181ffcf4ed1355ad996604dfb56f76601e33_2_690x325.png" alt="request" data-base62-sha1="m0Uh9kNSXP3WfcCOGZLMEgKb32z" width="690" height="325" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/9/a/9a4a181ffcf4ed1355ad996604dfb56f76601e33_2_690x325.png, https://0x00sec.s3.amazonaws.com/optimized/3X/9/a/9a4a181ffcf4ed1355ad996604dfb56f76601e33_2_1035x487.png 1.5x, https://0x00sec.s3.amazonaws.com/optimized/3X/9/a/9a4a181ffcf4ed1355ad996604dfb56f76601e33_2_1380x650.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/9/a/9a4a181ffcf4ed1355ad996604dfb56f76601e33_2_10x10.png"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">request</span><span class="informations">1920×906 168 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>Apparently, there is a <code>/widget/[IP]</code> endpoint, where anyone can make a request and get the IP data. Moving this from the browser to the terminal wasn’t successful at the beginning</p>
<pre><code class="lang-bash">op@ghost:~$ curl https://ipinfo.io/widget/8.8.8.8
Not Foundop@ghost:~$
</code></pre>
<p>Of course, since the widget is hosted on their website, it should only listen to requests originating from them. One way to do this is by adding the Referer header. That way, the request “says” to the server “hey, I’m making this request by using your website, so I’m totally legal”</p>
<pre><code class="lang-bash">op@ghost:~$ curl -H "Referer: https://ipinfo.io/" https://ipinfo.io/widget/8.8.8.8
{
  "ip": "8.8.8.8",
  "hostname": "dns.google",
  "anycast": true,
  "city": "Mountain View",
  "region": "California",
  ...
  ...
</code></pre>
<p>Well, there you have it, the first part’s done. But the second problem still existed: the rate-limiting mechanism was allowing 10 requests per user. By that time I had already mentioned that to pry to check this out since he’s been using the API. After around 10 (maybe 15?) seconds he came up with an idea about the rate-limiting problem: using the <code>X-Forwarded-For</code> header.</p>
<p>Acourding to <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For">developer.mozilla.org</a></p>
<blockquote>
<p>The X-Forwarded-For (XFF) header is a de-facto standard header for identifying the originating IP address of a client connecting to a web server through an HTTP proxy or a load balancer.</p>
</blockquote>
<p>You see, when a server is using a reverse proxy or a load balancer, the user’s IP address is contained in the <code>X-Forwarded-For</code> header and passed from the proxy to the main server. If that’s the case for IPinfo’s server, there might be a chance for the <code>X-Forwarded-For</code> header value to be overwritten by our value. Changing the header value on every request would look to the server as each request is made each time from a different user/IP. And that worked!</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/0/c/0c13530f2f8d0eb6e006c7c2e2fd818c00676726.png" data-download-href="/uploads/short-url/1IP8bKDOnFrq5VOr0IttduqRtYO.png?dl=1" title="BRUH"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/0/c/0c13530f2f8d0eb6e006c7c2e2fd818c00676726_2_690x195.png" alt="BRUH" data-base62-sha1="1IP8bKDOnFrq5VOr0IttduqRtYO" width="690" height="195" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/0/c/0c13530f2f8d0eb6e006c7c2e2fd818c00676726_2_690x195.png, https://0x00sec.s3.amazonaws.com/original/3X/0/c/0c13530f2f8d0eb6e006c7c2e2fd818c00676726.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/0/c/0c13530f2f8d0eb6e006c7c2e2fd818c00676726.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/0/c/0c13530f2f8d0eb6e006c7c2e2fd818c00676726_2_10x10.png"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">BRUH</span><span class="informations">961×272 24.9 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>We had a rate limit and enterprise bypass. Once we reported it, it got fixed the same day. And IPinfo’s response was awesome</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/5/d/5d3d17f6b552355d05088e8b6a086c2ecad95455.png" alt="twittercomment" data-base62-sha1="diPiqrXMc91XJdMBIoscgzezg6V" width="589" height="199"></p>
<p>TL;DR: <a href="https://twitter.com/vict0ni/status/1417162552266661893">https://twitter.com/vict0ni/status/1417162552266661893</a></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="10" />
<span class="post-likes">10 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="26656.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-11-23T00:40:04Z" class="post-time">
November 23, 2021, 12:40am
</time>
<meta itemprop="dateModified" content="2021-11-23T00:40:04Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
