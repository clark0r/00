<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>My Personal OSINT Techniques, Part 1 of 2: Key &amp; Layer, Contingency Seeding - Reconnaissance - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="We live in a world that is hyper communicative, with much of this  communication occurring on the Internet. 
On the Internet, companies/products want to communicate their value to customers and people want to communicate&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="13033.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;My Personal OSINT Techniques, Part 1 of 2: Key &amp; Layer, Contingency Seeding&#39;" href="13033.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/2/2de71eb7326ccbab8eeeb097f1b6fd23b29dd6e7.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/2/2de71eb7326ccbab8eeeb097f1b6fd23b29dd6e7.png" />
<meta property="og:url" content="https://0x00sec.org/t/my-personal-osint-techniques-part-1-of-2-key-layer-contingency-seeding/13033" />
<meta name="twitter:url" content="https://0x00sec.org/t/my-personal-osint-techniques-part-1-of-2-key-layer-contingency-seeding/13033" />
<meta property="og:title" content="My Personal OSINT Techniques, Part 1 of 2: Key &amp; Layer, Contingency Seeding" />
<meta name="twitter:title" content="My Personal OSINT Techniques, Part 1 of 2: Key &amp; Layer, Contingency Seeding" />
<meta property="og:description" content="We live in a world that is hyper communicative, with much of this  communication occurring on the Internet.  On the Internet, companies/products want to communicate their value to customers and people want to communicate with other people.  Open Source Intelligence (OSINT) is a byproduct of these online communications, and as the quantity of these communication continue to increase, the resources that yield OSINT will also increase.  In hacking (a term that I include Red Teaming and Penetration ..." />
<meta name="twitter:description" content="We live in a world that is hyper communicative, with much of this  communication occurring on the Internet.  On the Internet, companies/products want to communicate their value to customers and people want to communicate with other people.  Open Source Intelligence (OSINT) is a byproduct of these online communications, and as the quantity of these communication continue to increase, the resources that yield OSINT will also increase.  In hacking (a term that I include Red Teaming and Penetration ..." />
<meta property="og:article:section" content="Reconnaissance" />
<meta property="og:article:section:color" content="BF1E2E" />
<meta property="og:article:tag" content="osint" />
<meta property="og:article:tag" content="pentesting" />
<meta property="og:article:tag" content="hacking" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="9 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="25 ❤" />
<meta property="article:published_time" content="2019-04-16T16:20:51+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="13033.html">My Personal OSINT Techniques, Part 1 of 2: Key &amp; Layer, Contingency Seeding</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/reconnaissance/54.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Reconnaissance</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/osint.html" class="discourse-tag" rel="tag">osint</a>,
<a href="../../tag/pentesting.html" class="discourse-tag" rel="tag">pentesting</a>,
<a href="../../tag/hacking.html" class="discourse-tag" rel="tag">hacking</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="My Personal OSINT Techniques, Part 1 of 2: Key &amp; Layer, Contingency Seeding">
<meta itemprop="articleSection" content="Reconnaissance">
<meta itemprop="keywords" content="osint, pentesting, hacking">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/maderas"><span itemprop="name">maderas</span></a>
(https://twitter.com/hackermaderas)
</span>
<link itemprop="mainEntityOfPage" href="13033.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/2/2de71eb7326ccbab8eeeb097f1b6fd23b29dd6e7.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-16T16:20:51Z" class="post-time">
April 16, 2019, 4:20pm
</time>
<meta itemprop="dateModified" content="2019-04-16T16:20:51Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>We live in a world that is hyper communicative, with much of this communication occurring on the Internet.</p>
<p>On the Internet, companies/products want to communicate their value to customers and people want to communicate with other people.</p>
<p>Open Source Intelligence (OSINT) is a byproduct of these online communications, and as the quantity of these communication continue to increase, the resources that yield OSINT will also increase.</p>
<p>In hacking (a term that I include Red Teaming and Penetration Testing in), we weaponize information through the application of our experience, intelligence, strategy, creativity and tooling.</p>
<p>This capacity is a major distinction that separates an experienced hacker from most other users on the Internet.</p>
<p>For example: if a normal user accesses log files on a misconfigured web server and an experienced hacker accesses those same logs on that same host, what is the difference between the two users in this crude example?</p>
<p>The hacker has the capacity to convert the data on those log files into a resource that could allow them to access the web server and/or other hosts on the network (or beyond it).</p>
<p>OSINT is the real world equivalent of these metaphorical log files mentioned above, except it seems like every user and company on the Internet is writing their own log files…</p>
<p>And they seem to leave these log files they write for themselves all over the Internet.</p>
<p>OSINT is usually gathered for the purpose of analysis/reporting and is refined through any number of well defined processes. This yields intelligence that can be applied toward answering a specific question or deciding/reinforcing an appropriate response or path of action.</p>
<p>Below: The image provides an examples of a processes used to gather, analyze and refine OSINT.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/2/2de71eb7326ccbab8eeeb097f1b6fd23b29dd6e7.png" alt="050916_2237_TheArtofSea1" data-base62-sha1="6y4EP51eLIZG8u0aMI2R7Y7l6OH" width="580" height="367"></p>
<p>OSINT as a hacking/Red Team/penetration testing resource can yield a great number of resources that can be leveraged for enumeration and exploitation during an operation/engagement.</p>
<p>This data is usually much more information dense then the output provided by tooling such as a portscan or vulnerability scanner.</p>
<p>However, this data also tends to require more time to process effectively…it generally cannot be put into direct action as quickly as other data types due to the extra analysis/critical thinking needed to process it.</p>
<p>This is because OSINT often consists of what I call “layers”; sometimes these layers consist of data that targets contribute themselves.</p>
<p>Examples of the layers that targets can contribute to OSINT include things like metadata, overt/underlying conditions conveyed by the the wording of a target’s expression(s) and opportunities to better identify/quantify a target’s relationships (and the condition/nature of those relationships).</p>
<p>This is the real trick of making OSINT work during offensive operations/engagements: extracting the most relevant advantages possible from the layers of data provided without the time periods or logistical resources that most conventional processes for working with OSINT assume.</p>
<p>For an added bonus, OSINT tends to be an excellent resource for providing us with contingencies, which are infinitely useful when making decisions on things like target acquisition.</p>
<p>These contingencies can be a real boon for recouping time/energy lost in pursuing rabbit holes and/or running into dead ends, all of which happen to the best of us from time to time.</p>
<p>Two of the personal strategies I utilize most when working with OSINT during engagements include “Key and Layer” and “Contingency Seeding”.</p>
<p>I will demonstrate both processes (as well as some other methodologies, resources and tactics I use when working with OSINT) by detailing a real world example from an engagement I ran against a corporate client.</p>
<p><strong>Key and Layer, Contingency Seeding: Maximizing OSINT for Hacking/Red Team/Penetration Testing</strong></p>
<p>During an engagement I utilized Google Dorking to discover the archives of an internal mailing list that belonged to the target company; it was publicly accessible on the Internet.</p>
<p>This was an ongoing archive that contained well over a decades worth of internal emails, some of which were employee to employee communications and others that were employee to client/customer communications.</p>
<p>This archive contained thousands of emails, the earliest of which dated back to 2001 with the most current dating just days before the engagement began.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/1/16bae24277e8f1d73a1e45c713687f48a1ae8a18.png" alt="osint1" data-base62-sha1="3f4TRPQoNzcym1RZZWWhwGzuDB6" width="685" height="500"></p>
<p>By accident or on purpose, the majority of companies I’ve engaged keep some manner of OSINT rich archives sitting somewhere on the Internet, publicly available.</p>
<p>I found the archive in the image above after reading online user manuals for a network solution the target developed. I knew from reading blogs on the target’s sites that they used this solution in most of their own networks besides selling it as a managed and unmanaged solution to their customers/clients.</p>
<p>One of the manuals for this solution stated that it used default/hardcoded credentials with a username that I had never seen before; a fair approximation of this username would be <strong>XYZuser</strong>.</p>
<p>Searching the Internet for material that contained the default/hardcoded password used alongside the username, I used manual Google Dorking against the string <strong>intext:xyzuser</strong>.</p>
<p>Below: Manual Google Dorking against the string intext:xyzuser uncovered an indexed entry that led to the e-mail archive. This entry also displayed the username I searched for plus its matching password (redacted in red).</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/5/5d1c1171721e02bb1c991f7b141fdf5ba5b19f8d.png" alt="osint2A1" data-base62-sha1="dhGxvwptIT7TrF7lbKi0PyrrVdH" width="690" height="166"></p>
<p>The archive included a “Search this archive” function, which I used to search the archive for keywords like “password”, “credentials” and “Administrator”.</p>
<p>A search using the word “password” located hundreds of archived emails like the one pictured below (many of which contained credentials).</p>
<p>We will use the “Key and Layers” process against one of the archived emails I found (shown below) to demonstrate the capacity of the technique to help extract many of the advantages/resources an instance of OSINT can provide.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3275f42fa534a87a86764b54abf78e01c9b372c5.png" alt="osintemail1a" data-base62-sha1="7coAu8qfuXmgNrIA0LieFmrLtU9" width="503" height="500"><br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/7/7a54304177b1b8bc84d2d38d100f3900984ef131.png" alt="osintemail4a" data-base62-sha1="hsaCIheaS7XtMVv4uOwLj7dnMsN" width="534" height="475"><br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/2/242e1b75185d8de734ca8ce1d370fe5a4ae4fa03.png" alt="osintemail6" data-base62-sha1="5a3YlgMZpoQVyr8mV4MWEk1l58n" width="629" height="500"></p>
<p>The first step of this process is to evaluate this instance of OSINT for the primary, most visible advantage/resource it provides (the “Key” advantage).</p>
<p><strong>NOTE:</strong> I had already established a Key value for the archive as a whole at this point, based on the set of credentials I found via the Google search indexed entry above: the Key value of the archive was that it contained emails containing credentials.</p>
<p><strong>The Key value is important for many reasons, a few of which include:</strong></p>
<p><em>1) If it is your first time reviewing a single instance of OSINT and you can’t find a strong Key value that leaps out at you, it may be time to move onto another instance (or perhaps another source all together) for the time being (and perhaps come back to this one later).</em></p>
<p><strong>PLEASE NOTE:</strong> <em>Where the Key and Layer technique is concerned, an example of an OSINT instance would be any of the individual emails stored by this archive.</em></p>
<p><em>An example of an OSINT source would be the entire archive of emails itself and all the functionality the archive entails.</em></p>
<p><em>2) This Key advantage helps to insure our investment of time in investigating an instance or source of OSINT; offensive engagements/operations are dynamic challenges where time is ultimately the enemy</em>.</p>
<p>*Should an event outside of our control force us to suddenly abandon an OSINT source/instance after establishing a Key value, at least we have yielded some tangible value from that source/instance.</p>
<p>Over time, this strategy will pay dividends: we are ensuring that we are gaining advantages/resources from the material we choose to invest our time/attention in, while more quickly putting aside the material with layers that are not yielding these advantages/resources.*</p>
<p><em>This is especially important when working post exploitation in LAN, where your investment of attention elsewhere could (essentially) leave an active session out in the open. If we’re going to put a session (and the implant/infrastructure that maintains it) in a position where there is an increased probability of it being detected or disrupted (perhaps accidentally by an unsuspecting user), then we should be ensuring we maximize the reward to balance the added risk.</em></p>
<p><em>3) I’ve found that the Key value concept helps me gain better value from the materials I do set aside; it helps me move through a greater quantity of OSINT content more quickly, while also helping me maintain/define a sense of the value these resources could provide.</em></p>
<p><em>This is because defining the reasons an OSINT instance/source does not have a Key value also helps me defines the resources it does have.</em></p>
<p><em>This process helps me create a store of resources that can be drawn from at any point during an engagement. This allows me to understand how these resources could be used to connect the dots, even if the data doesn’t represent a dot itself.</em></p>
<p>Reading through the archived e-mail below, I establish the Key value: the email possesses another set of hardcoded/default credentials (redacted in red, a different set of credentials from those redacted above) for the same network solution, with information in the body of the email quantifying the relative effectiveness of it.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3275f42fa534a87a86764b54abf78e01c9b372c5.png" alt="osintemail1a" data-base62-sha1="7coAu8qfuXmgNrIA0LieFmrLtU9" width="503" height="500"></p>
<p>As is common with instances of OSINT, there are many more layers of advantages/resources present.</p>
<p>However, we also have Contingency Seeding occurring: given the context of this e-mail, the credentials it contains seems like a good path to investigate/follow.</p>
<p>Should this set of credentials lead us to a dead end or toward a disadvantageous situation, or should we learn from other recon that these credentials do not have the value we think they do, we have a second set of credentials to utilize (the credentials found in the Google Dorking search entry).</p>
<p>With the Key value already established (the credentials redacted in red), let’s work through the archived email layer by layer; when using “Key and Layer”, I work from the top of the source down to the bottom.</p>
<p>A layer constitutes every section of a source where resources/advantages are present.</p>
<p>Starting from the top of the e-mail (below), we have the full name of the target’s employee and their e-mail address; though the archive has tried to sanitize the e-mail address, it still hints at the naming convention the target’s internal/corporate e-mail addresses use (first.last@).<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/0/089adbe80522feecb33b6888f44e544a98ce71e0.png" alt="osintemail3" data-base62-sha1="1e7Bqtb1c0Jc6iLpHgRReIUNx3G" width="625" height="143"><br>
The date/time in the email was close to the date range when this engagement was occurring.</p>
<p>This helped quantify the relevance of a couple of things: it helped to ensure the effectiveness of the credentials that were included in the email and the situation surrounding them (the technical difficulty associated with changes to those credentials) which was addressed in the e-mail.</p>
<p>Also, given the thousands of emails present in the archive, we could search all of the emails this employee sent/responded to and quantify all of the days/times associated with those e-mails.</p>
<p>This would leave us with a statistical range as to when the employee may or may not have been active on their corporate email/corporate host.</p>
<p>As this archive would not contain all the employee’s emails, this statistical range would not be perfect.</p>
<p>However, should we ever gain access to this employee’s credentials/corporate host, this range could:</p>
<p>Help us lower the probability of being detected when accessing the employee’s email account or corporate host to utilize it as a resource (read the emails their account contains, launch social engineering attacks at other employees from it, utilize/search the employee’s host for resources with a Meterpreter session, etc.).</p>
<p>Also, if we wanted conduct attacks like taking screenshots of this employee’s online sessions, this statistical range could help us activate implants on their host during days/times the employee was most likely to be active.</p>
<p>Finally, if the archives show statistical norms when this employee e-mails other employees, this could help launch us social engineering attacks at those times/on those days against those employees, which can help with adding an extra layer of feigned authenticity to the attacks.</p>
<p>Now, we move on to another layer of resources: the body of the e-mail itself, a layer added by the target’s employee…as is often the case with OSINT, this is the most valuable intelligence we can find.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3478280402386f9c41a8c84e53c8fbceef01ff7c.png" alt="osintemail2" data-base62-sha1="7uagfN6J3XRd3vwMbhpxVVAKnUw" width="545" height="372"></p>
<p>This is where the Key resource is located, provided by the words of the target’s own employee: active (at the time at least), hardcoded/default credentials in an e-mail that is destined to be stored on the public Internet within hours or days.</p>
<p>The employee continues adding valuable layers to this OSINT by explaining why his fellow employees should not change these default credentials, furthering the statement by saying it is unlikely the target or it’s clients/customers (both of whom make heavy use of the target’s products) will go through the trouble of doing so.</p>
<p>The body of this e-mail has helped solidify the value of the credentials it provides, ensuring that there is a high likely hood that any hosts enumerated hosts that are this product will be accessible via these credentials.</p>
<p>Logging into a host always carries the danger of being detected, but logging into a host after multiple failed attempts is generally much worse.</p>
<p>The body of this e-mail could aid in crafting social engineering attacks that appear to mimic this employee’s writing style, word choices, demeanor and formatting; impression of these elements could likely be improved through studying any number of emails in the archive that belong to this employee.</p>
<p>This study could include noting historic differences/similarities in how this employee interacts with certain employees/clients over many emails, with targets of social engineering attacks that impersonate this employee targeting employees/clients that display a dynamic we feel can be leveraged.</p>
<p>For social engineering attacks against this employee, we know Alexander likes to go by Alex. For social engineering attacks that pose as them, we know the name the name they go by and how he prefers to sign off on his correspondence (using “Best,”, which we can be verify by studying other emails that belong to this employee in the archive).</p>
<p>We could use this email and others in the archive that belong to this employee to build custom wordlists with Cewl to bruteforce any resources attributed to them.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/7/7a54304177b1b8bc84d2d38d100f3900984ef131.png" alt="osintemail4a" data-base62-sha1="hsaCIheaS7XtMVv4uOwLj7dnMsN" width="534" height="475"></p>
<p>Moving on to the layer shown above, the archived emails that belonged to the target’s employees seemed to always include the internal corporate email signature of each participant (this varied where the target’s clients/customers are concerned).</p>
<p>These signatures pretty much mangled the scant security measures that were taken to obscure information like internal corporate emails.</p>
<p>Here, we have data that helped us quantify the viability/quality of this instance of OSINT: since this employee is a System Architect, there is the highest reasonable probability that the data is factual, given the employee’s position in the company.</p>
<p>We also have other data helpful in attempting other attacks (especially social engineering attacks) such as an address, phone number, fax and this employee’s division.</p>
<p>This layer also adds extra value to other data found earlier: having discovered the facility this employee works at, we could take an established statistical range of the days/times this employee worked using the headers of their archived e-mails and use that to make a safe assumption what days/times the majority of that facility’s employees work.</p>
<p>This data could be used to to improve the probability of successfully launching any number of attacks against the facility’s network infrastructure or the employees themselves.</p>
<p>The archives attempts to hide the employee’s email addresses are a failure due to the presence of the employee’s email signatures:</p>
<ol>
<li>
<p>We already have the naming convention of this employee’s email address taken from headers.</p>
</li>
<li>
<p>The obscured e-mail address is repeated here above the target company’s domain name.</p>
</li>
<li>
<p>The number of Xs used to hide the remainder of the employee’s email address equals the same number of characters used to spell the company’s/target’s domain name in the website address field after the www (the company’s emails could also be found using <a href="https://Hunter.io" rel="noopener nofollow ugc">Hunter.io</a> and this method recreates the employee’s email address exactly).</p>
</li>
</ol>
<p>We also have the layout/appearance of the target company’s internal e-mail signature and their confidentiality agreement; both of these could aid in producing convincing phishing/spearphishing emails that appear to originate from within the company.</p>
<p>We have the employee’s phone number; we could attempt to gain access to this employee’s voicemail box, possibly leveraging data from this and other emails in the archive to do so.</p>
<p>For examples: employee ID numbers are often the default code used to secure an employee’s voicemail; we could search archived emails belonging to this employee to see if the ID numbers were ever an included value in the email headers/signature or mentioned by this employee or other employees/clients/customers.</p>
<p>Since there is no cellphone field in the signature, this could be a deskphone within the target company’s facility; if a BlackHat could gain access to the employees voicemail box, PBX type exploitation for profit could be a possible.</p>
<p>The BlackHat PBX attack scenario adds value to the idea of quantifying times/dates listed in the header of this/other archived emails belonging to this employee to help establish a statistical range of normal working days on/days off and hours on/hours off, as well as the likely norms worked by other company employees at that facility.</p>
<p>PBX exploitation for profit often involves a BlackHat exploiting PBX employee voicemail message forwarding functionality, causing company phonelines to call pay by minute (1-900) numbers belonging to the BlackHat, charging the company for the time elapsed via repeated calls; some BlackHats have earned hundreds of thousands of dollars over a weekend by doing this…it helps to utilize this attack when company employees are off and not near their desk phones.</p>
<p>Due to the presence of the fax machine number, we now know a fax machine is likely present at the target facility, which is an added, viable attack vector.</p>
<p>This adds a third contingency via Contingency Seeding: our first contingencies should utilize the credentials that have been found. Should these credentials not work, another set of contingencies could involve trying to locate fax machines on the target’s perimeter to attack; or, if we already have a foothold in this facility’s LAN, we could try to locate the fax and utilize it for post exploitation activities.</p>
<p>Since there is no deskphone field in the email signature, this employee may only use a cellphone or softphone for work, which could create an avenue for other attacks against them.</p>
<p>For instance, if we somehow discover that the employee uses a cellphone instead of a deskphone, we could attempt possibly attempt SMS based social engineering attacks them.</p>
<p>Or, if we learn that the employee uses a softphone, we could attempt to enumerate the software used and attempt to leverage any vulnerabilities that the software possesses at some point of this engagement/operation.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/2/242e1b75185d8de734ca8ce1d370fe5a4ae4fa03.png" alt="osintemail6" data-base62-sha1="5a3YlgMZpoQVyr8mV4MWEk1l58n" width="629" height="500"></p>
<p>Above: The final layer of data for this instance of OSINT is the “Other related posts” field.</p>
<p>The messages in this thread could allow us to discover departments, networks and facilities where we can best utilize the credentials we have found to access hosts in the target’s network.</p>
<p>For instance, if messages in this section contains emails where company employees state having the network solution in play, we could enumerate what department/location they work at through data contained in their email signature (and possibly the email itself or other emails in the archive).</p>
<p>The same strategy could also apply to any customers/clients involved in this dialogue. If their email signatures didn’t leak identifying information in any of this section’s threads, we could also attempt to search emails in the archive for the necessary information.</p>
<p>Then it becomes a matter of enumeration to find the hosts that data in an email or emails points at.</p>
<p>Perhaps an employee in one of emails listed in this section states they constantly have to work around the problem these credentials present (confirming the network hosts are present in their network); this employee’s e-mail signature states they work in the target’s Engineering Department in another facility.</p>
<p>We could enumerate the target’s domains/subdomains with tools like Amass, Aquatone, Fierce or Sublis3r and/or sites like DNSDumpster, searching for domains/subdomains that seem likely to be part of the Engineering department (looking for naming conventions containing words like “dev” or “staging” are a good start).</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/7/74008b8e8d1cb97a95b1420c8ea6d465bff2889e.png" alt="amassosint1A" data-base62-sha1="gycynDOQtrezblXvGkWYb693LuC" width="460" height="500"><br>
<em><strong>Image above:</strong> OWASP Amass DNS Enumeration output enumerates a target IP range using words in the naming convention indicative of Engineering/Developer department subdomains.</em></p>
<p>After locating the necessary target domains/subdomains, we could then search these IP in Shodan to see if the necessary network solution is present pending other enumeration, such as portscans of the target’s full IP ranges.</p>
<p>As DNS and other enumeration commences, we could also utilize Shodan search filters to expedite the process of finding these hosts (we could use the archive to isolate attributes that allow us to do so).</p>
<p>This is especially helpful, as Shodan search filters allow us to search by a huge number of parameters, examples of which include state, country, port, type of software and network IP range.</p>
<p><strong>NOTE:</strong> Daniel Miessler’s overview of Shodan search filters can be found here <a href="https://danielmiessler.com/study/shodan/" rel="noopener nofollow ugc">https://danielmiessler.com/study/shodan/</a></p>
<p>We could also use the e-mails that make up this thread to further isolate the best targets: what are the employees/customers/clients saying about the credentials and the situation surrounding them?</p>
<p>Are they working on fixing their dependence on these credentials regardless of the difficulties?</p>
<p>Are employees from any of the target’s departments/locations stating that they are just fine with the credentials or do they state they’ve resigned themselves to the situation?</p>
<p><strong>This type of data is excellent for Contingency Seeding; let’s say we read the emails linked in this section and established some contingencies based off them.</strong></p>
<p><strong>Contingency Seeding often includes establishing different levels of viable targets…we will state this example from a BlackHat’s perspective, where all of the company and it’s clients/customers are fair game):</strong></p>
<p><strong>Target 1 - The second, confirmed set of credentials vs. hosts/networks where employees/customers/clients have stated/hinted the credentials are used and they have no plans of fixing their dependence on them…search for these networks using the data contained in employee email signatures and any clues that may be included in emails contained in this thread.</strong></p>
<p><strong>Contingency Target 1 - The second, confirmed set of credentials vs. hosts/networks where employees/clients/customers have stated/hinted the credentials are used and they plan on remediating the issue, but they have not begun this process…search for these networks using the data contained in client/customer email signatures and any clues that may be included in emails contained in this thread.</strong></p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/5/5d1c1171721e02bb1c991f7b141fdf5ba5b19f8d.png" alt="osint2A1" data-base62-sha1="dhGxvwptIT7TrF7lbKi0PyrrVdH" width="690" height="166"></p>
<p><strong>Contingency Target 2 - First set of credentials found in Google search engine entry (above, redacted in red) vs. hosts/networks where employees/clients/customers have stated/hinted credentials are used and they have no plans of fixing their dependence on them…use these credentials against hosts where the other confirmed credentials have failed (these may have been networks identified using the data contained in employee email signatures and any other clues that may have been included in emails contained in this thread).</strong></p>
<p><strong>Contingency Target 3 - First set of credentials found in Google search engine entry (above, redacted in red) vs. hosts/networks where employees/clients/customers have stated/hinted credentials are used and they plan on remediating the issue, but they have not begun this process…use these credentials against hosts where the other confirmed credentials have failed (these may have been networks identified using the data contained in employee email signatures and any other clues that may have been included in emails contained in this thread).</strong></p>
<p><strong>Other resources/advantages present in the layers of “Other related posts”:</strong></p>
<p>Reading all of the emails in this thread may present opportunities to improve the probability of successful social engineering attacks.</p>
<p>For instance, if messages became heated between two participants in this thread, we could fashion a social engineering attack leveraging sentiments like “you were right, I found this document (really a malicious attachment). I apologize…” or “I looked into it for you and I think I found a solution, which I attached (really a malicious attachment)”.</p>
<p>An attack of this type could be made especially potent given our access to both the thread and archived e-mails.</p>
<p>The archive is likely to include a wealth of materials that could help us impersonate the target company’s employees (or even it’s clients/customers) through studying (and then mimicking) idiosyncrasies like: individual word choices, the layout of their writing, habitual spelling mistakes, favored expressions, the aesthetics conveyed by individual email signatures, changes of demeanor between interactions with different employees (or different clients/customers for that matter) and quotes used in their e-mails, all garnished by details like the company privacy disclosure.</p>
<p>While the archived emails likely lack some of the aesthetic qualities of the company’s emails, these can be learned/mimicked by searching the web for images of company emails, signing up for company resources via temporary email (with Guerilla Mail perhaps) that are available to anyone (such as promotional materials or employment opportunities).</p>
<p>At the time of this engagement, the email addresses contained in this thread were only dated days/weeks before the beginning of the engagement.</p>
<p>This gave me the opportunity to use tooling like Spiderfoot or Pwned (which queries Have I been Pwned?) to locate any of the emails in the thread that had been included in a credentials dump recent to the start of the engagement.</p>
<p>If Spiderfoot stated that any of the emails in the thread were associated with or used to create external accounts on other sites, it may be worth seeing if any of those sites had recent dumps associated with them as well.</p>
<p>If any of the target’s employees/customers/clients had credentials in these dumps, there is always the chance they are reusing passwords between accounts…this could translate to taking creds from a recent dump and using those credentials to access an employee’s/client’s/customer’s corporate email account.</p>
<p>It’s always possible that by using dumped credentials to access other accounts belonging to an employee/customer/client that we could eventually gain access to a internal corporate account .</p>
<p>Perhaps the account is linked to or contains intelligence/data that grants us access to an internal corporate account (for instance, I have found corporate email credentials saved in the “Drafts” folder of other external email accounts).</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="19" />
<span class="post-likes">19 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../random-thoughts-after-nearly-9-years-pentesting-red-teaming-2019/16397.html">Random Thoughts After Nearly 9 years Pentesting/Red Teaming: 2019</a>
<meta itemprop="position" content="3">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../0x00sec-2019-year-end-review-year-0x04/18391.html">0x00sec 2019 Year End Review - Year 0x04</a>
<meta itemprop="position" content="4">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="13033.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-22T22:02:15Z" class="post-time">
April 22, 2019, 10:02pm
</time>
<meta itemprop="dateModified" content="2019-04-22T22:02:15Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>As always, a cracking article <a class="mention" href="https://0x00sec.org/u/maderas">@maderas</a>.</p>
<p>You’re a sensation on twitter and you’re still loyal to your roots &lt;3</p>
<p>Huge respect man!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/maderas"><span itemprop="name">maderas</span></a>
(https://twitter.com/hackermaderas)
</span>
<link itemprop="mainEntityOfPage" href="13033.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-23T15:50:19Z" class="post-time">
April 23, 2019, 3:50pm
</time>
<meta itemprop="dateModified" content="2019-04-23T15:50:19Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks man!</p>
<p>This place and all of you have been good to me.</p>
<p>I don’t get to spend as much time here as I like, but that doesn’t change the fact that this is home…only a sucker forgets their roots.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="13033.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-16T16:35:56Z" class="post-time">
May 16, 2019, 4:35pm
</time>
<meta itemprop="dateModified" content="2019-05-16T16:35:56Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
