<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>HTS.org R3 challenge - Web Hacking - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Preface
I stated my reasoning behind this article series in the first article which can be found here. 
To avoid redundancy please check out the preface over there and let’s get right into action! 
note: If I write non s&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="index.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;HTS.org R3 challenge&#39;" href="1967.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/d/dab15bee7b2c15c94ce9fe37a2937d2a67b30298.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/d/dab15bee7b2c15c94ce9fe37a2937d2a67b30298.png" />
<meta property="og:url" content="https://0x00sec.org/t/hts-org-r3-challenge/1967" />
<meta name="twitter:url" content="https://0x00sec.org/t/hts-org-r3-challenge/1967" />
<meta property="og:title" content="HTS.org R3 challenge" />
<meta name="twitter:title" content="HTS.org R3 challenge" />
<meta property="og:description" content="Preface I stated my reasoning behind this article series in the first article which can be found here.  To avoid redundancy please check out the preface over there and let’s get right into action!  note: If I write non sense in this and the next following articles please correct me for the sake of me and others not getting confused and mixed up with things 🙂 .  Author Assigned Level: Wannabe Community Assigned Level: poll Required Skills Since we’re starting at the beginning not muc..." />
<meta name="twitter:description" content="Preface I stated my reasoning behind this article series in the first article which can be found here.  To avoid redundancy please check out the preface over there and let’s get right into action!  note: If I write non sense in this and the next following articles please correct me for the sake of me and others not getting confused and mixed up with things 🙂 .  Author Assigned Level: Wannabe Community Assigned Level: poll Required Skills Since we’re starting at the beginning not muc..." />
<meta property="og:article:section" content="Web Hacking" />
<meta property="og:article:section:color" content="0E76BD" />
<meta property="og:article:tag" content="webhacking" />
<meta property="og:article:tag" content="challenge" />
<meta property="og:article:tag" content="hacking" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="6 ❤" />
<meta property="article:published_time" content="2017-05-04T17:15:35+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="index.html">HTS.org R3 challenge</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/web-hacking/59.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #0E76BD"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Web Hacking</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/webhacking.html" class="discourse-tag" rel="tag">webhacking</a>,
<a href="../../tag/challenge.html" class="discourse-tag" rel="tag">challenge</a>,
<a href="../../tag/hacking.html" class="discourse-tag" rel="tag">hacking</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="HTS.org R3 challenge">
<meta itemprop="articleSection" content="Web Hacking">
<meta itemprop="keywords" content="webhacking, challenge, hacking">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ricksanchez"><span itemprop="name">ricksanchez</span></a>
</span>
<link itemprop="mainEntityOfPage" href="index.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/d/dab15bee7b2c15c94ce9fe37a2937d2a67b30298.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-05-04T17:15:35Z" class="post-time">
May 4, 2017, 5:15pm
</time>
<meta itemprop="dateModified" content="2017-05-05T17:18:23Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<h1>Preface</h1>
<p>I stated my reasoning behind this article series in the first article which can be found <a href="../hts-org-r1-challenge/index.html">here</a>.<br>
To avoid redundancy please check out the preface over there and let’s get right into action!</p>
<p><em><strong>note:</strong></em> If I write non sense in this and the next following articles please correct me for the sake of me and others not getting confused and mixed up with things <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> .</p>
<h4>Author Assigned Level: Wannabe</h4>
<h4>Community Assigned Level:</h4>
<div class="poll" data-poll-status="open" data-poll-type="regular" data-poll-name="poll">
<div>
<div class="poll-container">
<ul>
<li data-poll-option-id="e1c1af66349ae633fa9ffd223d9e01f3">Newbie</li>
<li data-poll-option-id="48cde21e0fcdef5aef447a332bb6dcc0">Wannabe</li>
<li data-poll-option-id="f0d5a092a44bae0d9f0734127a07fe91">Hacker</li>
<li data-poll-option-id="d0be935ef28646b5afecbf524d510b85">Wizard</li>
<li data-poll-option-id="cc5e4d9a5dc2c4d9aa641ef7a2a97876">Guru</li>
</ul>
</div>
<div class="poll-info">
<p>
<span class="info-number">0</span>
<span class="info-label">voters</span>
</p>
</div>
</div>
</div>
<h4>Required Skills</h4>
<p>Since we’re starting at the beginning not much knowledge is required at the moment.</p>
<ul>
<li>basic HTML</li>
<li>PHP argument parsing</li>
<li>some knowledge about directory traversal</li>
</ul>
<h4>Disclaimer</h4>
<p>These write ups are only my 2 cents on the challenges. So don’t take them too seriously. <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
<hr>
<h1>
<a href="http://HTS.org">HTS.org</a> realistic challenges</h1>
<h3><a href="https://www.hackthissite.org/missions/realistic/3/">Realistic challenge 3</a></h3>
<h4>Message:</h4>
<blockquote>
<p>Message: I run this website where people can read and submit peace-related poetry. I am doing this out of good will towards others, and I don’t see why I would be making enemies out of this, but some real ass hole hacked my website posting a bunch of ignorant aggressive propaganda on the front page. And I made that website a while ago, and I no longer have access to it. Do you think you can hack in and change it back? Please? Oh, and bonus points if you message me the name of the bastard who did this!<br>
My website can be found here.</p>
</blockquote>
<h4>What can we extract from the message?</h4>
<ul>
<li>We have a read and submit mechanism for poems</li>
<li>someone hacked the site and changed it</li>
<li>admin has no access to it anymore…</li>
</ul>
<h3>The site:</h3>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/d/dab15bee7b2c15c94ce9fe37a2937d2a67b30298.png" width="576" height="500"></p>
<p>Ok this site definitely got h4xx0r3d massively or did it ;)?</p>
<h3>The source</h3>
<p>Let’s take a look at the source code again. This helped us plenty the last two times!</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/8/8174c7dfdf81b2d1de659057e0bc350d40666d0a.png" width="690" height="12"></p>
<p>Ok what the heck is this?? a super weird html formatting. Everything is written on line 1 which makes it difficult to read but might this come in handy ?? Not sure yet… <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
Even reading the source code of the page until the end didn’t reveal anything interesting. Just a bunch of text and picture formatting… So what now?</p>
<h4>Be careful and always look out for the small things</h4>
<p>What am I saying here?<br>
Let’s look at the page code once more but this time more carefully.<br>
The source code is formatted in such a way to distract you!<br>
It a hassle to read and follow where some function ‘opens’ and ‘closes’ but more importantly we missed the fact that we can scroll down!<br>
And all the way at the bottom we can find this:</p>
<pre><code>&lt;!--Note to the webmasterThis website has been hacked, but not totally destroyed. The old website is still up. I simply copied the old index.html file to oldindex.html and remade this one. Sorry about the inconvenience.--&gt;
</code></pre>
<p>Let’s jump right to oldindex.html</p>
<p><strong>the main page:</strong><br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/1/14ffea3bfb04bf7cd1b3b01c7bf03f0dabf444c6.png" width="690" height="385"></p>
<p><strong>the subpages:</strong><br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/5/5b32f9577b3f9a7608977013b010cc0d00c42b95.png" width="621" height="295"><br>
Ok this one doesn’t look promising at all…<br>
Just a page where you can click some poems and read them.<br>
No hidden running scripts or anything.<br>
Our only clue is the URL which ends in:</p>
<pre><code>readpoem.php?name=Images of an Impending War
</code></pre>
<p>So the poems are stored on the server.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/c/cbef06bdbfb670fb1f5d91f447354c30f041833c.png" width="632" height="500"></p>
<h3>The ‘hack’</h3>
<div class="spoiler">
<p>But we can find this! The submit poem form which is handled through:</p>
<pre><code>&lt;form action="submitpoems2.php" method="post"&gt;Name of poem:&lt;br /&gt;
</code></pre>
<p>Another .php script …</p>
<h5>Can we somehow exploit this??</h5>
<p>Let’s think about this… We have header field and some text form and the script uses the ‘post’ method.<br>
We need to do some research on what might happen here:</p>
<ul>
<li>POST creates an array (e.g. array( key =&gt; value, key2 =&gt; value2, key3 =&gt; value3, …)). This array holds key/value pairs, where keys are the names of the form controls and values are the input data from the user.</li>
<li>POST is treated as $_POST. This is a superglobal, which means that it will always be accessible, regardless of scope - and you can access it from any function, class or file without having to do anything special.</li>
<li>$_POST is an array of variables passed to the current script via the HTTP POST method.</li>
<li>HTTP POST Submits data to be processed to a specified resource</li>
</ul>
<p>Ok enough for now, but if you’re still feel unfamiliar with GET and POST request read them up <a href="https://www.tutorialspoint.com/php/php_get_post.htm">here</a></p>
<p>####<span class="hashtag">#So</span> what can we do?<br>
We use the submit form to restore the original index.html!<br>
So we copy the html code of the oldindex.html and paste it as our poem.<br>
For the title we choose the place where we wanna save it basically.<br>
Why?<br>
Because we saw how saved poems are saved on the server through the URL above.<br>
-&gt; So this should be the index.html!<br>
<strong>BUT</strong> since our php submit form lies one level above the index.html file in terms of directories we need to traverse the path one step lower.<br>
So we choose …/index.html as our name!<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/0/0edad2c6c10a6e3d8268103797c0de1a1f3749da.png" width="498" height="500"></p>
</div>
<h1>Conclusions</h1>
<p>So this time we had to combine 3 different areas to solve this little riddle.<br>
Some html knowledge, some php knowledge and a little bit of directory traversing.<br>
Even if you’re not an active html or php developer it’s necessary to know how things are and can be handled and interpreted.<br>
As a hacker you need a nicely filled toolbelt <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>The next article of the series can be found <a href="../hts-org-r4-challenge/index.html">here</a> once it’s up!!</p>
<p>Stay tuned <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="5" />
<span class="post-likes">5 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../hts-org-r2-challenge/index.html">HTS.org R2 challenge</a>
<meta itemprop="position" content="6">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../hts-org-r9-challenge/index.html">HTS.org R9 challenge</a>
<meta itemprop="position" content="7">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../hts-org-r10-challenge/index.html">HTS.org R10 challenge</a>
<meta itemprop="position" content="8">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/BO41"><span itemprop="name">BO41</span></a>
</span>
<link itemprop="mainEntityOfPage" href="index.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-05-06T09:44:45Z" class="post-time">
May 6, 2017, 9:44am
</time>
<meta itemprop="dateModified" content="2017-05-06T09:44:45Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>… even better with the changes you made <img src="../../images/emoji/twitter/thumbsup.png%3Fv=9" title=":thumbsup:" class="emoji" alt=":thumbsup:"><br>
I am really enjoying this, keep up the good work</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="index.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-01-21T00:41:04Z" class="post-time">
January 21, 2018, 12:41am
</time>
<meta itemprop="dateModified" content="2018-01-21T00:41:04Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
