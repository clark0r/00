<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>[CrackMe] NoREpls - Part 6 - Challenges - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Backstory
After reading the cracking attempts from the previous thread, edgyReggie asked DownerDanny to take some time into researching further possible solutions to deter crackers. That some time has now passed and edge&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="3059.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;[CrackMe] NoREpls - Part 6&#39;" href="3059.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/c/c54a3bf96186cac3c23ca741b35d03840844090d.JPG" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/c/c54a3bf96186cac3c23ca741b35d03840844090d.JPG" />
<meta property="og:url" content="https://0x00sec.org/t/crackme-norepls-part-6/3059" />
<meta name="twitter:url" content="https://0x00sec.org/t/crackme-norepls-part-6/3059" />
<meta property="og:title" content="[CrackMe] NoREpls - Part 6" />
<meta name="twitter:title" content="[CrackMe] NoREpls - Part 6" />
<meta property="og:description" content="Backstory After reading the cracking attempts from the previous thread, edgyReggie asked DownerDanny to take some time into researching further possible solutions to deter crackers. That some time has now passed and edgeS0ft are ready to release their updated software hoping that it will at least hold off the weaker pirates until DownerDanny can study and apply more methods…  Difficulty Author Assigned Level: Wannabe Community Assigned Level: poll  Goal  Your goal is to achieve the “full” versio..." />
<meta name="twitter:description" content="Backstory After reading the cracking attempts from the previous thread, edgyReggie asked DownerDanny to take some time into researching further possible solutions to deter crackers. That some time has now passed and edgeS0ft are ready to release their updated software hoping that it will at least hold off the weaker pirates until DownerDanny can study and apply more methods…  Difficulty Author Assigned Level: Wannabe Community Assigned Level: poll  Goal  Your goal is to achieve the “full” versio..." />
<meta property="og:article:section" content="Reverse Engineering" />
<meta property="og:article:section:color" content="12A89D" />
<meta property="og:article:section" content="Challenges" />
<meta property="og:article:section:color" content="283890" />
<meta property="og:article:tag" content="reverseengineering" />
<meta property="og:article:tag" content="assembly" />
<meta property="og:article:tag" content="crackme" />
<meta property="og:article:tag" content="windows" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="18 ❤" />
<meta property="article:published_time" content="2017-07-27T04:38:59+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="3059.html">[CrackMe] NoREpls - Part 6</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/reverse-engineering/58.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #12A89D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Reverse Engineering</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/reverse-engineering/challenges.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #283890"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Challenges</span>
</span>
</a>
<meta itemprop="position" content="2" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/reverseengineering.html" class="discourse-tag" rel="tag">reverseengineering</a>,
<a href="../../tag/assembly.html" class="discourse-tag" rel="tag">assembly</a>,
<a href="../../tag/crackme.html" class="discourse-tag" rel="tag">crackme</a>,
<a href="../../tag/windows.html" class="discourse-tag" rel="tag">windows</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="[CrackMe] NoREpls - Part 6">
<meta itemprop="articleSection" content="Challenges">
<meta itemprop="keywords" content="reverseengineering, assembly, crackme, windows">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/c/c54a3bf96186cac3c23ca741b35d03840844090d.JPG">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-27T04:38:59Z" class="post-time">
July 27, 2017, 4:38am
</time>
<meta itemprop="dateModified" content="2017-07-27T10:05:08Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<h1>Backstory</h1>
<p>After reading the cracking attempts from the <a href="../crackme-norepls-part-5/3022/index.html">previous thread</a>, <code>edgyReggie</code> asked <code>DownerDanny</code> to take some time into researching further possible solutions to deter crackers. That <em>some time</em> has now passed and <code>edgeS0ft</code> are ready to release their updated software <em>hoping</em> that it will at least hold off the weaker pirates until <code>DownerDanny</code> can study and apply more methods…</p>
<h2>Difficulty</h2>
<h4>Author Assigned Level: Wannabe</h4>
<h4>Community Assigned Level:</h4>
<div class="poll" data-poll-status="open" data-poll-type="regular" data-poll-name="poll">
<div>
<div class="poll-container">
<ul>
<li data-poll-option-id="e1c1af66349ae633fa9ffd223d9e01f3">Newbie</li>
<li data-poll-option-id="48cde21e0fcdef5aef447a332bb6dcc0">Wannabe</li>
<li data-poll-option-id="f0d5a092a44bae0d9f0734127a07fe91">Hacker</li>
<li data-poll-option-id="d0be935ef28646b5afecbf524d510b85">Wizard</li>
<li data-poll-option-id="cc5e4d9a5dc2c4d9aa641ef7a2a97876">Guru</li>
</ul>
</div>
<div class="poll-info">
<p>
<span class="info-number">0</span>
<span class="info-label">voters</span>
</p>
</div>
</div>
</div>
<hr>
<h2>Goal</h2>
<ul>
<li>Your goal is to achieve the “full” version of the software, i.e. removing all nags that you see and unlocking all features of the program.</li>
<li>Your second goal is to ensure that your unlocked program works on different machines.</li>
<li>Your third (optional) goal is to generate a working name-serial pair if possible.</li>
<li>Bonus points to the most elegant solutions (minimal byte patching).</li>
</ul>
<hr>
<h2>Rules of Engagement</h2>
<p>Not really a rule but it would be a better learning experience if you disable all <em>anti-anti</em> plugins. I’m not forcing this onto you but I’d recommend leaving them until later.</p>
<hr>
<h2>Research Material</h2>
<details>
<summary>
DEFINITE SPOILERS IN HERE! Don't reveal unless you're really stuck!</summary>
<ul>
<li><a href="https://grazfather.github.io/re/malware/ida/2016/09/18/Anti-Disassembly.html">Grazfather - Anti-Disassembly Techniques and Mitigation</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms633497(v=vs.85).aspx">MSDN - EnumWindows</a></li>
</ul>
</details>
<hr>
<h2>Binary</h2>
<h4>Preview (look and design may not be accurate):</h4>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/c/c54a3bf96186cac3c23ca741b35d03840844090d.JPG" width="313" height="149"></p>
<h4>Version 2.2 revised version (bug fixes)</h4>
<p><a href="http://www.mediafire.com/file/p5awaouaj7rak74/NoREpls2.2.exe">MediaFire - http://www.mediafire.com/file/p5awaouaj7rak74/NoREpls2.2.exe</a></p>
<p><a href="https://www.virustotal.com/en/file/d3d8c6d8ff5d7733b531f0fb19329f6341fbb003e0e5854eb8ff56b9193e1b9d/analysis/1501149854/">VirusTotal - https://www.virustotal.com/en/file/d3d8c6d8ff5d7733b531f0fb19329f6341fbb003e0e5854eb8ff56b9193e1b9d/analysis/1501149854/</a></p>
<p>Good luck! <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="6" />
<span class="post-likes">6 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../challenge-collection-reverse-engineering-and-crackme/3027.html">Challenge Collection: Reverse Engineering and CrackMe</a>
<meta itemprop="position" content="6">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/rokups"><span itemprop="name">rokups</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-27T08:58:26Z" class="post-time">
July 27, 2017, 8:58am
</time>
<meta itemprop="dateModified" content="2017-07-27T08:58:26Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This is getting fun!</p>
<div class="spoiler">
<p>Control flow obfuscation threw me off a bit. I patched it out en-masse and while program ran most of the time getting rid of last nag (demo label and register menu item) just crashed application. Got to be more careful next time <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
<p>After that i added usual “mov al, 1” to serial check function there was no more nag window, but it was still labeled a demo. Had to patch one more spot which removes demo label and disables “Register” menu item. This was weird and xref to that variable was lost to control flow obfuscation. But hey - whatever works… <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-27T10:06:57Z" class="post-time">
July 27, 2017, 10:06am
</time>
<meta itemprop="dateModified" content="2017-07-27T10:06:57Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>An updated version has been released to address some bugs. Please download the revised version!</p>
<p><a class="mention" href="https://0x00sec.org/u/rokups">@rokups</a> Please retry your solution and see if it works better.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/rokups"><span itemprop="name">rokups</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-27T13:03:49Z" class="post-time">
July 27, 2017, 1:03pm
</time>
<meta itemprop="dateModified" content="2017-07-27T13:03:49Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Better indeed <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"> <code>edgyReggie</code> should not be coding while intoxicated <img src="../../images/emoji/twitter/stuck_out_tongue.png%3Fv=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<div class="spoiler">
<p>Now its enough to patch “setnle al” &gt; “mov al, 1” in serial check function, like before. I me needing that other patch to clean up UI was edgyReggie’s bug but hesitated. Too many times when i shouted “bug” it turned out to be my mistake <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</div>
<p>Any recommendations on reading material regarding reverse-engineering serial generation algorithm? I have a general idea of just going through serial check algorithm and adjusting serial values to ones that algorithm expects, but it would produce one serial and sounds inefficient. Is there a better way?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/b/b80338d699f9b2472ed06c26a618e035affeead4.PNG">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-27T17:21:07Z" class="post-time">
July 27, 2017, 5:21pm
</time>
<meta itemprop="dateModified" content="2017-07-27T17:21:07Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Pretty cool anti-debug this time… Here’s my approach.</p>
<div class="spoiler">
<p>We use the same strategy as always for finding the anti-debug: Step your way through the code. You’ll see the structure is known from the last two parts; <em>nearly</em> the same. When you come to the loop you’ll know what I mean by <em>nearly</em> <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">.<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/b/b80338d699f9b2472ed06c26a618e035affeead4.PNG" width="594" height="113"></p>
<p>Again it’s the second call which makes us worry, but this time it’s triggered on the third (Not second as last time) run!<br>
And that’s not everything; just jump into it and you’ll see what I mean:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/7/76ce11f6db0a8a2464ee6e0fe79cd66c1b1d8958.PNG" width="471" height="238"></p>
<p>What? Mmh… Something’s wrong; let us remove our automatic analysis and have a look at the raw stuff. Right-click -&gt; Analysis -&gt; Remove analysis from module:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/e/e0fd77903beff18c6061003d72f4abf67cf9d989.PNG" width="603" height="260"></p>
<p>Now the reversing can continue. Jump a few instructions to get here:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/1/1519a98dc524d313006c31fc346cae67dcc0e057.PNG" width="473" height="176"></p>
<p>The highlighted line is the terminating call; but how can that be? It’s not shown as a call! Just re enable the analysis (Right-click -&gt; Analysis -&gt; Analyse code [CTRL + A]) and it will be correctly interpreted.<br>
How do we want to patch? As always, you’ve got multiple possible solutions:</p>
<ul>
<li>NOP the call (And the PUSHs before! Why? Think or try it yourself <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">)</li>
<li>change PUSH EBP to RETN</li>
<li>…</li>
</ul>
<p>I prefer the second way (1 byte patch; just unselect the “Fill with NOP’s”); but it’s up to you. Anyway, we’ve managed to clean our binary and are ready for cracking it!</p>
<p>It’s the same as last time; run the program, pause the execution when the first nag is shown, ALT+K for having a look at the call stack, select the call to the DialogBox and change the JNZ in front of the call to a JZ (=JE) - done!</p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-27T23:31:44Z" class="post-time">
July 27, 2017, 11:31pm
</time>
<meta itemprop="dateModified" content="2017-07-27T23:31:44Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group" data-username="rokups" data-post="4" data-topic="3059">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/rokups/40/2802_2.png" class="avatar"> rokups:</div>
<blockquote>
<p>Any recommendations on reading material regarding reverse-engineering serial generation algorithm? I have a general idea of just going through serial check algorithm and adjusting serial values to ones that algorithm expects, but it would produce one serial and sounds inefficient. Is there a better way?</p>
</blockquote>
</aside>
<p>Sorry, I don’t have anything on that. I’d assume it just takes a lot of practice.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Leeky"><span itemprop="name">Leeky</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/5/5090ca38fb99364927fccfd982664e6e588eebcc.PNG">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-28T04:58:42Z" class="post-time">
July 28, 2017, 4:58am
</time>
<meta itemprop="dateModified" content="2017-07-28T04:58:42Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks dtm!</p>
<div class="spoiler">
<p>My first approaches half way failed with cracked binaries that crashed 50% of the time and worked the other 50%.<br>
At the end I did something similar to <a class="mention" href="https://0x00sec.org/u/rokups">@rokups</a> and also patched the CRC on the StringTable to mess it that as well.<br>
(To allow debugging I just patched a few jumps, I didn’t include those in the final binary tho’ which means my crack won’t work if a debugger is running in the background)<br>
And because I love pictures:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/5/5090ca38fb99364927fccfd982664e6e588eebcc.PNG" width="330" height="259"><br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/c/cb774a15a22c18635e7811d79110035559315baa.PNG" width="335" height="265"><br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/e/e9205c5c65b1b0077517f122dd320c1bace0b805.PNG" width="331" height="266"></p>
</div>
<p><a class="mention" href="https://0x00sec.org/u/thedoctor">@TheDoctor</a> that trick is pretty cool, thank you for showing it! <img src="../../images/emoji/twitter/open_mouth.png%3Fv=9" title=":open_mouth:" class="emoji" alt=":open_mouth:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="4" />
<span class="post-likes">4 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/rokups"><span itemprop="name">rokups</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-28T07:16:06Z" class="post-time">
July 28, 2017, 7:16am
</time>
<meta itemprop="dateModified" content="2017-07-28T07:16:06Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>So… My patch is just 3 bytes. Does anyone have any less?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="2" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Leeky"><span itemprop="name">Leeky</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-28T07:46:50Z" class="post-time">
July 28, 2017, 7:46am
</time>
<meta itemprop="dateModified" content="2017-07-28T07:46:50Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>If you start asking like that, 1 byte patch <img src="../../images/emoji/twitter/stuck_out_tongue.png%3Fv=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:">:</p>
<div class="spoiler">
<p>End of serial checking routine, replace pop ebx or pop esi with pop eax (0x58).<br>
The program will start in demo mode, you then have to register. After registering the program exits.<br>
Now restarting and you have the full version.</p>
<pre><code class="lang-nohighlight">CPU Disasm
Address   Hex dump          Command                                  Comments
00F7337B      837D E8 00    CMP DWORD PTR SS:[EBP-18],0
00F7337F      0F95C0        SETNE AL                                 ; here is the 3 byte patch I guess?
00F73382      5F            POP EDI
00F73383      5E            POP ESI                                  ; Either replace this
00F73384      5B            POP EBX                                  ; or this
00F73385      8B4D FC       MOV ECX,DWORD PTR SS:[EBP-4]
00F73388      33CD          XOR ECX,EBP
00F7338A      E8 7F070000   CALL 00F73B0E
00F7338F      8BE5          MOV ESP,EBP
00F73391      5D            POP EBP
00F73392      C3            RETN
</code></pre>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/rokups"><span itemprop="name">rokups</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-28T08:02:46Z" class="post-time">
July 28, 2017, 8:02am
</time>
<meta itemprop="dateModified" content="2017-07-28T08:02:46Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Oh wow that is a nice observation right there! Only way to beat that must be making a working serial <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-28T08:11:34Z" class="post-time">
July 28, 2017, 8:11am
</time>
<meta itemprop="dateModified" content="2017-07-28T08:11:34Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Optional 1 byte patch to remove the anti-debug and the 1 byte patch to crack the program; read my comment above, if you’re interested <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/bugcheck"><span itemprop="name">bugcheck</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3059.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-03-18T14:47:38Z" class="post-time">
March 18, 2020, 2:47pm
</time>
<meta itemprop="dateModified" content="2020-03-18T17:26:00Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<div class="spoiler">
<p><span alt="bugcheck" data-base62-sha1="8JtsAcHp4fzw4RFZuw91nV0qFJ3" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span></p>
</div>
<p>That’s what i did !</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
