<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Crackme.c - A small reversing puzzle - Challenges - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="What‚Äôs up everyone? It‚Äôs been quite a while. This is just going to be an easy little puzzle for you guys to play around with. I got bored in class so I decided to make a fake login in C. 
There are 3 intended solutions t&amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="1762.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="M6h5q9Ppd8kfwaKxhOHn94DQJ"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="M6h5q9Ppd8kfwaKxhOHn94DQJ"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Crackme.c - A small reversing puzzle&#39;" href="1762.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/e/e2105fa2426f718e6e79c6bc7e18304dfb0719e8.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/e/e2105fa2426f718e6e79c6bc7e18304dfb0719e8.png" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/crackme-c-a-small-reversing-puzzle/1762" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/crackme-c-a-small-reversing-puzzle/1762" />
<meta property="og:title" content="Crackme.c - A small reversing puzzle" />
<meta name="twitter:title" content="Crackme.c - A small reversing puzzle" />
<meta property="og:description" content="What‚Äôs up everyone? It‚Äôs been quite a while. This is just going to be an easy little puzzle for you guys to play around with. I got bored in class so I decided to make a fake login in C.  There are 3 intended solutions to this, but those are for you to find out!  The code for the puzzle can be found here: http://pastebin.com/T9XA0gjS  BUT! If you want to solve the puzzles without looking at the code first, just follow this:    I‚Äôll have my 3 solutions in the spoilers below. Have fun!  -Defalt  S..." />
<meta name="twitter:description" content="What‚Äôs up everyone? It‚Äôs been quite a while. This is just going to be an easy little puzzle for you guys to play around with. I got bored in class so I decided to make a fake login in C.  There are 3 intended solutions to this, but those are for you to find out!  The code for the puzzle can be found here: http://pastebin.com/T9XA0gjS  BUT! If you want to solve the puzzles without looking at the code first, just follow this:    I‚Äôll have my 3 solutions in the spoilers below. Have fun!  -Defalt  S..." />
<meta property="og:article:section" content="Reverse Engineering" />
<meta property="og:article:section:color" content="12A89D" />
<meta property="og:article:section" content="Challenges" />
<meta property="og:article:section:color" content="283890" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="17 ‚ù§" />
<meta property="article:published_time" content="2017-03-09T21:12:42+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="1762.html">Crackme.c - A small reversing puzzle</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/reverse-engineering/58.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #12A89D'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Reverse Engineering</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/reverse-engineering/challenges/13.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #283890'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Challenges</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Crackme.c - A small reversing puzzle'>
      <link itemprop='url' href='1762.html'>
      <meta itemprop='datePublished' content='2017-03-09T21:12:42Z'>
        <meta itemprop='articleSection' content='Challenges'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Defalt.html'><span itemprop='name'>Defalt</span></a>
                (The Defalt)
              </span>

                <link itemprop="mainEntityOfPage" href="1762.html">

                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/2X/e/e2105fa2426f718e6e79c6bc7e18304dfb0719e8.png">

              <span class="crawler-post-infos">
                  <time  datetime='2017-03-09T21:12:42Z' class='post-time'>
                    March 9, 2017,  9:12pm
                  </time>
                  <meta itemprop='dateModified' content='2017-03-09T21:12:42Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>What‚Äôs up everyone? It‚Äôs been quite a while. This is just going to be an easy little puzzle for you guys to play around with. I got bored in class so I decided to make a fake login in C.</p>
<p>There are 3 intended solutions to this, but those are for you to find out!</p>
<p>The code for the puzzle can be found here: <a href="../../../external.html?link=http://pastebin.com/T9XA0gjS" rel="noopener nofollow ugc">http://pastebin.com/T9XA0gjS</a></p>
<p>BUT! If you want to solve the puzzles without looking at the code first, just follow this:<br>
<img src="../../../0x00sec.s3.amazonaws.com/original/2X/e/e2105fa2426f718e6e79c6bc7e18304dfb0719e8.png" width="540" height="230"></p>
<p>I‚Äôll have my 3 solutions in the spoilers below. Have fun!</p>
<p>-Defalt</p>
<p>Solution 1:</p>
<div class="spoiler">
<p>Buffer overflow</p>
<p>The first solution is the easiest. We can simply overflow the buffer used to store the given password to change the value of the ‚Äúvalid‚Äù integer to a non-zero number, which will evaluate to true when it‚Äôs checked.</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/b/b6b58bd00a84d8611d4e782921b925fe4bd97d38.png" width="690" height="146"></p>
</div>
<p>Solution 2:</p>
<div class="spoiler">
<p>The second solution is a bit harder, but still pretty easy. We‚Äôll start by using objdump on our executable to get the assembly for all of the funtions:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/b/b07934a9f355aabeff8e0d937bfea0e8f24da591.png" width="626" height="96"></p>
<p>Now that we have this dump file, let‚Äôs take a look in it. We‚Äôll scroll all the way down to the assembly for the main function. BUT, what‚Äôs this? Right above the main function we can see there is another function that is hidden from us:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/b/b9aa1ce91788a4bdc1ee90766ecc04e8f9204aff.png" width="599" height="254"></p>
<p>But, if we look at the main function, this secret function is never called. But don‚Äôt worry, GDB to the rescue! We can changed the EIP to point to the secret function, and force it to execute:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/f/fea0802de1bb9a3a133c29d44a3f1a33ee3a9908.png" width="416" height="134"></p>
<p>Now if we let the program finish, we should see the output of the secret function:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/f/ff92d1b2ed305f759802a70be806d161a125ff10.png" width="389" height="144"></p>
</div>
<p>Solution 3:</p>
<div class="spoiler">
<p>Our last solution is the largest pain in the ass out the 3. When we execute our login, the values are juggled around in the registers, as usual. BUT, using GDB, we can read these registers and find the password while it‚Äôs being tested.</p>
<p>To do this, we just start our login in GDB normally:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/3/33033a7044b89a1aa68ed5343c1e6759b83860ff.png" width="690" height="398"></p>
<p>Now that we‚Äôre here, let‚Äôs disassemble this program and take a look at the assembly. Specifically, we‚Äôre going to look where the gets() function is called, and the instructions that follow it:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/4/42fb9a7fba87edde14d17dd09be9acda5f2afb2d.png" width="584" height="127"></p>
<p>Here we can see that after gets() is called, there‚Äôs a lot of movement done with the EAX register. So, if we monitor the EAX register, we might be able to find something. We‚Äôll use the display command to show whats in EAX every time we step through an instruction.</p>
<p>This is what a change in EAX will look like, that number to the right will change. Now, let‚Äôs step through our program until we‚Äôre prompted for a password, then we‚Äôll start paying attention to this number:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/d/dc80edee5b41f54c7bb54f9b9523d1bb70a564b5.png" width="396" height="148"></p>
<p>Now that we‚Äôve been prompted for the password, let‚Äôs keep an eye on EAX until it changes again:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/9/9a5bfb58d51f55d05ad5c9d137046aa6a9e10c83.png" width="193" height="72"></p>
<p>There we go. Now, if we use ‚Äúx/s‚Äù to convert to contents of the address currently stored in EAX to a string, we should have the password for our login:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/2/2f7213d4e458f90042f52bb1a5e2ee9ce467d525.png" width="355" height="56"></p>
</div>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="11" />
              <span class='post-likes'>11 Likes</span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='../../../external.html?link=http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                        <a itemprop='url' href="../../../external.html?link=https://0x00sec.org/t/challenge-collection-reverse-engineering-and-crackme/3027">Challenge Collection: Reverse Engineering and CrackMe</a>
                        <meta itemprop='position' content='2'>
                      </div>
                </div>

            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Neo.html'><span itemprop='name'>Neo</span></a>
                (Ne0_)
              </span>


                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/2X/1/10fa51f50f319a833b6cd3b8dcd03c10d57e0af4.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-03-21T07:05:58Z' class='post-time'>
                    March 21, 2017,  7:05am
                  </time>
                  <meta itemprop='dateModified' content='2017-03-22T06:43:35Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Nice little Challenge. Looking forward for more!</p>
<p>Here‚Äôs my solution:</p>
<div class="spoiler">
<p>First, i disassembled the main function:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/1/10fa51f50f319a833b6cd3b8dcd03c10d57e0af4.png" width="524" height="114"></p>
<p>At 0x0804859b we see a value compared to 0, if equals, a few instructions are jumped over. My guess: DWORD PTR [ebp-0xc] is a ‚Äúboolean‚Äù value that is 1 if the entered password is correct.<br>
To prove this hypothesis:<br>
<img src="../../../0x00sec.s3.amazonaws.com/original/2X/a/af3af8878b6083dfcdaaa5559cb07e9259ae7e26.png" width="472" height="71"></p>
<p>A comparison, followed by a jump if not equal. BUT, if it is equal, our old friend DWORD PTR [ebp-0xc] is set to 1 (my guess: password correct).</p>
<p>So, I set a breakpoint just before the boolean ‚Äúpassword correct‚Äù value is checked:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/2/250601f7f47105265a27d77247dad984982676a1.png" width="235" height="59"></p>
<p>Get the address of the ebp register:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/a/ac0e1090468a56b684d735ca48520618ba050196.png" width="406" height="38"></p>
<p>Subtract 12, because our pointer is -0xc (hexadecimal for 12) in regards to ebp. So our ‚Äúpassword correct‚Äù ‚Äúboolean‚Äù lies at 0xfffcecc.</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/f/f39e406a41ffda493a5f29960477c22ceb9c7c00.png" width="267" height="94"></p>
<p>So I check the value, it is indeed 0. Then I just set it to 1, so the next instructions thinks the password I entered has been correct, et voil√†:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/6/696219207d606be53edaf675661651566a4a872c.png" width="224" height="75"></p>
<p>Tbf, I didn‚Äôt get the password in this scenario. BUT, I logged in, and that‚Äôs something at least, right?</p>
</div>
<p>edit: Thanks <a class="mention" href="../../u/oaktree.html">@oaktree</a> for setting the spoiler tags. Sorry, totally forgot about that.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/besa.html'><span itemprop='name'>besa</span></a>
                
              </span>


                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/2X/3/365afe901896d8fba8b32f2a4808d7d916fdb4c8.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-03-29T05:28:12Z' class='post-time'>
                    March 29, 2017,  5:28am
                  </time>
                  <meta itemprop='dateModified' content='2017-03-29T22:26:57Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Simple solution:</p>
<p><span class="spoiler">My solution was to find the offset of the read only data section then export all strings in that section.<br>
<img src="../../../0x00sec.s3.amazonaws.com/original/2X/3/365afe901896d8fba8b32f2a4808d7d916fdb4c8.png" width="348" height="500"></span></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/lantern-shadowclaw.html'><span itemprop='name'>lantern-shadowclaw</span></a>
                (Austin)
              </span>


                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/2X/1/1a50ad18beb73f0b789916b05d701c7f3828668d.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-07-06T17:52:29Z' class='post-time'>
                    July 6, 2017,  5:52pm
                  </time>
                  <meta itemprop='dateModified' content='2017-07-06T20:55:35Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Been trying out binary ninja demo.<br>
Made this very easy‚Ä¶</p>
<div class="spoiler">
<p>opened the binary and saw the secret function looked at the hex for the function and found the password</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/1/1a50ad18beb73f0b789916b05d701c7f3828668d.png" width="428" height="258"></p>
</div>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/ATGC.html'><span itemprop='name'>ATGC</span></a>
                (We&#39;re all just code)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-07-08T20:58:56Z' class='post-time'>
                    July 8, 2017,  8:58pm
                  </time>
                  <meta itemprop='dateModified' content='2017-07-08T20:58:56Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This feels like cheating, but‚Ä¶</p>
<div class="spoiler">
<pre><code class="lang-auto">&gt; strings crackme | grep password</code></pre>
<pre><code class="lang-auto">The password is: Rev3ngineering1sc00l!
Enter the password! 
Checking password...</code></pre>
</div>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/lacike.html'><span itemprop='name'>lacike</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-07-18T19:45:53Z' class='post-time'>
                    July 18, 2017,  7:45pm
                  </time>
                  <meta itemprop='dateModified' content='2017-07-18T19:45:53Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hello, I tried another two solutions.</p>
<p>The first one is similar that the first one of <a class="mention" href="../../u/defalt-2.html">@Defalt</a> solutions.</p>
<div class="spoiler">
<p>I use buffer overflow too, but instead of overwritting the ‚Äúvalid‚Äù variable, I use the shorten input and overwrite only the original password.</p>
<pre><code>./crackme 
Enter the password! AAAAAAAAAAAAAAAAAAAAAA        AAAAAAAAAAAAAAAAAAAAAA

Checking password...

Successfully logged in!
Good job!
</code></pre>
</div>
<p>The second solution uses different approach then other solutions in this thread.</p>
<div class="spoiler">
<p>It is possible to use buffer overflow vulnerability and exploit the binary. It is possible to achieve execution of ‚Äúsecret‚Äù function via entered password. Just enter looong password and overwrite the stored return address from main function in stack.<br>
On modern systems with ASLR enabled and with crackme compiled with gcc from <a class="mention" href="../../u/defalt-2.html">@Defalt</a> post, it can be a not so easy to overwrite the stored return address (eip). Maybe you noticed the difference between prologue and epilogue of main and secret functions.<br>
If you want to play with this exploit, I recommend you to temporary disable ASLR (do not forget to turn on this protection again, just set value to 2 instead of 0)</p>
<pre><code>sysctl -w kernel.randomize_va_space=0
</code></pre>
<p>Or you can use another compiler instead of gcc. For example tcc from tcc:i386 package works good, and clang should work too).<br>
The desired output from crackme looks like:</p>
<pre><code>Checking password...

Login failed!
You found the secret function!
Congrats!
The password is: Rev3ngineering1sc00l!
</code></pre>
</div>
<p>Here is my input for second solution:</p>
<div class="spoiler">
<p>probably you will need to adjust the length of zeros and the address of secret function in this exploit. I compiled crackme with 32-bit tcc compiler.</p>
<pre><code>python -c "print 'A'+'\x00'*55+'\xa2\x82\x04\x08'"  | ./crackme
</code></pre>
</div>
<p>Thanks for this small puzzle.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="M6h5q9Ppd8kfwaKxhOHn94DQJ"></script>
  </body>
  
</html>
