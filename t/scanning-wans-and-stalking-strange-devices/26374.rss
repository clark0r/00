<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Scanning WAN&#39;s and Stalking strange devices</title>
    <link>https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374</link>
    <description>## BackDrop

Last month while haphazardly scrolling through a networking book i came across something known as  the [shared address space ](https://en.wikipedia.org/wiki/IPv4_shared_address_space) , shared addresses are something ISPs use to achieve [CGNAT](https://en.wikipedia.org/wiki/Carrier-grade_NAT) (carrier grade NAT) which is just like  regular old NAT but on the ISPs router , ISPs do this so that they don&#39;t have to assign each one you a public address (IPv4 address space is running out/ran out :thinking: remember ?) . so CGNAT is basically ISPs  NATing a bunch of  customers into using a single public address in order to conserve the IPv4 address space.

### The shared address space

According to [IANA](https://datatracker.ietf.org/doc/rfc6598/?include_text=1), 100.64.0.0/10 is reserved for CGNAT purposes. 
&gt;Note : some ISPs in their naivety may use private ranges for CGNAT puposes , which certainly will cause problems to customers who use the same address range for their LANs


Lets compare regular  NAT and CGNAT setups . 

- ***Regular NAT*** : all devices in this setup use one public address (193.223.22.22) to communicate with the internet
![Regular NAT |615x251, 100%](upload://kCKJNIIDDZ0CFQfaqNe1MKVtVJY.png)

- ***CGNAT*** :  multiple customers of the ISP share the same public address (193.223.22.22) , in order to  conserve the IPv4 address space.
![CGNAT|652x500, 75%](upload://vV3bTyZzZvbCscIJGtHgMi4n8Jf.png)
&gt;*Note the 100.xx.xx.xx shared address being used in the WAN* 

### Our Business with the shared address space / ISP WANs

Now you might ask, why exactly are we interested in this shared address space? well everybody scans LANs and shodan scans the internet, dont you think WANs should recieve fair treatment as well :thinking: ?

Here are a few reasons why ISP WANs should be explored :

 1) WANs are special because they contain a lot of devices which are otherwise not reachable from the internet due to CGNAT , these might include poorly configured routers ,ISPs router firmware upgrade servers etc.
            
 2) WANs of Mobile Network provider are especially interesting , as many embedded devices
use them , examples of such devices could be street light systems, traffic controllers, customer modems etc. 

3) WANs present a unexplored landscape where you are more likely to discover something exciting.


### Getting Down to Business

***Tools of trade*** : Ive been a long time admirer of masscan, its a stable scanning solution , but recent experience with [rustscan](https://github.com/RustScan/RustScan) has also been very good , i find it to be faster than masscan, you can choose whatever suits you. 

***Finding the right range to scan*** : Mobile ISP tend to use the shared address space 100.64.0.0/10 , while broadband ISPs are more likely to use private ranges such as 172.16.0.0/12 or 10.0.0.0/8, in either case these are very large ranges to scan, in case of broadband ISPs you can visit you routers page to find your WAN address , in case of mobile ISPs you can visit your phones &#39;about&#39; section in settings to find your IP/WAN address, if your using a modem ifconfig should do the trick.

&gt;Note : not all ISPs employ CGNAT , dont be surprised if you see a public address in place of your WAN address  

***Scanning Smartly*** : Like i have previously mentioned ip ranges used for WAN are large, instead of wasting time scanning the entire range you can you the following trick , lets say your WAN address is 10.27.27.123, you could scan the subnet 10.27.0.0/16 since you were assigned a address in this range, it is likely that other devices exist in the same range, you could also scan subsequent ranges such as 10.28.0.0/16, 10.29.0.0/16 and so forth as it is very likely that ISP uses these (masscan automatically does this), another neat trick is case of mobile ISPs is to continuously connect and disconnect from the network while noting down your WAN address each time, this should give you a good idea of the subnets your ISP uses.

&gt;Note : Its likely devices you find in WANs will change their addresses from time to time , especially in case of mobile networks , its thus advisable to scan smaller ip block and immediately analyze the results.  

&gt;Note : In a few cases you might be able to reach a few not so obvious private ranges which your ISP might be using, for example lets say your WAN address is 100.90.1.27, you would assume that your ISP only uses the shared address space 100.64.0.0/10, but this is not always the case, you may be able to reach devices in the subnets 172.16.0.0/12 or 10.0.0.0/8, a random scan of these address space might reveal interesting targets, performing a traceroute to a internet address(say 8.8.8.8) can also reveal the use of such alternate WAN address spaces. 

***Scanning and analyzing devices*** : 

- Scanning with masscan :
`sudo masscan -p80 100.99.0.0/16 2&gt; /dev/null | tee results.txt`
![masscan|690x354, 75%](upload://aLRLNHz8p8H169T6ywJJP0g3soB.png)


&gt; Note: piping masscans error stream to /dev/null hides its status messages so that you can get a clean output file , although masscan does support the &#39;-oL&#39; option like nmap for output, the above approach shows you ips discovered in realtime and also saves them in the result file, while the &#39;-oL&#39; option requires you wait untill the whole scan is complete in order to view the results.

&gt; Note: if you are using a modem and masscan timesout with a ARP resolve error, specify the MAC address of your modem using the --router-mac=aa:bb:cc:dd:ee:ff option.

&gt; Note: you can save time by increasing packet rate of masscan using --rate option , --rate=300 is a good rate for 4G mobile networks , broadband users can rise it even higher , but be mindful of the packet rate, very high packet rate can negatively affect device discovery probability.

- Analyzing results:  since we scanned for port 80, we can use httpx to look for interesting targets.

    - Picking ips from the results file
    `cat results.txt | cut -f6 -d&#39; &#39; &gt; ip.txt`

    - Probing targets with httpx
    `httpx -status-code -title -l ip.txt`
    ![httpx|690x387, 75%](upload://xWSJBADP9MZ6Gm3Hk18cRGrXKNe.png)


&gt; Note: while i have choosen to target web based services(port 80) here, you can modify your scan to include ssh and telnet ports, which perhaps will yield more interesting results.  

***Recommended ports for scanning*** :

 **Port**| **Type**| **Service**
  :-----:|:-----:|:---------:
   80     |  TCP  |  HTTP
   8000   |  TCP  |  HTTP ALT
   9000   |  TCP  |  HTTP ALT
   8080   |  TCP  |  HTTP ALT
   21     |  TCP  |  FTP
   22     |  TCP  |  SSH
   23     |  TCP  |  Telnet
   502    |  TCP  |  ModBus
   5555   |  TCP  |  ADB  
&lt;br&gt;

***Persistant Access / Device Rediscovery*** : Devices on WANs can change their ip address unpredictably , this can happen due to power outage, network disconnection etc, this is more wide spread in case of Mobile Networks, its a pain to re-scan an entire network range to find a particular device you are interested in, in such cases you can leverage  [DDNS](https://en.wikipedia.org/wiki/Dynamic_DNS) settings which many devices offer, you can create an free account on [NoIp](https://www.noip.com/) (upto 3 devices) and setup the DDNS service on the device, so everytime a device changes its WAN address it will update the corresponding DDNS hostname accordingly , you&#39;ll just have to resolve your DDNS hostname to find its WAN address.

&gt;Note: If you are confused as to why a DDNS client would update its WAN address instead of its public address to the DDNS server, DDNS client works by checking the WAN interfaces ip address, it does not attempt to determine its actual public ip address, in its point of view the address assigned to the WAN interface is globally routable.

***Results*** :  Lets take a look what we managed to find

*strange routers that i have never seen before* : 

![hp|690x323, 75%](upload://reh8g7Xv3FBLkmQRMgheLE81OlF.png)
&lt;br&gt;
![four-faith|633x500, 75%](upload://pIp9B8O3JJiLM5BVS4taNNVEF3f.png)
&lt;br&gt;
![nirad|690x413, 75%](upload://aaCiVl6f8HjX3qDua2DTHTu5B1s.png)


***IOT devices***
![cmd-meter|690x348, 75%](upload://f7LWi5m6ylQCLPFTIzUQZbZLIOA.png)

![wattmon|690x280](upload://6BoVUzGzlxOR8nWglwESRyydwn6.png)



***subscriber modems***
![digisol|690x346, 75%](upload://djialMkRU2Zb7JJZ29dXOYE8TX7.png)
&lt;br&gt;
![enter|690x323, 75%](upload://bixq71CRGVq5ZZ0zskItHbL7gb6.png)
&lt;br&gt;
![techie|690x444, 75%](upload://uvB4XLujf871YGnrMCbeolywU2m.png)


***firewalls***
![juniper|655x500, 75%](upload://zUNQanNv9rwWRlwd10qmoCw1Usy.png)
&lt;br&gt;
![dell|690x478, 75%](upload://nqtkAdMq5kKaHmNAsj8VS9xcwes.png)

&gt;Note: &#39;TCCC&#39; stands for &#39;The Coca Cola Company&#39; (no im not kidding :smile: )
### Observations

- Firstly we notice a variety of ***routers*** whose administration panels are accessible from the WAN network,this is often the result of misconfiguring the http service to listen on all interfaces, the absence of routers manufactured by popular vendors in our results tells us that such a misconfiguration is rather the trait of uncommon and shady vendors, if one finds routers from such vendors in large numbers it is likely that the ISP is distributing them, for they are cheaper than regular routers.  
&lt;br&gt;
- ***IOT devices*** : we come across the administrative interface of a very interesting device which seems to be an electric meter(how do i know ?, i checked the vendors website)(the other screenshot is of a controller of modbus devices), the sheer nature of such devices requires them to use mobile networks for connectivity, in which case its obvious that there does not exist any router/intermediate device between such a IOT device and the ISPs router , this combined with the fact that it exposes a administrative interface (most likely by default) yet again confirms the infamous security posture of IOT devices. Like a good friend of mine once said &quot;The &#39;S&#39; in IOT stands for Security&quot;. WANs in near future(if not already) will be gold mines of IOT devices which depend on mobile networks. 
&lt;br&gt;
- ***Subscriber modems*** are the devices you are most likely to run into when scanning mobile ISP WANs, it does not always have to be those old-fashioned data cards , there are also devices such as these (a travel modem)
![tplink|546x447, 50%](upload://5YHsPVhc1NvcQz1PUoiothpNdx4.jpeg)
only devices such as these and datacards(ones with wifi) have web based administrative interfaces. These devices are fascinating because of their capability to send and recieve SMS messages, many services on the internet requires SMS verification (example: [hunter.io](https://hunter.io)) to prevent fraud , these services can also detect disposable phone numbers and VOIP numbers which leaves attackers without much choice, in such cases these modems become lucrative targets.

&gt; Note: one can determine a modems phone number by running a operator specific [USSD](https://en.wikipedia.org/wiki/Unstructured_Supplementary_Service_Data) code, some operators have a SMS based service wherein they send back the phone number when you send a SMS to specific service number, in other cases one can check the SMS archive of the modem, some messages from operators might contain the phone number.    

- Dicovering Firewalls on broadband ISP WANs are pretty common , but i found a few on a mobile ISPs network , after some research i found that many enterprise grade firewalls have a so called &#39;fail safe&#39; mode wherein you connect a modem to the firewall which makes it accessible even when all wired internet connections fail.
![checkpoint-min|690x478, 75%](upload://hz7VKOdQEoAqtSejjz10oV1FGml.jpeg)


### Limitations
- Like i have previously mentioned, not all ISP have CGNATS
in such cases there is not much you can do.

- A WAN network usually contains users of a particular area or a city, there may not be too many devices sometimes

- Some ISPs prevent communication between devices in a WAN (i&#39;m not sure how effective this actually is)

- Interacting with devices on a WAN (especially on mobile networks) is extremely slow sometimes.


### References

- [IPv4_shared_address_space](https://en.wikipedia.org/wiki/IPv4_shared_address_space)
- [rfc6598](https://datatracker.ietf.org/doc/rfc6598/?include_text=1)
- [Carrier-grade_NAT](https://en.wikipedia.org/wiki/Carrier-grade_NAT)
- [USSD](https://en.wikipedia.org/wiki/Unstructured_Supplementary_Service_Data)
- [Dynamic_DNS](https://en.wikipedia.org/wiki/Dynamic_DNS)

### Tools: 
- [RustScan](https://github.com/RustScan/RustScan)
- [Masscan](https://github.com/robertdavidgraham/masscan)

### Further Reading:
- [Network_address_translation](https://en.wikipedia.org/wiki/Network_address_translation)
- [WANs by CISCO](https://www.cisco.com/c/en/us/products/switches/what-is-a-wan-wide-area-network.html)
 - [The Benefits of SD-WAN](https://www.checkpoint.com/cyber-hub/network-security/what-is-sd-wan/benefits-of-sd-wan/)
- [Assessing the Impact of Carrier-Grade NAT on
Network Applications](https://tools.ietf.org/html/rfc7021)
- [Tunneling out of Carrier Grade Nat (CGNAT) with SSH and AWS | Don&#39;s Blog](https://www.donaldsimpson.co.uk/2016/10/24/tunneling-out-of-carrier-grade-nat-cgnat-with-ssh-and-aws/)</description>
    
    <lastBuildDate>Wed, 23 Jun 2021 13:36:30 +0000</lastBuildDate>
    <category>Networking</category>
    <atom:link href="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Scanning WAN&#39;s and Stalking strange devices</title>
        <dc:creator><![CDATA[system]]></dc:creator>
        <description><![CDATA[
            <p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
          <p><a href="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/8">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/8</link>
        <pubDate>Wed, 20 Oct 2021 02:58:10 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-26374-8</guid>
        <source url="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374.rss">Scanning WAN&#39;s and Stalking strange devices</source>
      </item>
      <item>
        <title>Scanning WAN&#39;s and Stalking strange devices</title>
        <dc:creator><![CDATA[messede]]></dc:creator>
        <description><![CDATA[
            <p>yep httpx is one handy tool</p>
          <p><a href="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/7">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/7</link>
        <pubDate>Wed, 23 Jun 2021 13:36:30 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-26374-7</guid>
        <source url="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374.rss">Scanning WAN&#39;s and Stalking strange devices</source>
      </item>
      <item>
        <title>Scanning WAN&#39;s and Stalking strange devices</title>
        <dc:creator><![CDATA[pry0cc]]></dc:creator>
        <description><![CDATA[
            <p>Such an awesome article! This is super interesting, and it’s great to see somebody else combining httpx with mass scanning!!</p>
          <p><a href="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/6">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/6</link>
        <pubDate>Wed, 23 Jun 2021 12:35:01 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-26374-6</guid>
        <source url="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374.rss">Scanning WAN&#39;s and Stalking strange devices</source>
      </item>
      <item>
        <title>Scanning WAN&#39;s and Stalking strange devices</title>
        <dc:creator><![CDATA[New001]]></dc:creator>
        <description><![CDATA[
            <p>This is very cool. Great post, really. <img src="https://0x00sec.org/images/emoji/twitter/clap.png?v=9" title=":clap:" class="emoji" alt=":clap:"></p>
          <p><a href="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/5">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/5</link>
        <pubDate>Mon, 21 Jun 2021 17:11:23 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-26374-5</guid>
        <source url="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374.rss">Scanning WAN&#39;s and Stalking strange devices</source>
      </item>
      <item>
        <title>Scanning WAN&#39;s and Stalking strange devices</title>
        <dc:creator><![CDATA[messede]]></dc:creator>
        <description><![CDATA[
            <p>Thanks mate , WANs have largely been ignored, but if you spend  time exploring it, you can find some pretty serious stuff.</p>
          <p><a href="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/4">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/4</link>
        <pubDate>Mon, 21 Jun 2021 07:44:22 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-26374-4</guid>
        <source url="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374.rss">Scanning WAN&#39;s and Stalking strange devices</source>
      </item>
      <item>
        <title>Scanning WAN&#39;s and Stalking strange devices</title>
        <dc:creator><![CDATA[vict0ni]]></dc:creator>
        <description><![CDATA[
            <p>That’s really awesome! It’s like a huuuge internal pentest heh. Great research!</p>
          <p><a href="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/2">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/2</link>
        <pubDate>Mon, 21 Jun 2021 07:07:34 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-26374-2</guid>
        <source url="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374.rss">Scanning WAN&#39;s and Stalking strange devices</source>
      </item>
      <item>
        <title>Scanning WAN&#39;s and Stalking strange devices</title>
        <dc:creator><![CDATA[messede]]></dc:creator>
        <description><![CDATA[
            <h2>
<a name="backdrop-1" class="anchor" href="https://0x00sec.org#backdrop-1"></a>BackDrop</h2>
<p>Last month while haphazardly scrolling through a networking book i came across something known as  the <a href="https://en.wikipedia.org/wiki/IPv4_shared_address_space">shared address space </a> , shared addresses are something ISPs use to achieve <a href="https://en.wikipedia.org/wiki/Carrier-grade_NAT">CGNAT</a> (carrier grade NAT) which is just like  regular old NAT but on the ISPs router , ISPs do this so that they don’t have to assign each one you a public address (IPv4 address space is running out/ran out <img src="https://0x00sec.org/images/emoji/twitter/thinking.png?v=9" title=":thinking:" class="emoji" alt=":thinking:"> remember ?) . so CGNAT is basically ISPs  NATing a bunch of  customers into using a single public address in order to conserve the IPv4 address space.</p>
<h3>
<a name="the-shared-address-space-2" class="anchor" href="https://0x00sec.org#the-shared-address-space-2"></a>The shared address space</h3>
<p>According to <a href="https://datatracker.ietf.org/doc/rfc6598/?include_text=1">IANA</a>, 100.64.0.0/10 is reserved for CGNAT purposes.</p>
<blockquote>
<p>Note : some ISPs in their naivety may use private ranges for CGNAT puposes , which certainly will cause problems to customers who use the same address range for their LANs</p>
</blockquote>
<p>Lets compare regular  NAT and CGNAT setups .</p>
<ul>
<li>
<p><em><strong>Regular NAT</strong></em> : all devices in this setup use one public address (193.223.22.22) to communicate with the internet<br>
<img src="https://0x00sec.s3.amazonaws.com/original/3X/9/0/908cf3150c7ca5cfb742cd56634113f5bffb566e.png" alt="Regular NAT" data-base62-sha1="kCKJNIIDDZ0CFQfaqNe1MKVtVJY" width="615" height="251"></p>
</li>
<li>
<p><em><strong>CGNAT</strong></em> :  multiple customers of the ISP share the same public address (193.223.22.22) , in order to  conserve the IPv4 address space.<br>
</p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/d/f/dfb65d87b067166f03487b4c45e4982d7cf0225d.png" data-download-href="/uploads/short-url/vV3bTyZzZvbCscIJGtHgMi4n8Jf.png?dl=1" title="CGNAT"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/d/f/dfb65d87b067166f03487b4c45e4982d7cf0225d_2_489x375.png" alt="CGNAT" data-base62-sha1="vV3bTyZzZvbCscIJGtHgMi4n8Jf" width="489" height="375" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/d/f/dfb65d87b067166f03487b4c45e4982d7cf0225d_2_489x375.png, https://0x00sec.s3.amazonaws.com/optimized/3X/d/f/dfb65d87b067166f03487b4c45e4982d7cf0225d_2_733x562.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/d/f/dfb65d87b067166f03487b4c45e4982d7cf0225d.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/d/f/dfb65d87b067166f03487b4c45e4982d7cf0225d_2_10x10.png"></a></div><p></p>
</li>
</ul>
<blockquote>
<p><em>Note the 100.xx.xx.xx shared address being used in the WAN</em></p>
</blockquote>
<h3>
<a name="our-business-with-the-shared-address-space-isp-wans-3" class="anchor" href="https://0x00sec.org#our-business-with-the-shared-address-space-isp-wans-3"></a>Our Business with the shared address space / ISP WANs</h3>
<p>Now you might ask, why exactly are we interested in this shared address space? well everybody scans LANs and shodan scans the internet, dont you think WANs should recieve fair treatment as well <img src="https://0x00sec.org/images/emoji/twitter/thinking.png?v=9" title=":thinking:" class="emoji" alt=":thinking:"> ?</p>
<p>Here are a few reasons why ISP WANs should be explored :</p>
<ol>
<li>
<p>WANs are special because they contain a lot of devices which are otherwise not reachable from the internet due to CGNAT , these might include poorly configured routers ,ISPs router firmware upgrade servers etc.</p>
</li>
<li>
<p>WANs of Mobile Network provider are especially interesting , as many embedded devices<br>
use them , examples of such devices could be street light systems, traffic controllers, customer modems etc.</p>
</li>
<li>
<p>WANs present a unexplored landscape where you are more likely to discover something exciting.</p>
</li>
</ol>
<h3>
<a name="getting-down-to-business-4" class="anchor" href="https://0x00sec.org#getting-down-to-business-4"></a>Getting Down to Business</h3>
<p><em><strong>Tools of trade</strong></em> : Ive been a long time admirer of masscan, its a stable scanning solution , but recent experience with <a href="https://github.com/RustScan/RustScan">rustscan</a> has also been very good , i find it to be faster than masscan, you can choose whatever suits you.</p>
<p><em><strong>Finding the right range to scan</strong></em> : Mobile ISP tend to use the shared address space 100.64.0.0/10 , while broadband ISPs are more likely to use private ranges such as 172.16.0.0/12 or 10.0.0.0/8, in either case these are very large ranges to scan, in case of broadband ISPs you can visit you routers page to find your WAN address , in case of mobile ISPs you can visit your phones ‘about’ section in settings to find your IP/WAN address, if your using a modem ifconfig should do the trick.</p>
<blockquote>
<p>Note : not all ISPs employ CGNAT , dont be surprised if you see a public address in place of your WAN address</p>
</blockquote>
<p><em><strong>Scanning Smartly</strong></em> : Like i have previously mentioned ip ranges used for WAN are large, instead of wasting time scanning the entire range you can you the following trick , lets say your WAN address is 10.27.27.123, you could scan the subnet 10.27.0.0/16 since you were assigned a address in this range, it is likely that other devices exist in the same range, you could also scan subsequent ranges such as 10.28.0.0/16, 10.29.0.0/16 and so forth as it is very likely that ISP uses these (masscan automatically does this), another neat trick is case of mobile ISPs is to continuously connect and disconnect from the network while noting down your WAN address each time, this should give you a good idea of the subnets your ISP uses.</p>
<blockquote>
<p>Note : Its likely devices you find in WANs will change their addresses from time to time , especially in case of mobile networks , its thus advisable to scan smaller ip block and immediately analyze the results.</p>
</blockquote>
<blockquote>
<p>Note : In a few cases you might be able to reach a few not so obvious private ranges which your ISP might be using, for example lets say your WAN address is 100.90.1.27, you would assume that your ISP only uses the shared address space 100.64.0.0/10, but this is not always the case, you may be able to reach devices in the subnets 172.16.0.0/12 or 10.0.0.0/8, a random scan of these address space might reveal interesting targets, performing a traceroute to a internet address(say 8.8.8.8) can also reveal the use of such alternate WAN address spaces.</p>
</blockquote>
<p><em><strong>Scanning and analyzing devices</strong></em> :</p>
<ul>
<li>Scanning with masscan :<br>
<code>sudo masscan -p80 100.99.0.0/16 2&gt; /dev/null | tee results.txt</code><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/4/b/4b7eefce2e27aa94502f7297f0a22f54e11abf8d.png" data-download-href="/uploads/short-url/aLRLNHz8p8H169T6ywJJP0g3soB.png?dl=1" title="masscan"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/4/b/4b7eefce2e27aa94502f7297f0a22f54e11abf8d_2_517x265.png" alt="masscan" data-base62-sha1="aLRLNHz8p8H169T6ywJJP0g3soB" width="517" height="265" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/4/b/4b7eefce2e27aa94502f7297f0a22f54e11abf8d_2_517x265.png, https://0x00sec.s3.amazonaws.com/optimized/3X/4/b/4b7eefce2e27aa94502f7297f0a22f54e11abf8d_2_775x397.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/4/b/4b7eefce2e27aa94502f7297f0a22f54e11abf8d.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/4/b/4b7eefce2e27aa94502f7297f0a22f54e11abf8d_2_10x10.png"></a></div>
</li>
</ul>
<blockquote>
<p>Note: piping masscans error stream to /dev/null hides its status messages so that you can get a clean output file , although masscan does support the ‘-oL’ option like nmap for output, the above approach shows you ips discovered in realtime and also saves them in the result file, while the ‘-oL’ option requires you wait untill the whole scan is complete in order to view the results.</p>
</blockquote>
<blockquote>
<p>Note: if you are using a modem and masscan timesout with a ARP resolve error, specify the MAC address of your modem using the --router-mac=aa:bb:cc:dd:ee:ff option.</p>
</blockquote>
<blockquote>
<p>Note: you can save time by increasing packet rate of masscan using --rate option , --rate=300 is a good rate for 4G mobile networks , broadband users can rise it even higher , but be mindful of the packet rate, very high packet rate can negatively affect device discovery probability.</p>
</blockquote>
<ul>
<li>
<p>Analyzing results:  since we scanned for port 80, we can use httpx to look for interesting targets.</p>
<ul>
<li>
<p>Picking ips from the results file<br>
<code>cat results.txt | cut -f6 -d' ' &gt; ip.txt</code></p>
</li>
<li>
<p>Probing targets with httpx<br>
<code>httpx -status-code -title -l ip.txt</code><br>
</p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/e/d/edefb59d5372b9a367fc7e76804bb4c25c2cbf7c.png" data-download-href="/uploads/short-url/xWSJBADP9MZ6Gm3Hk18cRGrXKNe.png?dl=1" title="httpx"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/e/d/edefb59d5372b9a367fc7e76804bb4c25c2cbf7c_2_517x290.png" alt="httpx" data-base62-sha1="xWSJBADP9MZ6Gm3Hk18cRGrXKNe" width="517" height="290" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/e/d/edefb59d5372b9a367fc7e76804bb4c25c2cbf7c_2_517x290.png, https://0x00sec.s3.amazonaws.com/optimized/3X/e/d/edefb59d5372b9a367fc7e76804bb4c25c2cbf7c_2_775x435.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/e/d/edefb59d5372b9a367fc7e76804bb4c25c2cbf7c.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/e/d/edefb59d5372b9a367fc7e76804bb4c25c2cbf7c_2_10x10.png"></a></div><p></p>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>Note: while i have choosen to target web based services(port 80) here, you can modify your scan to include ssh and telnet ports, which perhaps will yield more interesting results.</p>
</blockquote>
<p><em><strong>Recommended ports for scanning</strong></em> :</p>
<div class="md-table">
<table>
<thead>
<tr>
<th style="text-align:center"><strong>Port</strong></th>
<th style="text-align:center"><strong>Type</strong></th>
<th style="text-align:center"><strong>Service</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">80</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">HTTP</td>
</tr>
<tr>
<td style="text-align:center">8000</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">HTTP ALT</td>
</tr>
<tr>
<td style="text-align:center">9000</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">HTTP ALT</td>
</tr>
<tr>
<td style="text-align:center">8080</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">HTTP ALT</td>
</tr>
<tr>
<td style="text-align:center">21</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">FTP</td>
</tr>
<tr>
<td style="text-align:center">22</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">SSH</td>
</tr>
<tr>
<td style="text-align:center">23</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">Telnet</td>
</tr>
<tr>
<td style="text-align:center">502</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">ModBus</td>
</tr>
<tr>
<td style="text-align:center">5555</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">ADB</td>
</tr>
</tbody>
</table>
</div><br>
<p><em><strong>Persistant Access / Device Rediscovery</strong></em> : Devices on WANs can change their ip address unpredictably , this can happen due to power outage, network disconnection etc, this is more wide spread in case of Mobile Networks, its a pain to re-scan an entire network range to find a particular device you are interested in, in such cases you can leverage  <a href="https://en.wikipedia.org/wiki/Dynamic_DNS">DDNS</a> settings which many devices offer, you can create an free account on <a href="https://www.noip.com/">NoIp</a> (upto 3 devices) and setup the DDNS service on the device, so everytime a device changes its WAN address it will update the corresponding DDNS hostname accordingly , you’ll just have to resolve your DDNS hostname to find its WAN address.</p>
<blockquote>
<p>Note: If you are confused as to why a DDNS client would update its WAN address instead of its public address to the DDNS server, DDNS client works by checking the WAN interfaces ip address, it does not attempt to determine its actual public ip address, in its point of view the address assigned to the WAN interface is globally routable.</p>
</blockquote>
<p><em><strong>Results</strong></em> :  Lets take a look what we managed to find</p>
<p><em>strange routers that i have never seen before</em> :</p>
<p></p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/b/e/bed7d48101bcfae9cfc7d8e6b7530f903005d03f.png" data-download-href="/uploads/short-url/reh8g7Xv3FBLkmQRMgheLE81OlF.png?dl=1" title="hp"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/b/e/bed7d48101bcfae9cfc7d8e6b7530f903005d03f_2_517x242.png" alt="hp" data-base62-sha1="reh8g7Xv3FBLkmQRMgheLE81OlF" width="517" height="242" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/b/e/bed7d48101bcfae9cfc7d8e6b7530f903005d03f_2_517x242.png, https://0x00sec.s3.amazonaws.com/optimized/3X/b/e/bed7d48101bcfae9cfc7d8e6b7530f903005d03f_2_775x363.png 1.5x, https://0x00sec.s3.amazonaws.com/optimized/3X/b/e/bed7d48101bcfae9cfc7d8e6b7530f903005d03f_2_1034x484.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/b/e/bed7d48101bcfae9cfc7d8e6b7530f903005d03f_2_10x10.png"></a></div><br>
<br><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/b/4/b43b5ff9a32a3cdbadbbee9f48e4c2a163b2f4dd.png" data-download-href="/uploads/short-url/pIp9B8O3JJiLM5BVS4taNNVEF3f.png?dl=1" title="four-faith"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/b/4/b43b5ff9a32a3cdbadbbee9f48e4c2a163b2f4dd_2_474x375.png" alt="four-faith" data-base62-sha1="pIp9B8O3JJiLM5BVS4taNNVEF3f" width="474" height="375" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/b/4/b43b5ff9a32a3cdbadbbee9f48e4c2a163b2f4dd_2_474x375.png, https://0x00sec.s3.amazonaws.com/optimized/3X/b/4/b43b5ff9a32a3cdbadbbee9f48e4c2a163b2f4dd_2_711x562.png 1.5x, https://0x00sec.s3.amazonaws.com/optimized/3X/b/4/b43b5ff9a32a3cdbadbbee9f48e4c2a163b2f4dd_2_948x750.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/b/4/b43b5ff9a32a3cdbadbbee9f48e4c2a163b2f4dd_2_10x10.png"></a></div><br>
<br><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/4/7/4749005d91018481bf630b93b1077ef760ecec06.png" data-download-href="/uploads/short-url/aaCiVl6f8HjX3qDua2DTHTu5B1s.png?dl=1" title="nirad"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/4/7/4749005d91018481bf630b93b1077ef760ecec06_2_517x309.png" alt="nirad" data-base62-sha1="aaCiVl6f8HjX3qDua2DTHTu5B1s" width="517" height="309" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/4/7/4749005d91018481bf630b93b1077ef760ecec06_2_517x309.png, https://0x00sec.s3.amazonaws.com/optimized/3X/4/7/4749005d91018481bf630b93b1077ef760ecec06_2_775x463.png 1.5x, https://0x00sec.s3.amazonaws.com/optimized/3X/4/7/4749005d91018481bf630b93b1077ef760ecec06_2_1034x618.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/4/7/4749005d91018481bf630b93b1077ef760ecec06_2_10x10.png"></a></div><p></p>
<p><em><strong>IOT devices</strong></em><br>
</p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/6/a/6a018db10b1475477b2930d5ccc2597289e8e228.png" data-download-href="/uploads/short-url/f7LWi5m6ylQCLPFTIzUQZbZLIOA.png?dl=1" title="cmd-meter"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/6/a/6a018db10b1475477b2930d5ccc2597289e8e228_2_517x261.png" alt="cmd-meter" data-base62-sha1="f7LWi5m6ylQCLPFTIzUQZbZLIOA" width="517" height="261" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/6/a/6a018db10b1475477b2930d5ccc2597289e8e228_2_517x261.png, https://0x00sec.s3.amazonaws.com/optimized/3X/6/a/6a018db10b1475477b2930d5ccc2597289e8e228_2_775x391.png 1.5x, https://0x00sec.s3.amazonaws.com/optimized/3X/6/a/6a018db10b1475477b2930d5ccc2597289e8e228_2_1034x522.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/6/a/6a018db10b1475477b2930d5ccc2597289e8e228_2_10x10.png"></a></div><p></p>
<p></p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/2/e/2e4765ff8c4f958b02cac0730848fbd6807f60d0.png" data-download-href="/uploads/short-url/6BoVUzGzlxOR8nWglwESRyydwn6.png?dl=1" title="wattmon"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/2/e/2e4765ff8c4f958b02cac0730848fbd6807f60d0_2_690x280.png" alt="wattmon" data-base62-sha1="6BoVUzGzlxOR8nWglwESRyydwn6" width="690" height="280" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/2/e/2e4765ff8c4f958b02cac0730848fbd6807f60d0_2_690x280.png, https://0x00sec.s3.amazonaws.com/optimized/3X/2/e/2e4765ff8c4f958b02cac0730848fbd6807f60d0_2_1035x420.png 1.5x, https://0x00sec.s3.amazonaws.com/optimized/3X/2/e/2e4765ff8c4f958b02cac0730848fbd6807f60d0_2_1380x560.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/2/e/2e4765ff8c4f958b02cac0730848fbd6807f60d0_2_10x10.png"></a></div><p></p>
<p><em><strong>subscriber modems</strong></em><br>
</p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/5/d/5d4a91871327c4550a331e62fb320b9ecbc4f4ed.png" data-download-href="/uploads/short-url/djialMkRU2Zb7JJZ29dXOYE8TX7.png?dl=1" title="digisol"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/5/d/5d4a91871327c4550a331e62fb320b9ecbc4f4ed_2_517x259.png" alt="digisol" data-base62-sha1="djialMkRU2Zb7JJZ29dXOYE8TX7" width="517" height="259" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/5/d/5d4a91871327c4550a331e62fb320b9ecbc4f4ed_2_517x259.png, https://0x00sec.s3.amazonaws.com/optimized/3X/5/d/5d4a91871327c4550a331e62fb320b9ecbc4f4ed_2_775x388.png 1.5x, https://0x00sec.s3.amazonaws.com/optimized/3X/5/d/5d4a91871327c4550a331e62fb320b9ecbc4f4ed_2_1034x518.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/5/d/5d4a91871327c4550a331e62fb320b9ecbc4f4ed_2_10x10.png"></a></div><br>
<br><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/4/f/4f3066efe8fb0cc3ab532ccf2e4b4669ec576588.png" data-download-href="/uploads/short-url/bixq71CRGVq5ZZ0zskItHbL7gb6.png?dl=1" title="enter"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/4/f/4f3066efe8fb0cc3ab532ccf2e4b4669ec576588_2_517x242.png" alt="enter" data-base62-sha1="bixq71CRGVq5ZZ0zskItHbL7gb6" width="517" height="242" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/4/f/4f3066efe8fb0cc3ab532ccf2e4b4669ec576588_2_517x242.png, https://0x00sec.s3.amazonaws.com/optimized/3X/4/f/4f3066efe8fb0cc3ab532ccf2e4b4669ec576588_2_775x363.png 1.5x, https://0x00sec.s3.amazonaws.com/optimized/3X/4/f/4f3066efe8fb0cc3ab532ccf2e4b4669ec576588_2_1034x484.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/4/f/4f3066efe8fb0cc3ab532ccf2e4b4669ec576588_2_10x10.png"></a></div><br>
<br><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/d/5/d5d39cf087616b1bd9209f7d5b628c81aca8b1f2.png" data-download-href="/uploads/short-url/uvB4XLujf871YGnrMCbeolywU2m.png?dl=1" title="techie"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/d/5/d5d39cf087616b1bd9209f7d5b628c81aca8b1f2_2_517x333.png" alt="techie" data-base62-sha1="uvB4XLujf871YGnrMCbeolywU2m" width="517" height="333" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/d/5/d5d39cf087616b1bd9209f7d5b628c81aca8b1f2_2_517x333.png, https://0x00sec.s3.amazonaws.com/optimized/3X/d/5/d5d39cf087616b1bd9209f7d5b628c81aca8b1f2_2_775x499.png 1.5x, https://0x00sec.s3.amazonaws.com/optimized/3X/d/5/d5d39cf087616b1bd9209f7d5b628c81aca8b1f2_2_1034x666.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/d/5/d5d39cf087616b1bd9209f7d5b628c81aca8b1f2_2_10x10.png"></a></div><p></p>
<p><em><strong>firewalls</strong></em><br>
</p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/f/b/fbb7e57dc906e6588085df7324f560b9f2b55902.png" data-download-href="/uploads/short-url/zUNQanNv9rwWRlwd10qmoCw1Usy.png?dl=1" title="juniper"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/f/b/fbb7e57dc906e6588085df7324f560b9f2b55902_2_491x375.png" alt="juniper" data-base62-sha1="zUNQanNv9rwWRlwd10qmoCw1Usy" width="491" height="375" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/f/b/fbb7e57dc906e6588085df7324f560b9f2b55902_2_491x375.png, https://0x00sec.s3.amazonaws.com/optimized/3X/f/b/fbb7e57dc906e6588085df7324f560b9f2b55902_2_736x562.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/f/b/fbb7e57dc906e6588085df7324f560b9f2b55902.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/f/b/fbb7e57dc906e6588085df7324f560b9f2b55902_2_10x10.png"></a></div><br>
<br><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/a/4/a4301662027d62d1bf79efa19a2fff587d727790.png" data-download-href="/uploads/short-url/nqtkAdMq5kKaHmNAsj8VS9xcwes.png?dl=1" title="dell"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/a/4/a4301662027d62d1bf79efa19a2fff587d727790_2_517x358.png" alt="dell" data-base62-sha1="nqtkAdMq5kKaHmNAsj8VS9xcwes" width="517" height="358" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/a/4/a4301662027d62d1bf79efa19a2fff587d727790_2_517x358.png, https://0x00sec.s3.amazonaws.com/optimized/3X/a/4/a4301662027d62d1bf79efa19a2fff587d727790_2_775x537.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/a/4/a4301662027d62d1bf79efa19a2fff587d727790.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/a/4/a4301662027d62d1bf79efa19a2fff587d727790_2_10x10.png"></a></div><p></p>
<blockquote>
<p>Note: ‘TCCC’ stands for ‘The Coca Cola Company’ (no im not kidding <img src="https://0x00sec.org/images/emoji/twitter/smile.png?v=9" title=":smile:" class="emoji" alt=":smile:"> )</p>
</blockquote>
<h3>
<a name="observations-5" class="anchor" href="https://0x00sec.org#observations-5"></a>Observations</h3>
<ul>
<li>Firstly we notice a variety of <em><strong>routers</strong></em> whose administration panels are accessible from the WAN network,this is often the result of misconfiguring the http service to listen on all interfaces, the absence of routers manufactured by popular vendors in our results tells us that such a misconfiguration is rather the trait of uncommon and shady vendors, if one finds routers from such vendors in large numbers it is likely that the ISP is distributing them, for they are cheaper than regular routers.<br>
<br>
</li>
<li>
<em><strong>IOT devices</strong></em> : we come across the administrative interface of a very interesting device which seems to be an electric meter(how do i know ?, i checked the vendors website)(the other screenshot is of a controller of modbus devices), the sheer nature of such devices requires them to use mobile networks for connectivity, in which case its obvious that there does not exist any router/intermediate device between such a IOT device and the ISPs router , this combined with the fact that it exposes a administrative interface (most likely by default) yet again confirms the infamous security posture of IOT devices. Like a good friend of mine once said “The ‘S’ in IOT stands for Security”. WANs in near future(if not already) will be gold mines of IOT devices which depend on mobile networks.<br>
<br>
</li>
<li>
<em><strong>Subscriber modems</strong></em> are the devices you are most likely to run into when scanning mobile ISP WANs, it does not always have to be those old-fashioned data cards , there are also devices such as these (a travel modem)<br>
<img src="https://0x00sec.s3.amazonaws.com/original/3X/2/9/29e774559db0ff1451748f5b1718684b8e9fed5e.jpeg" alt="tplink" data-base62-sha1="5YHsPVhc1NvcQz1PUoiothpNdx4" width="273" height="223"><br>
only devices such as these and datacards(ones with wifi) have web based administrative interfaces. These devices are fascinating because of their capability to send and recieve SMS messages, many services on the internet requires SMS verification (example: <a href="https://hunter.io">hunter.io</a>) to prevent fraud , these services can also detect disposable phone numbers and VOIP numbers which leaves attackers without much choice, in such cases these modems become lucrative targets.</li>
</ul>
<blockquote>
<p>Note: one can determine a modems phone number by running a operator specific <a href="https://en.wikipedia.org/wiki/Unstructured_Supplementary_Service_Data">USSD</a> code, some operators have a SMS based service wherein they send back the phone number when you send a SMS to specific service number, in other cases one can check the SMS archive of the modem, some messages from operators might contain the phone number.</p>
</blockquote>
<ul>
<li>Dicovering Firewalls on broadband ISP WANs are pretty common , but i found a few on a mobile ISPs network , after some research i found that many enterprise grade firewalls have a so called ‘fail safe’ mode wherein you connect a modem to the firewall which makes it accessible even when all wired internet connections fail.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/7/b/7b1d7fe7ca3a8278fdce9a9e30946d79f4d38fb9.jpeg" data-download-href="/uploads/short-url/hz7VKOdQEoAqtSejjz10oV1FGml.jpeg?dl=1" title="checkpoint-min"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/7/b/7b1d7fe7ca3a8278fdce9a9e30946d79f4d38fb9_2_517x358.jpeg" alt="checkpoint-min" data-base62-sha1="hz7VKOdQEoAqtSejjz10oV1FGml" width="517" height="358" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/7/b/7b1d7fe7ca3a8278fdce9a9e30946d79f4d38fb9_2_517x358.jpeg, https://0x00sec.s3.amazonaws.com/optimized/3X/7/b/7b1d7fe7ca3a8278fdce9a9e30946d79f4d38fb9_2_775x537.jpeg 1.5x, https://0x00sec.s3.amazonaws.com/optimized/3X/7/b/7b1d7fe7ca3a8278fdce9a9e30946d79f4d38fb9_2_1034x716.jpeg 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/7/b/7b1d7fe7ca3a8278fdce9a9e30946d79f4d38fb9_2_10x10.png"></a></div>
</li>
</ul>
<h3>
<a name="limitations-6" class="anchor" href="https://0x00sec.org#limitations-6"></a>Limitations</h3>
<ul>
<li>
<p>Like i have previously mentioned, not all ISP have CGNATS<br>
in such cases there is not much you can do.</p>
</li>
<li>
<p>A WAN network usually contains users of a particular area or a city, there may not be too many devices sometimes</p>
</li>
<li>
<p>Some ISPs prevent communication between devices in a WAN (i’m not sure how effective this actually is)</p>
</li>
<li>
<p>Interacting with devices on a WAN (especially on mobile networks) is extremely slow sometimes.</p>
</li>
</ul>
<h3>
<a name="references-7" class="anchor" href="https://0x00sec.org#references-7"></a>References</h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/IPv4_shared_address_space">IPv4_shared_address_space</a></li>
<li><a href="https://datatracker.ietf.org/doc/rfc6598/?include_text=1">rfc6598</a></li>
<li><a href="https://en.wikipedia.org/wiki/Carrier-grade_NAT">Carrier-grade_NAT</a></li>
<li><a href="https://en.wikipedia.org/wiki/Unstructured_Supplementary_Service_Data">USSD</a></li>
<li><a href="https://en.wikipedia.org/wiki/Dynamic_DNS">Dynamic_DNS</a></li>
</ul>
<h3>
<a name="tools-8" class="anchor" href="https://0x00sec.org#tools-8"></a>Tools:</h3>
<ul>
<li><a href="https://github.com/RustScan/RustScan">RustScan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">Masscan</a></li>
</ul>
<h3>
<a name="further-reading-9" class="anchor" href="https://0x00sec.org#further-reading-9"></a>Further Reading:</h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Network_address_translation">Network_address_translation</a></li>
<li><a href="https://www.cisco.com/c/en/us/products/switches/what-is-a-wan-wide-area-network.html">WANs by CISCO</a></li>
<li><a href="https://www.checkpoint.com/cyber-hub/network-security/what-is-sd-wan/benefits-of-sd-wan/">The Benefits of SD-WAN</a></li>
<li><a href="https://tools.ietf.org/html/rfc7021">Assessing the Impact of Carrier-Grade NAT on<br>
Network Applications</a></li>
<li><a href="https://www.donaldsimpson.co.uk/2016/10/24/tunneling-out-of-carrier-grade-nat-cgnat-with-ssh-and-aws/">Tunneling out of Carrier Grade Nat (CGNAT) with SSH and AWS | Don’s Blog</a></li>
</ul>
          <p><a href="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/1">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374/1</link>
        <pubDate>Sun, 20 Jun 2021 10:58:02 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-26374-1</guid>
        <source url="https://0x00sec.org/t/scanning-wans-and-stalking-strange-devices/26374.rss">Scanning WAN&#39;s and Stalking strange devices</source>
      </item>
  </channel>
</rss>
