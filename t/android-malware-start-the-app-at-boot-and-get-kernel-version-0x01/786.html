<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Android Malware - Start the app at boot and get kernel Version 0x01 - Malware - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="#Introduction 
Hi everyone ! Today, we will start to making the malware application for the Android OS, before you begin with this tutorial. If you want to be confortable with the tutorial you should have some basic know&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="786.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Android Malware - Start the app at boot and get kernel Version 0x01&#39;" href="786.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/1X/f3c182b3a8694f7812ce47c70e6f405a5d5a160f.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/1X/f3c182b3a8694f7812ce47c70e6f405a5d5a160f.png" />
<meta property="og:url" content="https://0x00sec.org/t/android-malware-start-the-app-at-boot-and-get-kernel-version-0x01/786" />
<meta name="twitter:url" content="https://0x00sec.org/t/android-malware-start-the-app-at-boot-and-get-kernel-version-0x01/786" />
<meta property="og:title" content="Android Malware - Start the app at boot and get kernel Version 0x01" />
<meta name="twitter:title" content="Android Malware - Start the app at boot and get kernel Version 0x01" />
<meta property="og:description" content="#Introduction  Hi everyone ! Today, we will start to making the malware application for the Android OS, before you begin with this tutorial. If you want to be confortable with the tutorial you should have some basic knowledge of Java/Android programming ( class, method, permission).  If you don’t understand some part of the code feel free to ask me more information 😃  Let’s begin !  Part I - Check kernel Version  Can I use towelroot to root the device ? Towelroot is an exploit made by geo..." />
<meta name="twitter:description" content="#Introduction  Hi everyone ! Today, we will start to making the malware application for the Android OS, before you begin with this tutorial. If you want to be confortable with the tutorial you should have some basic knowledge of Java/Android programming ( class, method, permission).  If you don’t understand some part of the code feel free to ask me more information 😃  Let’s begin !  Part I - Check kernel Version  Can I use towelroot to root the device ? Towelroot is an exploit made by geo..." />
<meta property="og:article:section" content="Malware" />
<meta property="og:article:section:color" content="F7941D" />
<meta property="og:article:tag" content="malware" />
<meta property="og:article:tag" content="android" />
<meta property="og:article:tag" content="hacking" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="10 ❤" />
<meta property="article:published_time" content="2016-07-22T11:32:43+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="786.html">Android Malware - Start the app at boot and get kernel Version 0x01</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/malware.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F7941D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Malware</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/malware.html" class="discourse-tag" rel="tag">malware</a>,
<a href="../../tag/android.html" class="discourse-tag" rel="tag">android</a>,
<a href="../../tag/hacking.html" class="discourse-tag" rel="tag">hacking</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Android Malware - Start the app at boot and get kernel Version 0x01">
<meta itemprop="articleSection" content="Malware">
<meta itemprop="keywords" content="malware, android, hacking">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/L3akM3-0day"><span itemprop="name">L3akM3-0day</span></a>
</span>
<link itemprop="mainEntityOfPage" href="786.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/1X/f3c182b3a8694f7812ce47c70e6f405a5d5a160f.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-07-22T11:32:43Z" class="post-time">
July 22, 2016, 11:32am
</time>
<meta itemprop="dateModified" content="2016-07-22T11:37:50Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p><span class="hashtag">#Introduction</span></p>
<p>Hi everyone ! Today, we will start to making the malware application for the <strong>Android OS</strong>, before you begin with this tutorial. If you want to be confortable with the tutorial you should have some basic knowledge of Java/Android programming ( class, method, permission).</p>
<p>If you don’t understand some part of the code feel free to ask me more information <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>Let’s begin !</p>
<h1>Part I - Check kernel Version</h1>
<hr>
<h2>Can I use towelroot to root the device ?</h2>
<p>Towelroot is an exploit made by geohot ( available here <a href="https://towelroot.com/" rel="noopener nofollow ugc">TowelRoot</a> is you’re want to root your device ). The exploit made by geohot exploit the futex_requeue function in kernel/futex.c in Linux kernel through 3.14.5.</p>
<p>Our Malware today will be able to</p>
<ul>
<li>Get the currentKernel of the device</li>
<li>Check if the kernel is greater than 3.14.15</li>
</ul>
<p><em>I’ll use Android studio on window platform but you can use eclipse or whatever IDE you like</em></p>
<p>Here I create a new project :</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/1X/7186e82fa9aeed80d85d3a363ee78f530a61229f.png" width="690" height="370"></p>
<p>Choose the minimun sdk</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/1X/6b76768aaa21f42bc0760e35e7e548ad75351ade.png" width="690" height="449"></p>
<p>Start with Empty activity<br>
<img src="https://0x00sec.s3.amazonaws.com/original/1X/5ffb1b5c60a5a81c20e08d7f4f5fd7bed664068b.png" width="690" height="449"></p>
<h2>Class GatherInformation</h2>
<p>Now that our project is created we will create a class GatherInformation. The class will have a method <em>isExploitable</em>, if the device is exploitable by the towelroot exploit the method will return true.</p>
<p>Create a new class GatherInformation</p>
<pre><code class="lang-java">package com.android.malwaretutorial_test;

/**
 * Created by jphet on 22/07/2016.
 */
public class GatherInformation {
    /** Method to verify kernel version**/
    public static boolean isExploitable() {
        /** Kernel will stock the current kernel device**/
        String kernel = System.getProperty("os.version").split("-")[0];
        /** For a 3.12.5 kernel , the variable will have : 3.12.5 as a string value 
            We split the kernel variable into an array =&gt; [3, 12, 5 ]
            we parse the string as and integer and we compare the kernel to see if we can use futex ( towelroot )
        **/
        if (Integer.parseInt(kernel.split("\\.")[0]) &lt;= 3) {
            if (Integer.parseInt(kernel.split("\\.")[1]) &lt;= 14) {
                if (Integer.parseInt(kernel.split("\\.")[2]) &lt;= 15) {
                    return true;
                }
            }
        }
        return false;
    }
}


</code></pre>
<p>Now we will print this to the screen to test our code. In the MainActivity</p>
<pre><code class="lang-java">public class MainActivity extends AppCompatActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        /** Create a textView **/
        TextView text = (TextView)findViewById(R.id.exploitable);
       /** If the function return true print Root the device on the app **/
        if(GatherInformation.isExploitable()){
            text.setText("Root the device ! :) ");
        }
        else {
            text.setText("Nooo :( Towelroot won't work");
        }
    }
}
</code></pre>
<p>In the activity_main.xml you should add an id to your text view</p>
<pre><code class="lang-xml">&lt;TextView
        android:id="@+id/exploitable"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Hello World!" /&gt;
</code></pre>
<p>Here the result</p>
<p>With a kernel &gt; 3.14.15<br>
<img src="https://0x00sec.s3.amazonaws.com/original/1X/f3c182b3a8694f7812ce47c70e6f405a5d5a160f.png" alt="Imgur" width height></p>
<p>With a kernel &lt;= 3.14.15</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/1X/55516b0d45daa965119051766a780061b4697e98.png" width="321" height="484"></p>
<h1>Part II - Start application everytime the phone boot</h1>
<hr>
<p>Now we will start the application everytime the phone boot. We will make a new class called BootReceiver, this class will inherit the Broadcast Receivcer</p>
<h2>BroadcastReceiver</h2>
<pre><code class="lang-java">package com.android.malwaretutorial_test;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

public class BootReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        /** if the boot is completed **/
        if(Intent.ACTION_BOOT_COMPLETED.equals(intent.getAction())){
            /** Start the MainActivity.class everytime the phone boot**/
            Intent i = new Intent(context, MainActivity.class);
            context.startActivity(i);
        }
    }
}
</code></pre>
<h2>Permission</h2>
<p>Now we need to add permission to the manifest <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<pre><code class="lang-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.android.malwaretutorial_test"&gt;
    &lt;!--PERMISSION--&gt;
    &lt;uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/&gt;
    &lt;!--PERMISSION--&gt;
    &lt;application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:supportsRtl="true"
        android:theme="@style/AppTheme"&gt;
        &lt;activity android:name=".MainActivity"&gt;

            &lt;intent-filter&gt;
                &lt;action android:name="android.intent.action.MAIN" /&gt;
                &lt;action android:name="android.intent.category.DEFAULT" /&gt;

                &lt;category android:name="android.intent.category.LAUNCHER" /&gt;

            &lt;/intent-filter&gt;

        &lt;/activity&gt;

    &lt;/application&gt;

&lt;/manifest&gt;


</code></pre>
<p>Good job ! <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Now everytime you boot your phone the app will launch and tell you if your device can be rooted.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="7" />
<span class="post-likes">7 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../android-malware-a-tumor-called-marla-0x02/851.html">Android Malware : A tumor called Marla 0x02</a>
<meta itemprop="position" content="2">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../android-malware-start-the-app-at-boot-and-get-kernel-version-0x01-c/793.html">Android Malware - Start the App at Boot and get Kernel Version 0x01 [C#]</a>
<meta itemprop="position" content="3">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="786.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-07-22T11:37:12Z" class="post-time">
July 22, 2016, 11:37am
</time>
<meta itemprop="dateModified" content="2016-07-22T11:37:12Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Well that’s a pretty good start! I’m exited to see it actually root the phone though!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/REal0day"><span itemprop="name">REal0day</span></a>
</span>
<link itemprop="mainEntityOfPage" href="786.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-01-16T07:25:28Z" class="post-time">
January 16, 2018, 7:25am
</time>
<meta itemprop="dateModified" content="2018-01-16T07:25:28Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Did this tutorial and I LOVED it.<br>
I wanted to just add all the features of towelroot to my Malware Tutorial APK, but am running around decompiling tr.apk, looking at TowelRoot.smali, libexploit.so, and getting a bit confused.</p>
<p>Wondering if I’m approaching this correctly, or if maybe I should just request more permissions from the user, and somehow write some code the will</p>
<ol>
<li>Download towelroot</li>
<li>Run it to gain root</li>
<li>Hide that app, or make it not appear.</li>
</ol>
<p>Any advice on this would be great!<br>
Thanks!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="786.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-01-21T00:42:19Z" class="post-time">
January 21, 2018, 12:42am
</time>
<meta itemprop="dateModified" content="2018-01-21T00:42:19Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
