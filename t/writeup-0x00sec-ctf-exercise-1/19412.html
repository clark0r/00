<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Writeup: 0x00sec CTF - Exercise #1 - CTF - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Writeup CTF 0x00sec Web -  Exercise #1

I was excited as I read that there will be bi-monthly CTF exercises on 0x00sec as I wanted to do some CTFs for a long time now. 
Challenge
The challenge or exercise was in the we&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="19412.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Writeup: 0x00sec CTF - Exercise #1&#39;" href="19412.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/writeup-0x00sec-ctf-exercise-1/19412" />
<meta name="twitter:url" content="https://0x00sec.org/t/writeup-0x00sec-ctf-exercise-1/19412" />
<meta property="og:title" content="Writeup: 0x00sec CTF - Exercise #1" />
<meta name="twitter:title" content="Writeup: 0x00sec CTF - Exercise #1" />
<meta property="og:description" content="Writeup CTF 0x00sec Web -  Exercise #1  I was excited as I read that there will be bi-monthly CTF exercises on 0x00sec as I wanted to do some CTFs for a long time now.  Challenge The challenge or exercise was in the web category. Which means that we have to take a look at web-based attacks like SQL Injections, Cross-Site Scripting and others. It is always good to have the OWASP Top 10 in mind.  The challenges description was:   Get the flag! There are multiple ways to achieve your goal ..." />
<meta name="twitter:description" content="Writeup CTF 0x00sec Web -  Exercise #1  I was excited as I read that there will be bi-monthly CTF exercises on 0x00sec as I wanted to do some CTFs for a long time now.  Challenge The challenge or exercise was in the web category. Which means that we have to take a look at web-based attacks like SQL Injections, Cross-Site Scripting and others. It is always good to have the OWASP Top 10 in mind.  The challenges description was:   Get the flag! There are multiple ways to achieve your goal ..." />
<meta property="og:article:section" content="CTF" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="og:article:tag" content="0x00ctf" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="13 ❤" />
<meta property="article:published_time" content="2020-02-22T11:05:48+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="19412.html">Writeup: 0x00sec CTF - Exercise #1</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/ctf/55.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F1592A"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">CTF</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/0x00ctf.html" class="discourse-tag" rel="tag">0x00ctf</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Writeup: 0x00sec CTF - Exercise #1">
<meta itemprop="articleSection" content="CTF">
<meta itemprop="keywords" content="0x00ctf">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/H45uK1mchi"><span itemprop="name">H45uK1mchi</span></a>
</span>
<link itemprop="mainEntityOfPage" href="19412.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-02-22T11:05:48Z" class="post-time">
February 22, 2020, 11:05am
</time>
<meta itemprop="dateModified" content="2020-02-22T11:05:48Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p><span alt="header-ctf-0x00sec" data-base62-sha1="wOiVhJMMswDlMlkqZB8w6ZTLfjQ" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span></p>
<h1>Writeup CTF 0x00sec Web - Exercise <span class="hashtag">#1</span>
</h1>
<p>I was excited as I read that there will be bi-monthly CTF exercises on <a href="../introducing-bi-monthly-0x00sec-ctf-exercises/19044.html">0x00sec</a> as I wanted to do some CTFs for a long time now.</p>
<h2>Challenge</h2>
<p>The challenge or exercise was in the <em>web</em> category. Which means that we have to take a look at web-based attacks like SQL Injections, Cross-Site Scripting and others. It is always good to have the <a href="https://owasp.org/www-project-top-ten/" rel="nofollow noopener">OWASP Top 10</a> in mind.</p>
<p>The challenges description was:</p>
<blockquote>
<p>Get the flag! There are multiple ways to achieve your goal <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</blockquote>
<p>And an URL was provided.</p>
<h3>Initial Recon</h3>
<p>If we open up the URL in a browser, we see a simple login page, where you can enter a username and a password.</p>
<p><span alt="exercise-1" data-base62-sha1="3A0IERLP7vo5aDxyy78HQPFduzL" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span></p>
<p>If you see a login field in a CTF, SQL injections may be the first thing that comes to your mind. But it is always good to do some basic recon first.</p>
<p>Because it is just a simple page with a login field and no links to subpages, we are quite limited with the visual recon. But what we can do, is to view the page source.<br>
This is something that you should always do because you can find quite interesting information in the page source like:</p>
<ul>
<li>Javascript and external javascript files</li>
<li>Hidden inputs</li>
<li>Leftover comments</li>
</ul>
<p>In this case, we have luck and there is an interesting comment in there:</p>
<pre><code class="lang-auto">  &lt;!-- TODO: --&gt;
  &lt;!-- * Remove the git directory after publishing --&gt;
</code></pre>
<p>That sounds indeed good. Public accessible <code>.git/</code> directories are a not that uncommon low-hanging-fruit in bug bounties.</p>
<h2>Git</h2>
<p>First, you should learn what <code>git</code> is and what it is used for. From the <a href="https://git-scm.com/" rel="nofollow noopener">offical page</a>:</p>
<blockquote>
<p>Git is a free and open source distributed version control system designed to handle everything from small to very large projects with speed and efficiency.</p>
</blockquote>
<p>Git is a commonly used version control system for software projects of all kind. It keeps track of your source files and changes that are made to them. If you never used git, you should start by playing around with it, learn some basic commands like <code>git add</code>, <code>git commit</code> and understand how it works.</p>
<p>Public accessible git repositories are very sweet because they very likely contain sensitive information because people often commit security-related keys, passwords and other stuff to it. So our goal is to get this information.</p>
<p>If you now played a bit with git or already familiar with it, you know that git creates a hidden <code>.git</code> folder in your project, where you run <code>git init</code>. In this folder, git keeps track of all the changes and commits you make.</p>
<p>So let’s try to access the <code>.git/</code> folder from the browser, to see if it’s really there.<br>
But, we get a Forbidden message if we try to access it.</p>
<p><span alt="forbidden" data-base62-sha1="lcZ5HLxGM50kTa15efdE5A1qT91" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span></p>
<p>But this is only for the directory listing. If we try to access a specific file, like <code>config</code> we have access.</p>
<p><span alt="git-config" data-base62-sha1="fHQSbv3EzFWh8W91ro0bl3wi5UA" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span></p>
<h3>Grab the repository</h3>
<p>Now there are several ways to get the repository. One easy way is to use <code>wget</code> and recursively download the repository.</p>
<pre><code class="lang-bash">wget -r --no-parent --connect-timeout=5 http://public-git.com/.git/
</code></pre>
<p>However, in our case, this will not work, due to the Access Forbidden error code on the <code>.git/</code> index. If you want to learn more about public git folders and how to download them checkout this <a href="https://en.internetwache.org/dont-publicly-expose-git-or-how-we-downloaded-your-websites-sourcecode-an-analysis-of-alexas-1m-28-07-2015/" rel="nofollow noopener">article</a>.</p>
<p>Another way is to use tools like <a href="https://github.com/internetwache/GitTools" rel="nofollow noopener">GitTools</a>.<br>
With <code>bash ./gitdumper.sh https://exercise-1.0x00sec.dev/.git/ output</code><br>
I downloaded the git repository.</p>
<p><span alt="git-dumper" data-base62-sha1="ry5oIZLDbBDHctyODqE79WGSb8G" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span></p>
<p>Now we can use the terminal git or any gui git client to check out the commits and the source.</p>
<p>With <code>git status</code> we see that there are two staged files to be deleted <code>start.sh</code> and <code>index.php</code>.</p>
<p>The first one is a start script for docker and the latter one the PHP source code of the page.</p>
<h2>The login</h2>
<p>Let’s now take a deeper look into the login action in the PHP source code (index.php).</p>
<p>The login action looks like this:</p>
<pre><code class="lang-php">    if (isset($_POST["username"]) &amp;&amp; isset($_POST["password"])) {
        if ($_POST["username"] == "admin" &amp;&amp; hash('sha256', $_POST["password"]) == "e83176eaefcc1ae8c4a23dbc73ebcf122f26cfb9ba5c7cf4763e96c1c38a6c6c") {
            echo '&lt;h4&gt; '.xor_this(base64_decode("Cl9SEwgSQRVFUA1dAl1dVFkaQF0CWAQUTQ=="), $_POST["password"]).' &lt;/h4&gt;';
        } else {
            echo '&lt;h4 class="error"&gt; Incorrect Password :) &lt;/h4&gt;';
        }
    }
</code></pre>
<p>So if our username is <code>admin</code> and our password matched the sha256 hash, a base64 string will be passed into <code>xor_this(string, key)</code>.</p>
<p>As <code>sha246</code> is not secure we can easily crack it. Or even better, try to look it up. Maybe someone already cracked it.</p>
<p>So I pasted the hash into <a href="https://crackstation.net/" rel="nofollow noopener">CrackStation.net</a> and the hash was already cracked and I got the password.</p>
<p>After the login, the flag was printed out.</p>
<h2>Conclusion</h2>
<p>This CTF exercise was quite fun and also quite a real-world scenario. Because public git directories are real and sadly more common then you might think.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="10" />
<span class="post-likes">10 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="19412.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-02-22T14:53:10Z" class="post-time">
February 22, 2020, 2:53pm
</time>
<meta itemprop="dateModified" content="2020-02-22T14:53:10Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Absolutely awesome writeup mate!</p>
<p>Thank you so much for releasing the writeup so quick <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Really well written!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ueembio_agent"><span itemprop="name">ueembio_agent</span></a>
(ueembio agent)
</span>
<link itemprop="mainEntityOfPage" href="19412.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-03-30T19:41:32Z" class="post-time">
March 30, 2020, 7:41pm
</time>
<meta itemprop="dateModified" content="2020-03-30T19:41:32Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I am new in this domain. And that’s very helpful. Thnx mate</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="19412.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-06-23T03:05:51Z" class="post-time">
June 23, 2020, 3:05am
</time>
<meta itemprop="dateModified" content="2020-06-23T03:05:51Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
