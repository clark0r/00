<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>ORFinder, the easy way to abuse mail servers - Reconnaissance - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="Hi fellas, 
Let me introduce you my last tool, ORFinder 
ORFinder claims to be able to find any smtp services, exposed over the internet, vulnerable to open relay attack. 
Such attack relies on the fact that the sender /&amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="3237.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="LkYk9YKbwMiPLqMtec9ZzTPRO"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="LkYk9YKbwMiPLqMtec9ZzTPRO"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;ORFinder, the easy way to abuse mail servers&#39;" href="3237.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/orfinder-the-easy-way-to-abuse-mail-servers/3237" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/orfinder-the-easy-way-to-abuse-mail-servers/3237" />
<meta property="og:title" content="ORFinder, the easy way to abuse mail servers" />
<meta name="twitter:title" content="ORFinder, the easy way to abuse mail servers" />
<meta property="og:description" content="Hi fellas,  Let me introduce you my last tool, ORFinder  ORFinder claims to be able to find any smtp services, exposed over the internet, vulnerable to open relay attack.  Such attack relies on the fact that the sender / receiver addresses are not checked by the underlying mail server, allowing to perform phishing attacks or any kind of fraud. Which could be valuable for any OPSEC.  DISCLAIMER: I‚Äôm not responsible for misuse or for any damage that you may cause! You agree that you use this softw..." />
<meta name="twitter:description" content="Hi fellas,  Let me introduce you my last tool, ORFinder  ORFinder claims to be able to find any smtp services, exposed over the internet, vulnerable to open relay attack.  Such attack relies on the fact that the sender / receiver addresses are not checked by the underlying mail server, allowing to perform phishing attacks or any kind of fraud. Which could be valuable for any OPSEC.  DISCLAIMER: I‚Äôm not responsible for misuse or for any damage that you may cause! You agree that you use this softw..." />
<meta property="og:article:section" content="Reconnaissance" />
<meta property="og:article:section:color" content="BF1E2E" />
<meta property="og:article:tag" content="tool" />
<meta property="og:article:tag" content="linux" />
<meta property="og:article:tag" content="hacking" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="20 ‚ù§" />
<meta property="article:published_time" content="2017-08-07T15:31:38+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="3237.html">ORFinder, the easy way to abuse mail servers</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/reconnaissance/54.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #BF1E2E'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Reconnaissance</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/tool.html' class='discourse-tag' rel="tag">tool</a>, 
            <a href='../../tag/linux.html' class='discourse-tag' rel="tag">linux</a>, 
            <a href='../../tag/hacking.html' class='discourse-tag' rel="tag">hacking</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='ORFinder, the easy way to abuse mail servers'>
      <link itemprop='url' href='3237.html'>
      <meta itemprop='datePublished' content='2017-08-07T15:31:37Z'>
        <meta itemprop='articleSection' content='Reconnaissance'>
      <meta itemprop='keywords' content='tool, linux, hacking'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Nitrax.html'><span itemprop='name'>Nitrax</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="3237.html">


              <span class="crawler-post-infos">
                  <time  datetime='2017-08-07T15:31:38Z' class='post-time'>
                    August 7, 2017,  3:31pm
                  </time>
                  <meta itemprop='dateModified' content='2017-08-07T15:40:29Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi fellas,</p>
<p>Let me introduce you my last tool, <a href="../../../external.html?link=https://github.com/Nitr4x/ORFinder" rel="noopener nofollow ugc">ORFinder</a></p>
<p>ORFinder claims to be able to find any smtp services, exposed over the internet, vulnerable to open relay attack.<br>
Such attack relies on the fact that the sender / receiver addresses are not checked by the underlying mail server, allowing to perform phishing attacks or any kind of fraud. Which could be valuable for any OPSEC.</p>
<p><strong>DISCLAIMER: I‚Äôm not responsible for misuse or for any damage that you may cause! You agree that you use this software at your own risk.</strong></p>
<p><strong>Note: The usage of a VPN could disrupt the tool behaviors. Stay tuned for updates</strong></p>
<h2><a name="p-14288-how-it-works-1" class="anchor" href="#p-14288-how-it-works-1"></a>How it works</h2>
<p>Here is, in a few lines, the tool workflow:</p>
<pre data-code-wrap="bash"><code class="lang-bash">Get IP ranges according to the given country code
For each IP
	Check if the smtp service is running
	if True
		Check if the service is vulnerable to open relay attack
</code></pre>
<p>Pretty straightforward, isn‚Äôt it ?</p>
<h2><a name="p-14288-usage-2" class="anchor" href="#p-14288-usage-2"></a>Usage</h2>
<h3><a name="p-14288-build-3" class="anchor" href="#p-14288-build-3"></a>Build</h3>
<p>To build the container, just use this command:</p>
<pre data-code-wrap="bash"><code class="lang-bash">docker build -t orfinder .
</code></pre>
<p>Docker will download the Debian image and then execute the installation steps.</p>
<blockquote>
<p>Be patient, the process can be quite long the first time.</p>
</blockquote>
<h3><a name="p-14288-run-4" class="anchor" href="#p-14288-run-4"></a>Run</h3>
<p>Once the build process is over, get and enjoy your new open relay scanner !</p>
<pre data-code-wrap="bash"><code class="lang-bash">docker run -it --rm orfinder -c COUNTRY_CODE
</code></pre>
<blockquote>
<p>Don‚Äôt forget to regularly pull this repository for updates.</p>
</blockquote>
<h2><a name="p-14288-faq-5" class="anchor" href="#p-14288-faq-5"></a>FAQ</h2>
<p>Here is a few questions that you guys asked me on IRC.</p>
<h3><a name="p-14288-how-did-you-get-the-ip-ranges-of-a-given-country-6" class="anchor" href="#p-14288-how-did-you-get-the-ip-ranges-of-a-given-country-6"></a>How did you get the IP ranges of a given country ?</h3>
<p>I advise you to check the Loader <img src="../../images/emoji/twitter/wink8e5e.png?v=15" title=":wink:" class="emoji" alt=":wink:" loading="lazy" width="20" height="20"> I don‚Äôt want to disclose the source here to avoid Google indexing.</p>
<h3><a name="p-14288-how-did-you-detect-open-services-7" class="anchor" href="#p-14288-how-did-you-detect-open-services-7"></a>How did you detect open services ?</h3>
<p>The detection is performed through a simple TCP SYN scan.</p>
<h3><a name="p-14288-how-did-you-detect-if-a-given-service-is-vulnerable-8" class="anchor" href="#p-14288-how-did-you-detect-if-a-given-service-is-vulnerable-8"></a>How did you detect if a given service is vulnerable ?</h3>
<p>Once the TCP connection established with the target, I send the following commands and check the return value.</p>
<pre data-code-wrap="bash"><code class="lang-bash">HELO domain.com
MAIL FROM: <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="d3b7bcbeb2babd93b4beb2babffdb0bcbe">[email&#160;protected]</a>
RCPT TO: <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="482c2725292126653a2b3e082f25292124662b2725">[email&#160;protected]</a>
</code></pre>
<p>If each of those commands return 250, it means that the service is potentially vulnerable to open relay attacks. I said potentially cause, some mail servers implement security measures that cannot be detected without being, prior, root <img src="../../images/emoji/twitter/stuck_out_tongue8e5e.png?v=15" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:" loading="lazy" width="20" height="20"> .<br>
Consequently, a manual check should be done once the vulnerable service has been detected.</p>
<h3><a name="p-14288-is-it-safe-to-use-9" class="anchor" href="#p-14288-is-it-safe-to-use-9"></a>Is it safe to use ?</h3>
<p>TCP SYN scan is, probably, the stealthiest way to perform port scanning. Moreover, our requests should be drowned by the bots scanning the internet constantly.</p>
<p>Upstream, the vulnerability check, instantiate a TCP connection with the target. For privacy reasons, I chose to proxify each request made through TOR not to disclose the end user identity.</p>
<h2><a name="p-14288-last-words-10" class="anchor" href="#p-14288-last-words-10"></a>Last words</h2>
<p>Contributions are welcome if you have ideas to enhance this tool <img src="../../images/emoji/twitter/wink8e5e.png?v=15" title=":wink:" class="emoji" alt=":wink:" loading="lazy" width="20" height="20"></p>
<p>I hope you enjoyed your reading.</p>
<p>Best,<br>
Nitrax</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="16" />
              <span class='post-likes'>16 Likes</span>
            </div>


            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Retr1.html'><span itemprop='name'>Retr1</span></a>
                (The memelord of 0x00sec)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-07T15:52:56Z' class='post-time'>
                    August 7, 2017,  3:52pm
                  </time>
                  <meta itemprop='dateModified' content='2017-08-07T15:52:56Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>holy sh*t man i‚Äôve been waiting for this! praise the lord <a class="mention" href="../../u/nitrax-2.html">@Nitrax</a> and his miracles!</p>
<p>i am surprised at the simplicity of this tool. i‚Äôll be sure to reincarnate parts of your code and scan for something else once i have the time! maybe something that scans iot devices‚Ä¶</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Nitrax.html'><span itemprop='name'>Nitrax</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-08T07:38:27Z' class='post-time'>
                    August 8, 2017,  7:38am
                  </time>
                  <meta itemprop='dateModified' content='2017-08-08T07:38:27Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Well, you are welcome <img src="../../images/emoji/twitter/slight_smile8e5e.png?v=15" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"></p>
<aside class="quote no-group" data-username="Retr1Static" data-post="2" data-topic="3237">
<div class="title">
<div class="quote-controls"></div>
 Retr1Static:</div>
<blockquote>
<p>i‚Äôll be sure to reincarnate parts of your code and scan for something else</p>
</blockquote>
</aside>
<p>Go ahead mate and don‚Äôt forget to pm me your repo <img src="../../images/emoji/twitter/wink8e5e.png?v=15" title=":wink:" class="emoji" alt=":wink:" loading="lazy" width="20" height="20"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Gaius.html'><span itemprop='name'>Gaius</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-02T14:41:16Z' class='post-time'>
                    September 2, 2017,  2:41pm
                  </time>
                  <meta itemprop='dateModified' content='2017-09-02T15:11:04Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I looked over where you‚Äôre resolving IPs to locations, and I thought it might be helpful to have a local database of this information. Here is a short script to populate a sqlite db with ip blocks in CIDR notation. The source I found doesn‚Äôt have city or regional information, but it was pretty simple to scrape. Posting in case anyone else would find it useful.</p>
<pre><code>#!/usr/bin/env python3

# Populate ip database with all country ip blocks in CIDR notation

import sqlite3
import requests
import bs4
import re

conn = sqlite3.connect('ip.db')
c = conn.cursor()

c.execute('CREATE TABLE IF NOT EXISTS blocks (country TEXT, code TEXT, block TEXT)')

r = requests.get('http://ipdeny.com/ipblocks')

soup = bs4.BeautifulSoup(r.text,'lxml')
table = soup.find('table',attrs={'cellspacing':'1'})
rows = table.find_all('tr')

for i,row in enumerate(rows):
    data = row.find_all('td')
    description = data[0].text.split()
    # find index of country code with REGEX
    code_index = 1
    for j,word in enumerate(description):
        if re.match('\([A-Z]{2}\)',word):
            code_index = j
    country = ' '.join(description[:code_index])
    code = description[code_index].strip('()') # how lewd
    link = data[1].find('a')['href']
    rblock = requests.get('http://ipdeny.com/ipblocks/'+link)
    blocks = rblock.text.split()
    for block in blocks:
        c.execute('INSERT INTO blocks (country,code,block) VALUES (?,?,?)',(country,code,block))
    conn.commit()
    print('\r{0}/{1} complete'.format((i+1),len(rows)),end='',flush=True)
print('\nCommitting changes and exiting . . .')
conn.commit()
conn.close()
quit()</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/pry0cc.html'><span itemprop='name'>pry0cc</span></a>
                (Leader &amp; Offsec Engineer &amp; Forum Daddy)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-10-16T09:43:04Z' class='post-time'>
                    October 16, 2017,  9:43am
                  </time>
                  <meta itemprop='dateModified' content='2017-10-16T09:43:04Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This is amazing! Have you seen my geo2ip project? That could be baller for this. I‚Äôm reading them from CSVs and never got round to populating a sqlite db with them. You should put this on github and make it a module.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Raw-x.html'><span itemprop='name'>Raw-x</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-12-04T14:39:25Z' class='post-time'>
                    December 4, 2017,  2:39pm
                  </time>
                  <meta itemprop='dateModified' content='2017-12-04T14:39:25Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Here a script from a friend that can help to find CIDR Range</p>
<p>[code]#!/usr/bin/env python</p>
<h1></h1>
<h1>Country to Network CIDR Range Grabber</h1>
<h1>By: Hood3dRob1n</h1>
<h1></h1>
<p>import math, optparse, os, sys, urllib<br>
from colorama import Style, Fore # sudo pip install colorama</p>
<h1>Establish Home Dir</h1>
<p>HOME = os.path.dirname(os.path.abspath(<strong>file</strong>)) + ‚Äú/‚Äù</p>
<h1>Colors on Windows, idk if this really works or not?</h1>
<p>if os.name == ‚Äònt‚Äô or sys.platform.startswith(‚Äòwin‚Äô): colorama.init()</p>
<h1>Some Simple Print functions</h1>
<p>def caution( msg ): print Style.BRIGHT + Fore.YELLOW + ‚Äú[‚Äù + Fore.WHITE + ‚Äú<em>" + Fore.YELLOW + "] " + Fore.WHITE + str( msg ) + Fore.RESET<br>
def good( msg ): print Style.BRIGHT + Fore.GREEN + ‚Äú[‚Äù + Fore.WHITE + "</em>‚Äù + Fore.GREEN + "] " + Fore.WHITE + str( msg ) + Fore.RESET<br>
def status( msg ): print Style.BRIGHT + Fore.BLUE + ‚Äú[‚Äù + Fore.WHITE + ‚Äú*‚Äù + Fore.BLUE + "] " + Fore.WHITE + str( msg ) + Fore.RESET<br>
def error( msg ): print Style.BRIGHT + Fore.RED + ‚Äú[‚Äù + Fore.WHITE + ‚ÄúERROR‚Äù + Fore.RED + "] " + Fore.WHITE + str( msg ) + Fore.RESET<br>
def print_line( msg ): print Style.BRIGHT + Fore.WHITE + str( msg ) + Fore.RESET</p>
<p>def banner():<br>
‚Äú‚Äù‚Äú0x1337 Banner‚Äù""<br>
cls()<br>
print Style.BRIGHT + Fore.BLUE + ‚Äú\nCountry to Network CIDR Range Grabber\nBy‚Äù + Fore.WHITE + ‚Äú: Hood3dRob1n\n‚Äù + Fore.RESET</p>
<p>def cls():<br>
‚Äú‚Äù‚ÄúClear‚Äù""<br>
if os.name == ‚Äònt‚Äô or sys.platform.startswith(‚Äòwin‚Äô): os.system(‚Äòcls‚Äô)<br>
else: os.system(‚Äòclear‚Äô)</p>
<p>def country_to_cidr(ccode):<br>
‚Äú‚Äù"<br>
Fetches the latest Country IP Allocations from RIPE Database<br>
This link is updated daily so should be decent source for some time <img src="../../../0x00sec.org/images/emoji/twitter/slight_smilec164.html?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
Full list is filtered by requested country code<br>
Returns list array of the matching CIDR ranges for said country code<br>
‚Äú‚Äù"<br>
cidr_range=[]<br>
opener = urllib.FancyURLopener()<br>
f = opener.open(‚Äú<a>ftp://ftp.ripe.net/pub/stats/ripencc/delegated-ripencc-latest</a>‚Äù)<br>
lines=f.readlines()<br>
for line in lines:<br>
if ((‚Äòipv4‚Äô in line) &amp; (country_code.upper() in line)) :<br>
s=line.split("|")<br>
net=s[3]<br>
cidr=float(s[4])<br>
cidr_range.append("%s/%d" % (net,(32-math.log(cidr,2))))<br>
if verbose: good("%s/%d" % (net,(32-math.log(cidr,2))))<br>
return cidr_range</p>
<h1>Parse Arguments/Options</h1>
<p>parser = optparse.OptionParser(banner(), version="%prog v0.02a")<br>
parser.add_option("-c", ‚Äú‚Äìcountry-code‚Äù, dest=‚Äúcode‚Äù, default=None, type=‚Äústring‚Äù, help=‚ÄúTwo Letter Country Code to find CIDR Range for‚Äù)<br>
parser.add_option("-v", action=‚Äúcount‚Äù, default=0, dest=‚Äúverbose‚Äù, help=‚ÄúEnable Verbose Output‚Äù)<br>
(options, args) = parser.parse_args()</p>
<h1>Make sure we got arguments</h1>
<p>args = sys.argv[1:]<br>
if not args:<br>
parser.print_help()<br>
sys.exit()</p>
<p>if options.code == None:<br>
print ‚Äô ‚Äô<br>
error(‚ÄúMissing Argument: --country-code\n‚Äù)<br>
sys.exit()</p>
<p>country_code = options.code.upper()<br>
verbose=options.verbose<br>
RESULTSDIR = HOME + ‚ÄúCIDR/‚Äù<br>
if not os.path.isfile(RESULTSDIR) and not os.path.isdir(RESULTSDIR):<br>
os.umask(0)<br>
os.mkdir(RESULTSDIR, 0770)</p>
<p>def main():<br>
try:<br>
status(‚ÄúFetching CIDR list for: %s‚Äù % country_code)<br>
cidr_range = country_to_cidr(country_code)<br>
if len(cidr_range) &gt; 0:<br>
fh=open(RESULTSDIR+country_code+‚Äô_ranges.txt‚Äô, ‚Äòw+‚Äô)<br>
for i in cidr_range:<br>
fh.write(i+"\n")<br>
fh.close()<br>
print<br>
good(‚ÄúCIDR Ranges for %s saved to: %s\n\n‚Äù % (country_code, RESULTSDIR+country_code+‚Äô_ranges.txt‚Äô))<br>
else:<br>
error(‚ÄúNo CIDR Results Returned!‚Äù)<br>
error(‚ÄúCheck country code and try again or follow up manuall‚Ä¶\n\n‚Äù)<br>
except KeyboardInterrupt:<br>
error("[WARNING] CTRL+C Detected, Shutting Down‚Ä¶\n\n")<br>
sys.exit()</p>
<p>if <strong>name</strong> == ‚Äò<strong>main</strong>‚Äô:<br>
main()[/code]</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Nitrax.html'><span itemprop='name'>Nitrax</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-12-04T15:04:48Z' class='post-time'>
                    December 4, 2017,  3:04pm
                  </time>
                  <meta itemprop='dateModified' content='2017-12-04T15:04:48Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi <a class="mention" href="../../u/raw-x-2.html">@Raw-x</a>,</p>
<p>Thanks for the share.</p>
<p>With all my respect, the ORfinder purpose is far from just retrieving CIDR and IP adresses. Moreover, your script doesn‚Äôt represent, in any way, an enhancement of the tool mentioned above.</p>
<p>Unrelevant necrobumping, for any articles posted on 0x00sec, is wisely discourage.</p>
<p>Thanks for your comprehension.</p>
<p>Best,<br>
Nitrax</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="LkYk9YKbwMiPLqMtec9ZzTPRO"></script>
  </body>
  
</html>
