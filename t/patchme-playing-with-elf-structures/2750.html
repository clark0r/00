<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>[PatchMe] Playing With ELF Structures - Reverse Engineering - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Anyone who calls him/herself a hacker, should know about binary formats, especially if you are a low-level wizard. 
How well do you know the ELF? 

###Difficulty 
Meh, probably easy. 

###Rules 
Though it‚Äôs easy to ident&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="2750.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;[PatchMe] Playing With ELF Structures&#39;" href="2750.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/patchme-playing-with-elf-structures/2750" />
<meta name="twitter:url" content="https://0x00sec.org/t/patchme-playing-with-elf-structures/2750" />
<meta property="og:title" content="[PatchMe] Playing With ELF Structures" />
<meta name="twitter:title" content="[PatchMe] Playing With ELF Structures" />
<meta property="og:description" content="Anyone who calls him/herself a hacker, should know about binary formats, especially if you are a low-level wizard.  How well do you know the ELF?   ###Difficulty  Meh, probably easy.   ###Rules  Though it‚Äôs easy to identify what‚Äôs up, do justify why you patched the binary that way.   ###Hints  Hell no.   ###Binary  The binary is super tiny and can be downloaded from here.   Have fun!" />
<meta name="twitter:description" content="Anyone who calls him/herself a hacker, should know about binary formats, especially if you are a low-level wizard.  How well do you know the ELF?   ###Difficulty  Meh, probably easy.   ###Rules  Though it‚Äôs easy to identify what‚Äôs up, do justify why you patched the binary that way.   ###Hints  Hell no.   ###Binary  The binary is super tiny and can be downloaded from here.   Have fun!" />
<meta property="og:article:section" content="Reverse Engineering" />
<meta property="og:article:section:color" content="12A89D" />
<meta property="og:article:tag" content="linux" />
<meta property="og:article:tag" content="challenge" />
<meta property="og:article:tag" content="elf" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="3 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="34 ‚ù§" />
<meta property="article:published_time" content="2017-07-02T18:03:47+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="2750.html">[PatchMe] Playing With ELF Structures</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/reverse-engineering/58.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #12A89D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Reverse Engineering</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/linux.html" class="discourse-tag" rel="tag">linux</a>,
<a href="../../tag/challenge.html" class="discourse-tag" rel="tag">challenge</a>,
<a href="../../tag/elf.html" class="discourse-tag" rel="tag">elf</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="[PatchMe] Playing With ELF Structures">
<meta itemprop="articleSection" content="Reverse Engineering">
<meta itemprop="keywords" content="linux, challenge, elf">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-02T18:03:47Z" class="post-time">
July 2, 2017, 6:03pm
</time>
<meta itemprop="dateModified" content="2017-07-03T22:51:41Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Anyone who calls him/herself a hacker, should know about binary formats, especially if you are a low-level wizard.</p>
<p>How well do you know the ELF?</p>
<hr>
<p>###<em>Difficulty</em></p>
<p>Meh, probably easy.</p>
<hr>
<p>###<em>Rules</em><br>
Though it‚Äôs easy to identify what‚Äôs up, do justify why you patched the binary that way.</p>
<hr>
<p>###<em>Hints</em><br>
Hell no.</p>
<hr>
<p>###<em>Binary</em><br>
The binary is super tiny and can be downloaded from <a href="https://transfer.sh/h01pU/exit" rel="nofollow noopener">here</a>.</p>
<hr>
<p>Have fun!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="8" />
<span class="post-likes">8 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Towel"><span itemprop="name">Towel</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-03T08:06:43Z" class="post-time">
July 3, 2017, 8:06am
</time>
<meta itemprop="dateModified" content="2017-07-03T08:06:43Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Solved, here are the changes and md5sum:</p>
<div class="spoiler">
<p>$ ./fixed<br>
$ radiff2 exit fixed<br>
0x00000042 00 =&gt; 01 0x00000042<br>
0x00000044 05 =&gt; 00 0x00000044<br>
0x00000046 00 =&gt; 05 0x00000046<br>
0x00000052 40 =&gt; 00 0x00000052<br>
0x00000054 00 =&gt; 40 0x00000054<br>
0x0000005a 40 =&gt; 00 0x0000005a<br>
0x0000005c 00 =&gt; 40 0x0000005c<br>
0x00000060 89 =&gt; 00 0x00000060<br>
0x00000062 00 =&gt; 89 0x00000062<br>
0x00000068 89 =&gt; 00 0x00000068<br>
0x0000006a 00 =&gt; 89 0x0000006a<br>
0x00000072 20 =&gt; 00 0x00000072<br>
0x00000074 00 =&gt; 20 0x00000074<br>
$ md5sum fixed<br>
f4d39629c07a157f80e544b1bd04bcc8</p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-03T08:27:47Z" class="post-time">
July 3, 2017, 8:27am
</time>
<meta itemprop="dateModified" content="2017-07-03T08:27:47Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Sorry mate, your solution is disqualified.</p>
<p>As I mentioned above, you need to explain why you did what you did. In ELF terms to be even more precise. Just comparing and changing values doesn‚Äôt say anything to me.</p>
<p>I set that challenge so people can read up the ELF structures because it‚Äôs a valuable piece of info.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ATGC"><span itemprop="name">ATGC</span></a>
(We&#39;re all just code)
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-03T22:24:56Z" class="post-time">
July 3, 2017, 10:24pm
</time>
<meta itemprop="dateModified" content="2017-07-03T22:24:56Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Awesome challenge <a class="mention" href="https://0x00sec.org/u/_py">@_py</a>! <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:"></p>
<div class="spoiler">
<p>Starting simply, running <code>exit</code> produces a Segmentation fault.</p>
<p>Dumping the symbol table by running <code>readelf -s exit</code> shows that there is no main function but there is a <code>_start</code>. However, it has a type of <code>NOTYPE</code> which is odd as it would usually have a type of <code>FUNC</code>:</p>
<pre><code class="lang-auto">Symbol table '.symtab' contains 7 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000400080     0 SECTION LOCAL  DEFAULT    1
     2: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS exit.nasm
     3: 0000000000400080     0 NOTYPE  GLOBAL DEFAULT    1 _start
     4: 0000000000600089     0 NOTYPE  GLOBAL DEFAULT    1 __bss_start
     5: 0000000000600089     0 NOTYPE  GLOBAL DEFAULT    1 _edata
     6: 0000000000600090     0 NOTYPE  GLOBAL DEFAULT    1 _end
</code></pre>
<p>Running <code>gdb exit</code>, setting a breakpoint at <code>_start</code> and running it, also seg faults before hitting the breakpoint. This suggests something is badly wrong with the ELF file‚Ä¶</p>
<p>Running <code>readelf -SW exit</code> shows that there aren‚Äôt many sections but they look OK:</p>
<pre><code class="lang-auto">There are 5 section headers, starting at offset 0x180:

Section Headers:
  [Nr] Name              Type            Address          Off    Size   ES Flg Lk Inf Al
  [ 0]                   NULL            0000000000000000 000000 000000 00      0   0  0
  [ 1] .text             PROGBITS        0000000000400080 000080 000009 00  AX  0   0 16
  [ 2] .shstrtab         STRTAB          0000000000000000 00015b 000021 00      0   0  1
  [ 3] .symtab           SYMTAB          0000000000000000 000090 0000a8 18      4   3  8
  [ 4] .strtab           STRTAB          0000000000000000 000138 000023 00      0   0  1
Key to Flags:
  W (write), A (alloc), X (execute), M (merge), S (strings), l (large)
  I (info), L (link order), G (group), T (TLS), E (exclude), x (unknown)
  O (extra OS processing required) o (OS specific), p (processor specific)
</code></pre>
<p>However, the program (segment) headers (dumped using <code>readelf -lW</code>) look damaged:</p>
<pre><code class="lang-auto">Elf file type is EXEC (Executable file)
Entry point 0x400080
There are 1 program headers, starting at offset 66

Program Headers:
  Type           Offset   VirtAddr           PhysAddr           FileSiz  MemSiz   Flg Align
  &lt;unknown&gt;: 500 0x000000 0x0000000000000040 0x0089000000000040 0x89000000000000 0x000000     0x20

 Section to Segment mapping:
  Segment Sections...
   00     .shstrtab .symtab .strtab
</code></pre>
<p>Unless we want to start moving parts of the binary around and updating offsets let‚Äôs try fixing up the one program (segment) header we have:</p>
<p>First, set the segment type to 1 so that the segment is loadable:</p>
<ul>
<li>Change byte 0x42 from 0x00 to 0x01</li>
<li>Change byte 0x44 from 0x05 to 0x00</li>
</ul>
<p>Then set the flags to 5 so that the segment is both readable (4) and executable (1)</p>
<ul>
<li>Change byte 0x46 from 0x00 to 0x05</li>
</ul>
<p>Now we can load and execute the segment we need to make sure it contains the .text section which contains the code:</p>
<p>Update the virtual address so that it plus the size can contain the address of the .text section:</p>
<ul>
<li>Change byte 0x52 from 0x40 to 0x00</li>
<li>Change byte 0x54 from 0x00 to 0x40</li>
</ul>
<p>Update the ‚Äòsize in file‚Äô so that it contains the address of the .text section:</p>
<ul>
<li>Change byte 0x62 from 0x00 to 0x89</li>
<li>Change byte 0x68 from 0x89 to 0x00</li>
</ul>
<p>Finally update the ‚Äòsize in memory‚Äô so that it also contains the address of the .text section:</p>
<ul>
<li>Change byte 0x6A from 0x00 to 0x89</li>
</ul>
<p>Re-running <code>readelf -lW exit</code> shows that we‚Äôve fixed up the program header:</p>
<pre><code class="lang-auto">Elf file type is EXEC (Executable file)
Entry point 0x400080
There are 1 program headers, starting at offset 66

Program Headers:
  Type           Offset   VirtAddr           PhysAddr           FileSiz  MemSiz   Flg Align
  LOAD           0x000000 0x0000000000400000 0x0089000000000040 0x000089 0x000089 R E 0x20

 Section to Segment mapping:
  Segment Sections...
   00     .text 
</code></pre>
<p>And running <code>exit</code> now no longer seg faults <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-03T22:40:57Z" class="post-time">
July 3, 2017, 10:40pm
</time>
<meta itemprop="dateModified" content="2017-07-03T23:06:43Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>God damn! You killed it man! +1 for the unintended solution <img src="../../images/emoji/twitter/ok_hand.png%3Fv=9" title=":ok_hand:" class="emoji" alt=":ok_hand:"></p>
<p>However, the fix could be much simpler, <span class="spoiler">1 byte patching to be precise <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></span></p>
<p>You identified the problem correctly. The issue was indeed related to the <span class="spoiler">program headers</span>. If you think of it carefuly though, why would readelf assume that the <span class="spoiler">program header</span> was corrupted? Its job is to <span class="spoiler"><strong>parse the ELF header</strong></span> after all.</p>
<p>Hint: <span class="spoiler">The e_phoff field holds the offset of the program header table. The ELF header is 64 bytes (0x40) and this structure will immediately follow.</span></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ricksanchez"><span itemprop="name">ricksanchez</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/b/b2fd092719247c0a1cebbd58c941f8c2a6e18a97.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-03T23:59:55Z" class="post-time">
July 3, 2017, 11:59pm
</time>
<meta itemprop="dateModified" content="2017-07-04T09:45:03Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I solved it as it was intended. Feeling no glory now anymore with that hint being given by <a class="mention" href="https://0x00sec.org/u/_py">@_py</a> tho <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"> ‚Ä¶<br>
Anyways‚Ä¶ First things first impressive solution <a class="mention" href="https://0x00sec.org/u/atgc">@ATGC</a> .</p>
<div class="spoiler">
<p>As in the extended solution above I first used tools like</p>
<blockquote>
<p>gdb</p>
</blockquote>
<hr>
<blockquote>
<p>readelf</p>
</blockquote>
<hr>
<blockquote>
<p>objdump</p>
</blockquote>
<hr>
<blockquote>
<p>xxd/hexdump</p>
</blockquote>
<p>on that file.<br>
I came to the same conclusion that the Program Headers were kinda weird with that <strong>unknown</strong> type.</p>
<p>I didn‚Äôt really know how to continue with my created binary logs and hex dumps, until<br>
I read more into that matter on how such an ELF binary is structured.<br>
Let‚Äôs take a look at the hex dump and some explanations along the way‚Ä¶</p>
<p>But first here‚Äôs an <a href="http://www.skyfree.org/linux/references/ELF_Format.pdf">awesome paper on the ELF specifications</a></p>
<p>An ELF header is 64 bytes in total (0x40) and structured like shown below.</p>
<pre><code>typedef struct {
    unsigned char e_ident[EI_NIDENT];          //red
    uint16_t      e_type;                      // yellow
    uint16_t      e_machine;                   // green  
    uint32_t      e_version;                   // turquoise
    ElfN_Addr     e_entry;                     // blue
    ElfN_Off      e_phoff;                     // pink
    ElfN_Off      e_shoff;                   
    uint32_t      e_flags;
    uint16_t      e_ehsize;
    uint16_t      e_phentsize;
    uint16_t      e_phnum;
    uint16_t      e_shentsize;
    uint16_t      e_shnum;
    uint16_t      e_shstrndx;
} ElfN_Ehdr;
</code></pre>
<p>Funky colors inc!</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/b/b2fd092719247c0a1cebbd58c941f8c2a6e18a97.png" width="404" height="500"></p>
<p>Ok what the hell is this supposed to be.</p>
<h2>red</h2>
<p>Basically e_ident is 16 bytes and the first 4 bytes are fixed: 0x7F, E, L, F. (7f45 4c46)<br>
The 5th byte determines if the program will be running on 32-bit(0x01) or 64-bit(0x02).<br>
The 6th byte indicates the integer format.<br>
The 7th byte is the ELF version ( always 0x01 btw. )<br>
The 8th byte is the ABI (Application Binary Interface)<br>
The 9th byte is the version.<br>
Rest is padding.</p>
<p>=&gt; This makes the red marked area. If you wanna read more about it or why these values are set click the awesome paper above.</p>
<h2>yellow</h2>
<p>This field determines if its an executable(0x02), an object file(0x01), a shared library(0x03) or a core file(0x04)</p>
<p>=&gt; executable is set. Ok.</p>
<h2>green</h2>
<p>This one sets the CPU arch basically.<br>
Look up the <a href="https://opensource.apple.com/source/dtrace/dtrace-90/sys/elf.h">EM_values here</a><br>
We have a 0x3e (int=62) which stands for EM_AMD64</p>
<h2>turquoise</h2>
<p>This one is always 0x01 so just let it be.</p>
<h2>blue</h2>
<p>Now it‚Äôs getting more interesting!<br>
This 8 byte area ( because of 64-bit ELF), marks the virtual address of the programs entry point.</p>
<p>How it‚Äôs calculated is a different story, and takes a lot more text.<br>
Just keep that in mind that we can find it here.</p>
<h2>pink</h2>
<p>This field holds the program header table‚Äôs file offset in bytes.<br>
If the file has no program header table, this member holds zero.</p>
<p>The ELF header is 64 bytes (0x40) and this structure will immediately follow.</p>
<p>It should be set to 0x40 &lt;=&gt; ‚Äò4000 0000 0000 0000‚Äô as well then!</p>
<p>So this one is the match winning one! <img src="../../images/emoji/twitter/trophy.png%3Fv=9" title=":trophy:" class="emoji" alt=":trophy:"></p>
<p>So let‚Äôs edit it to 0x40 and assembly it again:</p>
<p><code>$ xxd -r exit.dump &gt; new_exit &amp;&amp; chmod +x new_exit</code></p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/1/1e185493adb48d6b38214dfda92c0e91c04a196c.png" width="551" height="53"></p>
<p>The Segfault is gone!</p>
<p>Edit: We didn‚Äôt finish looking at the whole ELF header this time, since we found the error quite early!<br>
So don‚Äôt take these 6 colors above as ‚Äúthe whole ELF header‚Äù <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> .</p>
<h3>Final Words</h3>
<p>Py labeled this challenge as easy so I jumped the train and thought I‚Äôd be done in a couple of minutes (haha‚Ä¶), but then I realized that I lacked heavy knowledge on this internal stuff!<br>
So he made me read page after page to advance and try out a few things.<br>
After finishing this challenge I got to understand that this whole ELF thing was not a small chapter which I can quickly finish, but that it is a damn big book.<br>
I definitely need some more deep diving into this material to fully grasp the concepts of ELF binaries!</p>
<p>It was fun though. These kind of challenges which make you investigate stuff make you learn the most imho <img src="../../images/emoji/twitter/thumbsup.png%3Fv=9" title=":thumbsup:" class="emoji" alt=":thumbsup:"></p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="4" />
<span class="post-likes">4 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="2" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Neo"><span itemprop="name">Neo</span></a>
(Ne0_)
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-04T05:42:31Z" class="post-time">
July 4, 2017, 5:42am
</time>
<meta itemprop="dateModified" content="2017-07-04T05:42:31Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>As an ELF-noob, this was incredibly helpful for me to understand how this works. Thanks!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-04T06:20:57Z" class="post-time">
July 4, 2017, 6:20am
</time>
<meta itemprop="dateModified" content="2017-07-04T06:20:57Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Congrats <a class="mention" href="https://0x00sec.org/u/ricksanchez">@ricksanchez</a>! <img src="../../images/emoji/twitter/muscle.png%3Fv=9" title=":muscle:" class="emoji" alt=":muscle:"></p>
<p>Now you understand why it was easy <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"> If you know the internals, everything is easy.</p>
<p>I hope you learnt something new out of it.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ATGC"><span itemprop="name">ATGC</span></a>
(We&#39;re all just code)
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-04T06:47:25Z" class="post-time">
July 4, 2017, 6:47am
</time>
<meta itemprop="dateModified" content="2017-07-04T06:47:25Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/_py">@_py</a> Ah, of course! <span class="spoiler">I noticed that the bytes I was patching seemed suspiciously similar to those nearby, and it crossed my mind that if I could just shift the header everything might fall into place‚Ä¶ It never crossed my mind to just change the offset though! <img src="../../images/emoji/twitter/man_facepalming.png%3Fv=9" title=":man_facepalming:" class="emoji" alt=":man_facepalming:"></span></p>
<p>Great learning experience for me <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ATGC"><span itemprop="name">ATGC</span></a>
(We&#39;re all just code)
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-04T06:51:57Z" class="post-time">
July 4, 2017, 6:51am
</time>
<meta itemprop="dateModified" content="2017-07-04T06:51:57Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/ricksanchez">@ricksanchez</a> Great analysis and a clean, simple solution! You rock! <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ricksanchez"><span itemprop="name">ricksanchez</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-04T09:46:24Z" class="post-time">
July 4, 2017, 9:46am
</time>
<meta itemprop="dateModified" content="2017-07-04T09:46:24Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/_py">@_py</a> Yes I understand now, and I definitely learned a ton since I never really looked at the ELF internals the last few weeks when trying to advance in RE. This was a nice change for me.</p>
<p><a class="mention" href="https://0x00sec.org/u/atgc">@ATGC</a> Thanks man <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> !</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-04T21:21:09Z" class="post-time">
July 4, 2017, 9:21pm
</time>
<meta itemprop="dateModified" content="2017-07-04T21:21:09Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>BTW you can patch it from the command line like this. Nice challenge <a class="mention" href="https://0x00sec.org/u/_py">@_py</a></p>
<div class="spoiler">
<pre><code>echo -e "\x40" | dd of=exit seek=32 bs=1 count=1 conv=notrunc
</code></pre>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_13" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-04T22:02:26Z" class="post-time">
July 4, 2017, 10:02pm
</time>
<meta itemprop="dateModified" content="2017-07-04T22:02:26Z">
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I‚Äôm not home atm but are you sure it shouldn‚Äôt be:</p>
<p>[spoiler]echo -ne ‚Äú\x40‚Äù | dd of=exit seek=32 bs=1 count=1 cont=notrunc</p>
<p>IIRC, -e will add a newline at the end too. Might be wrong though.<br>
[/spoiler]</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="4" />
<span class="post-likes">4 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_14" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-05T05:25:02Z" class="post-time">
July 5, 2017, 5:25am
</time>
<meta itemprop="dateModified" content="2017-07-05T05:25:02Z">
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<p><span class="spoiler"><br>
Setting count and bs to 1 we are effectively discarding the \n (one single byte will be written to the output, despite of how many we provide as input), so it works fine, but your is, let‚Äôs say, more formal <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></span></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_15" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/xm4c"><span itemprop="name">xm4c</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-10-13T17:17:12Z" class="post-time">
October 13, 2017, 5:17pm
</time>
<meta itemprop="dateModified" content="2017-10-13T17:17:12Z">
<span itemprop="position">15</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/_py">@_py</a> The link to binary is not available any more <img src="../../images/emoji/twitter/disappointed.png%3Fv=9" title=":disappointed:" class="emoji" alt=":disappointed:"> Can we still play with it ?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_16" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-10-13T18:27:16Z" class="post-time">
October 13, 2017, 6:27pm
</time>
<meta itemprop="dateModified" content="2017-10-13T18:27:16Z">
<span itemprop="position">16</span>
</span>
</div>
<div class="post" itemprop="text">
<pre><code class="lang-makefile">base64 -d thebelow | gunzip &gt; chall
</code></pre>
<pre><code class="lang-makefile">H4sICAvqr1kAA2V4aXQAq3f1cWNiZGSAASYGOwYQr4HBAcx3goo3IJQAZSyAahwYWIGqQcKsDMjA
AYXuhPI64fIKKKoN/++wAVL8qGZgB8xA2xrg5kMAyH4Who//0dUKgDGmem6oeCdDAoq4OA5xOaj4
BDRxhtSKzBK9vMTiXIb4+KTi4vjiksSiEob41JTEkkQglZfCwKBXXJlbkpgEpEuKIHQGjFWSWlFC
hI8JA2kGSBiwQfkw/zZA+Zxo6gXQ+IIMoHDFBNHQ+FZEE2fEwmfCon8ClF4BpVmg9nBA+RJI7sNm
vwXUImUC9gMAxdDVAcACAAA=
</code></pre>
<p>My apologies for the inconvenience.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_17" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/neolex"><span itemprop="name">neolex</span></a>
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-10-15T06:50:27Z" class="post-time">
October 15, 2017, 6:50am
</time>
<meta itemprop="dateModified" content="2017-10-15T07:08:46Z">
<span itemprop="position">17</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks for the challenge !<br>
here‚Äôs my solution :</p>
<p>[spoiler]readelf gives me the 66 for the start of header but 64 for the size of</p>
<p><code>$readelf -h chall
[...]
D√©but des en-t√™tes de programme : 66 (octets dans le fichier)
[...]
Taille de cet en-t√™te: 64 (octets)
</code><br>
because the length of the ELF header is 64 the start of the program header should be 64 for as well.<br>
So I edited e_phoff from 0x42 ( 66 ) to 0x40 ( 64 ) :</p>
<p><code>neolex@archlinux-pc ~/D/h/c/0/patchme_playing_with_elf&gt; radiff2 chall patched
0x00000020 42 =&gt; 40 0x00000020</code><br>
And it executes without errors!<br>
[/spoiler]</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_18" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
Closed
</span>
<link itemprop="mainEntityOfPage" href="2750.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-10-17T06:47:39Z" class="post-time">
October 17, 2017, 6:47am
</time>
<meta itemprop="dateModified" content="2017-10-17T06:47:39Z">
<span itemprop="position">18</span>
</span>
</div>
<div class="post" itemprop="text">
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
