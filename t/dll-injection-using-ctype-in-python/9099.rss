<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>DLL injection using Ctype in python</title>
    <link>https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099</link>
    <description>hello everyone
I&#39;m trying do do dll injection using ctype in python , but the return value of this line of code is zero  `ctypes.windll.kenrel32.GetProcAddress(k32handle , &quot;LoadLibraryA&quot;)`

here is the code before I open process to inject :     
&gt; import ctypes
&gt; kernel32 = ctypes.windll.kernel32
&gt; h_k32 = kernel32.GetModuleHandleA(&quot;kernel32.dll&quot;)
&gt; print &quot;h_k32 = &quot;  + h_k32
&gt; 
&gt; lp_func = kernel32.GetProcAddress(h_k32 , &quot;LoadLibraryA&quot;)
&gt; 
&gt; print &quot;lp_func = &quot; + lp_func

the output is:
  &gt;  h_k32 = -780730368
&gt;    lp_func = 0

can someone tell me what I&#39;m doing wrong ?:sweat:
NOTE: I just did try the code above on other machine with same python version and worked,but still not working on my current machine !!

thank you</description>
    
    <lastBuildDate>Mon, 22 Oct 2018 00:52:28 +0000</lastBuildDate>
    <category>Questions</category>
    <atom:link href="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>DLL injection using Ctype in python</title>
        <dc:creator><![CDATA[system]]></dc:creator>
        <description><![CDATA[
            <p>This topic was automatically closed 3 days after the last reply. New replies are no longer allowed.</p>
          <p><a href="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/7">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/7</link>
        <pubDate>Thu, 25 Oct 2018 00:52:31 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-9099-7</guid>
        <source url="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099.rss">DLL injection using Ctype in python</source>
      </item>
      <item>
        <title>DLL injection using Ctype in python</title>
        <dc:creator><![CDATA[FOX]]></dc:creator>
        <description><![CDATA[
            <p>I appreciate your help, thank you</p>
          <p><a href="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/6">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/6</link>
        <pubDate>Mon, 22 Oct 2018 00:52:28 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-9099-6</guid>
        <source url="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099.rss">DLL injection using Ctype in python</source>
      </item>
      <item>
        <title>DLL injection using Ctype in python</title>
        <dc:creator><![CDATA[dtm]]></dc:creator>
        <description><![CDATA[
            <p>You should print them out in hex because it’d make more sense/readable. No one prints addresses in decimal.</p>
          <p><a href="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/5">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/5</link>
        <pubDate>Sun, 21 Oct 2018 23:47:53 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-9099-5</guid>
        <source url="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099.rss">DLL injection using Ctype in python</source>
      </item>
      <item>
        <title>DLL injection using Ctype in python</title>
        <dc:creator><![CDATA[sir1ous]]></dc:creator>
        <description><![CDATA[
            <p>Yup, this should be an address of the LoadLibraryA function.</p>
          <p><a href="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/4">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/4</link>
        <pubDate>Sun, 21 Oct 2018 23:47:06 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-9099-4</guid>
        <source url="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099.rss">DLL injection using Ctype in python</source>
      </item>
      <item>
        <title>DLL injection using Ctype in python</title>
        <dc:creator><![CDATA[FOX]]></dc:creator>
        <description><![CDATA[
            <p><img src="https://0x00sec.s3.amazonaws.com/original/2X/4/4dc1c068373358d9fbf4dc9150eee534063a9637.png" alt="C" data-base62-sha1="b5RSjHhw1DYOZt9XUiDg4RAWKfd" width="624" height="195"></p>
<p>Is this normal ? <img src="https://0x00sec.org/images/emoji/twitter/thinking.png?v=9" title=":thinking:" class="emoji" alt=":thinking:"></p>
          <p><a href="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/3">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/3</link>
        <pubDate>Sun, 21 Oct 2018 23:06:31 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-9099-3</guid>
        <source url="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099.rss">DLL injection using Ctype in python</source>
      </item>
      <item>
        <title>DLL injection using Ctype in python</title>
        <dc:creator><![CDATA[sir1ous]]></dc:creator>
        <description><![CDATA[
            <p>I think you need to declare proper restype and argtypes for GetModuleHandle and GetProcAddress.<br>
Anyway this answer worked for me: <a href="https://stackoverflow.com/questions/33779657/python-getmodulehandlew-oserror-winerror-126-the-specified-module-could-not-b/33780664#33780664" rel="nofollow noopener">https://stackoverflow.com/questions/33779657/python-getmodulehandlew-oserror-winerror-126-the-specified-module-could-not-b/33780664#33780664</a></p>
<p>TLDR:</p>
<pre><code>kernel32 = ctypes.WinDLL('kernel32', use_last_error=True)   
kernel32.GetProcAddress.restype = ctypes.c_void_p
kernel32.GetProcAddress.argtypes = (wintypes.HMODULE, wintypes.LPCSTR)

LoadLibAddy = kernel32.GetProcAddress(kernel32._handle, b'LoadLibraryA')
if not LoadLibAddy:
    raise ctypes.WinError(ctypes.get_last_error())</code></pre>
          <p><a href="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/2">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/2</link>
        <pubDate>Sun, 21 Oct 2018 22:19:14 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-9099-2</guid>
        <source url="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099.rss">DLL injection using Ctype in python</source>
      </item>
      <item>
        <title>DLL injection using Ctype in python</title>
        <dc:creator><![CDATA[FOX]]></dc:creator>
        <description><![CDATA[
            <p>hello everyone<br>
I’m trying do do dll injection using ctype in python , but the return value of this line of code is zero  <code>ctypes.windll.kenrel32.GetProcAddress(k32handle , "LoadLibraryA")</code></p>
<p>here is the code before I open process to inject :</p>
<blockquote>
<p>import ctypes<br>
kernel32 = ctypes.windll.kernel32<br>
h_k32 = kernel32.GetModuleHandleA(“kernel32.dll”)<br>
print "h_k32 = "  + h_k32</p>
<p>lp_func = kernel32.GetProcAddress(h_k32 , “LoadLibraryA”)</p>
<p>print "lp_func = " + lp_func</p>
</blockquote>
<p>the output is:</p>
<blockquote>
<p>h_k32 = -780730368<br>
lp_func = 0</p>
</blockquote>
<p>can someone tell me what I’m doing wrong ?<img src="https://0x00sec.org/images/emoji/twitter/sweat.png?v=9" title=":sweat:" class="emoji" alt=":sweat:"><br>
NOTE: I just did try the code above on other machine with same python version and worked,but still not working on my current machine !!</p>
<p>thank you</p>
          <p><a href="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/1">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099/1</link>
        <pubDate>Sun, 21 Oct 2018 16:13:09 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-9099-1</guid>
        <source url="https://0x00sec.org/t/dll-injection-using-ctype-in-python/9099.rss">DLL injection using Ctype in python</source>
      </item>
  </channel>
</rss>
