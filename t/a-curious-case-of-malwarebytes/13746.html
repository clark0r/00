<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>A Curious Case of Malwarebytes - Malware - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Introduction
Recently, I installed Malwarebytes on my machine. I played around with it for a little and I noticed that something was off with the scanning of files on disk. Naturally, it tempted me into digging further t&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="13746.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;A Curious Case of Malwarebytes&#39;" href="13746.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/7/7bb384025ba9c14a05962710c81501dee2909675.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/7/7bb384025ba9c14a05962710c81501dee2909675.png" />
<meta property="og:url" content="https://0x00sec.org/t/a-curious-case-of-malwarebytes/13746" />
<meta name="twitter:url" content="https://0x00sec.org/t/a-curious-case-of-malwarebytes/13746" />
<meta property="og:title" content="A Curious Case of Malwarebytes" />
<meta name="twitter:title" content="A Curious Case of Malwarebytes" />
<meta property="og:description" content="Introduction Recently, I installed Malwarebytes on my machine. I played around with it for a little and I noticed that something was off with the scanning of files on disk. Naturally, it tempted me into digging further to identify the root cause but I had also unexpectedly discovered something else that was incredibly strange. So, a couple of issues and hours of investigation later, I would like to present to you what I’ve uncovered in this journey.   What File Scanning? For those unaware, the E..." />
<meta name="twitter:description" content="Introduction Recently, I installed Malwarebytes on my machine. I played around with it for a little and I noticed that something was off with the scanning of files on disk. Naturally, it tempted me into digging further to identify the root cause but I had also unexpectedly discovered something else that was incredibly strange. So, a couple of issues and hours of investigation later, I would like to present to you what I’ve uncovered in this journey.   What File Scanning? For those unaware, the E..." />
<meta property="og:article:section" content="Malware" />
<meta property="og:article:section:color" content="F7941D" />
<meta property="og:article:tag" content="reverseengineering" />
<meta property="og:article:tag" content="bypass" />
<meta property="og:article:tag" content="antivirus" />
<meta property="og:article:tag" content="kernel" />
<meta property="og:article:tag" content="windows" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="37 ❤" />
<meta property="article:published_time" content="2019-05-18T11:56:35+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="13746.html">A Curious Case of Malwarebytes</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/malware.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F7941D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Malware</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/reverseengineering.html" class="discourse-tag" rel="tag">reverseengineering</a>,
<a href="../../tag/bypass.html" class="discourse-tag" rel="tag">bypass</a>,
<a href="../../tag/antivirus.html" class="discourse-tag" rel="tag">antivirus</a>,
<a href="../../tag/kernel.html" class="discourse-tag" rel="tag">kernel</a>,
<a href="../../tag/windows.html" class="discourse-tag" rel="tag">windows</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="A Curious Case of Malwarebytes">
<meta itemprop="articleSection" content="Malware">
<meta itemprop="keywords" content="reverseengineering, bypass, antivirus, kernel, windows">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/7/7bb384025ba9c14a05962710c81501dee2909675.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-18T11:56:35Z" class="post-time">
May 18, 2019, 11:56am
</time>
<meta itemprop="dateModified" content="2019-05-18T12:09:41Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<h1>Introduction</h1>
<p>Recently, I installed Malwarebytes on my machine. I played around with it for a little and I noticed that something was off with the scanning of files on disk. Naturally, it tempted me into digging further to identify the root cause but I had also unexpectedly discovered something else that was incredibly strange. So, a couple of issues and hours of investigation later, I would like to present to you what I’ve uncovered in this journey.</p>
<hr>
<h1>What File Scanning?</h1>
<p>For those unaware, the EICAR test file is a file developed to test anti-malware solutions by intentionally triggering a detection based on the following ASCII string: <code>X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*</code>. For more information about this, please see here: <a href="https://www.eicar.org/">https://www.eicar.org/</a>.</p>
<p>As I completed the installation of Malwarebytes, I wanted to test it with the classic EICAR file. So I dropped it into disk and waited for a detection notification… and nothing…? Malwarebytes did not bat an eyelid. I escalated it further and explicitly requested a scan on the file… and nothing!</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/7/7bb384025ba9c14a05962710c81501dee2909675.png" alt="image" data-base62-sha1="hEjl2DlKzrMLfjTeALTsUtW2ilD" width="690" height="441"></p>
<p>After Googling the issue, here is the summary in the <a href="https://forums.malwarebytes.com/topic/191650-malwarebytes-3-frequently-asked-questions/?do=findComment&amp;comment=1077438">FAQ</a> of why Malwarebytes does not detect EICAR files:</p>
<aside class="quote no-group" data-username="Malwarebytes">
<div class="title">
<div class="quote-controls"></div>
Malwarebytes:</div>
<blockquote>
<p>So in summary, MB3 already incorporates world-class, next-generation anti-malware technologies. Our combination of signature-less and rules-based layered approach is far more effective than using AV signatures. Malwarebytes is able to prevent 0-minute threats and attacks without updates, even script-based, file-less, and other advanced attacks . We won’t detect EICAR because EICAR is not representative of either today’s threat environment or security needs.</p>
</blockquote>
</aside>
<p>Weird flex, but okay.</p>
<p>After this unique incident, I decided to try and see if it would detect <em>anything</em> that was dropped to disk so I decided to find something that <em>should</em> guarantee a detection: Quasar RAT. I downloaded it and unzipped it, waiting in anticipation for the detection notification… and nothing! Again!</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/d/d2879bfc26897e1674ab9fa5081b6b68a1d7e28c.png" alt="image" data-base62-sha1="u2qOferTtMhUmcSkdW4olFGhZTe" width="690" height="471"></p>
<p>I performed a manual scan on the <em>Quasar.exe</em> file to check if Malwarebytes was actually functional at all and, lo and behold, it picked it up!</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/c/ca45f79e545963d1e5eed0447d2acbffe4ca8200.png" alt="image" data-base62-sha1="sRolTFPien2X7c47RO0nA7XXKfK" width="690" height="357"></p>
<hr>
<h1>Investigating the Issue</h1>
<p>Of course, I was not impressed by what I have seen. I wanted to investigate what was causing this problem to resolve it. Having messed with a little bit of kernel driver development before, I knew where to look.</p>
<h2>Minifilter Callback Operations</h2>
<p>Windows has a special type of drivers called <em>Minifilters</em> which are used for file system operations. To register as a minifilter, the driver must use the <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/fltkernel/nf-fltkernel-fltregisterfilter"><code>FltRegisterFilter</code></a> registration function. One of the parameters specify the registration context which is a struct that holds the relevant information to be provided to the kernel.</p>
<pre><code class="lang-auto">typedef struct _FLT_REGISTRATION {
  USHORT                                      Size;
  USHORT                                      Version;
  FLT_REGISTRATION_FLAGS                      Flags;
  const FLT_CONTEXT_REGISTRATION              *ContextRegistration;
  const FLT_OPERATION_REGISTRATION            *OperationRegistration;    // &lt;--
  PFLT_FILTER_UNLOAD_CALLBACK                 FilterUnloadCallback;
  PFLT_INSTANCE_SETUP_CALLBACK                InstanceSetupCallback;
  PFLT_INSTANCE_QUERY_TEARDOWN_CALLBACK       InstanceQueryTeardownCallback;
  PFLT_INSTANCE_TEARDOWN_CALLBACK             InstanceTeardownStartCallback;
  PFLT_INSTANCE_TEARDOWN_CALLBACK             InstanceTeardownCompleteCallback;
  PFLT_GENERATE_FILE_NAME                     GenerateFileNameCallback;
  PFLT_NORMALIZE_NAME_COMPONENT               NormalizeNameComponentCallback;
  PFLT_NORMALIZE_CONTEXT_CLEANUP              NormalizeContextCleanupCallback;
  PFLT_TRANSACTION_NOTIFICATION_CALLBACK      TransactionNotificationCallback;
  PFLT_NORMALIZE_NAME_COMPONENT_EX            NormalizeNameComponentExCallback;
  PFLT_SECTION_CONFLICT_NOTIFICATION_CALLBACK SectionNotificationCallback;
} FLT_REGISTRATION, *PFLT_REGISTRATION;
</code></pre>
<p>Within this struct, there is one member that is interesting: <code>OperationRegistration</code>.</p>
<pre><code class="lang-auto">typedef struct _FLT_OPERATION_REGISTRATION {
  UCHAR                            MajorFunction;
  FLT_OPERATION_REGISTRATION_FLAGS Flags;
  PFLT_PRE_OPERATION_CALLBACK      PreOperation;
  PFLT_POST_OPERATION_CALLBACK     PostOperation;
  PVOID                            Reserved1;
} FLT_OPERATION_REGISTRATION, *PFLT_OPERATION_REGISTRATION;
</code></pre>
<p>This struct describes the type of operation that will be registered as a callback (<code>MajorFunction</code>) and the two functions that will handle the callback (<code>PreOperation</code> and <code>PostOperation</code>). The <code>PreOperation</code> handles the callback <em>before</em> the operation is performed and the <code>PostOperation</code> handles the callback <em>after</em> the operation is performed. This struct is used in an array that may specify multiple types of operations.</p>
<h2>The Tip of the Iceberg</h2>
<p>Using this knowledge, I discovered the registration structure used for <code>FltRegisterFilter</code>:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/6/64683dfd0205b372f68adc27e0fc1d1414062cc5.png" alt="image" data-base62-sha1="ekf5fZ7cye7KJ9h3fwi1RQuNk3z" width="673" height="185"></p>
<p>If we match the offsets of the above struct definition, we can deduce that the two green <code>unk_XXX</code> values are the <code>ContextRegistration</code> and <code>OperationRegistration</code> respectively. We are interested in the second one:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/0/0d0c6e777b152fbe6d110b718cf0bffcc432f4cc.png" alt="image" data-base62-sha1="1RqQaK5GQHn5jb3jjrE188BoUfW" width="690" height="326"></p>
<p>The figure above shows the <code>OperationRegistration</code> struct with the operations <code>IRP_MJ_CREATE</code> (file handle opens) and <code>IRP_MJ_ACQUIRE_FOR_SECTION_SYNCHRONIZATION</code>. What’s strange here is that there is no registered callback registration for <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/irp-mj-write"><code>IRP_MJ_WRITE</code></a> (file writes) nor <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/irp-mj-cleanup"><code>IRP_MJ_CLEANUP</code></a> (file handle closes). This could track malicious byte patterns being written to a file as well as being able to scan a file after it has been opened and potentially modified. Perhaps this was the issue for failing to have scanned Quasar?</p>
<p>Anyway, the <code>IRP_MJ_CREATE</code> specifies both <code>PreOperation</code> and <code>PostOperation</code>. The <code>PostOperation</code> is only used for clean up so we are not interested in that. Let’s have a look at the <code>PreOperation</code>. The function is actually quite small and didn’t contain any relevant information about file scanning but I noticed the following deferred routine:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/1/11874c942e775e6656d27dea5c5d1313b643f9a0.png" alt="image" data-base62-sha1="2v3ZDah6DH4dMa7xd2uAX6Qaaze" width="246" height="159"></p>
<h2>Taken By Surprise</h2>
<p>If we jump into <code>sub_140005AA0</code>, we can see this:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/4/4a78550fe31762fb13086f2e20865c7df9911257.png" alt="image" data-base62-sha1="aCN8TGXU6zF3zdhhcuQ2WfIAXtB" width="458" height="500"></p>
<p>In the green boxes, there are calls to <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/wdm/nf-wdm-rtlcompareunicodestring"><code>RtlCompareUnicodeString</code></a>, with the first argument as the file extension and the second argument as <strong>hardcoded</strong> strings! Here are the three strings:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3911ccb605dec5be99360553d58d9de767b13ace.png" alt="image" data-base62-sha1="88RlMLhUDWDrmrd47ZQaOKHours" width="690" height="384"></p>
<p>Looking back at the flow chart, <code>RtlCompareUnicodeString</code> is defined to return zero if the two provided strings are the same. We can follow the green branches that satisfy this return value and see that execution flows all the way to the end of the function. The red box on the right contains the function that scans the file. If we wanted to bypass the file scanning function, all we need to do is to rename the file extension to <code>Manifest</code>, <code>Config</code>, or <code>etl</code> (case-insensitive)!</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3e7d98e93b5c3e676e745faf81ddb5ccdb42178e.jpeg" width height></p>
<p>It is actually possible to run executable files despite lacking the <code>exe</code> extension name. I believe that the <code>PATHTEXT</code> environment variable plays a role in the <a href="https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa"><code>CreateProcess</code></a> function. The (my) <code>PATHTEXT</code> variable is defined as:</p>
<pre><code class="lang-auto">.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC
</code></pre>
<p>From my educated guess, if the executing file has an unassociated file extension, it will iterate through these file types in order (left to right) and verify by analysing the file’s header. In the case of an <code>exe</code>, it will reach the <code>.EXE</code> value, be recognised as an executable by the <code>MZ</code> header signature, and then attempted to be executed as such. Correct me if I’m wrong.</p>
<hr>
<h1>Demonstration</h1>
<p>In the following GIF, I will show that malicious files dropped to disk do not get detected. Then, by changing the file name extensions to <code>etl</code> and <code>manifest</code>, Malwarebytes will not also not see them.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/e/ecede886df532e145002d92b1caa3669b661472b.gif" width height></p>
<h2>Dropper PoC</h2>
<p>I’ve also developed a PoC dropper designed to automate this process.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/3ac2bf566f2c9e8db49e09f8f78b127f1ff6af1b.gif" width height></p>
<hr>
<h1>Conclusion</h1>
<p>This journey started out quite strange and became even stranger. I have no idea why the implementation is missing some file system operation callbacks. It may explain why Malwarebytes is not scanning files when they are written to disk. I have even less of an idea as to why it was decided that these file extensions were whitelisted from scanning. Perhaps it was an optimisation of some sort? Maybe it was assumed that they weren’t executable? Let me know what you think.</p>
<p>As always, you can find the PoC here on my GitHub: <a href="https://github.com/NtRaiseHardError/Antimalware-Research/tree/master/Malwarebytes">https://github.com/NtRaiseHardError/Antimalware-Research/tree/master/Malwarebytes</a>.</p>
<p><em>– dtm</em></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="25" />
<span class="post-likes">25 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../0x00sec-2019-year-end-review-year-0x04/18391.html">0x00sec 2019 Year End Review - Year 0x04</a>
<meta itemprop="position" content="9">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Alice"><span itemprop="name">Alice</span></a>
(Alice)
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-18T18:32:22Z" class="post-time">
May 18, 2019, 6:32pm
</time>
<meta itemprop="dateModified" content="2019-05-18T18:32:22Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Correct and disagree with me if I am wrong, but pretty much malwarebytes fucked up when it comes to the name of files and the like? I don’t know the terminology nor do I understand why when written to disk it won’t be detected, but I believe there is a name for this type of fuck up? Anyways, I wonder if the extension could be changed like this:</p>
<p><code>malware.etl.exe</code></p>
<p>Maybe?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-18T22:28:23Z" class="post-time">
May 18, 2019, 10:28pm
</time>
<meta itemprop="dateModified" content="2019-05-18T22:28:23Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group" data-username="Alice" data-post="2" data-topic="13746">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/alice/40/7706_2.png" class="avatar"> Alice:</div>
<blockquote>
<p>Anyways, I wonder if the extension could be changed like this:</p>
<p><code>malware.etl.exe</code></p>
</blockquote>
</aside>
<p>The file extension is still <code>exe</code> which doesn’t change anything.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-19T03:29:42Z" class="post-time">
May 19, 2019, 3:29am
</time>
<meta itemprop="dateModified" content="2019-05-19T03:29:42Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group" data-username="BL4CKH47H4CK3R" data-post="5" data-topic="13746">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/bl4ckh47h4ck3r/40/11306_2.png" class="avatar"> BL4CKH47H4CK3R:</div>
<blockquote>
<p>Did you bypass their product key authentication system (premium forever) ?</p>
</blockquote>
</aside>
<p>No, I used a trial version.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Alice"><span itemprop="name">Alice</span></a>
(Alice)
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-19T12:22:03Z" class="post-time">
May 19, 2019, 12:22pm
</time>
<meta itemprop="dateModified" content="2019-05-19T12:22:03Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>It was an example, but yeah. I figured out that it was still an exe so nothing would change.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/jennlong"><span itemprop="name">jennlong</span></a>
(jenn)
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-21T00:05:12Z" class="post-time">
May 21, 2019, 12:05am
</time>
<meta itemprop="dateModified" content="2019-05-21T00:05:12Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>What an amazing analysis of Malwarebytes. So much was over my head but your comprehension and tenacity is truly inspiring. We are all a little bit smarter thanks to you.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dmknght"><span itemprop="name">dmknght</span></a>
(dmknght)
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-21T02:18:15Z" class="post-time">
May 21, 2019, 2:18am
</time>
<meta itemprop="dateModified" content="2019-05-21T02:18:15Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote group-VIP" data-username="dtm" data-post="1" data-topic="13746">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/dtm/40/6409_2.png" class="avatar"> dtm:</div>
<blockquote>
<p>the second argument as <strong>hardcoded</strong> strings</p>
</blockquote>
</aside>
<p>That is a big <code>Wow</code> in 2019. Does Malwarebytes have any anti-debugging technique?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="2" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-21T12:14:47Z" class="post-time">
May 21, 2019, 12:14pm
</time>
<meta itemprop="dateModified" content="2019-05-21T12:14:47Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group" data-username="jennlong" data-post="8" data-topic="13746" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/jennlong/40/7045_2.png" class="avatar"> jennlong:</div>
<blockquote>
<p>What an amazing analysis of Malwarebytes. So much was over my head but your comprehension and tenacity is truly inspiring. We are all a little bit smarter thanks to you.</p>
</blockquote>
</aside>
<p><a class="mention" href="https://0x00sec.org/u/jennlong">@jennlong</a> Thank you for your kind words! Much appreciated.</p>
<aside class="quote no-group quote-modified" data-username="dmknght" data-post="9" data-topic="13746">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar_proxy/v4/letter/d/73ab20/40.png" class="avatar"> dmknght:</div>
<blockquote>
<blockquote>
<p>the second argument as <strong>hardcoded</strong> strings</p>
</blockquote>
<p>That is a big <code>Wow</code> in 2019. Does Malwarebytes have any anti-debugging technique?</p>
</blockquote>
</aside>
<p><a class="mention" href="https://0x00sec.org/u/dmknght">@dmknght</a> I’m not sure. This was done with a majority of static analysis and then blackbox dynamic testing to confirm.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TKBomber"><span itemprop="name">TKBomber</span></a>
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-22T03:35:14Z" class="post-time">
May 22, 2019, 3:35am
</time>
<meta itemprop="dateModified" content="2019-05-22T03:35:14Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Someone dropped the ball hard…</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_14" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/cuckkoo"><span itemprop="name">cuckkoo</span></a>
(cuckkoo)
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-06T10:31:30Z" class="post-time">
June 6, 2019, 10:31am
</time>
<meta itemprop="dateModified" content="2019-06-06T10:31:30Z">
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Malwarebytes is always tripping on stuff like this and from what i’ve experienced i think they created a database of known malwares and they look for the same exact code in the files they scan and that is very sad because no one is going to write exact same code again apart from script-kiddies.</p>
<p>I once scanned my two copies of same malware with slight changes and guess what one was detected and one wasn’t.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_15" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/larkwiot"><span itemprop="name">larkwiot</span></a>
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-08T22:43:30Z" class="post-time">
June 8, 2019, 10:43pm
</time>
<meta itemprop="dateModified" content="2019-06-08T22:43:30Z">
<span itemprop="position">15</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This is normal antivirus behavior. It’s signature based scanning. And actually, Malwarebytes <em>not</em> detecting Eicar would indicate it doesn’t use signature based scanning.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_16" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-09T02:28:33Z" class="post-time">
June 9, 2019, 2:28am
</time>
<meta itemprop="dateModified" content="2019-06-09T02:28:33Z">
<span itemprop="position">16</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group" data-username="larkwiot" data-post="15" data-topic="13746">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/larkwiot/40/3237_2.png" class="avatar"> larkwiot:</div>
<blockquote>
<p>And actually, Malwarebytes <em>not</em> detecting Eicar would indicate it doesn’t use signature based scanning.</p>
</blockquote>
</aside>
<p>I think you need to recheck your logic. It is entirely possible that Malwarebytes uses signature-based scanning but does not include the signatures for EICAR and hence, will not detect it. As far as I’m concerned, signature-based scanning is the fastest and efficient methods for detecting known malware and simply not including an engine capable of performing this would be an insult to optimisation.</p>
<p>What you are claiming is simply outrageous and I fail to see any relevant evidence to support it. I also don’t see any sources that explicitly state that Malwarebytes does <strong>not</strong> use signatures. I am aware that they have a “signature-less” detection method but just to make sure you don’t trip on another incorrect logical conclusion, it does <strong>not</strong> mean Malwarebytes doesn’t use signatures. From the same thread questioning this “signature-less” method, a staff member replies:</p>
<aside class="quote no-group">
<blockquote>
<p>It uses a combination of both signature based and signature-less detection for increased protection.</p>
</blockquote>
</aside>
<p><a href="https://forums.malwarebytes.com/topic/201891-signature-less-detection/?do=findComment&amp;comment=1141708" class="onebox" target="_blank" rel="noopener">https://forums.malwarebytes.com/topic/201891-signature-less-detection/?do=findComment&amp;comment=1141708</a></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_17" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
Closed
</span>
<link itemprop="mainEntityOfPage" href="13746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-17T11:56:36Z" class="post-time">
June 17, 2019, 11:56am
</time>
<meta itemprop="dateModified" content="2019-06-17T11:56:36Z">
<span itemprop="position">17</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
