<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DOOM95 | Making an aimbot - Reverse Engineering - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="In the name of Allah, the most beneficent, the most merciful. 

Introduction
“.الأفكار تغير طابعك، أما الأفعال فتغير واقعك” 
I’ve played lots of classic games as a child, one that I particularly enjoyed was called DOOM, &amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="19862.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;DOOM95 | Making an aimbot&#39;" href="19862.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/doom95-making-an-aimbot/19862" />
<meta name="twitter:url" content="https://0x00sec.org/t/doom95-making-an-aimbot/19862" />
<meta property="og:title" content="DOOM95 | Making an aimbot" />
<meta name="twitter:title" content="DOOM95 | Making an aimbot" />
<meta property="og:description" content="In the name of Allah, the most beneficent, the most merciful.   Introduction “.الأفكار تغير طابعك، أما الأفعال فتغير واقعك”  I’ve played lots of classic games as a child, one that I particularly enjoyed was called DOOM, its concept was overly simple:   Kill monsters that spawn all over the map. (%) Collect items. (%) Unlock each level’s secret.  But as the saying goes: “There is beauty in simplicity”.  Those days are long gone, and although everything that surrounds me changed, I didn’t.  I gues..." />
<meta name="twitter:description" content="In the name of Allah, the most beneficent, the most merciful.   Introduction “.الأفكار تغير طابعك، أما الأفعال فتغير واقعك”  I’ve played lots of classic games as a child, one that I particularly enjoyed was called DOOM, its concept was overly simple:   Kill monsters that spawn all over the map. (%) Collect items. (%) Unlock each level’s secret.  But as the saying goes: “There is beauty in simplicity”.  Those days are long gone, and although everything that surrounds me changed, I didn’t.  I gues..." />
<meta property="og:article:section" content="Reverse Engineering" />
<meta property="og:article:section:color" content="12A89D" />
<meta property="og:article:tag" content="gamehacking" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="7 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="37 ❤" />
<meta property="article:published_time" content="2020-03-16T20:50:35+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="19862.html">DOOM95 | Making an aimbot</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/reverse-engineering/58.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #12A89D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Reverse Engineering</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/gamehacking.html" class="discourse-tag" rel="tag">gamehacking</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="DOOM95 | Making an aimbot">
<meta itemprop="articleSection" content="Reverse Engineering">
<meta itemprop="keywords" content="gamehacking">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="19862.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-03-16T20:50:35Z" class="post-time">
March 16, 2020, 8:50pm
</time>
<meta itemprop="dateModified" content="2020-03-16T21:16:12Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>In the name of Allah, the most beneficent, the most merciful.</p>
<hr>
<h4>Introduction</h4>
<p>“.الأفكار تغير طابعك، أما الأفعال فتغير واقعك”</p>
<p>I’ve played lots of classic games as a child, one that I particularly enjoyed was called <strong>DOOM</strong>, its concept was overly simple:</p>
<ul>
<li>Kill monsters that spawn all over the map. (%)</li>
<li>Collect items. (%)</li>
<li>Unlock each level’s secret.</li>
</ul>
<p>But as the saying goes: <em>“There is beauty in simplicity”</em>.</p>
<p>Those days are <em>long gone</em>, and although everything that surrounds me changed, <strong>I didn’t</strong>.<br>
I guess few things never <em>vanish</em>.<br>
<em>Note: I might do things wrong, but it’s all for fun anyway <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:">!</em></p>
<h4>And so it all began</h4>
<p>The shareware is available to download from <em><a href="https://www.moddb.com/games/doom/downloads/doom-shareware-doom95" rel="nofollow noopener">ModDB</a></em>.<br>
<span alt="image" data-base62-sha1="7j0MDqOHb2Nsnsb42LmdNuLS17F" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<br>
I started off by playing the game for a while, it reminded me of the implemented movement system.<br>
The <em>left/right</em> arrow-keys allow <strong>screen rotation</strong>.<br>
While <em>up/down</em> keys <em>render</em> <strong>forward and backward moves</strong> possible.<br>
<span alt="DView" data-base62-sha1="3PNeSHzBXOAQg09rlbj7rv021Do" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<br>
In order to look for the Image’s entry point, I used WinDBG and attached to <em>Doom95.exe</em> process.<br>
<span alt="image" data-base62-sha1="yTlUaPKf7kPprCH0Pjuce8rXTjT" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<br>
As you may have noticed, I’m running on a <em>64-bit machine</em>.<br>
But the executable is 32-bit:<br>
<span alt="image" data-base62-sha1="iZmM9UauQRmuyryplYkIQdlCO1r" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<strong>IMAGE_DOS_HEADER</strong>’s <em>lfanew</em> holds the <em>Offset</em> to the <em>PE signature</em>.<br>
–<br>
<span alt="image" data-base62-sha1="eiBJvu8hJBqKPPEEcewOHMURkc" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The field next to <strong>“PE\x00\x00”</strong> is called <em>‘Machine’</em>, a <strong>USHORT</strong> indicating <em>its type</em>.<br>
so I proceeded to switch to <em>x86 mode</em> using <strong>wow64exts</strong>.<br>
<br>
<span alt="image" data-base62-sha1="bjbqvwKzJe1Kb10Hizv8gtolwAl" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="oI1VBC85yqbd4V0ZocwlNRfcA29" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span></p>
<p>I then looked-up <em>“Doom”</em> within <em>loaded modules</em>, and used <em>$iment</em> to <em>extract</em> the <em>specified module</em>’s <strong>entry point</strong>.</p>
<pre><code class="lang-bash">0:011:x86&gt; lm m Doom*
start             end                 module name
00400000 00690000   Doom95   C (no symbols)           
10000000 10020000   Doomlnch C (export symbols)       Doomlnch.dll
0:011:x86&gt; ? $iment(00400000)
Evaluate expression: 4474072 = 004444d8
</code></pre>
<p>Jumping to that address in <em>IDA</em> reveals the function of interest: <strong>_WinMain</strong>.<br>
<span alt="image" data-base62-sha1="zgpgeIeL6ORX8Rgdi3Qj2GBNYGm" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The search for parts with beneficial information started.</p>
<pre><code class="lang-auto">push    eax               ; nHeight
add     edx, ebx
push    edx               ; nWidth
push    0                 ; Y
push    0                 ; X
push    0x80CA0000        ; dwStyle
push    offset WindowName ; "Doom 95"
push    offset ClassName  ; "Doom95Class"
push    0x40000           ; dwExStyle
call    cs:CreateWindowExA
</code></pre>
<p>The <strong>static</strong> <em>WindowName</em> used by the call will result in our <em>fast retrieval</em> of <em>Doom’s PID</em>.<br>
<span alt="image" data-base62-sha1="kVqrn4xhKgfldtnMi0Xb4iSb4Rp" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The combination of <strong>FindWindow()</strong> and <strong>GetWindowThreadProcessId()</strong> makes this possible.</p>
<pre><code class="lang-auto">	HWND	DoomWindow;
	DWORD	PID;
	DoomWindow = FindWindow(NULL, _T("Doom 95"));

	if (! DoomWindow)
	{
		goto out;
	}

	GetWindowThreadProcessId(DoomWindow, &amp;PID);
	printf("PID: %d\n", PID);

	out:
	return 0;
</code></pre>
<p><span alt="image" data-base62-sha1="r4UJT1Xqn3IgZ0IczfspueGXUaY" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The next thing that caught my eye in the <em>_WinMain procedure</em> were the following lines.</p>
<pre><code class="lang-auto">loc_43AF74:
mov     edi, 1
mov     eax, ds:dword_60B00C
xor     ebp, ebp
mov     ds:dword_60B450, edi
mov     ds:dword_4775CC, ebp
cmp     eax, edi
jz      short loc_43AFB8
call    cs:GetCurrentThreadId
push    eax             ; dwThreadId
mov     edx, ds:hInstance
push    edx             ; hmod
push    offset fn       ; lpfn
push    2               ; idHook
call    cs:SetWindowsHookExA
mov     ds:hhk, eax
</code></pre>
<p>The function SetWindowsHookEx installs a <strong>hook</strong>(<em>fn</em>) within the <em>current thread</em> to <em>monitor System Events</em>. This example specifically uses an idHook that equals 2, which according to <em>MSDN</em> refers to <strong>WH_KEYBOARD</strong>.<br>
<span alt="image" data-base62-sha1="ddq7X2nwVvrF2EQTW8CjRnoD8zB" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The callback function has the documented <em><a href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/ms644984(v%3Dvs.85)" rel="nofollow noopener">KeyboardProc</a></em> prototype. It captures the <em><a href="https://msdn.microsoft.com/en-us/library/dd375731(v=vs.85)" rel="nofollow noopener">Virtual-Key code</a></em> in <em>wParam</em>.<br>
On top of that, the <em>fn</em> function invokes <em>GetAsyncKeyState</em> to check if a <em>specific key is pressed</em> too:<br>
<span alt="image" data-base62-sha1="8cTpRvkiGeQwSna9g5J2MehIPtH" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The function that handles <em>arrow-keys</em> is <em>sub_442A90</em>.<br>
<span alt="image" data-base62-sha1="fkHxHbIhsqedtIP9Nyn6QNpvQ9G" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–</p>
<pre><code class="lang-auto">loc_439229:
mov     ebx, [esp+2Ch+v14]
mov     edx, [esp+2Ch+lParam]
mov     eax, esi
call    sub_442A90
</code></pre>
<h4>Player information</h4>
<p>Our ignorance of the structure stored within memory puts us at a disadvantage.<br>
In order to find where <em>Health is mainly stored</em>, I’ll be using <em>Cheat Engine</em> with the assumption that it is a <em>DWORD</em>(<em>4 bytes</em>): <em>“\x64\x00\x00\x00”</em>.<br>
<span alt="image" data-base62-sha1="jOn5cBjBqC8uTeBqUWpc3rhDKVi" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
I’ll then proceed to get the <em>character damaged</em>, and <em>‘Next Scan’</em> for the <em>new value</em>.<br>
We end up with <strong>5</strong> different <em>pointers</em>.<br>
<span alt="image" data-base62-sha1="hhNXPKhmsP9io4RoGThDkw28l87" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The <strong>last one</strong> is of a <em>black color</em>, meaning that it is a <em>dynamic address</em>, modifying it doesn’t result in any <strong>observable change</strong>.<br>
Others are clearly static, modifying <em>3/4</em> of them leads to <em>restoring the original value</em>, which meant that the <em>1/4</em> left is <strong>the parent</strong>, and the <em>rest just copy its value</em>.<br>
<strong>00482538</strong>: Health that appear on the screen.<br>
<strong>03682944</strong>: A promising address because it is <em>not updated with the parent</em>.<br>
<em>Health</em> is stored in <em>two different locations</em>, which means one is <em>nothing but a decoy</em>.<br>
<br>
I set the <em>first one’s value to <strong>1</strong></em>, and then got <em>attacked by a monster</em>.<br>
<span alt="image" data-base62-sha1="b7SDPdPSwcu9qK8BLMwdjl88hdj" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The result is:<br>
<span alt="image" data-base62-sha1="9tygzy6nlXGgmv2QsWEWYik4z1g" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The value that <em>appears on the screen hangs at 0</em>, and the <em>character doesn’t die</em>.<br>
While the second kept <em>decreasing on each attack</em>, meaning that it effectively held <em>the real value</em>.<br>
We need to <em>inspect the memory region</em> by selecting the value and clicking <em>CTRL+B</em>.<br>
<span alt="image" data-base62-sha1="n2LQxLywl9WNF0JQoZWVNhglWU5" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
We can change the <em>Display Type</em> from <strong>Byte hex</strong> to <strong>4 Byte hex</strong>.<br>
<span alt="image" data-base62-sha1="jS17zXcRgKCeXvP3oZZx1hIqvqG" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="bv2I6XTXgFbzoVBcKZnsSMmd8QG" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="bX3uqJ05AqeDPUGMSiLEOd4olvD" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
This is easier to work with, I <em>started searching</em> for the <strong>closest pointer</strong> in a <em>limited range</em>, and it turned out to be <strong>3682A24</strong>.<br>
<span alt="image" data-base62-sha1="29KWiJMKbPAAHAVlnRHw9fkVNJA" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
We then <em>goto address</em> to see its content:<br>
<span alt="image" data-base62-sha1="1SAx2Bo9VaO7aNnSVPiyfPHELAZ" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
Notice that the <em>Object’s health is empty</em>, and that <em>the struct</em> holds a <strong>Backward and Forward link</strong> at <em>its start</em>.</p>
<h4>A spark</h4>
<p>The idea that saved me a lot of time!<br>
<em><a href="https://doomwiki.org/wiki/Doom_cheat_codes" rel="nofollow noopener">CHEAT CODES</a></em>, I was both happy and shocked to find out that they really existed!</p>
<p><em>DOOMWiki</em> includes messages that appear on detection of each message.<br>
Two commands were exceptional because of the information they manipulate.</p>
<p><span alt="image" data-base62-sha1="AswH77cRyKBwfEHnPDtLbhp4Pd5" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="2r4cv32Dx1qxUcuDO1t8yTCStfn" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span></p>
<p>The magical keywords: <em>“ang=” and “BY REQUEST…”</em>.<br>
The first one’s usage occurs in:</p>
<pre><code class="lang-bash">loc_432776:
mov     eax, offset off_4669BC
movsx   edx, byte ptr [ebp+4]
call    sub_414E50
test    eax, eax
jz      short loc_4327D4
mov     edx, ds:dword_482A7C
lea     eax, ds:0[edx*8]
add     eax, edx
lea     eax, ds:0[eax*4]
sub     eax, edx
mov     eax, ds:dword_482518[eax*8]
mov     ebx, [eax+10h]
push    ebx
mov     ecx, [eax+0Ch]
push    ecx
mov     esi, [eax+20h]
push    esi
push    offset aAng0xXXY0xX0xX ; "ang=0x%x;x,y=(0x%x,0x%x)"
push    offset unk_5F2758
call    sprintf_
</code></pre>
<p>This is important and worthy to be added to our <em>CE Table</em>.<br>
<span alt="image" data-base62-sha1="tuu3VYDpy6AO94R9Z60WOuyzHWb" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
A struct layout is also to be concluded:<br>
<strong>@)</strong> +0x10: y<br>
<strong>@)</strong> + 0xC: x<br>
<strong>@)</strong> +0x20: angle<br>
I immediately noticed the missing <em>Z coordinate</em>.<br>
I knew it existed, I mean, there’s stairs. (Hey, don’t laugh! <img src="../../images/emoji/twitter/frowning.png%3Fv=9" title=":frowning:" class="emoji" alt=":frowning:">)<br>
I ended up realizing that it is at <em>+0x14</em> after a few tests. (Up and down we go.)<br>
<br>
<span alt="DCoords" data-base62-sha1="yMVc9VinW9pWVKV9TId1KQMMKye" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<br>
I knew that even if the enemy is on a different altitude: The shot still hits, and so I ignored Z.<br>
X, Y and Angle on the other hand are majorly important because of <em>distance calculation</em> and <em>angle measurement</em>.<br>
The values they <em>held look weird</em>, are <em>they floats</em>?<br>
<span alt="image" data-base62-sha1="r7bMTq6GxGzE8b6FEOLRAXsLPfe" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<span alt="image" data-base62-sha1="4MqpujagAUzJBxQdAr3nBERf6Vd" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
No, doesn’t look like it. All I knew for now is that the <em>view changes upon modification</em>.</p>
<p>Moving on to the second:</p>
<pre><code class="lang-auto">loc_432533:
mov     eax, offset off_466898
movsx   edx, byte ptr [ebp+4]
call    sub_414E50
test    eax, eax
jz      short loc_43255E
mov     eax, ds:dword_5F274C
mov     dword ptr [eax+0D8h], offset aByRequest___ ; "By request..."
call    sub_420C50
jmp     loc_4326BA
</code></pre>
<p>We can see that it only passes execution to <em>sub_420C50</em>, and that’s where the magic happens.</p>
<pre><code class="lang-bash">sub_420C50 proc near
push    ebx
push    ecx
push    edx
push    esi
mov     esi, ds:dword_484CFC
cmp     esi, offset dword_484CF8
jz      short loc_420C92
loc_420C62:
cmp     dword ptr [esi+8], offset sub_4250D0
jnz     short loc_420C87
test    byte ptr [esi+6Ah], 40h
jz      short loc_420C87
cmp     dword ptr [esi+6Ch], 0
jle     short loc_420C87
mov     ecx, 2710h
mov     eax, esi
xor     ebx, ebx
xor     edx, edx
call    sub_422370
loc_420C87:
mov     esi, [esi+4]
cmp     esi, offset dword_484CF8
jnz     short loc_420C62
loc_420C92:
pop     esi
pop     edx
pop     ecx
pop     ebx
retn
sub_420C50 endp
</code></pre>
<p>We can see that it traverses a <em>list of Objects</em>, starting with <strong>[484CFC]</strong> and ending if the <em>Forward link(+4)</em> <em>equals</em> <strong>484CF8</strong>.<br>
<span alt="image" data-base62-sha1="oDUbsNrnDnTNWLGOoUwTvch2kK0" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The inclusion of <strong>Player Object</strong> in <em>the list</em> indicates that it contains <em>all available</em> <strong>Entities</strong>.<br>
The three checks there are:<br>
<em>[Entity + 0x08] == 0x4250D0<br>
[Entity + 0x6A] &amp; 0x40<br>
[Entity + 0x6C] &gt; 0</em><br>
I was curious on what the <strong>Player Object</strong> held at those <em>Offsets</em>:<br>
<span alt="image" data-base62-sha1="5gdWwwKTdVikWgBGUiWKFuGOaDx" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<strong>@)</strong> + 0x8: <em>Function pointer(Pass)</em>.<br>
<strong>@)</strong> +0x6A: <em>Byte(Error)</em>, <em>seems like IsMonster check</em>.<br>
<strong>@)</strong> +0x6C: <em>Health(Pass)</em>.</p>
<h4>A small mistake</h4>
<p>“Did anyone do this before?”, I wondered.<br>
So I searched for:</p>
<blockquote>
<p>intext:“ang=0x%x;x,y=(0x%x,0x%x)” doom</p>
</blockquote>
<p>And well, I found out that the <em>source code was available</em>. <img src="../../images/emoji/twitter/joy.png%3Fv=9" title=":joy:" class="emoji" alt=":joy:"><br>
<span alt="image" data-base62-sha1="oXgIhN7IH09d1M4WeLdnsodp7Cx" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
At first <em>I was mad</em>, because I spent about <em>3 to 4 days to get the results previously stated</em>. But, hey! I <em>needed more information anyway</em>, and this was an <em>easy road showing up</em>.<br>
<span alt="image" data-base62-sha1="dHf644NBUps5ieBj7kW372Z1Je3" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="ybrCODwvZyaJOs2ZmxeJuPnRoRK" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="vHHSK5HzoS3EnN34GJQ1Kr7n1Gn" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
So the structure we look for is defined in <em><a href="https://github.com/historicalsource/doom/blob/master/linuxdoom-1.10/d_player.h" rel="nofollow noopener">d_player.h</a></em>, the <em>interesting element’s name</em> is <strong>mo</strong>.</p>
<pre><code class="lang-auto">//
// Extended player object info: player_t
//
typedef struct player_s
{
    mobj_t*		mo;
...
</code></pre>
<p>Its nature is <em>mobj_t</em>, declared in <em><a href="https://github.com/historicalsource/doom/blob/master/linuxdoom-1.10/p_mobj.h" rel="nofollow noopener">p_mobj.h</a></em>.</p>
<pre><code class="lang-auto">// Map Object definition.
typedef struct mobj_s
{
    // List: thinker links.
    thinker_t		thinker;

    // Info for drawing: position.
    fixed_t		x;
    fixed_t		y;
    fixed_t		z;

    // More list: links in sector (if needed)
    struct mobj_s*	snext;
    struct mobj_s*	sprev;

    //More drawing info: to determine current sprite.
    angle_t		angle;	// orientation
...
</code></pre>
<p>The size of <em><a href="https://github.com/historicalsource/doom/blob/master/linuxdoom-1.10/d_think.h" rel="nofollow noopener">thinker_t</a></em> is: <em>sizeof(PVOID) * 3</em> = 4 * 3 = <strong>12</strong>.<br>
Then comes <em>X, Y and Z</em> at <em>(0x0C, 0x10, 0x14)</em>.<br>
Two pointers <em><span class="mention">@0x18</span></em> are ignored(<em>4 * 2</em> = <strong>8</strong>).<br>
Angle is at <em>0x20</em>.</p>
<pre><code class="lang-auto">...
    int			health;

    // Movement direction, movement generation (zig-zagging).
    int			movedir;	// 0-7
    int			movecount;	// when 0, select a new dir

    // Thing being chased/attacked (or NULL),
    // also the originator for missiles.
    struct mobj_s*	target;
...
</code></pre>
<p>The target element is interesting, it supposedly holds a pointer to the <em>Map Object</em> being attacked!<br>
<em>Calculating its offset isn’t that hard</em>, because we know that <em>Health</em> is at <em>0x6C</em>.<br>
<em>FIELD_OFFSET(mobj_t, target)</em> = <em>0x6C + sizeof(int) * 3</em> = <strong>0x78</strong>.<br>
The following line in <em><a href="https://github.com/historicalsource/doom/blob/master/linuxdoom-1.10/r_local.h" rel="nofollow noopener">r_local.h</a></em> indicates that there’s a <strong>lookup table/function</strong> for <em>Angles</em>, explaining why there’s <em>weird values therein</em>.</p>
<pre><code class="lang-auto">// Binary Angles, sine/cosine/atan lookups.
#include "tables.h"
</code></pre>
<p>It’s time to see what the <em>target</em> element holds for us!<br>
<span alt="image" data-base62-sha1="ifAehZzIQSolfYLFpM5xIpX9v4R" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
Since I just started up the game, its value is <strong>NULL</strong>.<br>
<span alt="image" data-base62-sha1="3eLWzimOdQrjafIazsCqWbbGUWe" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<em>Attacking or getting attacked by a monster</em> leads to a <em>value change</em>.<br>
<span alt="image" data-base62-sha1="2xa2QmgNzxJN1N9CBFGzhy6U4Pf" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
But there is no <em>update after killing the monster, hmmm</em>.<br>
<span alt="image" data-base62-sha1="qDyCkdYcWX2bX9YzN5h0oiBWy5w" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The <strong>health</strong> is the <em>only indicator of death if it is &lt;= 0</em>.<br>
And that’s <em>not the only problem</em>:<br>
<em>Attacking a second Monster doesn’t result in any change occuring</em>.<br>
Since I want it to be <em>regularly updated</em>, I had to <em>find a way around it</em>.<br>
I restarted <em>Doom95.exe</em>, selected the <em>Pointer to Player’s Target</em> and:<br>
<span alt="image" data-base62-sha1="qVGF3JwoHwd3pkjxUw2USoMQJAF" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="i14OnO0rhb3BBhGG62hauOh1KOd" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="iP6YDDy81DU9khoKHLBpyVPDocj" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="jZYCS75mYllBnHZbdYpc7fZdiAp" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
We can now start fighting an enemy:<br>
<span alt="image" data-base62-sha1="6UVtY6H9xaKBZFCwM7tgQ8F82SV" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
This is the instruction <em>responsible for writing to the Player’s Target element</em>.<br>
Going back a little in <em>disassembly window</em>, there are some <strong>simple checks</strong>:<br>
<em>Is the Target NULL? Is it equal to the Player itself?</em><br>
<span alt="image" data-base62-sha1="pEiQiylHENAW1Ye3LSwacAVngDA" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The <em>origin of EBX register</em> is the <em>selected instruction</em>, and <em>its location is</em>: <strong>00422684</strong>.<br>
All I had to do is <em>find a location</em> where to place a <strong>JMP 422684</strong>.<br>
I ended up choosing <strong>0042264F</strong>:<br>
<span alt="image" data-base62-sha1="seTB8qbvgQ4Uc2Ocjbrfj2AVdIm" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="bY60giAgoBmezhfbuDhUaKuN1xA" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="wHbpAsyIpFyZiEnksKs1GQ41AXN" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The <em><strong>sequence of bytes</strong> turns from {0x7D, 0x1C} to {0xEB, 0x33}</em>, we aren’t <em>destroying any instructions after it</em>.<br>
Let’s now see if it <em>changes on each attack</em>:<br>
<strong>Monster <span class="hashtag">#1:</span></strong><br>
<span alt="image" data-base62-sha1="6vzKIWFaYsdmfIj1mPIkDqZboGB" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<strong>Monster <span class="hashtag">#2:</span></strong><br>
<span alt="image" data-base62-sha1="uEv2BkqbWQF1UG33FQDAxRVciZK" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<em>PERFECT!</em></p>
<h4>Last piece of the puzzle</h4>
<p>Monsters could <em>accurately aim at my character</em>.<br>
I knew a function responsible for <strong>angle measurement</strong> existed, <em>I just had to find it</em>.<br>
After a <em>few hours searching</em>, I ended up looking in <em><a href="https://github.com/historicalsource/doom/blob/master/linuxdoom-1.10/p_enemy.c" rel="nofollow noopener">p_enemy.c</a></em>;</p>
<pre><code class="lang-cpp">boolean P_CheckMeleeRange (mobj_t*	actor)
{
    mobj_t*	pl;
    fixed_t	dist;
	
    if (!actor-&gt;target)
	return false;
		
    pl = actor-&gt;target;
    dist = P_AproxDistance (pl-&gt;x-actor-&gt;x, pl-&gt;y-actor-&gt;y);

    if (dist &gt;= MELEERANGE-20*FRACUNIT+pl-&gt;info-&gt;radius)
	return false;
	
    if (! P_CheckSight (actor, actor-&gt;target) )
	return false;
							
    return true;		
}
</code></pre>
<p>A collection of interesting functions!<br>
<em>P_AproxDistance()</em><br>
<em>P_CheckSight()</em><br>
And the most <strong>promising</strong> one:<br>
<span alt="image" data-base62-sha1="vkxPq4qMs8lPbNqyrO67hLni9Uv" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<em>R_PointToAngle2()</em>, and its <em><a href="https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/r_main.c" rel="nofollow noopener">definition</a></em> is <em>the following</em>:</p>
<pre><code class="lang-cpp">angle_t
R_PointToAngle2
( fixed_t	x1,
  fixed_t	y1,
  fixed_t	x2,
  fixed_t	y2 )
{	
    viewx = x1;
    viewy = y1;
    
    return R_PointToAngle (x2, y2);
}
</code></pre>
<p>I knew the <em>Player’s X, Y were read right before invokation</em>. I used this information to <em>trace the calls</em> and <em>watched for accesses</em>:<br>
<span alt="image" data-base62-sha1="bKuFQZadhRtHg4j4msdnZYkXKtW" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="g4RnIuu5SiJ5yVR8hcLPuG2yiKk" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
Once a <em>monster aims at us</em>, we <strong>get results</strong>:<br>
<span alt="image" data-base62-sha1="jkUWfogcaWDryCQJpGMISr9i7pn" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
I <em>started</em> with those with the <em>least hit-count at the middle</em>.<br>
<span alt="image" data-base62-sha1="pIdj6xtr2mXFjPA6lzUOLcxP0ek" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<em>The second one looks like the thing we’re looking for!</em><br>
<span alt="image" data-base62-sha1="7rpj2BhBRF00MNFJ8EPPasWLVx4" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
It prepares to call <strong>0042DB10</strong> by loading the <em>Target</em> in <em>EAX</em> and storing its <em>(X, Y) coordinates</em> in <em>EBX and ECX</em>, while <em>EAX and EDX</em> hold <em>those of the monster</em>.<br>
<em>We can deduce that it is a __fastcall.</em><br>
<strong>Disassembling</strong> the function <em>shows</em>:<br>
<span alt="image" data-base62-sha1="8KIIcQ2qpEtqA5vNpwMcRgwMGcT" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<em>Looks familiar!</em><br>
<em>It is R_PointToAngle2() @ <strong>0042DB10</strong> <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:">!</em><br>
With that in <em>mind, locating this function is made easier</em>.</p>
<pre><code class="lang-cpp">//
// A_FaceTarget
//
void A_FaceTarget (mobj_t* actor)
{	
    if (!actor-&gt;target)
	return;
    
    actor-&gt;flags &amp;= ~MF_AMBUSH;
	
    actor-&gt;angle = R_PointToAngle2 (actor-&gt;x,
				    actor-&gt;y,
				    actor-&gt;target-&gt;x,
				    actor-&gt;target-&gt;y);
    
    if (actor-&gt;target-&gt;flags &amp; MF_SHADOW)
	actor-&gt;angle += (P_Random()-P_Random())&lt;&lt;21;
}
</code></pre>
<p>I’ll just use <em>IDA</em>.<br>
<span alt="image" data-base62-sha1="b4JuU96bk5LltnYyiU0nyIrw7Dz" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="wLnsf5SAqEg7kME3uvwaAZmjMGl" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<span alt="image" data-base62-sha1="oOJliovdZUrItGnJS2vGynk9Tmf" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
Looks like it, <em>it starts by returning if Target is <strong>NULL</strong></em>, then <em>AND</em>s [<em>Monster+0x68</em>] with <strong>0xDF</strong>. What’s sad, is that <em>I was looking at it since the beginning</em> in <strong>CE</strong>, welp <img src="../../images/emoji/twitter/joy.png%3Fv=9" title=":joy:" class="emoji" alt=":joy:">.<br>
<em>A_FaceTarget is at <strong>0041F670</strong></em>.</p>
<h4>The making</h4>
<p>All that <em>we’ve learned about the game</em> will allow us to start <em>wrapping things</em> in <em>C++</em>.<br>
Let’s create <em>ADoom.h</em>:</p>
<pre><code class="lang-auto">#ifndef __ADOOM_H__
#define __ADOOM_H__

class ADoom {
public:
	ADoom(DWORD);
	~ADoom();
private:
	HANDLE	DH;
};

#endif
</code></pre>
<p>And <em>ADoom.c</em>:</p>
<pre><code class="lang-auto">#include &lt;cstdio&gt;
#include &lt;cstdlib&gt;
#include &lt;stdexcept&gt;
#include &lt;tchar.h&gt;
#include &lt;Windows.h&gt;

#include "ADoom.h"

ADoom::ADoom(DWORD CPID)
{
	DH = OpenProcess(PROCESS_ALL_ACCESS, FALSE, CPID);

	if (DH != INVALID_HANDLE_VALUE)
	{
		return;
	}

	throw std::runtime_error("Can't open process!");
}

ADoom::~ADoom(){
	CloseHandle(DH);
}

int main()
{
	HWND	DoomWindow;
	DWORD	PID;

	DoomWindow = FindWindow(NULL, _T("Doom 95"));
	if (! DoomWindow) goto out;
	GetWindowThreadProcessId(DoomWindow, &amp;PID);

	try
	{
		ADoom	DAim(PID);
	} catch (const std::runtime_error &amp;err) { };

	while (1)
	{
		Sleep(1);
	}
	out:
	return 0;
}
</code></pre>
<p>I’ll create functions that <em>read(<strong>rM</strong>)/write(<strong>wM</strong>) to the process memory</em> by extending <em>both the header and source file</em>.<br>
We are going to use <em>two WINAPI calls for that purpose</em>: <strong>ReadProcessMemory()</strong> and <strong>WriteProcessMemory()</strong>.<br>
<span alt="image" data-base62-sha1="6Z2etDBlJvvpT3aVS32SPriNUJP" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span> | | | | | <span alt="image" data-base62-sha1="x0fChMctZMlRuOwwZwSDLakufvK" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–</p>
<pre><code class="lang-auto">	template&lt;typename ReadType&gt;
	ReadType rM(DWORD, DWORD);
	BOOL wM(DWORD, PVOID, SIZE_T);
</code></pre>
<p>–</p>
<pre><code class="lang-auto">template&lt;typename ReadType&gt;
ReadType ADoom::rM(DWORD RAddress, DWORD Offset)
{
	ReadType Result;
	PVOID	 External = reinterpret_cast&lt;PVOID&gt;(RAddress + Offset);

	ReadProcessMemory(DH, External, &amp;Result, sizeof(Result), NULL);
	return Result;
}

BOOL ADoom::wM(DWORD RAddress, PVOID LAddress, SIZE_T Size)
{
	BOOL	Status = FALSE;
	PVOID	External = reinterpret_cast&lt;PVOID&gt;(RAddress);

	if (WriteProcessMemory(DH, External, LAddress, Size, NULL))
	{
		Status = TRUE;
	}
	
	return Status;
}
</code></pre>
<p><em>Let’s check if Player’s Object manipulation is possible</em>:</p>
<pre><code class="lang-auto">	try
	{
		ADoom	DAim(PID);
		DWORD	Corrupt = 0x12345678, Player, PPlayer = 0x482518;

		Player = DAim.rM&lt;DWORD&gt;(PPlayer, 0);
		printf("Player Object @ %lX\n", Player);

		DAim.wM(PPlayer, &amp;Corrupt, sizeof(Corrupt));
		puts("Corrupted the Player Object.");
	} catch (const std::runtime_error &amp;err) { }
</code></pre>
<p>–<br>
<span alt="image" data-base62-sha1="ly6c7GFsj6JaDEr7Tj1ZVXLWYQC" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
The <em><strong>Doom95.exe</strong> process crashes</em>, <em>success</em>.<br>
We have to <em>apply the <strong>2 byte</strong> patch and keep an eye</em> on the <strong>Player’s Target</strong> value.</p>
<pre><code class="lang-auto">	try
	{
		ADoom	DAim(PID);
		BYTE	Patch[2] = {0xEB, 0x33};
		DWORD	PAddress = 0x42264F;
		DWORD	Player, PPlayer = 0x482518;
		int		THealth;
		DWORD	OTarget = 0, Target;

		Player = DAim.rM&lt;DWORD&gt;(PPlayer, 0);
		printf("Player Object @ %lX\n", Player);

		printf("Applying Patch @ %lX\n", PAddress);
		DAim.wM(PAddress, &amp;Patch[0], sizeof(Patch));

		while (true)
		{
			Target = DAim.rM&lt;DWORD&gt;(Player, 0x78);

			// Are we currently engaging the enemy?
			if (Target != 0)
			{
				// If yes, is it already dead?
				THealth = DAim.rM&lt;int&gt;(Target, 0x6C);
				if (THealth &lt;= 0)
				{
					continue;
				}

				/*
					Uniqueness check.
				*/
				if (! OTarget || OTarget != Target)
				{
					printf("Current Target @ %lX\n", Target);
					OTarget = Target;
				}
			}
		}
	} catch (const std::runtime_error &amp;err) { }
</code></pre>
<p>–<br>
<span alt="image" data-base62-sha1="lsQqFMUPgeeNOODEyAV4SiDnZ62" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
<em>So far so good, we are making progress.</em><br>
At first, I totally forgot about the <strong>Health check</strong>, and <em>it kept aiming at the dead Monster</em>.<br>
<span alt="dead" data-base62-sha1="jON6o5PLmVhEEy7vMTFJ0rOQXyJ" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
It is time to use our knowledge about <em>A_FaceTarget(<strong>0041F670</strong>)</em>.<br>
It takes an <em>mobj_t *</em> argument in <strong>EAX</strong>, and <em>performs a single check</em>(<em>EAX-&gt;target != NULL</em>) before <em>calculating and storing the correct angle</em>, this is a <em>minimum of work on our side</em>.<br>
All is left to do, is creating a <strong>reliable function</strong> and <em>storing/running</em> it in the <em>remote thread</em>.</p>
<pre><code class="lang-auto">VOID _declspec(naked) Reliable(VOID)
{
	__asm {
		mov eax, 0x482518 // Load PPlayer in EAX
		mov eax, [eax]    // Load Player Object in EAX
		mov edi, 0x41F670 // Indicate the FP(A_FaceTarget)
		call edi          // Call it
		ret
	}
}
</code></pre>
<p>We can <em>compile the executable and load it up in IDA</em>.<br>
<span alt="image" data-base62-sha1="jXTC4USdmpZg5xgnBm5eZCiKXKY" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
–<br>
<em><strong>Hex-view</strong> is synchronized with <strong>Disassembly-view</strong>, so selecting the first ‘mov’ is all we have to do.</em><br>
<span alt="image" data-base62-sha1="g2kdHxZUqFXI7UJ9tHLlmoR7B6F" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
That is <em>our function</em>!</p>
<pre><code class="lang-auto">BYTE Payload[] = {0xB8, 0x18, 0x25, 0x48, 0x00, 0x8B, 0x00,
				  0xBF, 0x70, 0xF6, 0x41, 0x00, 0xFF, 0xD7,
				  0xC3};
DWORD PSize = sizeof(Payload);
</code></pre>
<p>With that done, <em>we need a location to write it to</em>, it needs to be <em>Executable/Readable and Writeable too</em>.<br>
In order to get it, we will call <strong>VirtualAllocEx()</strong>.<br>
<span alt="image" data-base62-sha1="od9JLxuLm4q7I9SJxPMZpzGMYDv" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
We have to specify <em>flProtect</em> as <em>PAGE_EXECUTE_READWRITE</em>.<br>
Another <em>helper function</em> will be called <strong>aM</strong> short for <em>allocate Memory</em>. <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<pre><code class="lang-auto">DWORD aM(SIZE_T);
</code></pre>
<p>–</p>
<pre><code class="lang-auto">DWORD ADoom::aM(SIZE_T Size)
{
	LPVOID RAddress = VirtualAllocEx(DH, NULL, Size, MEM_COMMIT | MEM_RESERVE,
					  PAGE_EXECUTE_READWRITE);
	DWORD  Cast = reinterpret_cast&lt;DWORD&gt;(RAddress);

	return Cast;
}
</code></pre>
<p>And then there should be a <em>function to spawn a Thread</em> in <em>Doom95.exe process</em>.<br>
We’ll be using <strong>CreateRemoteThread()</strong>, and <em>wait for it to terminate</em> using <strong>WaitForSingleObject()</strong>.<br>
<span alt="image" data-base62-sha1="ebiICrKofvYkdCrHOasHhs5ivCb" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span> | | <span alt="image" data-base62-sha1="ti7Dc5gUNTnnWzbUY4a5fzX831" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
It’ll be called <strong>sT</strong>.</p>
<pre><code class="lang-auto">VOID sT(DWORD);
</code></pre>
<p>–</p>
<pre><code class="lang-cpp">VOID ADoom::sT(DWORD FPtr)
{
	HANDLE RT;

	RT = CreateRemoteThread(DH, NULL, 0, (LPTHREAD_START_ROUTINE) FPtr,
		 NULL, 0, NULL);

	if (RT != INVALID_HANDLE_VALUE)
	{
		WaitForSingleObject(RT, INFINITE);
	}
}
</code></pre>
<p>That’s all we need, <em>now we can implement the whole loop</em>:</p>
<pre><code class="lang-auto">	try
	{
		ADoom	DAim(PID);
		BYTE	Patch[2] = {0xEB, 0x33};
		DWORD	PAddress = 0x42264F;
		BYTE	Payload[] = {0xB8, 0x18, 0x25, 0x48, 0x00, 0x8B, 0x00,
							 0xBF, 0x70, 0xF6, 0x41, 0x00, 0xFF, 0xD7,
							 0xC3};
		DWORD	Location, PSize = sizeof(Payload);
		DWORD	PPlayer = 0x482518, Player, Target;
		int		THealth;

		/*
			Patch:
			An unconditional JMP instruction that allows Player-&gt;target
			to be updated on every attack.
		*/
		printf("Applying Patch @ %lX\n", PAddress);
		DAim.wM(PAddress, Patch, sizeof(Patch));

		printf("Allocating Memory(%d)\n", PSize);
		Location = DAim.aM(PSize);

		printf("Storing Function @ %lX\n", Location);
		DAim.wM(Location, Payload, PSize);

		puts("[0x00sec] Aimbot starting.");

		while (TRUE)
		{
			Player = DAim.rM&lt;DWORD&gt;(PPlayer, 0);
			Target = DAim.rM&lt;DWORD&gt;(Player, 0x78);

			// Did any enemy attack us?
			if (Target != 0)
			{
				// If yes, is it still alive?
				THealth = DAim.rM&lt;int&gt;(Target, 0x6C);
				if (THealth &gt; 0)
				{
					// Aim at it.
					DAim.sT(Location);
				}
			}
		}
	} catch (const std::runtime_error &amp;err) { }
</code></pre>
<p>–<br>
<span alt="image" data-base62-sha1="qFQInlJJkzFdgAhszIE640shduk" class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span><br>
And it works! <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<h4>End</h4>
<p>It took many attempts to get to the final product, but it certainly was fun!<br>
I could not include <em>pictures or GIFs from the game because I didn’t find a way to do it</em>, for that, I apologize.<br>
Lots of modifications were made to guarantee <em>reliability</em>, an example would be <em>the Player object</em> is updated on <em>two events</em>: <strong>Death</strong>/<strong>Level Change</strong>.<br>
And I also <em>got rid of some functions such as</em>:</p>
<pre><code class="lang-auto">VOID GetMonsters(vector&lt;DWORD&gt; *M, HANDLE Proc)
{
	DWORD	First = 0x484CFC, Last = 0x484CF8;
	int		MHealth;
	UCHAR	IsMonster;

	First = rM&lt;DWORD&gt;(First, Proc);
	Last = rM&lt;DWORD&gt;(Last, Proc);
	
	do {
		IsMonster = rM&lt;UCHAR&gt;(First + 0x6A, Proc);
		MHealth = rM&lt;int&gt;(First + 0x6C, Proc);

		// Is it a monster and is it alive?
		if ((IsMonster &amp; 0x40) &amp;&amp; (MHealth &gt; 0))
		{
			M-&gt;push_back(First);
		}
	} while ((First = rM&lt;DWORD&gt;(First + 4, Proc)) != Last);
}
</code></pre>
<p><em>I didn’t even need to include &lt;cmath&gt; in the end!</em><br>
<strong>NIAHAHAHA!</strong><br>
~ exploit</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="19" />
<span class="post-likes">19 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../0x00sec-2020-year-end-review-0x05/24443.html">0x00sec 2020 Year End Review - 0x05</a>
<meta itemprop="position" content="11">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="19862.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-03-16T21:00:31Z" class="post-time">
March 16, 2020, 9:00pm
</time>
<meta itemprop="dateModified" content="2020-03-16T21:00:31Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Sick article dude!</p>
<p>This is really creative stuff, you always kill it with your articles, keep it up man <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>You’re going to go so far in this world, there are few people like you.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="19862.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-03-16T21:03:10Z" class="post-time">
March 16, 2020, 9:03pm
</time>
<meta itemprop="dateModified" content="2020-03-16T21:03:10Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thank you so much, I’ll do my best <img src="../../images/emoji/twitter/heart.png%3Fv=9" title=":heart:" class="emoji" alt=":heart:">!<br>
I’m really happy I found the time to write this <img src="../../images/emoji/twitter/grin.png%3Fv=9" title=":grin:" class="emoji" alt=":grin:">!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/ricksanchez"><span itemprop="name">ricksanchez</span></a>
</span>
<link itemprop="mainEntityOfPage" href="19862.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-03-17T17:31:36Z" class="post-time">
March 17, 2020, 5:31pm
</time>
<meta itemprop="dateModified" content="2020-03-17T17:31:36Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Good stuff as always <a class="mention" href="https://0x00sec.org/u/exploit">@exploit</a> ! Really enjoyed the write-up <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> .<br>
About time you wrote a new article <img src="../../images/emoji/twitter/stuck_out_tongue.png%3Fv=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="19862.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-03-17T17:53:14Z" class="post-time">
March 17, 2020, 5:53pm
</time>
<meta itemprop="dateModified" content="2020-03-17T17:53:14Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I know, it took forever <a class="mention" href="https://0x00sec.org/u/ricksanchez">@ricksanchez</a>. <img src="../../images/emoji/twitter/joy.png%3Fv=9" title=":joy:" class="emoji" alt=":joy:"><br>
And thank youu, really happy you liked it! <img src="../../images/emoji/twitter/laughing.png%3Fv=9" title=":laughing:" class="emoji" alt=":laughing:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Danus"><span itemprop="name">Danus</span></a>
</span>
<link itemprop="mainEntityOfPage" href="19862.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-03-19T15:40:31Z" class="post-time">
March 19, 2020, 3:40pm
</time>
<meta itemprop="dateModified" content="2020-03-19T15:40:31Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This is some pretty fucking cool stuff <a class="mention" href="https://0x00sec.org/u/exploit">@exploit</a>, good job!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="19862.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-03-19T16:33:04Z" class="post-time">
March 19, 2020, 4:33pm
</time>
<meta itemprop="dateModified" content="2020-03-19T16:44:12Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thank youu <a class="mention" href="https://0x00sec.org/u/danus">@Danus</a>! <img src="../../images/emoji/twitter/grin.png%3Fv=9" title=":grin:" class="emoji" alt=":grin:"> <img src="../../images/emoji/twitter/heart.png%3Fv=9" title=":heart:" class="emoji" alt=":heart:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/DamaneDz"><span itemprop="name">DamaneDz</span></a>
(DamaneDz)
</span>
<link itemprop="mainEntityOfPage" href="19862.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-03-20T12:47:41Z" class="post-time">
March 20, 2020, 12:47pm
</time>
<meta itemprop="dateModified" content="2020-03-20T12:47:41Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Nice one kho <img src="../../images/emoji/twitter/stuck_out_tongue.png%3Fv=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> <img src="../../images/emoji/twitter/heart.png%3Fv=9" title=":heart:" class="emoji" alt=":heart:"><br>
One of the best gamehacking sheet I’ve <em>ever read</em> !</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hartescout"><span itemprop="name">hartescout</span></a>
(meatball)
</span>
<link itemprop="mainEntityOfPage" href="19862.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-06-26T05:42:23Z" class="post-time">
June 26, 2020, 5:42am
</time>
<meta itemprop="dateModified" content="2020-06-26T05:42:23Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Carmacks’s gonna come at you with a shovel. <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Awesome write up!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="19862.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-07-16T12:50:37Z" class="post-time">
July 16, 2020, 12:50pm
</time>
<meta itemprop="dateModified" content="2020-07-16T12:50:37Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
