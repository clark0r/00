<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CrackMe Challenge [Part 3] - Hardcoded Password ~ Obfuscated (C#) - Challenges - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Hey Mates, 
we have again some time, so we accept another challenge! Why? Because we can! Ok, enough motivation speech for now; let’s come to the introduction. 
This time I just reused the program I made last time (Yep, &amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="449.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;CrackMe Challenge [Part 3] - Hardcoded Password ~ Obfuscated (C#)&#39;" href="449.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/1X/6caeaf3ec03581da1b5401c3dd66dfb1b6ae9ce1.PNG" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/1X/6caeaf3ec03581da1b5401c3dd66dfb1b6ae9ce1.PNG" />
<meta property="og:url" content="https://0x00sec.org/t/crackme-challenge-part-3-hardcoded-password-obfuscated-c/449" />
<meta name="twitter:url" content="https://0x00sec.org/t/crackme-challenge-part-3-hardcoded-password-obfuscated-c/449" />
<meta property="og:title" content="CrackMe Challenge [Part 3] - Hardcoded Password ~ Obfuscated (C#)" />
<meta name="twitter:title" content="CrackMe Challenge [Part 3] - Hardcoded Password ~ Obfuscated (C#)" />
<meta property="og:description" content="Hey Mates,  we have again some time, so we accept another challenge! Why? Because we can! Ok, enough motivation speech for now; let’s come to the introduction.  This time I just reused the program I made last time (Yep, I’m a lazy guy 😎) but with a slightly difference: Obfuscation. I talked from time to time in my last article about it and now I’ll tell you what it is.  WTF? What’s this Random Code??? First I’ll give you the obfuscated program with the exercise to try decompiling it. ..." />
<meta name="twitter:description" content="Hey Mates,  we have again some time, so we accept another challenge! Why? Because we can! Ok, enough motivation speech for now; let’s come to the introduction.  This time I just reused the program I made last time (Yep, I’m a lazy guy 😎) but with a slightly difference: Obfuscation. I talked from time to time in my last article about it and now I’ll tell you what it is.  WTF? What’s this Random Code??? First I’ll give you the obfuscated program with the exercise to try decompiling it. ..." />
<meta property="og:article:section" content="Reverse Engineering" />
<meta property="og:article:section:color" content="12A89D" />
<meta property="og:article:section" content="Challenges" />
<meta property="og:article:section:color" content="283890" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="10 ❤" />
<meta property="article:published_time" content="2016-05-22T06:56:19+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="449.html">CrackMe Challenge [Part 3] - Hardcoded Password ~ Obfuscated (C#)</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/reverse-engineering/58.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #12A89D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Reverse Engineering</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/reverse-engineering/challenges.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #283890"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Challenges</span>
</span>
</a>
<meta itemprop="position" content="2" />
</span>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="CrackMe Challenge [Part 3] - Hardcoded Password ~ Obfuscated (C#)">
<meta itemprop="articleSection" content="Challenges">
<meta itemprop="keywords" content>
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="449.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/1X/6caeaf3ec03581da1b5401c3dd66dfb1b6ae9ce1.PNG">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-22T06:56:19Z" class="post-time">
May 22, 2016, 6:56am
</time>
<meta itemprop="dateModified" content="2016-05-22T06:56:19Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Hey Mates,<br>
we have again some time, so we accept another challenge! Why? Because we <strong>can</strong>! Ok, enough motivation speech for now; let’s come to the introduction.<br>
This time I just reused the program I made last time (Yep, I’m a lazy guy <img src="../../images/emoji/twitter/sunglasses.png%3Fv=9" title=":sunglasses:" class="emoji" alt=":sunglasses:">) but with a slightly difference: Obfuscation. I talked from time to time in my last article about it and now I’ll tell you what it is.</p>
<h2>WTF? What’s this Random Code???</h2>
<p>First I’ll give you the obfuscated program with the exercise to try decompiling it. Get it here: <a href="https://mega.nz/#!b5RinRoL!E4BfTfcUu-fUWW36D-wn4KLR7Rrt75vDl5vp452pEXc" rel="noopener nofollow ugc">https://mega.nz/#!b5RinRoL!E4BfTfcUu-fUWW36D-wn4KLR7Rrt75vDl5vp452pEXc</a>. Maybe you already see a difference in the file size. The program is <strong>much</strong> bigger than last time, although I promise that I only changed the password <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">. After decompiling you should explore the file a bit. Maybe you’ll find something that looks in the form like the main function on yourself. If not, just read further on. It’s not that important.<br>
You should be greeted with code like this after you’ve found the main function:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/1X/6caeaf3ec03581da1b5401c3dd66dfb1b6ae9ce1.PNG" width="402" height="500"><br>
Yeah, that’s main! But WTF is that code?<br>
After I had found the right obfuscator (Shouldn’t be too good or too bad and of course free; this is the reason why this article wasn’t published yesterday, because it took me more time than I thought <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:">), I selected some obfuscation options, e.g. string encryption, a very popular obfuscation technique. So what you see here is the product of an encryption technique. It wouldn’t be such a fun to RE that, so some ingenious guy came right from the heaven to help us <img src="../../images/emoji/twitter/innocent.png%3Fv=9" title=":innocent:" class="emoji" alt=":innocent:">.</p>
<h2>De4Dot</h2>
<p>De4Dot is an unobfuscator which supports manny different obfuscators (Sadly not the newest version of .NET Refactor; I had to take v 4.5), which helps you <strong>a lot</strong> with reversing C# applications! Get it here: <a href="http://de4dot.com/" rel="noopener nofollow ugc">http://de4dot.com/</a><br>
After download extract the binary and just drop your obfuscated file on the de4dot.exe (Maybe de4dot-x64.exe). You can also use your obfuscated file as argument when running the .exe via terminal. <strong>At this point I remeber that I only tried that on Win7! If you get any errors on linux or other Wins ask in the comments and I’ll try to help you!</strong> Now you should see that it creates a new file called “yourObfuscatedFile-cleaned.exe”. Run it and you’ll see it works as good as before.</p>
<h2>Reversing the Unobfuscated Executable</h2>
<p>It’s as easy as some of you may think. Now you just have to open the cleaned file in dotPeek. Make sure you’ve closed the obfuscated file in dotPeek before, because it made some issues when I tried it without closing. After exploring the file a bit you see that it’s not the same as last time. More classes with default names are added. Now you see that we’re not done with just unobfuscating the file, because it remains with weird changes. Maybe it will confuse you a bit, but it’s not that hard. Just try the different classes and you’ll see that class1 should be the one we search for. Ok, we come to the interesting point: Are the strings unencrypted? The answer is yes! Apart from the variable, classes and method names we got our source back! Again it’s not that hard to find the password now, so I let you alone with this “challenge”.</p>
<h2>Conclusion</h2>
<p>Puh, that was the last part of introduction to C# reversing. When we come to other languages (I plan to make a series on C++ and Java/Android too) I will introduce some fundamentals in the first posts too, but for the next C# parts I think we can start with the real challenges. As always I hope you had fun while learned something new. Next time I’ll give you a harder challenge than a hardcoded password ;).</p>
<p>|-TheDoctor-|</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="7" />
<span class="post-likes">7 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../crackme-challenge-part-5-license-key-c/465/18.html">CrackMe Challenge [Part 5] - License Key (C#)</a>
<meta itemprop="position" content="3">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="449.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-22T08:44:30Z" class="post-time">
May 22, 2016, 8:44am
</time>
<meta itemprop="dateModified" content="2016-05-22T08:44:30Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Nice <a class="mention" href="https://0x00sec.org/u/thedoctor">@TheDoctor</a>!</p>
<p>I see the difference!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/JaCube"><span itemprop="name">JaCube</span></a>
(Jakub)
</span>
<link itemprop="mainEntityOfPage" href="449.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-22T19:18:03Z" class="post-time">
May 22, 2016, 7:18pm
</time>
<meta itemprop="dateModified" content="2016-05-22T19:18:03Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks, <a class="mention" href="https://0x00sec.org/u/thedoctor">@TheDoctor</a> !</p>
<p>Obfuscated version not worked for me on linux with mono 4.2.3. But after unobfuscating with de4dot on windows program begin work on linux too.</p>
<p>P.S. And MonoDevelop can decompile obfuscated version <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="449.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-05-23T11:21:50Z" class="post-time">
May 23, 2016, 11:21am
</time>
<meta itemprop="dateModified" content="2016-05-23T11:21:50Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thank you for the response!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
