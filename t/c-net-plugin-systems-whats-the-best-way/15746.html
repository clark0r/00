<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>C# .Net Plugin Systems, whats the best way? - Questions - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="First of all, hello 0x00sec I’m back, after around 2 years I finally am not head deep in research, school, and work, and I’ve been working on a plugin loader called Code_Olive, more on that in a bit, Code_Olive is meant &amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="15746.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;C# .Net Plugin Systems, whats the best way?&#39;" href="15746.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/c-net-plugin-systems-whats-the-best-way/15746" />
<meta name="twitter:url" content="https://0x00sec.org/t/c-net-plugin-systems-whats-the-best-way/15746" />
<meta property="og:title" content="C# .Net Plugin Systems, whats the best way?" />
<meta name="twitter:title" content="C# .Net Plugin Systems, whats the best way?" />
<meta property="og:description" content="First of all, hello 0x00sec I’m back, after around 2 years I finally am not head deep in research, school, and work, and I’ve been working on a plugin loader called Code_Olive, more on that in a bit, Code_Olive is meant to be my solution to the need for a new and better PluginLoader for .Net Core and even .Net Framework But is there a better way to load a plugin?  In .Net based languages specifically c#, f# and vb there are many many ways of making a plugin type system, from reflection to dynami..." />
<meta name="twitter:description" content="First of all, hello 0x00sec I’m back, after around 2 years I finally am not head deep in research, school, and work, and I’ve been working on a plugin loader called Code_Olive, more on that in a bit, Code_Olive is meant to be my solution to the need for a new and better PluginLoader for .Net Core and even .Net Framework But is there a better way to load a plugin?  In .Net based languages specifically c#, f# and vb there are many many ways of making a plugin type system, from reflection to dynami..." />
<meta property="og:article:section" content="Questions" />
<meta property="og:article:section:color" content="BF1E2E" />
<meta property="og:article:tag" content="programming" />
<meta property="og:article:tag" content="csharp" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="3 ❤" />
<meta property="article:published_time" content="2019-08-21T14:50:22+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="15746.html">C# .Net Plugin Systems, whats the best way?</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/support/52.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Questions</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/programming.html" class="discourse-tag" rel="tag">programming</a>,
<a href="../../tag/csharp.html" class="discourse-tag" rel="tag">csharp</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="C# .Net Plugin Systems, whats the best way?">
<meta itemprop="articleSection" content="Questions">
<meta itemprop="keywords" content="programming, csharp">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dedady157"><span itemprop="name">dedady157</span></a>
</span>
<link itemprop="mainEntityOfPage" href="15746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-08-21T14:50:22Z" class="post-time">
August 21, 2019, 2:50pm
</time>
<meta itemprop="dateModified" content="2019-08-22T13:25:29Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>First of all, hello 0x00sec I’m back, after around 2 years I finally am not head deep in research, school, and work, and I’ve been working on a plugin loader called <a href="https://github.com/dedady157/Code_Olive" rel="nofollow noopener">Code_Olive</a>, more on that in a bit, Code_Olive is meant to be my solution to the need for a new and better PluginLoader for .Net Core and even .Net Framework But is there a better way to load a plugin?</p>
<p>In .Net based languages specifically c#, f# and vb there are many many ways of making a plugin type system, from reflection to dynamic interface loading. there are many options each with there ups and downs but what’s the best way to load a plugin?</p>
<p>Currently, there are only 2 Major ways <em>that I know work</em> of isolating a plugin from the host and other plugins.</p>
<ol>
<li>Reflection using the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.loader?view=netcore-2.2" rel="nofollow noopener">System.Reflection.Loader</a> library from Microsoft on <a href="https://www.nuget.org/packages/System.Reflection/" rel="nofollow noopener">NuGet</a> allows us to take full control of how a loaded assembly is loaded, bound, and how externals are resolved allowing us to <em>fully</em> control what environment our Plugin is held in but it takes more code and more knowledge of the .Net Runtime to create a robust and efficient <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.loader.assemblyloadcontext?view=netcore-2.2" rel="nofollow noopener">AssemblyLoadContext</a> but only supports Assembly Unloading in 3.0.</li>
<li>
<a href="https://docs.microsoft.com/en-us/dotnet/framework/app-domains/application-domains" rel="nofollow noopener">App domains</a> Curates this by making plugin stuck in there own virtual environment unable to directly access the main program runtime but also has its downsides since we can’t control what gets loaded by the plugin it can still load host assemblies witch we might not want. This also has the added benefit of making plugins unloadable, it also is <a href="https://devblogs.microsoft.com/dotnet/porting-to-net-core/" rel="nofollow noopener">not supported in .Net Core</a>.</li>
</ol>
<p>When it comes to reading and executing plugin data, we again have 3 ways</p>
<ol>
<li>
<a href="https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b6174b62" rel="nofollow noopener">Plugin Interfacing</a>, this requires an SDK of sorts to be set up between the Plugin and Host Assemblies making isolation difficult as some data will need to be accessed by both assemblies.</li>
<li>
<a href="https://docs.microsoft.com/en-us/dotnet/framework/reflection-and-codedom/reflection" rel="nofollow noopener">Reflection</a>, this does not require an SDK but is more difficult to create and can be slower if not optimized/done incorrectly.</li>
<li>
<a href="https://www.c-sharpcorner.com/UploadFile/85ed7a/dependency-injection-in-C-Sharp/" rel="nofollow noopener">Dependency injection</a>, it’s fast but bulky and annoying to set up.</li>
</ol>
<p>we have all these methods of loading plugins but what why?<br>
If we using <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.loader?view=netcore-2.2" rel="nofollow noopener">System.Reflection.Loader</a> we can enforce a partial-custom core library and restrict access to potentially dangerous assemblies but using this alone will require us to use an SDK assembly to be shared between both environments however we can do better <a href="https://stackoverflow.com/questions/7299097/dynamically-replace-the-contents-of-a-c-sharp-method" rel="nofollow noopener">Method Injection</a> a topic which I feel is seen as black magic or taboo, we all know that we can <a href="https://docs.microsoft.com/en-us/dotnet/api/system.reflection.methodinfo.createdelegate?view=netframework-4.8" rel="nofollow noopener">create a delegate off of a method</a> adding a short of <a href="http://www.thejoyofcode.com/Performance_of_Method.Invoke_vs_a_Delegate.aspx" rel="nofollow noopener">0.2-0.5 ms ontop of direct execution</a> even if its a static method but not everyone knows that if they simply replace the runtime handle for the method they can replace the method executed. well doing so, the result is we can replace functions inside the plugin assembly without adding any bulk <em>unless you manage it</em> and not have any added processing time, interested? This is the exact idea I had in mind when it comes to <a href="https://github.com/dedady157/Code_Olive" rel="nofollow noopener">Code_Olive</a> <em>now I’m still working on it and will soon work on creating a .Net Framework and .Net Core branch to allow for unloading</em> but the way it works <strong>currently</strong> is I load the assembly using <a href="https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assembly.loadfile?view=netframework-4.8" rel="nofollow noopener">Assembly.LoadFile</a> witch isolates the assembly and blocks it from causing other assemblies to load from it, then using standard <a href="https://docs.microsoft.com/en-us/dotnet/framework/reflection-and-codedom/reflection" rel="nofollow noopener">Reflection</a> methods I look for a class called ‘CodeOliveInfo’ witch, as the name suggests, contains all the plugin info such as its name and version but it also contains a few nice things. have ever wanted to edit how your assembly is loaded and executed at runtime? well this is what using these methods can provide, using 3 methods in the plugin and a lot of code in the main program I have created stages to loading, stage 1 loading your Functions and Tweaking what you want to load, stage 2 initializing the actual plugin by reading data from other plugins and doing some initial processing, stage 3 actually starting your plugin. these 3 allow the plugin to have full control over what it does and when it comes to communication between host programs and other plugins we have Method Injection using an attribute that contains the Plugin name or a <em>Core Library’s</em> and the full path to the method we can effectively directly access whichever functions we need while still being able to block what plugins can access without any delay to executing such functions either!</p>
<p>awesome right or wrong? that’s why this is a discussion. do you think this would be worse or better when it comes to plugin loading and executing? and if you have a better idea of how to do it, what is it?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="15746.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-08-24T14:50:25Z" class="post-time">
August 24, 2019, 2:50pm
</time>
<meta itemprop="dateModified" content="2019-08-24T14:50:25Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed 3 days after the last reply. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
