<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Fileless Malware - Red-Team - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Fileless Malware
Turning ourselves into Ghosts
“ Hunting for a fileless threat can be a tedious and labor-intensive task for any analyst. It is, most often than not, extremely time-consuming and requires a significant am&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="26973.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Fileless Malware&#39;" href="26973.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/3X/4/9/49680a78973609535aa3848958cce9635cd10e81.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/3X/4/9/49680a78973609535aa3848958cce9635cd10e81.png" />
<meta property="og:url" content="https://0x00sec.org/t/fileless-malware/26973" />
<meta name="twitter:url" content="https://0x00sec.org/t/fileless-malware/26973" />
<meta property="og:title" content="Fileless Malware" />
<meta name="twitter:title" content="Fileless Malware" />
<meta property="og:description" content="Fileless Malware Turning ourselves into Ghosts “ Hunting for a fileless threat can be a tedious and labor-intensive task for any analyst. It is, most often than not, extremely time-consuming and requires a significant amount of data gathering. On top of that, the traditional tools, methods, and defenses seem to be less effective when dealing with these almost invisible threats. Threat actors are frequently using attack techniques that work directly from the memory or using legitimate tools or se..." />
<meta name="twitter:description" content="Fileless Malware Turning ourselves into Ghosts “ Hunting for a fileless threat can be a tedious and labor-intensive task for any analyst. It is, most often than not, extremely time-consuming and requires a significant amount of data gathering. On top of that, the traditional tools, methods, and defenses seem to be less effective when dealing with these almost invisible threats. Threat actors are frequently using attack techniques that work directly from the memory or using legitimate tools or se..." />
<meta property="og:article:section" content="Red-Team" />
<meta property="og:article:section:color" content="BF1E2E" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="13 ❤" />
<meta property="article:published_time" content="2021-08-30T14:44:04+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="26973.html">Fileless Malware</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/red-team/102.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Red-Team</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Fileless Malware">
<meta itemprop="articleSection" content="Red-Team">
<meta itemprop="keywords" content>
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dmcxblue"><span itemprop="name">dmcxblue</span></a>
(David)
</span>
<link itemprop="mainEntityOfPage" href="26973.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/3X/4/9/49680a78973609535aa3848958cce9635cd10e81.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-08-30T14:44:04Z" class="post-time">
August 30, 2021, 2:44pm
</time>
<meta itemprop="dateModified" content="2021-08-30T14:49:43Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<h1><a name="fileless-malware-1" class="anchor" href="26973.html#fileless-malware-1"></a>Fileless Malware</h1>
<h2><a name="turning-ourselves-into-ghosts-2" class="anchor" href="26973.html#turning-ourselves-into-ghosts-2"></a>Turning ourselves into Ghosts</h2>
<p>“ <em><strong>Hunting for a fileless threat can be a tedious and labor-intensive task for any analyst. It is, most often than not, extremely time-consuming and requires a significant amount of data gathering. On top of that, the traditional tools, methods, and defenses seem to be less effective when dealing with these almost invisible threats. Threat actors are frequently using attack techniques that work directly from the memory or using legitimate tools or services pre-installed in the system to achieve their goals (Trend Micro, 2017). It is a popular technique among targeted attacks and advanced persistent threats (APT), and now it has been adopted by conventional malware such as Trojans, ransomwares, and even the most recent emerging threat – cryptocurrency miners. In some incidents, searching for a malicious file that resides in the hard drive seem to be insufficient. This study explores the different variations of fileless attacks that targeted the Windows operating system and what kind of artifacts or tools can provide clues for forensic investigations.”</strong></em></p>
<p><strong>Fileless malware</strong></p>
<p>Has been described as an attack that does not entail files being written onto the disk, this is partly true, as we have a few malwares that leave something behind to execute malicious code into memory and then delete itself to leave no traces behind. Its arrival can be through different methods, Exploitation, Brute-Force, USB and typically a phishing email with attachments.</p>
<p>To understand Traditional Malware this is typically done when a Binary or File is downloaded to disk and then executed with traditional malware this file is needed on the host machine to execute its payload. Below you can see the flow of traditional malware.</p>
<p>Traditional Malware</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/4/9/49680a78973609535aa3848958cce9635cd10e81.png" alt data-base62-sha1="atnLeVF0Z6S0QmnTn2m2lZafT3z" role="presentation" width="624" height="384"></p>
<p>SANS image</p>
<p><strong>Fileless Malware</strong></p>
<p>The point of entry of Fileless malware is like traditional malware, anything the previous one can do, fileless malware can do as well. Unlike the traditional malware this does not need to store malicious code into a file and save this to disk, it can leverage exploits or launch scripts directly from memory using whitelisted tools (I will touch later this), The image below explains the chain of fileless malware attacks.</p>
<p>Fileless Malware</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/d/1/d1a3c2ea0c38b8acda57d161e13f4a62013b1f08.png" alt data-base62-sha1="tUyEcIFDuK6xgUcRcBNPVH1FbUA" role="presentation" width="624" height="319"></p>
<p>SANS image</p>
<p><em><strong>Exploit:</strong></em></p>
<p>The fileless attack that arrives via Exploit may be referred to as “Completely Fileless”. RCE (Remote Code Execution) allows an attacker to load shellcode directly to the memory without writing any files to disk.</p>
<p><em><strong>Malicious Website/MailSpam/Phishing Email:</strong></em></p>
<p>Arrival via malicious websites or phishing emails uses script-based programs such as Macros, PowerShell, VBScript, JavaScript, HTA, etc., to run the malicious code directly to the memory. Typically, the initial script acts as a downloader which connects to a malicious host and downloads the payload. The transition to fileless moves once the script runs in memory and deletes the document upon execution.</p>
<p><em><strong>Persistence</strong></em></p>
<p>The persistence would depend on the end goal of the attacker. Fileless malware may not be persistent at all. Since the malicious code is already running in memory, it can already launch its payload. Without any persistence, a simple reboot would clear the code in memory. WMI or Scheduled Tasks are common fileless persistence method that attackers use.</p>
<p>Some reasons to use Fileless Malware in an Attack</p>
<ul>
<li>Stealthy: Fileless malware uses legitimate tools to proxy execute payloads, sometimes it’s difficult to block these legitimate tools since they are used in an environment regularly</li>
<li>Living-off-the-land: The legitimate tools are installed be default, what more reason do you need.</li>
<li>Trusted: These tools are trusted and sometimes pass unnoticed when executing malware</li>
</ul>
<p><em><strong>Memory Injection</strong></em></p>
<p>Memeory Injection technique involves hiding malicious code in the memory of a legitimate process. While processes that are critical to Windows activity are running, this malware distributes and re-injects itself into these processes, making it trickier to detect as these don’t trigger traditional red flags or whitelists.</p>
<p>Fileless malware exists only in a computer random-access memory (RAM) meaning that nothing is ever written directly to the hard drive. This makes it more difficult to detect as there are no stored files for defensive security software to scan, I will work on some samples that give an idea on how fileless malware can execute and stay living in memory, research from Microsoft categorizes them in 3 types:</p>
<p>In the research it states</p>
<p><strong>Type I: No File Activity Performed</strong></p>
<p>A fully fileless malware can be considered one that never requires writing a file on the disk. How would such malware infect a machine in the first place? One example is where a target machine receives malicious network packets that exploit the EternalBlue vulnerability. The vulnerability allows the installation of the DoublePulsar backdoor, which ends up residing only in the kernel memory. In this case, there is no file, or any data written on a file.</p>
<p>A compromised device may also have malicious code hiding in the device’s firmware (such as BIOS), a USB peripheral (like the BadUSB attack), or in firmware of a network card. All these examples don’t require a file on the disk to run and can theoretically live only in memory. The malicious code would survive reboots, disk re-formats, and OS reinstall.</p>
<p>Infections of this type of cab be particularly difficult to detect because most antivirus products don’t have the capability to inspect firmware. In cases where a product does have the abilities to inspect and detect malicious firmware, these are still significant challenges associated with remediation of threats at this level. This type of fileless malware requires high levels of sophistication and often dangerous, threats of this type are uncommon and not practical for most attacks.</p>
<p><strong>Type II: Indirect file activity</strong></p>
<p>There are other ways that malware can achieve fileless presence on a machine without requiring significant engineering effort. Fileless malware of this type doesn’t directly write files on the file system, but they can end up using files indirectly. For example, with the Poshpy backdoor attackers installed a malicious PowerShell command within the WMI repository and configured a WMI filter to run the command periodically.</p>
<p>It’s possible to carry out such installation via command line without requiring a backdoor to already be on the file. The malware can be installed and theoretically run without ever touching the file system. However, the WMI repository is stored on a physical file in a central storage area managed by the CIM Object Manager, and usually contains legitimate data. Even though the infection chain does technically use a physical file, it’s considered a fileless attack because WMI repository is a multi-purpose data container that can’t be detected and removed.</p>
<p><strong>Type III: Files required to operate</strong></p>
<p>Some malwares can have a sort of fileless persistence, but not without using files to operate. An example for this scenario is Kotver, which creates a shell open verb handler in the registry for a random file extension. Opening the file with such extension will lead to the execution of a script through the legitimate tool mshta.exe</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/9/6/96b994ab1d27c76708df7529e624b27d1f25c8dc.png" alt data-base62-sha1="lvndYFxRGu6wCNz5x0tXoYoTrje" role="presentation" width="624" height="143"></p>
<p>When the open verb is invoked, the associated command from the registry is launched, which results in the execution of a small script. This script reads data form a further registry key and executes it, in turn leading to the loading of the final payload. However, to trigger the open verb in the first place, Kotver has to drop a file with the same extension targeted by the verb (in the example above, the extension is .bbf5590fd). It also must set an auto-run key configured to open such a file when the machine starts.</p>
<p>Kotver is considered a fileless threat because <em><strong>the file system is of no practical use. The files with random extensions contain junk data that isn’t usable in verifying the presence of the threat.</strong></em> The files that store the registry are containers that can’t be detected and deleted if malicious content is present.</p>
<p>Below are some programs and examples of what can be considered fileless malware.</p>
<p>Programs that can achieve Fileless Malware</p>
<ul>
<li>PowerShell.exe</li>
</ul>
<p>PowerShell a powerful language that is built in Windows since Windows 7 it provides access to COM and WMI, it also provides a hosting API with which PowerShell runtime can be embedded inside other applications. An example of a Fileless technique with PowerShell can be the following:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/0/9/095b986048c7c5ff0b7a2712d71b6227e0f1a8cb.png" alt data-base62-sha1="1kMxqfj3RIOhVXH6mEHAPhmYr11" role="presentation" width="624" height="131"></p>
<p>Shell</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/b/b/bbc2d8bcbd186b45303fdbb20b4f84c1dd76d632.png" alt data-base62-sha1="qN0K7KTORDOR1LlQkbPSb2PywBs" role="presentation" width="534" height="240"></p>
<p>No detection and no file left in the workstation since this is directly executed from the Console and the file has no need to be on disk and run.</p>
<ul>
<li>WMIC</li>
</ul>
<p>WMIC provides a command-line interface for Windows Management Instrumentation (WMI). WMIC is compatible with existing shells and utility commands. WMI has the ability to proxy execute XSL files from remote location or to even start processes on its own let’s check some examples.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/0/7/0791640e23ddd9f21187d88440a1045cae94ac75.png" alt data-base62-sha1="14WQ7Mbcha3TiNKEOTQ0G9sBmtv" role="presentation" width="624" height="454"></p>
<ul>
<li>WSCript.exe</li>
</ul>
<p>Windows Scripting Host it provides the ability of scripting comparable to batch files, but with a wider range of supported features. It supports multiple languages such as VBScript (VBE, VBS) and Jscript (JS, JSE) it can also be worked with WHS which is a language independent filename extension. The advantage of this is that it allows multiple scripts (“Jobs”) as well as a combination of scripting languages within a single file.</p>
<p>In the following example will use VBScript, Jscript and Python in the same file and have an execution even though we are combining 3 different Scripting Languages:</p>
<p>For python or any extra languages to be working these need to be install and added to the PATH of the system and registered as a scripting alternative for WSH a great target for this are most likely Developer Workstations in the example we have a file on Disk so this comes into consideration as the script isn’t malicious only the file it calls after which can be PowerShell, Mshta, MSbuild that can execute our payload in-memory</p>
<p>File:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/e/2/e255222831fd2ddfde23f80bbf89bbfdf700b4d3.png" alt data-base62-sha1="wieiXFsgG7mq1Rf6w3ZjlMjTvFN" role="presentation" width="408" height="309"></p>
<p>VB:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/8/b/8b5160a9079cb121eefa104bd761b389f4dd6e8e.png" alt data-base62-sha1="jSsIA2a1HZglv6c5UxB1s68wpZA" role="presentation" width="180" height="156"></p>
<p>JS</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/a/0/a0fa10f0a04f07a700ada894cd113132bef60906.png" alt data-base62-sha1="mY49ToSV9NjEVpwu8Sa27fdpMP4" role="presentation" width="183" height="150"></p>
<p>Python popping calc</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/c/7/c776d58eae7e2f90311fc78a123bf826f16162a3.png" data-download-href="/uploads/short-url/ssxCizWgClWyiV77IhZchWmkjrd.png?dl=1" title rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/c/7/c776d58eae7e2f90311fc78a123bf826f16162a3_2_405x500.png" alt data-base62-sha1="ssxCizWgClWyiV77IhZchWmkjrd" role="presentation" width="405" height="500" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/c/7/c776d58eae7e2f90311fc78a123bf826f16162a3_2_405x500.png, https://0x00sec.s3.amazonaws.com/original/3X/c/7/c776d58eae7e2f90311fc78a123bf826f16162a3.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/c/7/c776d58eae7e2f90311fc78a123bf826f16162a3.png 2x" data-dominant-color="B8D4EB"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">443×546 34.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<ul>
<li>Cscript.exe</li>
</ul>
<p>Same as WSCript the difference is that this one does give you a CONSOLE window</p>
<ul>
<li>Scriptrunner.exe</li>
</ul>
<p>I couldn’t find much information on what Scriptrunner is, but it seems to be a tool that allows to run multiple scripts instead of building a script that runs multiple things it helps to achieve this all with one line. This allows proxy execution via SMB</p>
<p>Example, there seems to be a warning when executing on remote servers</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/0/2/02c1faa8ebd73e4a1210d3d24003dc36d5242bac.png" alt data-base62-sha1="ooyj0r8uY6lzWz5fVqLDoBN6Hy" role="presentation" width="624" height="326"></p>
<p>But we will ignore it and execute</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/7/b/7bba6b19d9029e1539c094c22be365b019287585.png" data-download-href="/uploads/short-url/hEy7XrhiTv887yOoTUqQjYUzKWp.png?dl=1" title rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/7/b/7bba6b19d9029e1539c094c22be365b019287585_2_420x500.png" alt data-base62-sha1="hEy7XrhiTv887yOoTUqQjYUzKWp" role="presentation" width="420" height="500" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/7/b/7bba6b19d9029e1539c094c22be365b019287585_2_420x500.png, https://0x00sec.s3.amazonaws.com/original/3X/7/b/7bba6b19d9029e1539c094c22be365b019287585.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/7/b/7bba6b19d9029e1539c094c22be365b019287585.png 2x" data-dominant-color="A6ADB2"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">473×563 17.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<ul>
<li>Regsvr32.exe</li>
</ul>
<p>Is a command-line utility for registering and unregistering DLLs and ActiveX controls in the operating systems Registry. It’s a Microsoft signed binary the allows proxy execution (which is the ability to call remote files). This requires elevated permissions</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/b/2/b256e73dc5ef5bf146d53ea2488ec5d370fd5355.png" data-download-href="/uploads/short-url/prFb6JKI36D3LVLbawGAMQUyMQd.png?dl=1" title rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/b/2/b256e73dc5ef5bf146d53ea2488ec5d370fd5355_2_607x500.png" alt data-base62-sha1="prFb6JKI36D3LVLbawGAMQUyMQd" role="presentation" width="607" height="500" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/b/2/b256e73dc5ef5bf146d53ea2488ec5d370fd5355_2_607x500.png, https://0x00sec.s3.amazonaws.com/original/3X/b/2/b256e73dc5ef5bf146d53ea2488ec5d370fd5355.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/b/2/b256e73dc5ef5bf146d53ea2488ec5d370fd5355.png 2x" data-dominant-color="5F7482"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">624×514 48.5 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<ul>
<li>Mshta.exe</li>
</ul>
<p>MSHTA is a utility that executes Microsoft HTML Applications (HTA) files. HTAs are standalone applications that execute using the same model and technologies of Internet Explorer, but outside the browser, it can run scripting languages such as JScript and VBScript.</p>
<p>Request:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/e/a/ea467764fcd427bcda400129b692af6b1b59571f.png" alt data-base62-sha1="xquHv1dv3QlMDO1EW5gjs7bwcj5" role="presentation" width="624" height="274"></p>
<p>Execution:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/f/3/f3ad7d24b45815617e11732af69e912152279094.png" alt data-base62-sha1="yLFIQVLE3mjCjscP7vMWgU9aRz6" role="presentation" width="624" height="492"></p>
<p>Let’s not stop with these, we are familiar with Execution via Microsoft Signed Binaries, but we also spoke about exploitation of vulnerabilities as these do not touch Disk, since malicious packets are sent to the target machine and inject our shellcode where necessary, a great example of the recent BlueKeep method which exploits the RDP protocol it’s a major vulnerability affecting primarily Windows 7 machines, other exploits can be EternalBlue.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/9/d/9d8744cf88e4287fc954e1ca28ec06d9f4c47dc6.png" alt data-base62-sha1="mtyM2KNcPUTbdspiSrxEl5Ik7ZA" role="presentation" width="624" height="365"></p>
<p>The need of a file was completely unnecessary, and execution was done remotely.</p>
<p>C#</p>
<p>It gives access to an infrastructure of functions that developers use frequently and can build off. A few C2s have a great feature that allow us to execute C# binaries in memory without the need of placing these binaries on the disk. This is a great Post-Exploitation method to stay in memory.</p>
<p>Example:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/b/d/bd781f1ffef343339b63d1a8ee3b5db7a3da99ab.png" alt data-base62-sha1="r27Bh4UZkOvAoM2GtcGkghMGOCv" role="presentation" width="624" height="265"></p>
<p>I executed the Seatbelt tool to show me the most recent files the user has interacted with, and if we check our current path there is no Binary dropped to Disk.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/9/e/9e08346802562b45bc2804b6f417c8b6ce046fd5.png" alt data-base62-sha1="my11aroKzO0l72dOi39jNarWJ7f" role="presentation" width="444" height="76"></p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/3/3/33feb60bf45788da54054d19cf71cb5708aa3c4f.png" alt data-base62-sha1="7pY49K0DAIeuUu0fIOboAgO8QHR" role="presentation" width="624" height="225"></p>
<p>After some talk with my Sensei it also came to mind that User Accounts may allow us to stay in memory without touching Disk onto a Targeted Machine some examples may be, PSRemote, RDP, SSH and/or Poor Configuration</p>
<p>PSREMOTE:</p>
<p>The feature from PowerShell to gain a sessionl to execute commands on a remote host.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/7/2/7246469c79bb25a4c5dd06415f6bb232d314daaf.png" alt data-base62-sha1="giUZO3j1fUaOFTAHGTsJv7MjGWP" role="presentation" width="534" height="210"></p>
<p>RDP:</p>
<p>The remote Desktop Protocol which allows users for a fully interactive GUI remotely.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/8/9/89c85cb29831f05d26b9002423a7a583ee7090ba.png" alt data-base62-sha1="jESGBRZeKJzTRak8ywbVPhC9YDw" role="presentation" width="624" height="339"></p>
<p>Poor Configuration:</p>
<p>When software is installed with poor security implementations a great rule would be such as only allowing specific users access to these features or giving the software sufficient permissions to only execute at a certain level of authority with the possibility of avoiding Administrator or SYSTEM Access. In this Demo what if someone left an Emergency Back-Door to access the system in case they get locked out? Well, this happens:</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/7/2/72cce979865cf52b45aec1e200aba5d010136ed7.png" alt data-base62-sha1="gnzs7AYSrome7TbybKSOnAPowUn" role="presentation" width="531" height="411"></p>
<p>PHP Backdoor (Emergency Access)</p>
<p>This technique used there was no file left behind (well by the attacker) this is a legitimate “Emergency” Access that developers left behind for a “just in case”.</p>
<p>With these Demo’s and understanding we have techniques and methods on how to achieve a “Fileless Malware” to execute onto our Target machine and stay hidden. Staying hidden once already in the network and achieving to stay in memory would be already up to the Operator an example would be “Process Injection” is a well-used technique to stay hidden and in memory inside a legitimate Windows Process.</p>
<p>And lastly we also have hardware as a method of fileless malware a great demonstration for this would be the infamous Rubber Ducky and malicious USB that impersonates a Keyboard and interacts with the Computer if it were a user typing these commands no file touches disk and commands can be executed directly on a Command or Scripting Interpreter, such as CMD or PowerShell.</p>
<p>Demo:</p>
<div class="youtube-onebox lazy-video-container" data-video-id="RO7qcNPAyfY" data-video-title=" - YouTube" data-video-start-time data-provider-name="youtube">
<a href="https://www.youtube.com/watch?v=RO7qcNPAyfY" target="_blank" rel="noopener nofollow ugc">
<img class="youtube-thumbnail" "https://0x00sec.org/t/fileless-malware/src" title=" - YouTube" width height>
</a>
</div>
<p>References:</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.cybereason.com/blog/fileless-malware">
<header class="source">
<img src="https://0x00sec.s3.amazonaws.com/original/3X/2/4/24fd710e91be3121be7e8396f0d8cd5b5b04ab55.png" class="site-icon" data-dominant-color="919090" width="48" height="48">
<a href="https://www.cybereason.com/blog/fileless-malware" target="_blank" rel="noopener nofollow ugc">cybereason.com</a>
</header>
<article class="onebox-body">
<div class="aspect-image" style="--aspect-ratio:690/263;"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/d/2/d203c935b812e92f1d3465dda8c938a5189cb434_2_690x263.png" class="thumbnail" data-dominant-color="0F408A" width="690" height="263" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/d/2/d203c935b812e92f1d3465dda8c938a5189cb434_2_690x263.png, https://0x00sec.s3.amazonaws.com/original/3X/d/2/d203c935b812e92f1d3465dda8c938a5189cb434.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/d/2/d203c935b812e92f1d3465dda8c938a5189cb434.png 2x"></div>
<h3><a href="https://www.cybereason.com/blog/fileless-malware" target="_blank" rel="noopener nofollow ugc">Fileless Malware 101: Understanding Non-Malware Attacks</a></h3>
<p>Fileless malware abuses legitimate tools to carry out attacks. Read about fileless malware with examples from real world attacks.</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p><a href="https://us.norton.com/internetsecurity-malware-what-is-fileless-malware..html" class="onebox" target="_blank" rel="noopener nofollow ugc">https://us.norton.com/internetsecurity-malware-what-is-fileless-malware..html</a></p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.crowdstrike.com/cybersecurity-101/malware/fileless-malware/">
<header class="source">
<img src="https://0x00sec.s3.amazonaws.com/original/3X/0/6/06de729097562b94a75364c3fe0493f42a6122ee.png" class="site-icon" data-dominant-color="EB3725" width="96" height="96">
<a href="https://www.crowdstrike.com/cybersecurity-101/malware/fileless-malware/" target="_blank" rel="noopener nofollow ugc">crowdstrike.com</a>
</header>
<article class="onebox-body">
<div class="aspect-image" style="--aspect-ratio:421/260;"><img src="https://0x00sec.s3.amazonaws.com/original/3X/7/9/7915bfd10007ee07b66595eb975d512df73d574e.jpeg" class="thumbnail" data-dominant-color="2E2222" width="421" height="260"></div>
<h3><a href="https://www.crowdstrike.com/cybersecurity-101/malware/fileless-malware/" target="_blank" rel="noopener nofollow ugc">What is Fileless Malware? - CrowdStrike</a></h3>
<p>Fileless malware is a type of malicious software that uses native, legitimate tools built on a system to execute a cyberattack without code.</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.arista.com/en/solutions/security">
<header class="source">
<img src="https://0x00sec.s3.amazonaws.com/original/3X/5/6/563e1a34d7e11e97d744743fa0e495ca64593786.png" class="site-icon" data-dominant-color="003468" width="32" height="32">
<a href="https://www.arista.com/en/solutions/security" target="_blank" rel="noopener nofollow ugc" title="05:33PM - 03 May 2023">Arista Networks – 3 May 23</a>
</header>
<article class="onebox-body">
<div class="aspect-image" style="--aspect-ratio:543/305;"><img src="https://0x00sec.s3.amazonaws.com/original/3X/0/1/01872933c29649f9e047c63e2ac7b45675b21d7c.jpeg" class="thumbnail" data-dominant-color="364D6C" width="543" height="305"></div>
<h3><a href="https://www.arista.com/en/solutions/security" target="_blank" rel="noopener nofollow ugc">Security</a></h3>
<p>Arista Cloud Network Data Security tools provide next-generation network firewalls featuring visibility and cybersecurity monitoring powered by Arista Networks CloudVision®</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.varonis.com/blog/fileless-malware">
<header class="source">
<img src="https://0x00sec.s3.amazonaws.com/original/3X/3/3/334e35be1813c64adbb253b6aad9bdc40d92aff8.png" class="site-icon" data-dominant-color="D03C4B" width="46" height="46">
<a href="https://www.varonis.com/blog/fileless-malware" target="_blank" rel="noopener nofollow ugc">varonis.com</a>
</header>
<article class="onebox-body">
<div class="aspect-image" style="--aspect-ratio:689/230;"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/d/9/d932d25e2ae25a469d7e01be0253e490cef51f1b_2_689x230.png" class="thumbnail" data-dominant-color="373749" width="689" height="230" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/d/9/d932d25e2ae25a469d7e01be0253e490cef51f1b_2_689x230.png, https://0x00sec.s3.amazonaws.com/optimized/3X/d/9/d932d25e2ae25a469d7e01be0253e490cef51f1b_2_1033x345.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/d/9/d932d25e2ae25a469d7e01be0253e490cef51f1b.png 2x"></div>
<h3><a href="https://www.varonis.com/blog/fileless-malware" target="_blank" rel="noopener nofollow ugc">What is Fileless Malware? PowerShell Exploited</a></h3>
<p>Fileless malware uses PowerShell to steal valuable data and inject malicious code into your systems. In this guide, we’ll show you how to protect yourself.</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/security-101-how-fileless-attacks-work-and-persist-in-systems">
<header class="source">
<img src="https://0x00sec.s3.amazonaws.com/original/3X/b/4/b43c5f3137138de016eb1924df1efbc8c7ec73c2.png" class="site-icon" data-dominant-color="F15258" width="16" height="16">
<a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/security-101-how-fileless-attacks-work-and-persist-in-systems" target="_blank" rel="noopener nofollow ugc">trendmicro.com</a>
</header>
<article class="onebox-body">
<div class="aspect-image" style="--aspect-ratio:690/499;"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/2/7/27988c9e922540607abbb53f1a4cf51b08f5ad93_2_690x499.jpeg" class="thumbnail" data-dominant-color="A9C6B4" width="690" height="499" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/2/7/27988c9e922540607abbb53f1a4cf51b08f5ad93_2_690x499.jpeg, https://0x00sec.s3.amazonaws.com/original/3X/2/7/27988c9e922540607abbb53f1a4cf51b08f5ad93.jpeg 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/2/7/27988c9e922540607abbb53f1a4cf51b08f5ad93.jpeg 2x"></div>
<h3><a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/security-101-how-fileless-attacks-work-and-persist-in-systems" target="_blank" rel="noopener nofollow ugc">Security 101: How Fileless Attacks Work and Persist in Systems - Security News</a></h3>
<p>Many attackers are switching from file-based malware to memory-based attacks to improve their stealth. “Fileless,” “zero-footprint,” or “living off the land” threats use legitimate applications to carry out malicious activities.</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/fileless-threats?view=o365-worldwide">
<header class="source">
<a href="https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/fileless-threats?view=o365-worldwide" target="_blank" rel="noopener nofollow ugc">learn.microsoft.com</a>
</header>
<article class="onebox-body">
<img src="https://0x00sec.s3.amazonaws.com/original/3X/9/2/9209ecc2f83d9574790ba34c60193540a1967260.png" class="thumbnail onebox-avatar" data-dominant-color="D8D7B5" width="400" height="400">
<h3><a href="https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/fileless-threats?view=o365-worldwide" target="_blank" rel="noopener nofollow ugc">Fileless threats</a></h3>
<p>Learn about the categories of fileless threats and malware that live off the land</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>Python in WSH</p>
<p><a href="https://help.objectiflune.com/en/knowledgebase/KB/HWT/PPW/KB1504.html" class="onebox" target="_blank" rel="noopener nofollow ugc">https://help.objectiflune.com/en/knowledgebase/KB/HWT/PPW/KB1504.html</a></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="13" />
<span class="post-likes">13 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="26973.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-12-30T06:44:55Z" class="post-time">
December 30, 2021, 6:44am
</time>
<meta itemprop="dateModified" content="2021-12-30T06:44:55Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
