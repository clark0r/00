<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>How does malware utilize tor? - Questions - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="So, there is quite a lot of malware nowadays that use the tor network to communicate with c2 servers. 
From what I see is they host their c2 server under a .onion domain and then they hardcode tor ‚Äúproxies‚Äù into the malw&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="25405.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;How does malware utilize tor?&#39;" href="25405.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/optimized/3X/f/b/fb4cba310de9104eade8f87788e8f80bbf655a5d_2_1024x633.jpeg" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/optimized/3X/f/b/fb4cba310de9104eade8f87788e8f80bbf655a5d_2_1024x633.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/how-does-malware-utilize-tor/25405" />
<meta name="twitter:url" content="https://0x00sec.org/t/how-does-malware-utilize-tor/25405" />
<meta property="og:title" content="How does malware utilize tor?" />
<meta name="twitter:title" content="How does malware utilize tor?" />
<meta property="og:description" content="So, there is quite a lot of malware nowadays that use the tor network to communicate with c2 servers.  From what I see is they host their c2 server under a .onion domain and then they hardcode tor ‚Äúproxies‚Äù into the malware which is uses to connect to which will then allow it to send data back to the c2 server.  Now when I asked people about how they get the ‚Äúproxies‚Äù I was told they are not really proxies but that is what they look like     As you can see to me these look like proxies, now I kn..." />
<meta name="twitter:description" content="So, there is quite a lot of malware nowadays that use the tor network to communicate with c2 servers.  From what I see is they host their c2 server under a .onion domain and then they hardcode tor ‚Äúproxies‚Äù into the malware which is uses to connect to which will then allow it to send data back to the c2 server.  Now when I asked people about how they get the ‚Äúproxies‚Äù I was told they are not really proxies but that is what they look like     As you can see to me these look like proxies, now I kn..." />
<meta property="og:article:section" content="Questions" />
<meta property="og:article:section:color" content="BF1E2E" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="5 ‚ù§" />
<meta property="article:published_time" content="2021-03-30T00:12:25+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="25405.html">How does malware utilize tor?</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/support/52.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Questions</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="How does malware utilize tor?">
<meta itemprop="articleSection" content="Questions">
<meta itemprop="keywords" content>
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/jasper"><span itemprop="name">jasper</span></a>
(jasper)
</span>
<link itemprop="mainEntityOfPage" href="25405.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/3X/f/b/fb4cba310de9104eade8f87788e8f80bbf655a5d.jpeg">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-03-30T00:12:25Z" class="post-time">
March 30, 2021, 12:12am
</time>
<meta itemprop="dateModified" content="2021-03-30T06:42:20Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>So, there is quite a lot of malware nowadays that use the tor network to communicate with c2 servers.<br>
From what I see is they host their c2 server under a .onion domain and then they hardcode tor ‚Äúproxies‚Äù into the malware which is uses to connect to which will then allow it to send data back to the c2 server.</p>
<p>Now when I asked people about how they get the ‚Äúproxies‚Äù I was told they are not really proxies but that is what they look like<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/f/b/fb4cba310de9104eade8f87788e8f80bbf655a5d.jpeg" data-download-href="/uploads/short-url/zR6eq4koYi2pNxwq0fy2I4VdduZ.jpeg?dl=1" title rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/f/b/fb4cba310de9104eade8f87788e8f80bbf655a5d_2_690x426.jpeg" alt data-base62-sha1="zR6eq4koYi2pNxwq0fy2I4VdduZ" width="690" height="426" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/f/b/fb4cba310de9104eade8f87788e8f80bbf655a5d_2_690x426.jpeg, https://0x00sec.s3.amazonaws.com/optimized/3X/f/b/fb4cba310de9104eade8f87788e8f80bbf655a5d_2_1035x639.jpeg 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/f/b/fb4cba310de9104eade8f87788e8f80bbf655a5d.jpeg 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/f/b/fb4cba310de9104eade8f87788e8f80bbf655a5d_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename"></span><span class="informations">1281√ó792 320 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div><br>
As you can see to me these look like proxies, now I know the tor project themselves every 20minutes has a page that auto updates of the latest tor exit nodes but my question is how are they getting the port number so they can route traffic through them too?</p>
<p>Now I was able to speak to someone once who made malware that used this and they simply said to me ‚ÄúThey are free online, anyone can incorporate this into their malware‚Äù but he would not tell me where people get them from x_x</p>
<p>Anyone got any ideas at all?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/verking"><span itemprop="name">verking</span></a>
(Verking)
</span>
<link itemprop="mainEntityOfPage" href="25405.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-04-01T21:33:07Z" class="post-time">
April 1, 2021, 9:33pm
</time>
<meta itemprop="dateModified" content="2021-04-01T21:33:07Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I‚Äôm not sure about this particular variant you are showing so any more information is helpful.</p>
<p>What you are probably talking about are ‚Äútor2web‚Äù proxies, <a href="https://github.com/tor2web/Tor2web" class="inline-onebox" rel="noopener nofollow ugc">GitHub - tor2web/Tor2web: Tor2web is an HTTP proxy software that enables access to Tor Hidden Services by mean of common web browsers</a> . These proxies are specifically converting clearweb traffic to tor traffic without having to install additional Tor related binaries. So when your friend said they are free, you can lookup the software I mentioned above and find a couple of Tor2Web sites that will forward traffic onto a Tor website.</p>
<p>It doesn‚Äôt look like it in your example but Tor binaries are also included in some malware so that they can funnel all the traffic to Tor but this tends to have a lot of downsides. Resilient Botnet Command and Control with Tor by Dennis Brown (Defcon July 2010) made a pretty good presentation that is still relevant if you are curious for more.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/jasper"><span itemprop="name">jasper</span></a>
(jasper)
</span>
<link itemprop="mainEntityOfPage" href="25405.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-04-06T10:19:07Z" class="post-time">
April 6, 2021, 10:19am
</time>
<meta itemprop="dateModified" content="2021-04-06T10:19:07Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a href="https://blog.netlab.360.com/ddos-botnet-moobot-en/" class="inline-onebox" rel="noopener nofollow ugc">An Update for a Very Active DDos Botnet: Moobot</a> I was mainly referring to a specific piece of malware although since I first read about this piece alot more have come out using the same technique.<br>
They dont have tor binaries they have proxies hardcoded into the malware itself which they use and then when they spread newer version of the malware they update the proxies.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/jasper"><span itemprop="name">jasper</span></a>
(jasper)
</span>
<link itemprop="mainEntityOfPage" href="25405.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-04-12T12:14:53Z" class="post-time">
April 12, 2021, 12:14pm
</time>
<meta itemprop="dateModified" content="2021-04-12T12:14:53Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>BUMP! I am still needing to find this out.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="25405.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-07-29T16:13:16Z" class="post-time">
July 29, 2021, 4:13pm
</time>
<meta itemprop="dateModified" content="2021-07-29T16:13:16Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
