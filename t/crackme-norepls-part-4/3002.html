<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>[CrackMe] NoREpls - Part 4 - Challenges - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Backstory
edgyReggie is a busy guy‚Ä¶ He has a massive workload plus a part time job at the local supermarket on the weekends, and on top of that, he has to develop his software for extra pocket money! Because of this, he &amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="3002.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;[CrackMe] NoREpls - Part 4&#39;" href="3002.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/4/4c2d12b6ac1dddef5f5f7dfccece53f5b7627f99.JPG" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/4/4c2d12b6ac1dddef5f5f7dfccece53f5b7627f99.JPG" />
<meta property="og:url" content="https://0x00sec.org/t/crackme-norepls-part-4/3002" />
<meta name="twitter:url" content="https://0x00sec.org/t/crackme-norepls-part-4/3002" />
<meta property="og:title" content="[CrackMe] NoREpls - Part 4" />
<meta name="twitter:title" content="[CrackMe] NoREpls - Part 4" />
<meta property="og:description" content="Backstory edgyReggie is a busy guy‚Ä¶ He has a massive workload plus a part time job at the local supermarket on the weekends, and on top of that, he has to develop his software for extra pocket money! Because of this, he does not have the time to spare to learn how to really defeat those dirty crackers and has resorted to consulting the hacking society at his university. There, he found a very keen guy by the alias of DownerDanny who was willing to help edgyReggie to protect his software and thus..." />
<meta name="twitter:description" content="Backstory edgyReggie is a busy guy‚Ä¶ He has a massive workload plus a part time job at the local supermarket on the weekends, and on top of that, he has to develop his software for extra pocket money! Because of this, he does not have the time to spare to learn how to really defeat those dirty crackers and has resorted to consulting the hacking society at his university. There, he found a very keen guy by the alias of DownerDanny who was willing to help edgyReggie to protect his software and thus..." />
<meta property="og:article:section" content="Reverse Engineering" />
<meta property="og:article:section:color" content="12A89D" />
<meta property="og:article:section" content="Challenges" />
<meta property="og:article:section:color" content="283890" />
<meta property="og:article:tag" content="reverseengineering" />
<meta property="og:article:tag" content="assembly" />
<meta property="og:article:tag" content="crackme" />
<meta property="og:article:tag" content="windows" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="18 ‚ù§" />
<meta property="article:published_time" content="2017-07-22T14:19:40+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="3002.html">[CrackMe] NoREpls - Part 4</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/reverse-engineering/58.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #12A89D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Reverse Engineering</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/reverse-engineering/challenges.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #283890"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Challenges</span>
</span>
</a>
<meta itemprop="position" content="2" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/reverseengineering.html" class="discourse-tag" rel="tag">reverseengineering</a>,
<a href="../../tag/assembly.html" class="discourse-tag" rel="tag">assembly</a>,
<a href="../../tag/crackme.html" class="discourse-tag" rel="tag">crackme</a>,
<a href="../../tag/windows.html" class="discourse-tag" rel="tag">windows</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="[CrackMe] NoREpls - Part 4">
<meta itemprop="articleSection" content="Challenges">
<meta itemprop="keywords" content="reverseengineering, assembly, crackme, windows">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3002.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/4/4c2d12b6ac1dddef5f5f7dfccece53f5b7627f99.JPG">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-22T14:19:40Z" class="post-time">
July 22, 2017, 2:19pm
</time>
<meta itemprop="dateModified" content="2017-07-22T14:19:40Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<h1>Backstory</h1>
<p><code>edgyReggie</code> is a busy guy‚Ä¶ He has a massive workload plus a part time job at the local supermarket on the weekends, and on top of that, he has to develop his software for extra pocket money! Because of this, he does not have the time to spare to learn how to really defeat those dirty crackers and has resorted to consulting the hacking society at his university. There, he found a very keen guy by the alias of <code>DownerDanny</code> who was willing to help <code>edgyReggie</code> to protect his software and thus together, they formed <code>edgeS0ft</code>. There‚Äôs a <em>slight</em> problem though: he‚Äôs pretty new to the scene but hey, he‚Äôs volunteering so there‚Äôs no need to pay him for his work! What do you guys think of his first job? <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
<h2>Difficulty</h2>
<h4>Author Assigned Level: Wannabe</h4>
<h4>Community Assigned Level:</h4>
<div class="poll" data-poll-status="open" data-poll-type="regular" data-poll-name="poll">
<div>
<div class="poll-container">
<ul>
<li data-poll-option-id="e1c1af66349ae633fa9ffd223d9e01f3">Newbie</li>
<li data-poll-option-id="48cde21e0fcdef5aef447a332bb6dcc0">Wannabe</li>
<li data-poll-option-id="f0d5a092a44bae0d9f0734127a07fe91">Hacker</li>
<li data-poll-option-id="d0be935ef28646b5afecbf524d510b85">Wizard</li>
<li data-poll-option-id="cc5e4d9a5dc2c4d9aa641ef7a2a97876">Guru</li>
</ul>
</div>
<div class="poll-info">
<p>
<span class="info-number">0</span>
<span class="info-label">voters</span>
</p>
</div>
</div>
</div>
<hr>
<h2>Goal</h2>
<ul>
<li>Your goal is to achieve the ‚Äúfull‚Äù version of the software, i.e. removing all nags that you see and unlocking all features of the program.</li>
<li>Your secondary (optional) goal is to generate a working name-serial pair if possible.</li>
<li>Bonus points to the most elegant solutions (minimal byte patching).</li>
</ul>
<hr>
<h2>Rules of Engagement</h2>
<p>None.</p>
<hr>
<h2>Research Material</h2>
<details>
<summary>
DEFINITE SPOILERS IN HERE! Don't reveal unless you're really stuck!</summary>
<ul>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms680345(v=vs.85).aspx">MSDN - IsDebuggerPresent</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms647486(v=vs.85).aspx">MSDN - LoadString</a></li>
</ul>
</details>
<hr>
<h2>Binary</h2>
<h1>NOTE: Please remove all ‚ÄúLicense.lic‚Äù files in the same directory before executing.</h1>
<h4>Preview (look and design may not be accurate):</h4>
<ul>
<li>Now features a persistent top-most window! Great for taking notes!</li>
</ul>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/4/4c2d12b6ac1dddef5f5f7dfccece53f5b7627f99.JPG" width="311" height="148"></p>
<p><a href="http://www.mediafire.com/file/4p4yjmnk492a53h/NoREpls2.0.exe">MediaFire - http://www.mediafire.com/file/4p4yjmnk492a53h/NoREpls2.0.exe</a></p>
<p><a href="https://www.virustotal.com/en/file/42722d293cd2046dc5c5e9be9f7ebde29d7882f42587013074dad6beefe45a9e/analysis/1500732167/">VirusTotal - https://www.virustotal.com/en/file/42722d293cd2046dc5c5e9be9f7ebde29d7882f42587013074dad6beefe45a9e/analysis/1500732167/</a></p>
<p>Good luck!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="6" />
<span class="post-likes">6 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../challenge-collection-reverse-engineering-and-crackme/3027.html">Challenge Collection: Reverse Engineering and CrackMe</a>
<meta itemprop="position" content="5">
</div>
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../crackme-norepls-part-5/3022.html">[CrackMe] NoREpls - Part 5</a>
<meta itemprop="position" content="6">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Joe_Schmoe"><span itemprop="name">Joe_Schmoe</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3002.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/d/db58786062bf1a2c7d9adf3e9f3b3e96f08fe455.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-22T16:23:05Z" class="post-time">
July 22, 2017, 4:23pm
</time>
<meta itemprop="dateModified" content="2017-07-22T16:31:16Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>edgyReggie definitely cranked it up a notch.</p>
<div class="spoiler">
<p>The solution is the same as to the last one: replace the license check with a ‚Äúmov eax, 1‚Äù or change the conditional jump to an uncoditional one.</p>
<p>However, this time edgy‚Äôs hacker friend suggested adding some IsDebuggerPresent calls; This makes it harder for us to crack the program. Thankfully, we can pause the program before any checks take place, search for all calls to IsDebuggerPresent, and dummy them out. Afterwards the program is ours!<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/d/db58786062bf1a2c7d9adf3e9f3b3e96f08fe455.png" width="339" height="269"><br>
Ah, forgot to mention. edgy has obfuscated the string ‚ÄúPlease wait‚Ä¶ x seconds‚Äù in some way, so we can‚Äôt easily find where the popup is located. But, we remember that before the license check there was always a call to InitCommonControls; We can search for that instead.</p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/rokups"><span itemprop="name">rokups</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3002.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-23T17:14:57Z" class="post-time">
July 23, 2017, 5:14pm
</time>
<meta itemprop="dateModified" content="2017-07-23T17:14:57Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<div class="spoiler">
<p>Also there is regex check for serial validity. What i did is make dummy serial that follows the pattern <code>NOREPLS-0000-0000-0000-REPLS</code> and like you patched single instruction. At start i noped 3 bytes at <code>00931E01</code> and it worked, but putting <code>mov al, 1; nop</code> there is better. Three byte patch. To fix debugger i used <a href="https://github.com/nihilus/ScyllaHide" rel="nofollow noopener">ScyllaHide</a>.</p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="2" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Joe_Schmoe"><span itemprop="name">Joe_Schmoe</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3002.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-23T17:16:55Z" class="post-time">
July 23, 2017, 5:16pm
</time>
<meta itemprop="dateModified" content="2017-07-23T17:16:55Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<div class="spoiler">
<p>Oh! I noticed there was a regex but thought the last part was 4 numbers too! D‚Äôoh!</p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3002.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-24T05:40:38Z" class="post-time">
July 24, 2017, 5:40am
</time>
<meta itemprop="dateModified" content="2017-07-24T05:40:38Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p><span class="spoiler"><br>
It‚Äôs good that you utilise plugins to automate anti-anti methods however, I encourage everyone here to disable them so that they can actually understand the process and learn from it. Should there come a time where new anti techniques emerge, reliance on plugins should not be a problem. </span> <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Leeky"><span itemprop="name">Leeky</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3002.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/f/f76ad4dc6070608e4ba14fd3f968b241e3e2bcc9.PNG">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-24T16:19:17Z" class="post-time">
July 24, 2017, 4:19pm
</time>
<meta itemprop="dateModified" content="2017-07-24T16:19:17Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<div class="spoiler">
<p>No debugger allowed can‚Äôt stop me when I already now what to patch <img src="../../images/emoji/twitter/stuck_out_tongue.png%3Fv=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> (same as last time)<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/f/f76ad4dc6070608e4ba14fd3f968b241e3e2bcc9.PNG" width="319" height="249"></p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3002.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-24T16:34:04Z" class="post-time">
July 24, 2017, 4:34pm
</time>
<meta itemprop="dateModified" content="2017-07-24T16:34:04Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Try the next one. <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/TheDoctor"><span itemprop="name">TheDoctor</span></a>
(The C# Dude)
</span>
<link itemprop="mainEntityOfPage" href="3002.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/c/c969ba4b5e5ad47e655f854cbbe0ac55294f1a7f.PNG">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-25T11:49:54Z" class="post-time">
July 25, 2017, 11:49am
</time>
<meta itemprop="dateModified" content="2017-07-25T11:49:54Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Again, cool challenge!</p>
<p>I try to write an easy to follow solution, so that everyone, even beginners, can benefit from these <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">.</p>
<div class="spoiler">
<p>What‚Äôs the first step? Yep, run the program! You‚Äôll see it‚Äôs not that easy this time‚Ä¶ Our debugger just tells us that the process has terminated:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/c/c969ba4b5e5ad47e655f854cbbe0ac55294f1a7f.PNG" width="253" height="16"></p>
<p>Is this termination program-related? Test it out, just run the exe as you would normally do outside of your debugger; you‚Äôll see it works like a charm‚Ä¶ Also you‚Äôll see this annoying nag in front of you which just makes you keen on cracking it‚Ä¶ <img src="../../images/emoji/twitter/unamused.png%3Fv=9" title=":unamused:" class="emoji" alt=":unamused:"><br>
So, what could that be? Probably the program doesn‚Äôt like to be run in a debugger! There has to be a check somewhere in the code which checks whether it runs in a debugger. The approach to find it is pretty straightforward: Begin at the program‚Äôs entry point and go through the code step-by-step (F8); when the program terminates the last call was probably a bad one <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">. When you find a terminating call, rerun the program and dig in the call, continuing our previous strategy.</p>
<p>You‚Äôll get here:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/c/c3a5e8b8a7818d16478a5500f535c46229f3c513.PNG" width="572" height="122"></p>
<p>If you run this little loop the program terminates; dig into them, you‚Äôll see the highlighted call is responsible for exiting. Interestingly, it is harmless the first time we call it, but the second time it kills us; sweet‚Ä¶<br>
Open it - hold in mind that the second run is required to get to the right part of the code! - and have a look at it:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/e/e0ed862feb4901f1fde96dbc2fa64941a958597b.PNG" width="511" height="58"></p>
<p>You see the call to ‚ÄúIsDebuggerPresent‚Äù? As the name suggests this call checks whether the program is run in a debugger or not. If EAX is 1 it terminates -&gt; call to ‚ÄúExitProcess‚Äù.<br>
So we have multiple ways to fix this:</p>
<ul>
<li>change the call to MOV EAX, 0 (or XOR EAX, EAX; uses less space <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">)</li>
<li>change JE to JMP</li>
<li>NOP out the PUSH 0 and the call to ExitProcess</li>
</ul>
<p>Feel free to take the way you prefer‚Ä¶ I recommend patching the jump, because it takes only one byte. Anyway, now you can start the real reversing!</p>
<p>I won‚Äôt cover the process of cracking the program; same as last time <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:">.</p>
<p>Instead of stepping through the binary we could have searched for a call to IsDebuggerPresent; it‚Äôs the easiest way of identifying a debugger, so it was guessable that it‚Äôs used here. But there are many other ways which don‚Äôt rely on this call (Probably <a class="mention" href="https://0x00sec.org/u/dtm">@dtm</a> - sorry, edgyS0ft - is already on it‚Ä¶), so you shouldn‚Äôt rely on it, too!</p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3002.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-07-25T11:56:33Z" class="post-time">
July 25, 2017, 11:56am
</time>
<meta itemprop="dateModified" content="2017-07-25T11:56:33Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Very nice and detailed! Great work. <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/rmpinky"><span itemprop="name">rmpinky</span></a>
(Dark Sider)
</span>
<link itemprop="mainEntityOfPage" href="3002.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-10-16T22:22:42Z" class="post-time">
October 16, 2017, 10:22pm
</time>
<meta itemprop="dateModified" content="2017-10-16T23:04:58Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I seem to be struggling with working out how to find the licence checking part.</p>
<p>That damned security cookie keeps trigging as I‚Äôm tinkering!</p>
<p>Bypassed the debugger check very easily mind‚Ä¶</p>
<p>Edit - Bypassed with dialog jumps. No licence key even needed!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/oaktree"><span itemprop="name">oaktree</span></a>
(oaktree)
Closed
</span>
<link itemprop="mainEntityOfPage" href="3002.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-10-16T22:55:51Z" class="post-time">
October 16, 2017, 10:55pm
</time>
<meta itemprop="dateModified" content="2017-10-16T22:55:51Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
