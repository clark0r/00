<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Reversing ActionSpy Android Malware - Reverse Engineering - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Hello, 0x00ers! 
Hope you are doing well! 
First of all sorry if I did some mistakes I am not a native English speaker. 
In this article, Iâ€™m going to discuss a first part of analysis of one of the variant of the malware&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="26537.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Reversing ActionSpy Android Malware&#39;" href="26537.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/optimized/3X/5/6/564db5d6dce9fe43b04727ec462b9a3bfefdf9f3_2_1024x683.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/optimized/3X/5/6/564db5d6dce9fe43b04727ec462b9a3bfefdf9f3_2_1024x683.png" />
<meta property="og:url" content="https://0x00sec.org/t/reversing-actionspy-android-malware/26537" />
<meta name="twitter:url" content="https://0x00sec.org/t/reversing-actionspy-android-malware/26537" />
<meta property="og:title" content="Reversing ActionSpy Android Malware" />
<meta name="twitter:title" content="Reversing ActionSpy Android Malware" />
<meta property="og:description" content="Hello, 0x00ers!  Hope you are doing well!  First of all sorry if I did some mistakes I am not a native English speaker.  In this article, Iâ€™m going to discuss a first part of analysis of one of the variant of the malware ActionSpy.   Introdution This post is a first part of reversing a version of ActionSpy. The tools used are:   BurpSuite Binary Ninja jadx-gui AVD apktool foremost   Information gathering  Permissions Using jadx-gui to reverse the APK, it can be observed that the malware use near..." />
<meta name="twitter:description" content="Hello, 0x00ers!  Hope you are doing well!  First of all sorry if I did some mistakes I am not a native English speaker.  In this article, Iâ€™m going to discuss a first part of analysis of one of the variant of the malware ActionSpy.   Introdution This post is a first part of reversing a version of ActionSpy. The tools used are:   BurpSuite Binary Ninja jadx-gui AVD apktool foremost   Information gathering  Permissions Using jadx-gui to reverse the APK, it can be observed that the malware use near..." />
<meta property="og:article:section" content="Reverse Engineering" />
<meta property="og:article:section:color" content="12A89D" />
<meta property="og:article:tag" content="malware" />
<meta property="og:article:tag" content="android" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins ðŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="15 â¤" />
<meta property="article:published_time" content="2021-07-12T17:11:19+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="26537.html">Reversing ActionSpy Android Malware</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/reverse-engineering/58.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #12A89D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Reverse Engineering</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/malware.html" class="discourse-tag" rel="tag">malware</a>,
<a href="../../tag/android.html" class="discourse-tag" rel="tag">android</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Reversing ActionSpy Android Malware">
<meta itemprop="articleSection" content="Reverse Engineering">
<meta itemprop="keywords" content="malware, android">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hts"><span itemprop="name">hts</span></a>
(hts)
</span>
<link itemprop="mainEntityOfPage" href="26537.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/3X/5/6/564db5d6dce9fe43b04727ec462b9a3bfefdf9f3.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-07-12T17:11:19Z" class="post-time">
July 12, 2021, 5:11pm
</time>
<meta itemprop="dateModified" content="2021-07-13T02:56:21Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Hello, 0x00ers!<br>
Hope you are doing well!<br>
First of all sorry if I did some mistakes I am not a native English speaker.<br>
In this article, Iâ€™m going to discuss a first part of analysis of one of the variant of the malware ActionSpy.</p>
<h1>
<a name="introdution-1" class="anchor" href="26537.html#introdution-1"></a>Introdution</h1>
<p>This post is a first part of reversing a version of ActionSpy. The tools used are:</p>
<ul>
<li>BurpSuite</li>
<li>Binary Ninja</li>
<li>jadx-gui</li>
<li>AVD</li>
<li>apktool</li>
<li>foremost</li>
</ul>
<h1>
<a name="information-gathering-2" class="anchor" href="26537.html#information-gathering-2"></a>Information gathering</h1>
<h2>
<a name="permissions-3" class="anchor" href="26537.html#permissions-3"></a>Permissions</h2>
<p>Using jadx-gui to reverse the APK, it can be observed that the malware use nearly all the Android permissions, some of them are listed bellow:</p>
<pre><code class="lang-auto">    &lt;uses-permission android:name="android.permission.READ_PHONE_STATE"/&gt;
    &lt;uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/&gt;
    &lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/&gt;
    &lt;uses-permission android:name="android.permission.INTERNET"/&gt;
    &lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/&gt;
    &lt;uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/&gt;
    &lt;uses-permission android:name="android.permission.CHANGE_WIFI_STATE"/&gt;
    &lt;uses-permission android:name="android.permission.CAMERA"/&gt;
    &lt;uses-permission android:name="android.permission.RECORD_AUDIO"/&gt;
    &lt;uses-permission android:name="android.permission.READ_LOGS"/&gt;
    &lt;uses-permission android:name="android.permission.MOUNT_UNMOUNT_FILESYSTEMS"/&gt;
    &lt;uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS"/&gt;
    &lt;uses-permission android:name="android.permission.WRITE_SETTINGS"/&gt;
    &lt;uses-permission android:name="com.android.browser.permission.READ_HISTORY_BOOKMARKS"/&gt;
    &lt;uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/&gt;
    &lt;uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/&gt;
    &lt;uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/&gt;
    &lt;uses-permission android:name="android.permission.READ_CONTACTS"/&gt;
    &lt;uses-permission android:name="android.permission.READ_SMS"/&gt;
    &lt;uses-permission android:name="android.permission.READ_CALL_LOG"/&gt;
    ....
</code></pre>
<h2>
<a name="traffic-analysis-4" class="anchor" href="26537.html#traffic-analysis-4"></a>Traffic analysis</h2>
<p>Starting by the traffic analysis will give more information about how the malware communicate with the C2C server and which information is sent.</p>
<p>Installing the malware on an Android Virtual Device which has Burp Suite as proxy, it can be observed that the server send different HTTP requests to different servers with the domain name <a href="https://gvt1.com" rel="noopener nofollow ugc">gvt1.com</a>:</p>
<ul>
<li><a href="https://redirector.gvt1.com" rel="noopener nofollow ugc">redirector.gvt1.com</a></li>
<li><a href="https://r6---sn-n0ogpnx-b85l.gvt1.com" rel="noopener nofollow ugc">r6---sn-n0ogpnx-b85l.gvt1.com</a></li>
<li><a href="https://r3---sn-n0ogpnx-b85l.gvt1.com" rel="noopener nofollow ugc">r3---sn-n0ogpnx-b85l.gvt1.com</a></li>
<li><a href="https://r5---sn-n0ogpnx-b85l.gvt1.com" rel="noopener nofollow ugc">r5---sn-n0ogpnx-b85l.gvt1.com</a></li>
</ul>
<p>The first HTTP request is sent to <a href="https://redirector.gvt1.com" rel="noopener nofollow ugc">redirector.gvt1.com</a>, which will redirect to one of the C2C servers.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/5/6/564db5d6dce9fe43b04727ec462b9a3bfefdf9f3.png" data-download-href="/uploads/short-url/cjtytnoJOM1FnhuW3hb6j85ZtdN.png?dl=1" title="redirector" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/5/6/564db5d6dce9fe43b04727ec462b9a3bfefdf9f3_2_690x460.png" alt="redirector" data-base62-sha1="cjtytnoJOM1FnhuW3hb6j85ZtdN" width="690" height="460" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/5/6/564db5d6dce9fe43b04727ec462b9a3bfefdf9f3_2_690x460.png, https://0x00sec.s3.amazonaws.com/optimized/3X/5/6/564db5d6dce9fe43b04727ec462b9a3bfefdf9f3_2_1035x690.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/5/6/564db5d6dce9fe43b04727ec462b9a3bfefdf9f3.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/5/6/564db5d6dce9fe43b04727ec462b9a3bfefdf9f3_2_10x10.png"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">redirector</span><span class="informations">1157Ã—772 73 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>If we follow the redirection, a binary file is downloaded from the C2C server.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/c/9/c9cf5e7212a9f0365fa64b892972abc8d83f9206.png" data-download-href="/uploads/short-url/sNifXB5NYLY2RQ9FqH5Eggl4IK2.png?dl=1" title="file1_dl" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/c/9/c9cf5e7212a9f0365fa64b892972abc8d83f9206_2_690x466.png" alt="file1_dl" data-base62-sha1="sNifXB5NYLY2RQ9FqH5Eggl4IK2" width="690" height="466" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/c/9/c9cf5e7212a9f0365fa64b892972abc8d83f9206_2_690x466.png, https://0x00sec.s3.amazonaws.com/optimized/3X/c/9/c9cf5e7212a9f0365fa64b892972abc8d83f9206_2_1035x699.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/c/9/c9cf5e7212a9f0365fa64b892972abc8d83f9206.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/c/9/c9cf5e7212a9f0365fa64b892972abc8d83f9206_2_10x10.png"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">file1_dl</span><span class="informations">1273Ã—860 137 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>Using <code>wget</code> to download the file in order to check what it contains:</p>
<pre><code class="lang-auto">wget "http://r3---sn-n0ogpnx-b85l.gvt1.com/edgedl/release2/chrome_component/AKi1sv7cx4bJf9W1XiuhCek_9.18.0/KDDyO-ENZ8HrUUsbZHNxeA" -O file1.data
</code></pre>
<p>The malware sends some parameter trough the request including the public IP address of the victim.<br>
The part <code>AKi1sv7cx4bJf9W1XiuhCek_9.18.0/KDDyO-ENZ8HrUUsbZHNxeA</code> of the request change at each time, it suspected that the information is sent encrypted through the request.</p>
<h3>
<a name="downloaded-files-analysis-5" class="anchor" href="26537.html#downloaded-files-analysis-5"></a>Downloaded files Analysis</h3>
<p>Starting by identifying the file type of the downloaded file.</p>
<pre><code class="lang-auto">&gt; file file1.data
file1.data: Google Chrome extension, version 3
</code></pre>
<p>The application Google Chrome on Android does not support extensions. To get the data from this file <code>foremoset</code> is used.</p>
<pre><code class="lang-auto">&gt; foremost file1.data -o output_file1/
</code></pre>
<p>The tool founded one zip file which contains 3 files and one directory:<br>
<img src="https://0x00sec.s3.amazonaws.com/original/3X/6/1/6125779f2325e094354ae8303daf2ed557808236.png" alt="zip1_content" data-base62-sha1="dRoArRv9wid6tJcFqHCZrYk0N1Q" width="567" height="68"></p>
<p>The file <code>Filtering Rules</code> contains a list of 6291 domain names.</p>
<p>At each request a new list is downloaded with different domain names.</p>
<h2>
<a name="embedded-apks-6" class="anchor" href="26537.html#embedded-apks-6"></a>Embedded APKs</h2>
<p>The malware embed three APKs located in the folder <code>assets/init</code>. These APKs are:</p>
<ul>
<li>Camera.apk</li>
<li>Core.apk</li>
<li>Location.apk</li>
</ul>
<p>These APKs will be analyzed later on (Not in this current post).</p>
<h1>
<a name="static-analysis-7" class="anchor" href="26537.html#static-analysis-7"></a>Static Analysis</h1>
<h2>
<a name="main-activity-8" class="anchor" href="26537.html#main-activity-8"></a>Main activity</h2>
<p>The main activity is <code>com.jsyjv.klxblnwc.p004u.MainActivity</code>. The function <code>onCreate</code> look as follows:<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/6/8/68359576f06882defb73099fe1c4965cf01bdb04.png" data-download-href="/uploads/short-url/eRSsvqfc9CZqgVI6z47HDSTcuB6.png?dl=1" title="MainActivity_onCreate" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/6/8/68359576f06882defb73099fe1c4965cf01bdb04_2_690x375.png" alt="MainActivity_onCreate" data-base62-sha1="eRSsvqfc9CZqgVI6z47HDSTcuB6" width="690" height="375" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/6/8/68359576f06882defb73099fe1c4965cf01bdb04_2_690x375.png, https://0x00sec.s3.amazonaws.com/original/3X/6/8/68359576f06882defb73099fe1c4965cf01bdb04.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/6/8/68359576f06882defb73099fe1c4965cf01bdb04.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/6/8/68359576f06882defb73099fe1c4965cf01bdb04_2_10x10.png"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">MainActivity_onCreate</span><span class="informations">768Ã—418 47.3 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>The code calls a native function <code>mo684a</code> from the library <code>hello-jni</code> which generate a key, check if itâ€™s the first time the application is launched by reading the value from the shared preferences file located at<br>
<code>/data/data/com.isyjv.klxblnwc/shared_prefs/com.isyjv.klxblnwc.xml</code>.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/4/1/413ed4bf05fffd389158649930e5026b3914218d.png" data-download-href="/uploads/short-url/9jbEkn5FGnU5370cXitC9B9Og2N.png?dl=1" title="native_hello_jni_a" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/4/1/413ed4bf05fffd389158649930e5026b3914218d_2_690x139.png" alt="native_hello_jni_a" data-base62-sha1="9jbEkn5FGnU5370cXitC9B9Og2N" width="690" height="139" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/4/1/413ed4bf05fffd389158649930e5026b3914218d_2_690x139.png, https://0x00sec.s3.amazonaws.com/original/3X/4/1/413ed4bf05fffd389158649930e5026b3914218d.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/4/1/413ed4bf05fffd389158649930e5026b3914218d.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/4/1/413ed4bf05fffd389158649930e5026b3914218d_2_10x10.png"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">native_hello_jni_a</span><span class="informations">730Ã—148 17 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>The malware calls the function <code>com.isyjv.klxblnwc.util.Utils.desDecrypt</code> with the generated hex key.<br>
The function is as follows:<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/3/6/36af8215c4019ad5a4e745d60ecf054c24cee703.png" data-download-href="/uploads/short-url/7NLO5s0S75Os7Qu7Fm372ccYr0T.png?dl=1" title="desDecrypt" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/3/6/36af8215c4019ad5a4e745d60ecf054c24cee703_2_690x243.png" alt="desDecrypt" data-base62-sha1="7NLO5s0S75Os7Qu7Fm372ccYr0T" width="690" height="243" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/3/6/36af8215c4019ad5a4e745d60ecf054c24cee703_2_690x243.png, https://0x00sec.s3.amazonaws.com/original/3X/3/6/36af8215c4019ad5a4e745d60ecf054c24cee703.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/3/6/36af8215c4019ad5a4e745d60ecf054c24cee703.png 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/3/6/36af8215c4019ad5a4e745d60ecf054c24cee703_2_10x10.png"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">desDecrypt</span><span class="informations">772Ã—272 37.7 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<pre><code class="lang-java">  cipher.init(2, skeyFactory.generateSecret(desKeySpec)); // Initialize cipher to decryption mode
</code></pre>
<p>Before encrypting the argument, the function divide the string into two characters, convert it each to integer then encrypt it:</p>
<pre><code class="lang-java">  byte[] btxts = new byte[(txt.length() / 2)];
  int count = txt.length();
  for (int i = 0; i &lt; count; i += 2) {
    btxts[i / 2] = (byte) Integer.parseInt(txt.substring(i, i + 2), 16);
  }
</code></pre>
<p>As DES decryption is the inversion of DES encryption, the function desDecrypt here is used as encryption routine.</p>
<p>After the key generation, the malware start a service that init the configuration file and redirect logs of the application to a file. The file name is microlog.txt and located in the folder /sdcard. the content is as follow:</p>
<pre><code class="lang-auto">[DEBUG]22:14:53,00 Utils|main PService onCreate |Microlog 1 
[DEBUG]22:14:53,00 Utils|main PService onBind Intent { cmp=com.isyjv.klxblnwc/.s.PService } |Microlog 1 
[DEBUG]22:14:53,01 Utils|main PService Binder uid:10149 |Microlog 2 
[DEBUG]22:14:53,03 Utils|main PService caller signature md5:3bd158635713d3e220113fb6adc8b6e2 |Microlog 4 
[DEBUG]22:14:53,48 AppEnv|main onCreate |Microlog 0 
[DEBUG]22:14:53,50 AppEnv|main startJobSheduler ret 1 |Microlog 2 
[DEBUG]22:14:53,52 AppEnv|main onCreate List pkgName: com.isyjv.klxblnwc svrName: com.isyjv.klxblnwc.s.HService |Microlog 4 
[DEBUG]22:14:53,53 AppEnv|main onStartCommand startIdï¼š1 |Microlog 5 
[DEBUG]22:14:53,54 AppEnv|Thread-2 startGuard pkgName: com.isyjv.klxblnwc svrName: com.isyjv.klxblnwc.s.HService |Microlog 6 
[DEBUG]22:14:53,54 AppEnv|Thread-2 startGuard wating... |Microlog 6 
[DEBUG]22:14:54,679 Utils|Binder:4646_3 start to installPlugin /storage/emulated/0/origin/Camera.apk,pkgname:null |Microlog 1680 
[DEBUG]22:14:54,712 Utils|Binder:4646_3 install plugin failed, pkgname:null resultCode:0 |Microlog 1713 
[DEBUG]22:14:54,722 Utils|Binder:4646_3 start to installPlugin /storage/emulated/0/origin/Core.apk,pkgname:null |Microlog 1723 
[DEBUG]22:14:54,798 Utils|Binder:4646_3 install plugin failed, pkgname:null resultCode:0 |Microlog 1799 
[DEBUG]22:14:54,813 Utils|Binder:4646_3 start to installPlugin /storage/emulated/0/origin/Location.apk,pkgname:null |Microlog 1814 
[DEBUG]22:14:54,869 Utils|Binder:4646_3 install plugin failed, pkgname:null resultCode:0 |Microlog 1870
</code></pre>
<p>This service start a second service that will install the packed APKs, list installed Apps and check if the device is rooted. This information is logged to file /sdcard/microlog.txt.</p>
<p>Thatâ€™s it for this first part and thanks for reading!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="12" />
<span class="post-likes">12 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/3vn2odzn"><span itemprop="name">3vn2odzn</span></a>
(Null)
</span>
<link itemprop="mainEntityOfPage" href="26537.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-07-19T12:10:04Z" class="post-time">
July 19, 2021, 12:10pm
</time>
<meta itemprop="dateModified" content="2021-07-19T12:10:04Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Reverse engineering is a really cool branch. Since there is not much content about reverse engineering, it is pleasing to come across very descriptive content like this article. Thanks for your effort <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Successful topic.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="26537.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2021-11-11T09:11:47Z" class="post-time">
November 11, 2021, 9:11am
</time>
<meta itemprop="dateModified" content="2021-11-11T09:11:47Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
