<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Blue Teams Lab: Log Analysis — Compromised WordPress - Blue-Team - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Introduction
This is an interesting challenge that contains an attack on a WordPress site using multiple IP addresses and techniques to breach the site. Our goal is to identify the attacker and their methods by analyzing&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="38286.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Blue Teams Lab: Log Analysis — Compromised WordPress&#39;" href="38286.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/3X/d/7/d73249c7fc5d8d23765feed0d71a87d83bcdcfb3.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/3X/d/7/d73249c7fc5d8d23765feed0d71a87d83bcdcfb3.png" />
<meta property="og:url" content="https://0x00sec.org/t/blue-teams-lab-log-analysis-compromised-wordpress/38286" />
<meta name="twitter:url" content="https://0x00sec.org/t/blue-teams-lab-log-analysis-compromised-wordpress/38286" />
<meta property="og:title" content="Blue Teams Lab: Log Analysis — Compromised WordPress" />
<meta name="twitter:title" content="Blue Teams Lab: Log Analysis — Compromised WordPress" />
<meta property="og:description" content="Introduction This is an interesting challenge that contains an attack on a WordPress site using multiple IP addresses and techniques to breach the site. Our goal is to identify the attacker and their methods by analyzing the Apache access.log file. There are 6 question in the challenge and we will use Linux CLI to solve this.  Analysis If an attacker is attacking a web application, he/she might try to login to the admin panel. If they don’t have the required credentials, they may try to brute fo..." />
<meta name="twitter:description" content="Introduction This is an interesting challenge that contains an attack on a WordPress site using multiple IP addresses and techniques to breach the site. Our goal is to identify the attacker and their methods by analyzing the Apache access.log file. There are 6 question in the challenge and we will use Linux CLI to solve this.  Analysis If an attacker is attacking a web application, he/she might try to login to the admin panel. If they don’t have the required credentials, they may try to brute fo..." />
<meta property="og:article:section" content="Blue-Team" />
<meta property="og:article:section:color" content="0088CC" />
<meta property="og:article:tag" content="linux" />
<meta property="og:article:tag" content="event-log" />
<meta property="og:article:tag" content="forensics" />
<meta property="og:article:tag" content="websec" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="4 ❤" />
<meta property="article:published_time" content="2023-12-10T14:54:59+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="38286.html">Blue Teams Lab: Log Analysis — Compromised WordPress</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/blue-team/105.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #0088CC"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Blue-Team</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/linux.html" class="discourse-tag" rel="tag">linux</a>,
<a href="../../tag/event-log.html" class="discourse-tag" rel="tag">event-log</a>,
<a href="../../tag/forensics.html" class="discourse-tag" rel="tag">forensics</a>,
<a href="../../tag/websec.html" class="discourse-tag" rel="tag">websec</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Blue Teams Lab: Log Analysis — Compromised WordPress">
<meta itemprop="articleSection" content="Blue-Team">
<meta itemprop="keywords" content="linux, event-log, forensics, websec">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/alarick"><span itemprop="name">alarick</span></a>
</span>
<link itemprop="mainEntityOfPage" href="38286.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/3X/d/7/d73249c7fc5d8d23765feed0d71a87d83bcdcfb3.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-12-10T14:54:59Z" class="post-time">
December 10, 2023, 2:54pm
</time>
<meta itemprop="dateModified" content="2023-12-10T14:54:59Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<h1><a name="introduction-1" class="anchor" href="38286.html#introduction-1"></a>Introduction</h1>
<p>This is an interesting challenge that contains an attack on a WordPress site using multiple IP addresses and techniques to breach the site. Our goal is to identify the attacker and their methods by analyzing the Apache access.log file. There are 6 question in the challenge and we will use Linux CLI to solve this.</p>
<h1><a name="analysis-2" class="anchor" href="38286.html#analysis-2"></a>Analysis</h1>
<p>If an attacker is attacking a web application, he/she might try to login to the admin panel. If they don’t have the required credentials, they may try to brute force the account. This approach is noisy and reports a lot of login failure events in the access.log file. So first lets count the authentication failures for each IP.</p>
<pre><code class="lang-auto">cat access.log | grep "403" | cut -d " " -f 1 | sort | uniq -c | sort -nr
</code></pre>
<p><img src="https://0x00sec.s3.amazonaws.com/original/3X/d/7/d73249c7fc5d8d23765feed0d71a87d83bcdcfb3.png" alt="image" data-base62-sha1="uHIoGqG8SicCP9XvsY14hxPfNl1" width="163" height="291"></p>
<p>So the IPs to investigate are 110.29.54.120, 168.22.54.119, 197.23.128.35 and 119.241.22.121</p>
<p>When we investigate the first IP in the list: 110.29.54.120 we see a large number of login failures.</p>
<pre><code class="lang-auto">cat access.log | grep "110.29.54.120"
</code></pre>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/6/4/64259e930d241eb789dabccaf773b426300c6a70.jpeg" data-download-href="/uploads/short-url/ehWltc8526x0XIvwwlMmqz2DCbC.jpeg?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/3X/6/4/64259e930d241eb789dabccaf773b426300c6a70.jpeg" alt="image" data-base62-sha1="ehWltc8526x0XIvwwlMmqz2DCbC" width="690" height="340" data-dominant-color="27282A"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×355 113 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Anyhow the above picture contains the answer to the first question in the challenge.</p>
<p>Interestingly before all those failures, this IP successfully made a couple of logins to the admin panel. However after all those login failures, this IP tried to enumerate the contact form 7 plugin, but had no luck.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/5/9/594a4f63b77abd6090cdb5500030294a0a392d6a.png" data-download-href="/uploads/short-url/cJTHCtvFchq1SN6PhRIFFBgHU38.png?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/5/9/594a4f63b77abd6090cdb5500030294a0a392d6a_2_690x46.png" alt="image" data-base62-sha1="cJTHCtvFchq1SN6PhRIFFBgHU38" width="690" height="46" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/5/9/594a4f63b77abd6090cdb5500030294a0a392d6a_2_690x46.png, https://0x00sec.s3.amazonaws.com/original/3X/5/9/594a4f63b77abd6090cdb5500030294a0a392d6a.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/5/9/594a4f63b77abd6090cdb5500030294a0a392d6a.png 2x" data-dominant-color="2E2F31"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×49 52.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Now if we investigate the second IP: 168.22.54.119 and match the wp-login attempts using the following command, we see something that looks like an SQL injection payload.</p>
<pre><code class="lang-auto">cat access.log | grep "168.22.54.119" | grep "/wp-login.php?itsec-hb-token=adminlogin"
</code></pre>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/2/d/2daa779a84f24ff40bb21e508be6b6ae0c53c21f.jpeg" data-download-href="/uploads/short-url/6vYI31INCZXErCbVdS8gfiYyBhZ.jpeg?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/3X/2/d/2daa779a84f24ff40bb21e508be6b6ae0c53c21f.jpeg" alt="image" data-base62-sha1="6vYI31INCZXErCbVdS8gfiYyBhZ" width="690" height="87" data-dominant-color="2F292A"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×91 31.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>The payload is url encoded and if we decode it, it translates as follows:</p>
<pre><code class="lang-auto">2151+AND+1=1+UNION+ALL+SELECT+1,NULL,'&lt;script&gt;alert("XSS")&lt;/script&gt;',table_name+FROM+information_schema.tables+WHERE+2&gt;1--/**/;+EXEC+xp_cmdshell('cat+../../../etc/passwd')#
</code></pre>
<p>Please note there are few more SQLi payloads other than the one shown here. So we can suspect this attacker might have used something like sqlmap. To verify this we can isolate the user agent and analyze.</p>
<pre><code class="lang-auto">cat access.log | grep "168.22.54.119" | cut -d " " -f12-
</code></pre>
<p>And as we suspected, we can see sqlmap user agent in the logs:</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/4/a/4a7b5d38fcb138926c78263960e05a39c8f37d00.jpeg" data-download-href="/uploads/short-url/aCTDDq4OpasacnQ00JgsqEPH6Y8.jpeg?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/3X/4/a/4a7b5d38fcb138926c78263960e05a39c8f37d00.jpeg" alt="image" data-base62-sha1="aCTDDq4OpasacnQ00JgsqEPH6Y8" width="690" height="126" data-dominant-color="2E2C2E"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×132 51.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>If you examine the SQL injection payload, it tries to get a command shell using xp_cmdshell. However, the command xp_cmdshell is a MS SQL Server command so the attacker might be assuming that the wordpress site is using MS SQL Server for linux. Please check the links below.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://learn.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/xp-cmdshell-transact-sql?view=sql-server-ver16&amp;source=post_page-----15d9d7b883ce--------------------------------">
<header class="source">
<a href="https://learn.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/xp-cmdshell-transact-sql?view=sql-server-ver16&amp;source=post_page-----15d9d7b883ce--------------------------------" target="_blank" rel="noopener nofollow ugc">learn.microsoft.com</a>
</header>
<article class="onebox-body">
<div class="aspect-image" style="--aspect-ratio:690/362;"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/d/f/df50ff207e6a6ce3b4d58cdf0195308a0fb1e170_2_690x362.png" class="thumbnail" data-dominant-color="D1DDE2" width="690" height="362" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/d/f/df50ff207e6a6ce3b4d58cdf0195308a0fb1e170_2_690x362.png, https://0x00sec.s3.amazonaws.com/optimized/3X/d/f/df50ff207e6a6ce3b4d58cdf0195308a0fb1e170_2_1035x543.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/d/f/df50ff207e6a6ce3b4d58cdf0195308a0fb1e170.png 2x"></div>
<h3><a href="https://learn.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/xp-cmdshell-transact-sql?view=sql-server-ver16&amp;source=post_page-----15d9d7b883ce--------------------------------" target="_blank" rel="noopener nofollow ugc">xp_cmdshell (Transact-SQL) - SQL Server</a></h3>
<p>Spawns a Windows command shell and passes in a string for execution. Any output is returned as rows of text.</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://learn.microsoft.com/en-us/sql/linux/sql-server-linux-overview?view=sql-server-ver16&amp;source=post_page-----15d9d7b883ce--------------------------------">
<header class="source">
<a href="https://learn.microsoft.com/en-us/sql/linux/sql-server-linux-overview?view=sql-server-ver16&amp;source=post_page-----15d9d7b883ce--------------------------------" target="_blank" rel="noopener nofollow ugc">learn.microsoft.com</a>
</header>
<article class="onebox-body">
<div class="aspect-image" style="--aspect-ratio:690/362;"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/d/f/df50ff207e6a6ce3b4d58cdf0195308a0fb1e170_2_690x362.png" class="thumbnail" data-dominant-color="D1DDE2" width="690" height="362" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/d/f/df50ff207e6a6ce3b4d58cdf0195308a0fb1e170_2_690x362.png, https://0x00sec.s3.amazonaws.com/optimized/3X/d/f/df50ff207e6a6ce3b4d58cdf0195308a0fb1e170_2_1035x543.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/d/f/df50ff207e6a6ce3b4d58cdf0195308a0fb1e170.png 2x"></div>
<h3><a href="https://learn.microsoft.com/en-us/sql/linux/sql-server-linux-overview?view=sql-server-ver16&amp;source=post_page-----15d9d7b883ce--------------------------------" target="_blank" rel="noopener nofollow ugc">Overview of SQL Server on Linux - SQL Server</a></h3>
<p>This article describes how SQL Server runs on Linux and provides information on how to learn more.</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>Additionally this IP had access to the admin page for a brief period of time. However it seems after trying some other SQL injection payloads, the IP got logged out of the account.</p>
<p>Another interesting thing with this IP is, it tried to enumerate two plugins, Contact Form 7 and Simple File List.</p>
<pre><code class="lang-auto">cat access.log | grep "168.22.54.119" | egrep "contact|simple"
</code></pre>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/6/8/68d8f1d0f06ea2986db87643245cf06ff29f7f7a.png" data-download-href="/uploads/short-url/eXwsqLDDrT3gnpvpeTvDR0FyisG.png?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/6/8/68d8f1d0f06ea2986db87643245cf06ff29f7f7a_2_690x27.png" alt="image" data-base62-sha1="eXwsqLDDrT3gnpvpeTvDR0FyisG" width="690" height="27" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/6/8/68d8f1d0f06ea2986db87643245cf06ff29f7f7a_2_690x27.png, https://0x00sec.s3.amazonaws.com/original/3X/6/8/68d8f1d0f06ea2986db87643245cf06ff29f7f7a.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/6/8/68d8f1d0f06ea2986db87643245cf06ff29f7f7a.png 2x" data-dominant-color="2F3032"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×29 30.3 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>These two plugins are vulnerable to Arbitrary File Upload. This means an attacker can upload any file to the server, for example a webshell. If you simply search Contact Form 7 arbitrary file upload on duckduckgo, you will find the corresponding CVE (Link below) and that answers the 3rd question.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://blog.wpsec.com/contact-form-7-vulnerability/">
<header class="source">
<img src="https://0x00sec.s3.amazonaws.com/original/3X/6/4/648f7c48715cbf52c622873db322cb885b75dbf6.png" class="site-icon" data-dominant-color="0C86C4" width="32" height="32">
<a href="https://blog.wpsec.com/contact-form-7-vulnerability/" target="_blank" rel="noopener nofollow ugc" title="02:34PM - 21 December 2020">WPSec – 21 Dec 20</a>
</header>
<article class="onebox-body">
<div class="aspect-image" style="--aspect-ratio:690/285;"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/0/b/0bb3cc7e4529df93dd9e0097581c43fbe02c49f2_2_690x285.png" class="thumbnail" data-dominant-color="798679" width="690" height="285" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/0/b/0bb3cc7e4529df93dd9e0097581c43fbe02c49f2_2_690x285.png, https://0x00sec.s3.amazonaws.com/optimized/3X/0/b/0bb3cc7e4529df93dd9e0097581c43fbe02c49f2_2_1035x427.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/0/b/0bb3cc7e4529df93dd9e0097581c43fbe02c49f2.png 2x"></div>
<h3><a href="https://blog.wpsec.com/contact-form-7-vulnerability/" target="_blank" rel="noopener nofollow ugc">CVE-2020-35489: Unrestricted File Upload Vulnerability found in Contact Form...</a></h3>
<p>A high-severity&nbsp;Unrestricted File Upload&nbsp;vulnerability, tracked as CVE-2020–35489, was discovered in a popular WordPress plugin called&nbsp;Contact Form 7, currently installed on&nbsp;5 Million+ websites&nbsp;making them vulnerable to...</p>
<p>
<span class="label1">Est. reading time: 4 minutes</span>
</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>The other plugin that is vulnerable is Simple File List. If you search again for a Simple File List exploit, you can find the following link that explains the exploit and the affected version, which answers the 4th question.</p>
<p><a href="https://wpscan.com/vulnerability/365da9c5-a8d0-45f6-863c-1b1926ffd574/" class="onebox" target="_blank" rel="noopener nofollow ugc">https://wpscan.com/vulnerability/365da9c5-a8d0-45f6-863c-1b1926ffd574/</a></p>
<p>Now lets go ahead and analyze the next IP on the list, 197.23.128.35.</p>
<p>It seems this IP also had some success with admin login before getting a lockout.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/c/7/c73647f3cbfdba9436aaab499c36789d21df4e71.png" data-download-href="/uploads/short-url/sqjjqb9kxsmrmbDUNSQf0KRlawx.png?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/c/7/c73647f3cbfdba9436aaab499c36789d21df4e71_2_690x55.png" alt="image" data-base62-sha1="sqjjqb9kxsmrmbDUNSQf0KRlawx" width="690" height="55" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/c/7/c73647f3cbfdba9436aaab499c36789d21df4e71_2_690x55.png, https://0x00sec.s3.amazonaws.com/original/3X/c/7/c73647f3cbfdba9436aaab499c36789d21df4e71.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/c/7/c73647f3cbfdba9436aaab499c36789d21df4e71.png 2x" data-dominant-color="2A2C2D"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×58 47.2 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>After the lockout, it seems this IP tried various attacks, but without a success.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/d/f/df5cf98f265525d509b4cbf3d75106462a59d928.jpeg" data-download-href="/uploads/short-url/vRXFLgIpnl7ut8DvZZOqPuYYKzm.jpeg?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/3X/d/f/df5cf98f265525d509b4cbf3d75106462a59d928.jpeg" alt="image" data-base62-sha1="vRXFLgIpnl7ut8DvZZOqPuYYKzm" width="690" height="345" data-dominant-color="28292B"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×361 118 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>So now, to the final IP address: 119.241.22.121. Now, a lot of things has happened with this IP as well.</p>
<p>First of all, just like the IP 168.22.54.119, this IP also tried to exploit the two plugins: Contact Form 7 and Simple File List.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/a/e/ae51827a4f2bf3a636770d155abe0021b707d16f.png" data-download-href="/uploads/short-url/oS5IeQs2OnSOdOELQcFwba8Pyz5.png?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/a/e/ae51827a4f2bf3a636770d155abe0021b707d16f_2_690x70.png" alt="image" data-base62-sha1="oS5IeQs2OnSOdOELQcFwba8Pyz5" width="690" height="70" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/a/e/ae51827a4f2bf3a636770d155abe0021b707d16f_2_690x70.png, https://0x00sec.s3.amazonaws.com/original/3X/a/e/ae51827a4f2bf3a636770d155abe0021b707d16f.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/a/e/ae51827a4f2bf3a636770d155abe0021b707d16f.png 2x" data-dominant-color="27292A"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×74 49 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Then it goes on and try a bunch of enumerations to find login portals and control panels:</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/e/d/ed06803e318daa5f9d4a8c60fad658bee1a7b5ea.jpeg" data-download-href="/uploads/short-url/xOP5v1mPI4TrY43G6ckcmOajguu.jpeg?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/3X/e/d/ed06803e318daa5f9d4a8c60fad658bee1a7b5ea.jpeg" alt="image" data-base62-sha1="xOP5v1mPI4TrY43G6ckcmOajguu" width="690" height="232" data-dominant-color="28292A"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×243 76.6 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/6/7/6713f5457c41e0ee637e98bc923cc579b71ce546.jpeg" data-download-href="/uploads/short-url/eHRWfk21NkXptS58Zv3jDTUhy9U.jpeg?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/3X/6/7/6713f5457c41e0ee637e98bc923cc579b71ce546.jpeg" alt="image" data-base62-sha1="eHRWfk21NkXptS58Zv3jDTUhy9U" width="690" height="333" data-dominant-color="29282A"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×348 114 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Then it gains some access to the admin account before getting logged out of it.</p>
<p>Since this is an interesting IP address, lets check the user agents used by this IP. We issue the command like before but with this IP address.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/0/c/0c51995bc44cf389f7534b3823387cf50be2b834.jpeg" data-download-href="/uploads/short-url/1KYyoIA5PqdHrvtxZ2bKa56illq.jpeg?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/0/c/0c51995bc44cf389f7534b3823387cf50be2b834_2_690x310.jpeg" alt="image" data-base62-sha1="1KYyoIA5PqdHrvtxZ2bKa56illq" width="690" height="310" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/0/c/0c51995bc44cf389f7534b3823387cf50be2b834_2_690x310.jpeg, https://0x00sec.s3.amazonaws.com/original/3X/0/c/0c51995bc44cf389f7534b3823387cf50be2b834.jpeg 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/0/c/0c51995bc44cf389f7534b3823387cf50be2b834.jpeg 2x" data-dominant-color="29292B"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×324 91.3 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Here we see something interesting, the attacker used WPScan to enumerate or exploit the WordPress site. So now we know the two tools used by the attacker: sqlmap and wpscan. This answers the 2nd question.</p>
<p>Finally, the attacker has figured out that it is better to use a webshell to access the server. Hence he/she exploited the Simple File List plugin and uploaded the fr34k.png file.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/5/d/5d852859d40f5f6f65531f7da7988a43694b273d.png" data-download-href="/uploads/short-url/dljH0lqMsYpmlXzN8Dqcp8UaRsN.png?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/5/d/5d852859d40f5f6f65531f7da7988a43694b273d_2_690x63.png" alt="image" data-base62-sha1="dljH0lqMsYpmlXzN8Dqcp8UaRsN" width="690" height="63" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/5/d/5d852859d40f5f6f65531f7da7988a43694b273d_2_690x63.png, https://0x00sec.s3.amazonaws.com/original/3X/5/d/5d852859d40f5f6f65531f7da7988a43694b273d.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/5/d/5d852859d40f5f6f65531f7da7988a43694b273d.png 2x" data-dominant-color="2E2A2C"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×66 57.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Now we have a lead. The attacker found a way to exploit the application. So lets see if there are any other files with the same name “fr34k”</p>
<pre><code class="lang-auto">cat access.log | grep "fr34k"
</code></pre>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/d/8/d82cbea5928f5641636a15c11f31fb151a44f871.jpeg" data-download-href="/uploads/short-url/uQmZV60sgJ3aoine3JrTdjus4Bb.jpeg?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/3X/d/8/d82cbea5928f5641636a15c11f31fb151a44f871_2_690x255.jpeg" alt="image" data-base62-sha1="uQmZV60sgJ3aoine3JrTdjus4Bb" width="690" height="255" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/d/8/d82cbea5928f5641636a15c11f31fb151a44f871_2_690x255.jpeg, https://0x00sec.s3.amazonaws.com/original/3X/d/8/d82cbea5928f5641636a15c11f31fb151a44f871.jpeg 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/d/8/d82cbea5928f5641636a15c11f31fb151a44f871.jpeg 2x" data-dominant-color="2C2D2F"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×267 100 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Yeah so we have a bunch. What stands out is fr34k.php and this is probably a webshell which the answer to the 5th question. Interestingly the webshell upload was done by using a different IP address: 103.69.55.212 which had only one 403 Forbidden case.</p>
<p>Finally if we match the IP: 103.69.55.212 and the word “fr34k.php” we get all the logs corresponding to the webshell.</p>
<pre><code class="lang-auto">cat access.log | grep "103.69.55.212" | grep "fr34k.php"
</code></pre>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/3X/7/0/705adf9b7c6f130eecc256627b90c75ad02bf17a.jpeg" data-download-href="/uploads/short-url/g1WaFUCuEr815yBj2kzzToCOSLM.jpeg?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/3X/7/0/705adf9b7c6f130eecc256627b90c75ad02bf17a.jpeg" alt="image" data-base62-sha1="g1WaFUCuEr815yBj2kzzToCOSLM" width="690" height="234" data-dominant-color="2E2D2F"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">720×245 94.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Here, at the end we see when the attacker tried to access the webshell he/she got a 404 error and this answers the 6th question.</p>
<h1><a name="conclusion-3" class="anchor" href="38286.html#conclusion-3"></a>Conclusion</h1>
<p>This is a very interesting challenge that teaches you how to use Linux CLI to analyze the web server logs. To prevent such an attacks, one can use Web Application Firewalls (WAFs). There is a plenty of WordPress WAFs available and you can also use application agnostic WAFs like CloudFlare or CrowdStrike to mitigate such attacks.</p>
<p>Originally published on Medium: <a href="https://medium.com/@higgsborn/blue-teams-lab-log-analysis-compromised-wordpress-15d9d7b883ce" class="inline-onebox" rel="noopener nofollow ugc">Blue Teams Lab: Log Analysis — Compromised WordPress | by Higgsborn | Dec, 2023 | Medium</a></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/messede"><span itemprop="name">messede</span></a>
</span>
<link itemprop="mainEntityOfPage" href="38286.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-12-10T15:21:58Z" class="post-time">
December 10, 2023, 3:21pm
</time>
<meta itemprop="dateModified" content="2023-12-10T15:21:58Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>You said this was a challenge ?, what CTF is this from / what is the source ?, where can people find more stuff like this ?.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/alarick"><span itemprop="name">alarick</span></a>
</span>
<link itemprop="mainEntityOfPage" href="38286.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-12-10T15:47:06Z" class="post-time">
December 10, 2023, 3:47pm
</time>
<meta itemprop="dateModified" content="2023-12-10T15:47:06Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hey, you can find the challenges here: <a href="https://blueteamlabs.online/" rel="noopener nofollow ugc">https://blueteamlabs.online/</a> I only focus on free once.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Tas-sos"><span itemprop="name">Tas-sos</span></a>
</span>
<link itemprop="mainEntityOfPage" href="38286.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2023-12-19T15:26:06Z" class="post-time">
December 19, 2023, 3:26pm
</time>
<meta itemprop="dateModified" content="2023-12-19T15:26:06Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Great well explained and with all the relevant resource! Awesome post! Thank you! <img src="../../images/emoji/twitter/slight_smile.png%3Fv=12" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="38286.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2024-04-10T06:55:35Z" class="post-time">
April 10, 2024, 6:55am
</time>
<meta itemprop="dateModified" content="2024-04-10T06:55:35Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
