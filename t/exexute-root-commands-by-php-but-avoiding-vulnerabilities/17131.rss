<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Exexute root commands by PHP but avoiding vulnerabilities</title>
    <link>https://0x00sec.org/t/exexute-root-commands-by-php-but-avoiding-vulnerabilities/17131</link>
    <description>I have a project and for this project, my PHP page located on a server should accept some parameter by my clients. The &quot;problem&quot; is that I  need to run some commands that needs root privileges, basing them on external input.
For example:

    $p = $_GET[&#39;param&#39;];
    shell_exec(&quot;iptables &quot; . $p);

Now assuming that I will escape special characters to avoid vulnerabilities, just escaping &quot;| &amp; ; &quot;etc... In my opinion, by proceeding with this method is not secure because a complex malicious expression built by an attacker could hack it anyway. Of course, the page will not execute these commands as root for really, but thanks to this [method I will be able to assign root privileges only for few commands on another user](https://unix.stackexchange.com/questions/215412/allow-certain-guests-to-execute-certain-commands). These commands will be executed with that privileges by shell_exec call by the PHP page.
My question is the following: there are any more secure options to reach my goal?</description>
    
    <lastBuildDate>Fri, 25 Oct 2019 09:41:16 +0000</lastBuildDate>
    <category>Questions</category>
    <atom:link href="https://0x00sec.org/t/exexute-root-commands-by-php-but-avoiding-vulnerabilities/17131.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Exexute root commands by PHP but avoiding vulnerabilities</title>
        <dc:creator><![CDATA[system]]></dc:creator>
        <description><![CDATA[
            <p>This topic was automatically closed 3 days after the last reply. New replies are no longer allowed.</p>
          <p><a href="https://0x00sec.org/t/exexute-root-commands-by-php-but-avoiding-vulnerabilities/17131/2">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/exexute-root-commands-by-php-but-avoiding-vulnerabilities/17131/2</link>
        <pubDate>Mon, 28 Oct 2019 09:41:38 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-17131-2</guid>
        <source url="https://0x00sec.org/t/exexute-root-commands-by-php-but-avoiding-vulnerabilities/17131.rss">Exexute root commands by PHP but avoiding vulnerabilities</source>
      </item>
      <item>
        <title>Exexute root commands by PHP but avoiding vulnerabilities</title>
        <dc:creator><![CDATA[Virgula]]></dc:creator>
        <description><![CDATA[
            <p>I have a project and for this project, my PHP page located on a server should accept some parameter by my clients. The “problem” is that I  need to run some commands that needs root privileges, basing them on external input.<br>
For example:</p>
<pre><code>$p = $_GET['param'];
shell_exec("iptables " . $p);
</code></pre>
<p>Now assuming that I will escape special characters to avoid vulnerabilities, just escaping "| &amp; ; "etc… In my opinion, by proceeding with this method is not secure because a complex malicious expression built by an attacker could hack it anyway. Of course, the page will not execute these commands as root for really, but thanks to this <a href="https://unix.stackexchange.com/questions/215412/allow-certain-guests-to-execute-certain-commands" rel="nofollow noopener">method I will be able to assign root privileges only for few commands on another user</a>. These commands will be executed with that privileges by shell_exec call by the PHP page.<br>
My question is the following: there are any more secure options to reach my goal?</p>
          <p><a href="https://0x00sec.org/t/exexute-root-commands-by-php-but-avoiding-vulnerabilities/17131/1">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/exexute-root-commands-by-php-but-avoiding-vulnerabilities/17131/1</link>
        <pubDate>Fri, 25 Oct 2019 09:41:16 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-17131-1</guid>
        <source url="https://0x00sec.org/t/exexute-root-commands-by-php-but-avoiding-vulnerabilities/17131.rss">Exexute root commands by PHP but avoiding vulnerabilities</source>
      </item>
  </channel>
</rss>
