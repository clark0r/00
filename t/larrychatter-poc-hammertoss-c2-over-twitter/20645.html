<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>LARRYCHATTER - PoC HAMMERTOSS - C2 over Twitter - Malware - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Hey Offsec mates, 
So I was reading the report by FireEye on the Russian state-sponsored cyber operator team - APT 29 and their malware named HAMMERTOSS tDiscoverer. 
What it did was generate seemingly ‚Äúrandom‚Äù Twitter h&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="20645.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;LARRYCHATTER - PoC HAMMERTOSS - C2 over Twitter&#39;" href="20645.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/larrychatter-poc-hammertoss-c2-over-twitter/20645" />
<meta name="twitter:url" content="https://0x00sec.org/t/larrychatter-poc-hammertoss-c2-over-twitter/20645" />
<meta property="og:title" content="LARRYCHATTER - PoC HAMMERTOSS - C2 over Twitter" />
<meta name="twitter:title" content="LARRYCHATTER - PoC HAMMERTOSS - C2 over Twitter" />
<meta property="og:description" content="Hey Offsec mates,  So I was reading the report by FireEye on the Russian state-sponsored cyber operator team - APT 29 and their malware named HAMMERTOSS tDiscoverer.  What it did was generate seemingly ‚Äúrandom‚Äù Twitter handles periodically and use commands embedded in a tweeted image from that handle for C&amp;C.  Basically, their motto is to mimic human behaviour so as not to get caught by next-gen network security solutions.  Naturally, it caught my eye due to the unconventional C2 channel used by..." />
<meta name="twitter:description" content="Hey Offsec mates,  So I was reading the report by FireEye on the Russian state-sponsored cyber operator team - APT 29 and their malware named HAMMERTOSS tDiscoverer.  What it did was generate seemingly ‚Äúrandom‚Äù Twitter handles periodically and use commands embedded in a tweeted image from that handle for C&amp;C.  Basically, their motto is to mimic human behaviour so as not to get caught by next-gen network security solutions.  Naturally, it caught my eye due to the unconventional C2 channel used by..." />
<meta property="og:article:section" content="Malware" />
<meta property="og:article:section:color" content="F7941D" />
<meta property="og:article:tag" content="malware" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="2 ‚ù§" />
<meta property="article:published_time" content="2020-04-19T16:08:40+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="20645.html">LARRYCHATTER - PoC HAMMERTOSS - C2 over Twitter</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/malware.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F7941D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Malware</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/malware.html" class="discourse-tag" rel="tag">malware</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="LARRYCHATTER - PoC HAMMERTOSS - C2 over Twitter">
<meta itemprop="articleSection" content="Malware">
<meta itemprop="keywords" content="malware">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/slaeryan"><span itemprop="name">slaeryan</span></a>
(johndoe)
</span>
<link itemprop="mainEntityOfPage" href="20645.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-04-19T16:08:40Z" class="post-time">
April 19, 2020, 4:08pm
</time>
<meta itemprop="dateModified" content="2020-04-20T03:50:16Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Hey Offsec mates,</p>
<p>So I was reading the report by FireEye on the Russian state-sponsored cyber operator team - APT 29 and their malware named HAMMERTOSS tDiscoverer.<br>
What it did was generate seemingly ‚Äúrandom‚Äù Twitter handles periodically and use commands embedded in a tweeted image from that handle for C&amp;C.<br>
Basically, their motto is to mimic human behaviour so as not to get caught by next-gen network security solutions.<br>
Naturally, it caught my eye due to the unconventional C2 channel used by them.<br>
I mean sure we have seen social media being used as C2 in real-life by APTs such as the Indian Patchwork team etc but we don‚Äôt really see it often do we?</p>
<p>I decided to create a quick prototype in Python 3 demonstrating the implant‚Äôs capabilities and also added some extra features. Now, originally I intended to make a C2 framework much like Empire, Faction, Sliver, Covenant etc as I thought it‚Äôd be a cool addition to a Red Team operator‚Äôs arsenal but I got caught up in some other work so the project never progressed further and development halted.</p>
<p>Full disclosure: The code is messy as hell since I didn‚Äôt get time to clean it up but it works. It‚Äôs stupid perhaps but it works as intended as of yet.</p>
<p>I‚Äôm posting the link to the Github repository in case someday someone might find it useful and create a production C2 framework based on it.<br>
Here‚Äôs the link: <a href="https://github.com/slaeryan/LARRYCHATTER" rel="nofollow noopener">https://github.com/slaeryan/LARRYCHATTER</a></p>
<p>Oh and P.S. - Did you know the cute bird of Twitter is named Larry? Chatter of course means communication. Ergo, I thought it‚Äôd be appropriate to name the project LARRYCHATTER.</p>
<p>Hope you guys find it useful, cheers!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="20645.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-04-19T16:11:07Z" class="post-time">
April 19, 2020, 4:11pm
</time>
<meta itemprop="dateModified" content="2020-04-19T16:11:07Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Could you explain any of the code here?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/slaeryan"><span itemprop="name">slaeryan</span></a>
(johndoe)
</span>
<link itemprop="mainEntityOfPage" href="20645.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-04-19T16:34:58Z" class="post-time">
April 19, 2020, 4:34pm
</time>
<meta itemprop="dateModified" content="2020-04-19T17:48:31Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Sure.<br>
Okay so what I did was stupid simple.<br>
The project has two parts namely the LP and the Implant.</p>
<p>On the LP side, there‚Äôs not much to explain, it just takes a command from the operator, encrypts the command using a Python crypto lib and then embeds the encrypted command in the an image also fed by the operator before posting the stego image from the Twitter handle whose Developer API tokens have to be fed into the script.</p>
<p>The Implant side is based on web-scraping so as to avoid hard coding any API keys on the Implant side. I use BeautifulSoup lib to scrape the image from the Twitter handle and then proceed to extract the embedded encrypted command from the image, decrypt it and then proceed to perform the intended action on the host. All of this happens without touching the disk.</p>
<p>Dropbox is used for Data exfiltration in the current form. Again, to avoid hard coding the Dropbox API key on the Implant, I pass it along the command embedded in the image separated by a single space.</p>
<p>I‚Äôve also avoided hard coding anything on the Implant side as much as possible since it‚Äôs detrimental to OPSEC and it makes the Implant somewhat more resilient.</p>
<p>Regarding the Twitter Handle Generation algorithm. What I‚Äôve made is a simple pseudo-random generator. In other words, not really random but possible to predict with the correct seed. I‚Äôve used the current date as the seed after hashing it and extracting some characters out of the hash. The LP and the Implant will be kept in sync through the use of this algorithm. The end result is that it‚Äôs quite difficult to predict the Twitter handle using statistical analysis unlike some DGAs(Domain Generation Algorithm) without reverse-engineering the implant first which as we all know here may not be child‚Äôs play making it more resilient.</p>
<p>I hope I‚Äôve touched upon the basic concepts but I‚Äôd be happy to provide any additional technical details.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="20645.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-08-19T08:08:41Z" class="post-time">
August 19, 2020, 8:08am
</time>
<meta itemprop="dateModified" content="2020-08-19T08:08:41Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
