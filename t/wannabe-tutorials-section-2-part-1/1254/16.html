<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Wannabe Tutorials: Section 2 Part 1 - #16 by 0x00pf - Networking - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="I have talked to some people on IRC and have realized that my tutorials need some work. Thanks you for those who pointed out my errors and gave me suggestions. This tutorial, I hope, is better. Cheers. 

Recon
As I state&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../1254.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Wannabe Tutorials: Section 2 Part 1&#39;" href="../1254.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://0x00sec.org/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/wannabe-tutorials-section-2-part-1/1254/16" />
<meta name="twitter:url" content="https://0x00sec.org/t/wannabe-tutorials-section-2-part-1/1254/16" />
<meta property="og:title" content="Wannabe Tutorials: Section 2 Part 1" />
<meta name="twitter:title" content="Wannabe Tutorials: Section 2 Part 1" />
<meta property="og:description" content="Then FIN is the equivalent to the SYN flag for ordered disconnection. There is again a interchange of packets to ensure that whatever has been sent arrives to the destination. The wiki has a good general description https://en.wikipedia.org/wiki/Transmission_Control_Protocol#Connection_termination  A brief description of the use of FIN for port scanning can be found here:" />
<meta name="twitter:description" content="Then FIN is the equivalent to the SYN flag for ordered disconnection. There is again a interchange of packets to ensure that whatever has been sent arrives to the destination. The wiki has a good general description https://en.wikipedia.org/wiki/Transmission_Control_Protocol#Connection_termination  A brief description of the use of FIN for port scanning can be found here:" />
<meta property="og:article:section" content="Networking" />
<meta property="og:article:section:color" content="8C6238" />
<meta property="og:article:tag" content="recon" />
<meta property="og:article:tag" content="nmap" />
<meta property="og:article:tag" content="hacking" />
<meta property="article:published_time" content="2016-11-06T01:01:54+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="../1254.html">Wannabe Tutorials: Section 2 Part 1</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../../c/networking/63.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Networking</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../../tag/recon.html" class="discourse-tag" rel="tag">recon</a>,
<a href="../../../tag/nmap.html" class="discourse-tag" rel="tag">nmap</a>,
<a href="../../../tag/hacking.html" class="discourse-tag" rel="tag">hacking</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Wannabe Tutorials: Section 2 Part 1">
<meta itemprop="articleSection" content="Networking">
<meta itemprop="keywords" content="recon, nmap, hacking">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Valentine"><span itemprop="name">Valentine</span></a>
(Valentine)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-01T10:29:11Z" class="post-time">
November 1, 2016, 10:29am
</time>
<meta itemprop="dateModified" content="2016-11-03T15:11:30Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>I have talked to some people on IRC and have realized that my tutorials need some work. Thanks you for those who pointed out my errors and gave me suggestions. This tutorial, I hope, is better. Cheers.</p>
<hr>
<h1>Recon</h1>
<p>As I stated in <a href="../../wannabe-tutorials-section-1-part-4/1223.html">Section 1 Part 4</a> of my series, recon is probably the most important step of hacking. There are many techniques used, but in these tutorials I will only cover Scanners, specifically Port Scanners and Web Scanners.</p>
<p>By definition, Port Scanners are:</p>
<pre><code>"Application designed to probe a server or hosts for open ports."
</code></pre>
<p>The results of a scan on a port usually is categorized in one of three categories:</p>
<ul>
<li>
<strong>Open or Accepted:</strong> Host sent a reply that indicates that a service is listening on a port.</li>
<li>
<strong>Closed and/or Denied or Not Listening:</strong> Host sent a repy indicating that connections will be denied to the port.</li>
<li>
<strong>Filtered, Dropped, or Blocked:</strong> No reply from host or a Firewall (other security measures) is in place.</li>
</ul>
<p>In <code>nmap</code> there are many types of scans, but I’m only going to cover TCP, SYN, and UDP scans.</p>
<hr>
<h1>Types of Scans</h1>
<p>The simplest port scanners use the operating system’s network functions. <code>nmap</code> calls this a connect scan. In other words, if a port is open then the OS completes a TCP three-way-handshake, but afterwards the connection is closed to avoid a DoS attack.</p>
<p>A TCP three-way-handshake is when each device sends a SYN and an ACK (also known as a SYN-SYN-ACK). In normal sequence of a connection establishment, a SYN is sent by one device (<code>host a</code>). Once the SYN is received by the other device, <code>host b</code> sends a SYN-ACK. The SYN-ACK is received by <code>host a</code> and then host a sends a ACK. Once <code>host b</code> receives an ACK the TCP socket connection is established. A quick diagram is:</p>
<pre><code>host a ------ SYN ------&gt; host b
host a &lt;------ SYN-ACK ------ host b
host a ------ ACK ------&gt; host b
</code></pre>
<p>In <code>nmap</code>, the connect scan is as follows:</p>
<pre><code class="lang-auto">$ nmap -sT (Ip)
</code></pre>
<p>The problem with TCP scanning is that it’s noisy because services may log a sender’s IP address or an Intrusion Detection System may raise an alarm.</p>
<p>Thus, a SYN scan is often preferred. A SYN scan is a bit different. As with the TCP scan, a SYN scan first sends a SYN, but instead of a SYN-ACK returned only a ACK is actually returned. A quick diagram is:</p>
<pre><code>Client ------ SYN ------&gt; Server
Client &lt;------ ACK ------ Server
</code></pre>
<hr>
<p>A SYN (TCP SYN) scan is done in <code>nmap</code> using:</p>
<pre><code class="lang-auto">nmap -sS (Ip)
</code></pre>
<hr>
<p>The last scan type, UDP, is the trickiest. UDP is known as a connectionless protocol: when a packet is sent to a UDP port, that open port receives a packet, but the closed ports send a ICMP back. A quick diagram is:</p>
<pre><code>Client ------- Packet ------&gt; Server
Client &lt;------ ICMP ------- Server
</code></pre>
<p>In <code>nmap</code>, a UDP (UDP-ICMP) scan can be performed with this command:</p>
<pre><code class="lang-auto">nmap -sU (Ip)
</code></pre>
<p>The UDP scan is the only scan type that can be inserted with another scan type, for example, SYN scan:</p>
<pre><code class="lang-auto">nmap -sS -sU (Ip)
</code></pre>
<hr>
<h1>Conclusion</h1>
<p>Well, that’s it for this tutorial. I decided not to talk about the Web Scanners in this part because this tutorial was getting long, but I will have that tutorial up next. Please comment down below, as any suggestions are welcome, but please don’t flame me.</p>
<p>Cheers.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="7" />
<span class="post-likes">7 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-01T20:56:48Z" class="post-time">
November 1, 2016, 8:56pm
</time>
<meta itemprop="dateModified" content="2016-11-01T20:56:48Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Really really really enjoyed this overview <a class="mention" href="https://0x00sec.org/u/valentine">@Valentine</a>, I can really see you’ve done some research, and learnt a lot, and therefore put effort into this.</p>
<p>I actually learnt a lot from this, my understanding actually was wrong, and you’ve put me right <img src="../../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> I am so pleased you’ve done that. Also, I’ve never really 100% understood ICMP &amp; UDP, but you’ve really improved my understanding with your simple explanations! Good job!</p>
<p>PS: I would recommend placing this in the networking tutorial category since it is a lot about networking, right?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/kowalski"><span itemprop="name">kowalski</span></a>
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-02T10:31:00Z" class="post-time">
November 2, 2016, 10:31am
</time>
<meta itemprop="dateModified" content="2016-11-02T10:31:00Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>In your diagram for the three way handshake, host a should have the arrow pointed towards host b, since it is returning ack.</p>
<p>host a -------------ACK------------&gt; host b</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Valentine"><span itemprop="name">Valentine</span></a>
(Valentine)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-02T12:50:04Z" class="post-time">
November 2, 2016, 12:50pm
</time>
<meta itemprop="dateModified" content="2016-11-02T12:50:04Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Whoopsie daisy. I can fix that. XD</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Defalt"><span itemprop="name">Defalt</span></a>
(The Defalt)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-02T19:37:14Z" class="post-time">
November 2, 2016, 7:37pm
</time>
<meta itemprop="dateModified" content="2016-11-02T19:37:14Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I small note about SYN scans.</p>
<p>The server will always respond to a successful connection request with a SYN-ACK, it’s just the way TCP works. The reason the SYN scan works is because the attacker responds to a server with an RST packet, closing the connection before it’s actually established. This is why SYN scans are also known as half-open scans.</p>
<p>So, the diagram for a SYN scan would look like this…</p>
<pre><code>host a ------SYN-----&gt; host b
host a &lt;---SYN-ACK---- host b
host a ------RST-----&gt; host b
        Port is open
</code></pre>
<p>Otherwise, great write-up!</p>
<p>-Defalt</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="3" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-02T23:05:19Z" class="post-time">
November 2, 2016, 11:05pm
</time>
<meta itemprop="dateModified" content="2016-11-02T23:05:19Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group" data-username="Defalt" data-post="5" data-topic="1254">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/0x00sec.org/defalt/40/18_2.png" class="avatar"> Defalt:</div>
<blockquote>
<p>The reason the SYN scan works is because the attacker responds to a server with an RST packet, closing the connection before it’s actually established</p>
</blockquote>
</aside>
<p>AFAIK no port scanner sends a <code>RST</code> packet during the scan. Only the <code>SYN</code> packet is sent. What happens is that, as we are not calling <code>connect</code> the TCP/IP stack in the kernel does not know about any connection going on and it responds to the <em>unexpected</em> <code>SYN|ACK</code> packet with a <code>RST</code>, as it does for any unexpected packet.</p>
<p>To verify this you can easily write a simple program that sends one single <code>SYN</code> packet. Launch your preferred sniffer and run it against an open port (otherwise you just get a <code>RST</code> packet from the remote machine). You will see a <code>RST</code> packet in your sniffer trace even when your program is not sending it.</p>
<p>Then you can drop any outgoing <code>RST</code> packet in your machine (with a firewall rule) and your scan will still work.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Valentine"><span itemprop="name">Valentine</span></a>
(Valentine)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-02T23:57:33Z" class="post-time">
November 2, 2016, 11:57pm
</time>
<meta itemprop="dateModified" content="2016-11-02T23:57:33Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I used wikipedia so it could be wrong. Lmao. Sorry for the misshap.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Defalt"><span itemprop="name">Defalt</span></a>
(The Defalt)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/8/801d5f7b869d114e5b77f3c4b683712a4cad4a3d.gif">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-03T00:48:24Z" class="post-time">
November 3, 2016, 12:48am
</time>
<meta itemprop="dateModified" content="2016-11-03T00:48:24Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>It’s not that the attacker needs to send the packet, it’s that the victim needs to receive one. Due to TCP’s error checking/correction, if you did stop the outgoing RST packets, the victim will follow protocol and keep sending SYN-ACK packets until it gets a response or times out (if the port is open), this will effectively DoS the target, which is not the intended goal.</p>
<p>It doesn’t matter what the kernel thinks, the RST packet is sent so the victim machine doesn’t use up all it’s resources responding.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/8/801d5f7b869d114e5b77f3c4b683712a4cad4a3d.gif" width="389" height="140"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Valentine"><span itemprop="name">Valentine</span></a>
(Valentine)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-03T12:54:43Z" class="post-time">
November 3, 2016, 12:54pm
</time>
<meta itemprop="dateModified" content="2016-11-03T12:54:43Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p><em>“A SYN packet is sent (as if we are going to open a connection), and the target host responds with a SYN+ACK, this indicates the port is listening, and an RST indicates a non- listener. The server process is never informed by the TCP layer because the connection did not complete.”</em></p>
<p><a href="http://www.auditmypc.com/port-scanning.asp" class="onebox" target="_blank" rel="nofollow noopener">http://www.auditmypc.com/port-scanning.asp</a></p>
<p>I did a bit of research and this is what I found throughout the internet via google.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Valentine"><span itemprop="name">Valentine</span></a>
(Valentine)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-03T18:39:37Z" class="post-time">
November 3, 2016, 6:39pm
</time>
<meta itemprop="dateModified" content="2016-11-03T18:39:37Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Where is this going?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-03T21:28:32Z" class="post-time">
November 3, 2016, 9:28pm
</time>
<meta itemprop="dateModified" content="2016-11-03T21:28:32Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>To my knowledge, an RST flag is only sent in the event of an error, or in response to a socket close. RST stands for Reset, AKA Abort, quite like if you did a return 1 in a piece of C code, it would terminate the connection, although it isn’t the correct way to close it.</p>
<p>A FIN flag also exists; this is just like doing a return 0; it closes the connection stream, although is to communicate that no more data needs to be sent.</p>
<p>This is what Wikipedia mentions on TCP Reset Flags:</p>
<blockquote>
<p>In a stream of packets of a TCP connection, each packet contains a TCP header. Each of these headers contains a bit known as the “reset” (RST) flag. In most packets this bit is set to 0 and has no effect; however, if this bit is set to 1, it indicates to the receiving computer that the computer should immediately stop using the TCP connection; it should not send any more packets using the connection’s identifying numbers, called ports, and discard any further packets it receives with headers indicating they belong to that connection. A TCP reset basically kills a TCP connection instantly.</p>
</blockquote>
<blockquote>
<p>When used as designed, this can be a useful tool. One common application is the scenario where a computer (computer A) crashes while a TCP connection is in progress. The computer on the other end (computer B) will continue to send TCP packets since it does not know that computer A has crashed. When computer A reboots, it will then receive packets from the old pre-crash connection. Computer A has no context for these packets and no way of knowing what to do with them, so it might send a TCP reset to computer B. This reset lets computer B know that the connection is no longer working. The user on computer B can now try another connection or take other action.</p>
</blockquote>
<p>I think you may be referring to a TCP reset attack, which is, in essence, the opposite of what you’ve said: where you flood a machine with RST packets; and therefore kill any connection established, or any connection attempting to create itself.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_13" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-05T11:08:45Z" class="post-time">
November 5, 2016, 11:08am
</time>
<meta itemprop="dateModified" content="2016-11-05T11:08:45Z">
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Have we established a full answer yet? Does anybody agree with my explanation, or is <a class="mention" href="https://0x00sec.org/u/defalt">@Defalt</a> correct.</p>
<p>I’m glad we have a forum of discussion like this, and are able to have these discussions objectively.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_14" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-05T13:22:39Z" class="post-time">
November 5, 2016, 1:22pm
</time>
<meta itemprop="dateModified" content="2016-11-05T13:22:39Z">
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Summing up:</p>
<ul>
<li>In order to know the state of the port (Open|Close|Filtered) you do not need to send a <code>RST</code> packet. You will know the state when you get the first packet from the remote machine, independently of sending an extra <code>RST</code> or not.</li>
</ul>
<ul>
<li>If a <code>SYN|ACK</code> packet is received the port is <strong>OPEN</strong>
</li>
<li>if a <code>RST</code> or an <code>ICMP</code> error message is received, the port is <strong>CLOSED</strong>
</li>
<li>If nothing is received, the port is <strong>FILTERED</strong>
</li>
</ul>
<ul>
<li>
<code>nmap</code> does not send an <code>RST</code> packet as part of a <code>SYN</code> scan (just <code>strace</code> it).</li>
<li>Your sniffer will show an <code>RST</code> packet coming from the attacker machine, when scanning an Open Port. That packet is generated by the kernel in response to a <code>SYN|ACK</code> from the remote machine that is not associated to any on-going TCP connection.</li>
<li>Even when sending the <code>RST</code> packet is not really needed, it is a good practice to close the connection. This will happen automatically because of the previous point (the kernel will send the <code>RST</code>). In other words, sending a <code>RST</code> packet from the port scanner program is just redundant.</li>
<li>In a default Linux configuration, the <code>SYN|ACK</code> packet will be re-send up to 5 times with an increasing time-out, something like 1, 3, 6, 12, 24 seconds. This will happen if the <code>RST</code> packet is not sent to the target machine. In general, you will get 5 bursts of data that will be smaller than the original burst produced by the scanning itself… Because you will just get this packets back only from the open ports. The closed ones will not produce any re-send. If you can be DoSed by this you will also be DoS by the simple fact of running a scan. Nevertheless, not sending the <code>RST</code> packet is just dirty and a waste of resources more than a threat. And, as we have seen, it will only happen if you explicitly block them.</li>
</ul>
<ul>
<li>You really need to scan a big network with a lot of hosts up and a lot of open ports in each host to get something back that can be considered a DoS… (A <code>SYN|ACK</code> packet is 44 bytes long).</li>
</ul>
<p>This is how it works for a Linux box. For other system it may be different. Based on what is said above you can try and report back if something works differently in your system.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="4" />
<span class="post-likes">4 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_15" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/pry0cc"><span itemprop="name">pry0cc</span></a>
(Leader &amp; Offsec Engineer &amp; Forum Daddy)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-05T21:51:28Z" class="post-time">
November 5, 2016, 9:51pm
</time>
<meta itemprop="dateModified" content="2016-11-05T21:51:28Z">
<span itemprop="position">15</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Very nice! That has made me understand a hell of a lot more!!</p>
<p>So what about Sending a <code>FIN</code> packet? Is that used for an entirely different scenario as well?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_16" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/0x00pf"><span itemprop="name">0x00pf</span></a>
(pico)
</span>
<link itemprop="mainEntityOfPage" href="../1254.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2016-11-06T01:01:54Z" class="post-time">
November 6, 2016, 1:01am
</time>
<meta itemprop="dateModified" content="2016-11-06T01:01:54Z">
<span itemprop="position">16</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Then <code>FIN</code> is the equivalent to the <code>SYN</code> flag for ordered disconnection. There is again a interchange of packets to ensure that whatever has been sent arrives to the destination. The wiki has a good general description <a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol#Connection_termination" rel="nofollow noopener">https://en.wikipedia.org/wiki/Transmission_Control_Protocol#Connection_termination</a></p>
<p>A brief description of the use of <code>FIN</code> for port scanning can be found here:</p>
<aside class="quote quote-modified" data-post="1" data-topic="619">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../../user_avatar/0x00sec.org/0x00pf/40/199_2.png" class="avatar">
<a href="../../how-do-those-hacking-tools-work-the-art-of-port-scanning/619.html">How do those hacking tools work? The Art of Port Scanning</a> <a class="badge-wrapper  bullet" href="../../../c/networking/63.html"><span class="badge-category-bg" style="background-color: #8C6238;"></span><span style data-drop-close="true" class="badge-category clear-badge">Networking</span></a>
</div>
<blockquote>
LEVEL: Beginner
Port scanning is the process of finding out which ports are open in a given machine. An open port usually means a program listening on that port, and a program means bugs, and bugs means exploits… roughly :).
OK, everybody in the world uses nmap for this task. It would be stupid to write your own port scanner when such an advanced and polished tool is available. However, knowing how nmap does its magic and also, why not?, write your own simple scanner just for fun, are two valu…
</blockquote>
</aside>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
