<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>[VulnHub] Troll: 1 - Solution - CTF - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="This is my solution to the Tr0ll: 1 challenge by Maleus. The challenge and his webpage can be found here: 
https://www.vulnhub.com/entry/tr0ll-1,100/ 

Tr0ll was inspired by the constant trolling of the machines within t&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="5963.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;[VulnHub] Troll: 1 - Solution&#39;" href="5963.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/d/d6f8780acfc9670ec9fcb01c7e5691f4223a0953.jpeg" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/d/d6f8780acfc9670ec9fcb01c7e5691f4223a0953.jpeg" />
<meta property="og:url" content="https://0x00sec.org/t/vulnhub-troll-1-solution/5963" />
<meta name="twitter:url" content="https://0x00sec.org/t/vulnhub-troll-1-solution/5963" />
<meta property="og:title" content="[VulnHub] Troll: 1 - Solution" />
<meta name="twitter:title" content="[VulnHub] Troll: 1 - Solution" />
<meta property="og:description" content="This is my solution to the Tr0ll: 1 challenge by Maleus. The challenge and his webpage can be found here:     Tr0ll was inspired by the constant trolling of the machines within the OSCP labs.    The goal is simple, gain root and get Proof.txt from the /root directory.    Not for the easily frustrated! Fair warning, there be trolls ahead!   Details After locating the IP address of the target machine on our virtual network (we were not provided with login or networking information), I added the ad..." />
<meta name="twitter:description" content="This is my solution to the Tr0ll: 1 challenge by Maleus. The challenge and his webpage can be found here:     Tr0ll was inspired by the constant trolling of the machines within the OSCP labs.    The goal is simple, gain root and get Proof.txt from the /root directory.    Not for the easily frustrated! Fair warning, there be trolls ahead!   Details After locating the IP address of the target machine on our virtual network (we were not provided with login or networking information), I added the ad..." />
<meta property="og:article:section" content="CTF" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="og:article:tag" content="linux" />
<meta property="og:article:tag" content="ctf" />
<meta property="og:article:tag" content="webhacking" />
<meta property="og:article:tag" content="vulnhub" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="8 ❤" />
<meta property="article:published_time" content="2018-03-22T04:46:01+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="5963.html">[VulnHub] Troll: 1 - Solution</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/ctf/55.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F1592A"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">CTF</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
<div class="topic-category">
<div class="discourse-tags list-tags">
<a href="../../tag/linux.html" class="discourse-tag" rel="tag">linux</a>,
<a href="../../tag/ctf.html" class="discourse-tag" rel="tag">ctf</a>,
<a href="../../tag/webhacking.html" class="discourse-tag" rel="tag">webhacking</a>,
<a href="../../tag/vulnhub.html" class="discourse-tag" rel="tag">vulnhub</a>
</div>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="[VulnHub] Troll: 1 - Solution">
<meta itemprop="articleSection" content="CTF">
<meta itemprop="keywords" content="linux, ctf, webhacking, vulnhub">
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/johnmarston"><span itemprop="name">johnmarston</span></a>
(John Marston)
</span>
<link itemprop="mainEntityOfPage" href="5963.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/d/d6f8780acfc9670ec9fcb01c7e5691f4223a0953.jpeg">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-03-22T04:46:01Z" class="post-time">
March 22, 2018, 4:46am
</time>
<meta itemprop="dateModified" content="2020-07-06T22:49:16Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>This is my solution to the Tr0ll: 1 challenge by Maleus. The challenge and his webpage can be found here:</p>
<aside class="onebox allowlistedgeneric">
<header class="source">
<img src="https://www.vulnhub.com/static/img/favicon.ico" class="site-icon" width="64" height="64">
<a href="https://www.vulnhub.com/entry/tr0ll-1,100/" target="_blank" rel="noopener nofollow ugc">vulnhub.com</a>
</header>
<article class="onebox-body">
<div class="aspect-image" style="--aspect-ratio:666/500;"><img src="https://0x00sec.s3.amazonaws.com/original/3X/6/5/65cf04159507378462c5316707b264a32b2a4b5c.png" class="thumbnail" width="666" height="500" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/3X/6/5/65cf04159507378462c5316707b264a32b2a4b5c_2_10x10.png"></div>
<h3><a href="https://www.vulnhub.com/entry/tr0ll-1,100/" target="_blank" rel="noopener nofollow ugc">Tr0ll: 1</a></h3>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<blockquote>
<p>Tr0ll was inspired by the constant trolling of the machines within the OSCP labs.</p>
</blockquote>
<blockquote>
<p>The goal is simple, gain root and get Proof.txt from the /root directory.</p>
</blockquote>
<blockquote>
<p>Not for the easily frustrated! Fair warning, there be trolls ahead!</p>
</blockquote>
<h2>Details</h2>
<p>After locating the IP address of the target machine on our virtual network (we were not provided with login or networking information), I added the address to my <code>/etc/hosts</code> to prevent from having to keep typing out the entire IP.</p>
<pre><code class="lang-auto">    Currently scanning: Finished!   |   Screen View: Unique Hosts                 
                                                                               
    4 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 240               
    _____________________________________________________________________________
    IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
    -----------------------------------------------------------------------------
    192.168.171.1   00:50:56:c0:00:08      1      60  VMware, Inc.                
    192.168.171.2   00:50:56:fe:d9:5a      1      60  VMware, Inc.                
    192.168.171.133 00:0c:29:29:73:49      1      60  VMware, Inc.                
    192.168.171.254 00:50:56:f0:f5:0a      1      60  VMware, Inc.                

    root@kali:~/troll# echo "192.168.171.133 troll" &gt;&gt; /etc/hosts
</code></pre>
<p>Now that we have that out of the way, let’s start with an NMAP scan to get some more information.</p>
<pre><code class="lang-auto">    root@kali:~/troll# nmap -Pn -sT -A -p- -T4 troll
    
    Starting Nmap 7.31 ( https://nmap.org ) at 2017-01-03 00:56 CST
    Nmap scan report for troll (192.168.171.133)
    Host is up (0.00026s latency).
    Not shown: 65532 closed ports
    PORT   STATE SERVICE VERSION
    21/tcp open  ftp     vsftpd 3.0.2
    | ftp-anon: Anonymous FTP login allowed (FTP code 230)
    |_-rwxrwxrwx    1 1000     0            8068 Aug 09  2014 lol.pcap [NSE: writeable]
    22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)
    | ssh-hostkey: 
    |   1024 d6:18:d9:ef:75:d3:1c:29:be:14:b5:2b:18:54:a9:c0 (DSA)
    |   2048 ee:8c:64:87:44:39:53:8c:24:fe:9d:39:a9:ad:ea:db (RSA)
    |_  256 0e:66:e6:50:cf:56:3b:9c:67:8b:5f:56:ca:ae:6b:f4 (ECDSA)
    80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))
    | http-robots.txt: 1 disallowed entry 
    |_/secret
    |_http-server-header: Apache/2.4.7 (Ubuntu)
    |_http-title: Site doesn't have a title (text/html).
    MAC Address: 00:0C:29:29:73:49 (VMware)
    No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
    
    Network Distance: 1 hop
    Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
    
    TRACEROUTE
    HOP RTT     ADDRESS
    1   0.26 ms troll (192.168.171.133)
</code></pre>
<p>We have FTP (with anonymous login enabled), SSH, and an Apache web server. We don’t have very much to go off of so let’s start with the web server.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/2X/d/d6f8780acfc9670ec9fcb01c7e5691f4223a0953.jpeg" data-download-href="/uploads/short-url/uFIwiedcVaKvWRrbMZIVaTxTNth.jpeg?dl=1" title="Pic" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/2X/d/d6f8780acfc9670ec9fcb01c7e5691f4223a0953.jpeg" alt="Alt" title="Pic" data-base62-sha1="uFIwiedcVaKvWRrbMZIVaTxTNth" width="690" height="350" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/2X/d/d6f8780acfc9670ec9fcb01c7e5691f4223a0953_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">Pic</span><span class="informations">962×489 40.6 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p>Staying true to its name, the web server immediately presents us with a troll. Nothing in the source, looks like a dead end to me. Let’s check out the <code>/secret</code> directory that NMAP picked up.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/2X/0/0bf0c6d2bdfe2c3c0302bdb04c94ef50d0fcee12.jpeg" data-download-href="/uploads/short-url/1HD73lP0hmQQMGYJ5HbZxzG39Bg.jpeg?dl=1" title="Pic2" rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/2X/0/0bf0c6d2bdfe2c3c0302bdb04c94ef50d0fcee12.jpeg" alt="Alt" title="Pic2" data-base62-sha1="1HD73lP0hmQQMGYJ5HbZxzG39Bg" width="690" height="329" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/2X/0/0bf0c6d2bdfe2c3c0302bdb04c94ef50d0fcee12_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">Pic2</span><span class="informations">1166×557 45.3 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p>No surprise here…At this point, I tried to search for data hidden in the images but I found nothing useful. Web server seems like a dead end for now, so I’m going to check out that FTP server. After logging with with <code>anonymous:pass </code>, I see that there is a pcap file for us to download.</p>
<pre><code class="lang-auto">    root@kali:~/troll# ftp
    ftp&gt; open
    (to) troll
    Connected to troll.
    220 (vsFTPd 3.0.2)
    Name (troll:root): anonymous
    331 Please specify the password.
    Password:
    230 Login successful.
    Remote system type is UNIX.
    Using binary mode to transfer files.
    ftp&gt; ls
    200 PORT command successful. Consider using PASV.
    150 Here comes the directory listing.
    -rwxrwxrwx    1 1000     0            8068 Aug 09  2014 lol.pcap
</code></pre>
<p>I download the pcap file and throw it into Wireshark. After skimming over the capture, I notice a file named <code>secret_stuff.txt</code>. Looking down a little further, I notice that this file was downloaded and the data is readily available to read.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/2X/1/1aa638512382918f75d220429756659cf271f7f3.jpeg" data-download-href="/uploads/short-url/3NKxpAdXWyiHZlAcCe9fk10ARIT.jpeg?dl=1" title rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/optimized/2X/1/1aa638512382918f75d220429756659cf271f7f3_2_690x164.jpeg" alt data-base62-sha1="3NKxpAdXWyiHZlAcCe9fk10ARIT" width="690" height="164" srcset="https://0x00sec.s3.amazonaws.com/optimized/2X/1/1aa638512382918f75d220429756659cf271f7f3_2_690x164.jpeg, https://0x00sec.s3.amazonaws.com/optimized/2X/1/1aa638512382918f75d220429756659cf271f7f3_2_1035x246.jpeg 1.5x, https://0x00sec.s3.amazonaws.com/optimized/2X/1/1aa638512382918f75d220429756659cf271f7f3_2_1380x328.jpeg 2x" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/2X/1/1aa638512382918f75d220429756659cf271f7f3_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename"></span><span class="informations">1667×397 136 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div><br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/2X/e/e0a50f26381ed54221316410f86b02d5ee7068c8.jpeg" data-download-href="/uploads/short-url/w3iADWtsIGeaewrDZl1dhoCnZ1K.jpeg?dl=1" title rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/2X/e/e0a50f26381ed54221316410f86b02d5ee7068c8.jpeg" alt data-base62-sha1="w3iADWtsIGeaewrDZl1dhoCnZ1K" width="690" height="151" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/2X/e/e0a50f26381ed54221316410f86b02d5ee7068c8_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename"></span><span class="informations">1135×249 20 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p>After scratching my head over this message for probably far too long, I finally figure out that this is a directory on the web server. I copy and paste it into my browser and finally make some progress!</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/2X/7/7cf4348385ba5e2e5fce1a4416ff20f21bcc3659.jpeg" data-download-href="/uploads/short-url/hPopDb12GXRooiDgW8CDfpzUUVr.jpeg?dl=1" title rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/2X/7/7cf4348385ba5e2e5fce1a4416ff20f21bcc3659.jpeg" alt data-base62-sha1="hPopDb12GXRooiDgW8CDfpzUUVr" width="690" height="302" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/2X/7/7cf4348385ba5e2e5fce1a4416ff20f21bcc3659_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename"></span><span class="informations">758×332 24.3 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p>Here we have some kind of file named <code>roflmao</code>. I download it and run the <code>file</code> command on it, it is a 32-bit executable. Upon running it, we get this message</p>
<blockquote>
<p>Find address 0x0856BF to proceed</p>
</blockquote>
<p>My first instinct is to start digging into the executable itself. I run <code>objdump</code> on the file but discover that 0x0856BF is too high of a memory address and isn’t found within the binary.</p>
<pre><code class="lang-auto">    root@kali:~/troll# objdump -d roflmao 
    
    roflmao:     file format elf32-i386
    
    0804841d &lt;main&gt;:
    
    804841d:	55                   	push   %ebp
    
    804841e:	89 e5                	mov    %esp,%ebp
    
    8048420:	83 e4 f0             	and    $0xfffffff0,%esp
    
    8048423:	83 ec 10             	sub    $0x10,%esp
    
    8048426:	c7 04 24 d0 84 04 08 	movl   $0x80484d0,(%esp)
    
    804842d:	e8 be fe ff ff       	call   80482f0 &lt;printf@plt&gt;
    
    8048432:	c9                   	leave  
    
    8048433:	c3                   	ret    
    
    8048434:	66 90                	xchg   %ax,%ax
    
    8048436:	66 90                	xchg   %ax,%ax
    
    8048438:	66 90                	xchg   %ax,%ax
    
    804843a:	66 90                	xchg   %ax,%ax
    
    804843c:	66 90                	xchg   %ax,%ax
    
    804843e:	66 90                	xchg   %ax,%ax
</code></pre>
<p>Instead of wasting anymore time on that route, I write it off as a dead end and decide to try what worked before; check to see if it’s a directory. I copy and paste that address into my browser and we get a hit!</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/2X/3/30f5034b7ee8dd99143d85c456a9d9da752d9e7a.jpeg" data-download-href="/uploads/short-url/6Z5R5n2d2PXoDM7zniR9vZzGHSW.jpeg?dl=1" title rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/2X/3/30f5034b7ee8dd99143d85c456a9d9da752d9e7a.jpeg" alt data-base62-sha1="6Z5R5n2d2PXoDM7zniR9vZzGHSW" width="690" height="268" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/2X/3/30f5034b7ee8dd99143d85c456a9d9da752d9e7a_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename"></span><span class="informations">782×304 25.9 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div><br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/0/05d357352f2dc2d33b6ab227ad921b68e7c361f4.jpeg" alt data-base62-sha1="PxbjYXzXtl1ywo7ZytajHv49DK" width="626" height="234"><br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/a/a0325518858acb353998c3772445e6e7a93600e2.jpeg" alt data-base62-sha1="mRaenCVj7wVoBxsuPCKMOhyuOau" width="641" height="84"></p>
<p>We are presented with two directories, one containing what appears to be a list of usernames and one containing what appears to be a password for one of those usernames. I’m gonna guess that these usernames and password are for the SSH. So, after lots of trial and error I discover that the password located in <code>Pass.txt</code> is NOT the correct password. The password is in fact…“Pass.txt” (silly me, what was i thinking).</p>
<p>The correct login information is <code>overflow:Pass.txt</code>. We have shell access! Now we can really start poking around <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p><span alt class="broken-image" title="This image is broken"><svg class="fa d-icon d-icon-unlink svg-icon" aria-hidden="true"><use xlink:href="#unlink"></use></svg></span></p>
<p>Remember, the goal here is to obtain root level privileges so we can read the flag located in the /root directory. After poking around for a bit, I don’t find any files that are particularly interesting, ran into lots of dead ends. I finally decided to check the exact kernel release and version of the target system. Running <code>uname -a</code> gives us: <code>Linux troll 3.13.0-32-generic #57-Ubuntu SMP Tue Jul 15 03:51:12 UTC 2014 i686 i686 i686 GNU/Linux</code></p>
<p>Before diving any further into the filesystem to try and enumerate vulnerable processes, I decide to start with the kernel itself. Utilizing <code>searchsploit</code>, I discover that Ubuntu versions 12.04, 14.04, 14.10, and 15.04 that are running the Linux Kernel 3.13.0 - 3.19 are vulnerable to a local root exploit. If you care to read the exact workings of the exploit, which I recommend you do, it can be found here:<br>
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1328" rel="noopener nofollow ugc">Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - ‘overlayfs’ Privilege Escalation</a></p>
<p>Let’s see if we can get this working! Since I have the exploit on my Kali machine, I spin up a simple web server and download the source code of the exploit over to the target system using <code>wget</code>. Next, I compile the c file into an executable and run it. Let’s see what we get…<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://0x00sec.s3.amazonaws.com/original/2X/1/10be1d688d1b1a799199bff0b1506649b2215dfd.jpeg" data-download-href="/uploads/short-url/2o6Xrw8VJmJNRWqYpJQT5GSGlNX.jpeg?dl=1" title rel="noopener nofollow ugc"><img src="https://0x00sec.s3.amazonaws.com/original/2X/1/10be1d688d1b1a799199bff0b1506649b2215dfd.jpeg" alt data-base62-sha1="2o6Xrw8VJmJNRWqYpJQT5GSGlNX" width="675" height="500" data-small-upload="https://0x00sec.s3.amazonaws.com/optimized/2X/1/10be1d688d1b1a799199bff0b1506649b2215dfd_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename"></span><span class="informations">736×545 67.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p>We have successfully obtained root and captured the flag! Quite a frustrating challenge, but very satisfying.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="6" />
<span class="post-likes">6 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/alioo"><span itemprop="name">alioo</span></a>
</span>
<link itemprop="mainEntityOfPage" href="5963.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-03-23T11:27:17Z" class="post-time">
March 23, 2018, 11:27am
</time>
<meta itemprop="dateModified" content="2018-03-23T11:27:17Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>nice walkthrough <img src="../../images/emoji/twitter/+1.png%3Fv=9" title=":+1:" class="emoji" alt=":+1:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/johnmarston"><span itemprop="name">johnmarston</span></a>
(John Marston)
</span>
<link itemprop="mainEntityOfPage" href="5963.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-03-23T18:08:08Z" class="post-time">
March 23, 2018, 6:08pm
</time>
<meta itemprop="dateModified" content="2018-03-23T18:08:08Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks for reading, glad you enjoyed it!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/anon79434934"><span itemprop="name">anon79434934</span></a>
</span>
<link itemprop="mainEntityOfPage" href="5963.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-03-25T14:07:29Z" class="post-time">
March 25, 2018, 2:07pm
</time>
<meta itemprop="dateModified" content="2018-03-25T14:07:29Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I am really liking these Vulnhub challenges, finally something else other than RE.</p>
<p>Viva la revolucion!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="5963.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2018-04-21T04:46:14Z" class="post-time">
April 21, 2018, 4:46am
</time>
<meta itemprop="dateModified" content="2018-04-21T04:46:14Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
