<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Watcher - mapping addressable security cameras - a devlog - Programming - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Hello all. 
I thought I’d tell you a little about a side-project I’ve been working on, now that it is starting to take shape. It is still far from complete but I thought I’d share its development with 0x00sec. 
We all kn&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="14650.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Watcher - mapping addressable security cameras - a devlog&#39;" href="14650.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/6/6e4857a950e1f7b9d4f31109037409b930b82355.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/6/6e4857a950e1f7b9d4f31109037409b930b82355.png" />
<meta property="og:url" content="https://0x00sec.org/t/watcher-mapping-addressable-security-cameras-a-devlog/14650" />
<meta name="twitter:url" content="https://0x00sec.org/t/watcher-mapping-addressable-security-cameras-a-devlog/14650" />
<meta property="og:title" content="Watcher - mapping addressable security cameras - a devlog" />
<meta name="twitter:title" content="Watcher - mapping addressable security cameras - a devlog" />
<meta property="og:description" content="Hello all.  I thought I’d tell you a little about a side-project I’ve been working on, now that it is starting to take shape. It is still far from complete but I thought I’d share its development with 0x00sec.  We all know that the mythical Internet Of Things has been on the rise and that people make all kinds of interesting things publically addressable. Security cameras are one of them and for several years I have been wanting to write something that does the heavy lifting of finding them, pla..." />
<meta name="twitter:description" content="Hello all.  I thought I’d tell you a little about a side-project I’ve been working on, now that it is starting to take shape. It is still far from complete but I thought I’d share its development with 0x00sec.  We all know that the mythical Internet Of Things has been on the rise and that people make all kinds of interesting things publically addressable. Security cameras are one of them and for several years I have been wanting to write something that does the heavy lifting of finding them, pla..." />
<meta property="og:article:section" content="Programming" />
<meta property="og:article:section:color" content="92278F" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="5 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="74 ❤" />
<meta property="article:published_time" content="2019-06-28T12:18:44+00:00" />
<meta property="og:ignore_canonical" content="true" />
<link rel="next" href="14650%3Fpage=2.html">
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="14650.html">Watcher - mapping addressable security cameras - a devlog</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/programming/61.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #92278F"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Programming</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Watcher - mapping addressable security cameras - a devlog">
<meta itemprop="articleSection" content="Programming">
<meta itemprop="keywords" content>
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hostile.node"><span itemprop="name">hostile.node</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/6/6e4857a950e1f7b9d4f31109037409b930b82355.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-28T12:18:44Z" class="post-time">
June 28, 2019, 12:18pm
</time>
<meta itemprop="dateModified" content="2019-06-28T12:18:44Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Hello all.</p>
<p>I thought I’d tell you a little about a side-project I’ve been working on, now that it is starting to take shape. It is still far from complete but I thought I’d share its development with 0x00sec.</p>
<p>We all know that the mythical Internet Of Things has been on the rise and that people make all kinds of interesting things publically addressable. Security cameras are one of them and for several years I have been wanting to write something that does the heavy lifting of finding them, places them on a map and if possible, streams them.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/6/6e4857a950e1f7b9d4f31109037409b930b82355.png" alt="36" data-base62-sha1="fJBvUrRFPjVPdbrSoGaAlqedYAR" width="690" height="389"></p>
<h1>The technology stack</h1>
<p>There were a couple of things I wanted when I started building this:</p>
<ul>
<li>The program should be able to run locally, rather than as a webservice.</li>
<li>It should run on both Windows and Linux.</li>
<li>Should be extensible, as we aren’t looking at a static environment.</li>
</ul>
<p>For portability, Watcher is written in C++11. As there is a limit to how much of the wheel I’m willing to re-invent, <a href="https://www.libsdl.org/" rel="noopener nofollow ugc">SDL (Simple DirectMedia Layer)</a> provides cross-platform window creation, OpenGL initialisation, input handling and a few other things. Layering on top of SDL and OpenGL, <a href="https://github.com/ocornut/imgui" rel="noopener nofollow ugc">ImGui</a> is used to create the user interface while keeping the bloat low. For data management, <a href="https://sqlite.org/index.html" rel="noopener nofollow ugc">SQLite</a> handles storing and retrieving data from a database local to the program, which requires no “real” database service to have to be installed. The much beloved <a href="https://curl.haxx.se/" rel="noopener nofollow ugc">cURL</a> is used to interact with HTTP servers and finally, a JSON library serialises configuration files (such as rule sets) and messages between individual plugins.</p>
<p>Further building up on this, the map is built using tiles from a remote server: currently <a href="https://stamen.com/" rel="noopener nofollow ugc">Stamen</a>, but most <a href="https://wiki.openstreetmap.org/wiki/Tile_servers" rel="noopener nofollow ugc">tile servers</a> which used the same specification as <a href="https://wiki.openstreetmap.org" rel="noopener nofollow ugc">OpenStreetMap</a> can be used.</p>
<p>Geolocation is handled by <a href="http://ipinfo.io" rel="noopener nofollow ugc">ipinfo.io</a>, using their public API. This is rate limited to 1000 requests a day, but Watcher will just store the addresses which need to be resolved and try again later.</p>
<h1>The current state</h1>
<p>The plugin architecture is now working properly, allowing new components to be added without considerable overhead. The most basic way of finding cameras has been implemented: a simple multi-threaded portscanner scans the internet for webservers on certain ports (80, 81, 8000) and then forwards any results to a plugin which tries to identify if a webpage contains a camera or not, based on a growing ruleset. The vast majority of cameras have specific titles on their pages which makes this less of a faff than it would be otherwise.</p>
<p>Once a camera has been identified, the IP address is sent to the geolocation plugin so it can be represented on our map.</p>
<h1>Increasing coverage</h1>
<p>Obviously, scanning the entire internet takes a while. Quite a while, particularly if you’re thinking on being thorough and increasing the number of ports to scan for! Even using something like <a href="https://github.com/robertdavidgraham/masscan/" rel="noopener nofollow ugc">masscan</a>, you’d need a fairly fat pipe and a serious router. So, there are two additional plugins in the pipeline: one which will leverage Shodan, another which will use Google with specially targetted search terms.</p>
<h1>Next in the pipeline</h1>
<p>The map is currently quite basic. The user can scroll around, zoom in/out and see the camera markers, but can’t select them. The tile streaming is also a bit flakey and it’s possible for a tile which is in use to be unloaded, only to get loaded again a few seconds later. It isn’t great work and I could take some shortcuts to get the entire flow running sooner, but since I have no time constraints I can build a solid foundation and get something I’m happy with.</p>
<h1>Source?</h1>
<p>Open source, of course. You’ll find the code in the <a href="https://gitlab.com/hostile.node/watcher" rel="noopener nofollow ugc">project’s GitLab</a>. At the moment it only successfully builds on Windows, I need to spend some time wrangling the makefile <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<h1>Further posts?</h1>
<p>Do you find this kind of development post useful or interesting? Or would you rather just have a post when the tool is ready?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="31" />
<span class="post-likes">31 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
<div class="crawler-linkback-list" itemscope itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a itemprop="url" href="../0x00sec-2019-year-end-review-year-0x04/18391.html">0x00sec 2019 Year End Review - Year 0x04</a>
<meta itemprop="position" content="11">
</div>
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/messede"><span itemprop="name">messede</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-28T15:32:00Z" class="post-time">
June 28, 2019, 3:32pm
</time>
<meta itemprop="dateModified" content="2019-06-28T15:32:00Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hey there , great idea by the way , best wishes on developing the tool</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Baud"><span itemprop="name">Baud</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-28T16:58:06Z" class="post-time">
June 28, 2019, 4:58pm
</time>
<meta itemprop="dateModified" content="2019-06-28T16:58:06Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This project is very, very interesting, and so is the development post, I love finding out the underlying technologies of a program without having to dig through hundreds of files myself, but I guess I’ll be doing that anyway because I’m really curious to see the code and I need more exposure to C++11. Still, great job and good luck with this! Keep us updated.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_4" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/wntrmut"><span itemprop="name">wntrmut</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-28T20:29:53Z" class="post-time">
June 28, 2019, 8:29pm
</time>
<meta itemprop="dateModified" content="2019-06-28T20:29:53Z">
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Neat project, have you considered adding <a href="http://insecam.org" rel="nofollow noopener">insecam.org</a> to your coverage? It’s very similar in concept.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hostile.node"><span itemprop="name">hostile.node</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-29T07:18:38Z" class="post-time">
June 29, 2019, 7:18am
</time>
<meta itemprop="dateModified" content="2019-06-29T07:18:38Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks Baud! By all means, dig into it. The program is not particularly large and after some refactoring it is fairly well structured. Shout if you have any questions.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hostile.node"><span itemprop="name">hostile.node</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-29T07:27:15Z" class="post-time">
June 29, 2019, 7:27am
</time>
<meta itemprop="dateModified" content="2019-06-29T07:27:15Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks for the link. I had thought about it, but ended up deciding against it. Those websites use similar methodologies to gather their data, so I would rather spend time extending my rulesets. This should also require less maintenance, as the plugins I’m making use published APIs, rather than the more fragile alternative of scraping websites.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/cuckkoo"><span itemprop="name">cuckkoo</span></a>
(cuckkoo)
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-29T07:56:44Z" class="post-time">
June 29, 2019, 7:56am
</time>
<meta itemprop="dateModified" content="2019-06-29T07:56:44Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I’m excited, Please do tell when you’re done.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/zhihuiyuze"><span itemprop="name">zhihuiyuze</span></a>
(智慧雨泽)
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-06-30T12:34:33Z" class="post-time">
June 30, 2019, 12:34pm
</time>
<meta itemprop="dateModified" content="2019-06-30T12:34:33Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hope to have a tutorial</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/messede"><span itemprop="name">messede</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-02T14:34:49Z" class="post-time">
July 2, 2019, 2:34pm
</time>
<meta itemprop="dateModified" content="2019-07-02T14:34:49Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>i am not asking you to overload the tools capabilities, but i had to ask if you were going to include some known vulnerabilities or IOC’s , so that your are not just finding the cameras but , you have a view of vunerable ones , is this in the projects scope</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hostile.node"><span itemprop="name">hostile.node</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-02T19:00:58Z" class="post-time">
July 2, 2019, 7:00pm
</time>
<meta itemprop="dateModified" content="2019-07-02T19:00:58Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>It is in the project’s scope, and is part of why this program runs locally, as well as being one of the reasons for the plugin architecture it uses. Once I have the core in place, I’m planning on getting my hands on a few vulnerable models, set them up locally and assembling some plugins to target them. This is medium term though, still have a fair bit to do.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hostile.node"><span itemprop="name">hostile.node</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/f/f6204efe37074ce81c00cbe8c4e0a4e7cfdb7ad5.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-05T12:15:33Z" class="post-time">
July 5, 2019, 12:15pm
</time>
<meta itemprop="dateModified" content="2019-07-05T14:12:37Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<h2>Creating a Google Search plugin</h2>
<p>One of the historic ways of finding security cameras is via search engines: badly configured cameras are both publically addressable and often picked up by a trawling search engine. This has benefits over port-scanning, as we’d be looking into scanning the entire IPv4 address space - doable, but the ability of running e.g. masscan at full speed is beyond most of us.</p>
<p>Thankfully over the years people have created a substantial corpus of search queries to feed into Google which identify cameras from various manufacturers, mostly due the pages either having URLs which follow certain patterns or static titles.</p>
<p>Scraping results from Google is not a trivial task as it has various systems in place to prevent automated crawling, but they do provide an API we can make use of. The Custom Search Engine API can be used for free (rate limited to 10000 queries/day) and although intended to provide Google’s search within a certain domain / set of domains, it can be convinced to provide unrestricted searching capabilities.</p>
<p>In short, the steps are:</p>
<ul>
<li>Create a Custom Search Engine (<a href="https://developers.google.com/custom-search/v1/introduction" rel="noopener nofollow ugc">https://developers.google.com/custom-search/v1/introduction</a>).</li>
<li>When creating the CSE, set it to a non-existing domain and to fallback on “searching the entire web”.</li>
<li>After the CSE is created, edit it and remove the dummy domain.</li>
<li>Generate an API key.</li>
<li>Create queries using the API (you can experiment with <a href="https://developers.google.com/apis-explorer/#p/customsearch/v1/search.cse.list" rel="noopener nofollow ugc">https://developers.google.com/apis-explorer/#p/customsearch/v1/search.cse.list</a> to see how results are formatted).</li>
</ul>
<p>It is interesting to note that the API does not let us grab results in bulk: it identifies how many results there are and lets us set a starting point, but it’s limited to a maximum of 10 results at a time. This is not a show-stopper, it just means we need to break down every rule into multiple queries until we have retrieved all the results.</p>
<p>The basic functionality is now working, with Watcher being able to initiate queries and process the results. This now needs to be expanded to forward the results to the other plugins so the map and database are populated.</p>
<p><img src="https://0x00sec.s3.amazonaws.com/original/2X/f/f6204efe37074ce81c00cbe8c4e0a4e7cfdb7ad5.png" alt="Annotation%202019-07-05%20131104" data-base62-sha1="z7kG4d7hnqEmDy7HhXq3LfcOzfn" width="690" height="403"></p>
<p>Here we can see a set of results from the first (currently hardcoded) query. One of the next steps is to make the queries be loaded from a JSON file and start creating the corpus of rules.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="6" />
<span class="post-likes">6 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/messede"><span itemprop="name">messede</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-06T01:59:26Z" class="post-time">
July 6, 2019, 1:59am
</time>
<meta itemprop="dateModified" content="2019-07-06T01:59:26Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>and a custom google dork could also be accepted perhaps <img src="../../images/emoji/twitter/slightly_smiling_face.png%3Fv=9" title=":slightly_smiling_face:" class="emoji" alt=":slightly_smiling_face:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_13" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hostile.node"><span itemprop="name">hostile.node</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-06T10:11:01Z" class="post-time">
July 6, 2019, 10:11am
</time>
<meta itemprop="dateModified" content="2019-07-06T10:11:01Z">
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>You’ll be able to add any custom queries to the queries file - none of this will be hardcoded, so extending it will be straightforward.</p>
<p>Once we start using it properly, if we find it is a bit clunky I can add a custom query field into the UI as well.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_14" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/messede"><span itemprop="name">messede</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-06T15:06:55Z" class="post-time">
July 6, 2019, 3:06pm
</time>
<meta itemprop="dateModified" content="2019-07-06T15:06:55Z">
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group" data-username="hostile.node" data-post="13" data-topic="14650">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/hostile.node/40/12371_2.png" class="avatar"> hostile.node:</div>
<blockquote>
<p>custom query field into the UI</p>
</blockquote>
</aside>
<p>looking forward to that . <img src="../../images/emoji/twitter/+1.png%3Fv=9" title=":+1:" class="emoji" alt=":+1:"><img src="../../images/emoji/twitter/+1.png%3Fv=9" title=":+1:" class="emoji" alt=":+1:"><img src="../../images/emoji/twitter/+1.png%3Fv=9" title=":+1:" class="emoji" alt=":+1:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_15" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/carpetman"><span itemprop="name">carpetman</span></a>
(Emster)
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-08T17:58:04Z" class="post-time">
July 8, 2019, 5:58pm
</time>
<meta itemprop="dateModified" content="2019-07-08T17:58:04Z">
<span itemprop="position">15</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This is amazing! I have so much to learn from this. Thank you for sharing</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="2" />
<span class="post-likes">2 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_16" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/binarylaw"><span itemprop="name">binarylaw</span></a>
(binarylaw)
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-12T08:27:55Z" class="post-time">
July 12, 2019, 8:27am
</time>
<meta itemprop="dateModified" content="2019-07-12T08:27:55Z">
<span itemprop="position">16</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Very smart idea! Thank you for the writeup</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_17" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/messede"><span itemprop="name">messede</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-14T11:44:00Z" class="post-time">
July 14, 2019, 11:44am
</time>
<meta itemprop="dateModified" content="2019-07-14T11:44:00Z">
<span itemprop="position">17</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hey <a class="mention" href="https://0x00sec.org/u/hostile.node">@hostile.node</a> <img src="../../images/emoji/twitter/grin.png%3Fv=9" title=":grin:" class="emoji" alt=":grin:">, just wanted to know what’s happening…</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_18" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hostile.node"><span itemprop="name">hostile.node</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-14T12:43:55Z" class="post-time">
July 14, 2019, 12:43pm
</time>
<meta itemprop="dateModified" content="2019-07-14T12:43:55Z">
<span itemprop="position">18</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hey <a class="mention" href="https://0x00sec.org/u/messede">@messede</a>. I’ve been away for most of the week (business) and haven’t had the chance opportunity to make real progress on this in the last few days. I’m expecting to be able to put up another update post towards the end of the coming week. <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_19" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/messede"><span itemprop="name">messede</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-14T12:44:58Z" class="post-time">
July 14, 2019, 12:44pm
</time>
<meta itemprop="dateModified" content="2019-07-14T12:44:58Z">
<span itemprop="position">19</span>
</span>
</div>
<div class="post" itemprop="text">
<p>looking forward to it , ill keep bothering you here <img src="../../images/emoji/twitter/sweat_smile.png%3Fv=9" title=":sweat_smile:" class="emoji" alt=":sweat_smile:"><img src="../../images/emoji/twitter/sweat_smile.png%3Fv=9" title=":sweat_smile:" class="emoji" alt=":sweat_smile:"><img src="../../images/emoji/twitter/sweat_smile.png%3Fv=9" title=":sweat_smile:" class="emoji" alt=":sweat_smile:">, so that this thread stays alive…<img src="../../images/emoji/twitter/grin.png%3Fv=9" title=":grin:" class="emoji" alt=":grin:"><img src="../../images/emoji/twitter/grin.png%3Fv=9" title=":grin:" class="emoji" alt=":grin:"><img src="../../images/emoji/twitter/grin.png%3Fv=9" title=":grin:" class="emoji" alt=":grin:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_20" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Samxel.xo"><span itemprop="name">Samxel.xo</span></a>
</span>
<link itemprop="mainEntityOfPage" href="14650.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-07-15T13:50:11Z" class="post-time">
July 15, 2019, 1:50pm
</time>
<meta itemprop="dateModified" content="2019-07-15T13:50:11Z">
<span itemprop="position">20</span>
</span>
</div>
<div class="post" itemprop="text">
<p>nicee good luck on programming pls post more updates on this one</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="3" />
<span class="post-likes">3 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
<div role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement" class="topic-body crawler-post">
<span itemprop="name"><b><a rel="next" itemprop="url" href="14650%3Fpage=2.html">next page →</a></b></span>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
