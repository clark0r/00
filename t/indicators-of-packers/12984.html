<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Indicators of Packers - Malware - 0x00sec - The Home of the Hacker</title>
<meta name="description" content="Hello 0x00sec fellas! 
I want to start by saying that I love what you’re doing here. I’d like to thank all of you who contribute to this community even if a bit. Thank you all :two_hearts: 
Anyway enough with the emotion&amp;hellip;">
<meta name="generator" content="Discourse 3.1.0.beta6 - https://github.com/discourse/discourse version 80a1709965fa59da824b2e3392976fc6fc898f80">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.png">
<meta name="theme-color" media="all" content="#171616">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="12984.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">
<link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_a5ef387651921c3e4c7aa1108536015ba8299efb.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" class="light-scheme" />
<link href="../../stylesheets/desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop" />
<link href="../../stylesheets/chat_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat" />
<link href="../../stylesheets/discourse-details_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-details" />
<link href="../../stylesheets/discourse-lazy-videos_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-lazy-videos" />
<link href="../../stylesheets/discourse-local-dates_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-local-dates" />
<link href="../../stylesheets/discourse-narrative-bot_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-narrative-bot" />
<link href="../../stylesheets/discourse-presence_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-presence" />
<link href="../../stylesheets/discourse-spoiler-alert_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="discourse-spoiler-alert" />
<link href="../../stylesheets/docker_manager_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="docker_manager" />
<link href="../../stylesheets/poll_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll" />
<link href="../../stylesheets/chat_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="chat_desktop" />
<link href="../../stylesheets/poll_desktop_87cd179c68f77a1d2535709c09116ecd05093b39.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="poll_desktop" />
<link href="../../stylesheets/desktop_theme_46_f36ade55bf80933494fe3b5fab518f477de3bd4e.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2" />
<link href="../../stylesheets/desktop_theme_57_8c0e890a61cdb4c5833a9f9c96664ed164e7d645.css%3F__ws=0x00sec.org.css" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="57" data-theme-name="0x00sec-v2" />
<link rel="stylesheet" href="https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="https://s3.amazonaws.com/0x00sec/highlight.pack.js"></script>
<link rel="preload" href="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" as="script">
<script defer src="../../theme-javascripts/440fd21108f5ba9e5dfe06cca9fc842569d5a874.js%3F__ws=0x00sec.org" data-theme-id="40"></script>
<link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Indicators of Packers&#39;" href="12984.rss" />
<meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/6/627513974f7a39d9410fa1ce7d24c26bd80f5827.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/6/627513974f7a39d9410fa1ce7d24c26bd80f5827.png" />
<meta property="og:url" content="https://0x00sec.org/t/indicators-of-packers/12984" />
<meta name="twitter:url" content="https://0x00sec.org/t/indicators-of-packers/12984" />
<meta property="og:title" content="Indicators of Packers" />
<meta name="twitter:title" content="Indicators of Packers" />
<meta property="og:description" content="Hello 0x00sec fellas!  I want to start by saying that I love what you’re doing here. I’d like to thank all of you who contribute to this community even if a bit. Thank you all 💕  Anyway enough with the emotions 😃 Today I’m here with a compiled list of packer/crypter indicators that I can think of. Using these you may be able to detect if a packer/crypter is applied to your subject of analysis. Please feel free to make additions!  Lets Start.  1. Packer Signatures  Well obviousl..." />
<meta name="twitter:description" content="Hello 0x00sec fellas!  I want to start by saying that I love what you’re doing here. I’d like to thank all of you who contribute to this community even if a bit. Thank you all 💕  Anyway enough with the emotions 😃 Today I’m here with a compiled list of packer/crypter indicators that I can think of. Using these you may be able to detect if a packer/crypter is applied to your subject of analysis. Please feel free to make additions!  Lets Start.  1. Packer Signatures  Well obviousl..." />
<meta property="og:article:section" content="Malware" />
<meta property="og:article:section:color" content="F7941D" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="34 ❤" />
<meta property="article:published_time" content="2019-04-13T22:55:21+00:00" />
<meta property="og:ignore_canonical" content="true" />
</head>
<body class="crawler ">
<div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">

<a href="https://init.0x00sec.org" class="dow-menu">Init</a>
<a href="https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
<a href="https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
<header>
<a href="../../index.html">
0x00sec - The Home of the Hacker
</a>
</header>
<div id="main-outlet" class="wrap" role="main">
<div id="topic-title">
<h1>
<a href="12984.html">Indicators of Packers</a>
</h1>
<div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
<a href="../../c/malware.html" class="badge-wrapper bullet" itemprop="item">
<span class="badge-category-bg" style="background-color: #F7941D"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Malware</span>
</span>
</a>
<meta itemprop="position" content="1" />
</span>
</div>
</div>
<div itemscope itemtype="http://schema.org/DiscussionForumPosting">
<meta itemprop="headline" content="Indicators of Packers">
<meta itemprop="articleSection" content="Malware">
<meta itemprop="keywords" content>
<div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="0x00sec - The Home of the Hacker">
<div itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
<meta itemprop="url" content="https://0x00sec.org/uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.png">
</div>
</div>
<div id="post_1" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hunter"><span itemprop="name">hunter</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<link itemprop="image" href="https://0x00sec.s3.amazonaws.com/original/2X/6/627513974f7a39d9410fa1ce7d24c26bd80f5827.png">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-13T22:55:21Z" class="post-time">
April 13, 2019, 10:55pm
</time>
<meta itemprop="dateModified" content="2019-04-13T22:55:21Z">
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Hello 0x00sec fellas!<br>
I want to start by saying that I love what you’re doing here. I’d like to thank all of you who contribute to this community even if a bit. Thank you all <img src="../../images/emoji/twitter/two_hearts.png%3Fv=9" title=":two_hearts:" class="emoji" alt=":two_hearts:"></p>
<p>Anyway enough with the emotions <img src="../../images/emoji/twitter/smiley.png%3Fv=9" title=":smiley:" class="emoji" alt=":smiley:"> Today I’m here with a compiled list of packer/crypter indicators that I can think of. Using these you may be able to detect if a packer/crypter is applied to your subject of analysis. Please feel free to make additions!</p>
<p>Lets Start.</p>
<p><strong>1. Packer Signatures</strong><br>
Well obviously first thing to look for is the presence of any signatures related to already known packers or crypters (I’ll only use the term “packer” from now on). You could use PEiD, yarascan or any other tool really. Here is an example;<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/6/627513974f7a39d9410fa1ce7d24c26bd80f5827.png" alt="resim" data-base62-sha1="e2ZCTKLDPAmDzdP8d4TTPvl5XUz" width="628" height="348"></p>
<p>You see that PEiD found a signature match of UPX packer. The thing with signatures is that there can be false positives. Maybe author has made a loose definition while creating the signature, or maybe malware developer simply false flagged the binary. Long story short, don’t rely on them. Actually don’t rely on any single or combination of indicators. They are what they sound like, <em>indicators</em> not <em>facts</em>.</p>
<p><strong>2. Abnormal Entry Point / Section Names</strong><br>
Some packers create new sections to store the packed executable or stub code then arbitrarily name those sections. Regular section names for PE files go like; text, bss, data, rsrc, rodata. Sometimes compilers create some additional sections in order to store things like debug symbols etc. Whatever I see other then these names instantly raise my suspicion.<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/3/31b131e5f25ebc868f97789ef8e1c47f0777b97d.png" alt="resim" data-base62-sha1="75B28g0YfX08WN2UW0a77xcGnaB" width="487" height="174"></p>
<p><strong>3. Section or Memory Regions with RWE Permissions</strong><br>
This is another obvious one. Sometimes a packer allocates a section/memory region in order to store the <em>unpacked</em> code. So this region would need to have both writable and executable permissions; which is weird because compilers don’t do that by default cuz of security reasons. This is an anomaly. It may occur in runtime so you may wish to trace API calls related to memory permissions.<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/f/f244d6a990c8c135539b28268a94baea1fd233ec.png" alt="resim" data-base62-sha1="yzd25zyGG3f4OMDJixZGwj7Cwaw" width="690" height="75"></p>
<p><strong>4. Abnormal Difference Between Section Vsize and Psize</strong><br>
Physical size is the space occupied by a section on the <em>disk</em> while it’s not running. And virtual size is the size on <em>memory</em> while it’s running. Abnormal differences between these two values may indicate the presence of a packer. Because while not running the code will be compressed, hence small in size. When it begins to run though malware will try to decompress the code so its size will increase abnormally.<br>
Example;<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/a/a9c025f51e2bc6b295745719c87e79c0cfa7ec6d.png" alt="resim" data-base62-sha1="odGmPF9YTl2C0K5lDlT1Jd6SvO5" width="690" height="62"></p>
<p>You can also see that this example possess other features we have mentioned earlier as well.</p>
<p><strong>5. Data Sections Are Too Large</strong><br>
We generally divide sections into one of two types; code section or data section. As the name suggests code sections are the ones which contains code, and data sections are the ones which contains <em>drumroll</em> data! For example when you define a variable in a program it gets stored in one of the data sections depending on how you define it (bss, data, rodata, rsrc…). Naturally we expect a program to contain more code than it contains data. Unless it’s designed to print out a play of Shakespeare for some reason. Whenever I see a data section that is too large I suspect that it might contain an executable file inside it.<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/9/90518512e8d4295d5d278f631b0de621aea2841b.png" alt="resim" data-base62-sha1="kAHputhEBHl58KSUVmDPRcRxs4H" width="690" height="147"></p>
<p><strong>6. Too Few Imported Functions</strong><br>
When a file is packed normally you would only see the functions used by its unpacker stub code. Most probably there will be stuff related to memory allocation, mem permissions, module load, resources operations… So if it seems like the program imports abnormally few functions you could suspect of a packer.<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/5/5ec26a9c6b0aaea08d1fcddb5f7837048a4cbc4e.png" alt="resim" data-base62-sha1="dwhpT2lSCnxcAuJotFOcTB9y2nk" width="690" height="475"></p>
<p><strong>7. Section with High Entropy</strong><br>
Shannon’s entropy is an algorithm to calculate frequency of recurrences in a given data. It calculates a score over eight. Lesser the recurrences, higher the entropy (score). So if you see a section or file which’s entropy score is close to or above 7.0 you could suspect that the data inside it is encrypted, hence might be packed. Because increasing entropy is what any decent encryption algorithm is supposed to do.<br>
<img src="https://0x00sec.s3.amazonaws.com/original/2X/c/c129605e66140612aae70fcc2a0cd962b4f0bd4b.png" alt="resim" data-base62-sha1="ryMNCMrQ1MVjdF5XF71iuelhme7" width="690" height="272"></p>
<p>That’s all from me for now. Please feel free to add <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="21" />
<span class="post-likes">21 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_2" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-14T02:41:20Z" class="post-time">
April 14, 2019, 2:41am
</time>
<meta itemprop="dateModified" content="2019-04-14T02:41:20Z">
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>pestudio</p>
<p>Thank me later. <img src="../../images/emoji/twitter/wink.png%3Fv=9" title=":wink:" class="emoji" alt=":wink:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="5" />
<span class="post-likes">5 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_3" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hunter"><span itemprop="name">hunter</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-15T22:06:29Z" class="post-time">
April 15, 2019, 10:06pm
</time>
<meta itemprop="dateModified" content="2019-04-15T22:06:29Z">
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>i am well aware of the tool <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> it helps to know what to look for and where to find it from an investigator perspective</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_5" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/c0wm1lk"><span itemprop="name">c0wm1lk</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-22T20:37:50Z" class="post-time">
April 22, 2019, 8:37pm
</time>
<meta itemprop="dateModified" content="2019-04-22T20:37:50Z">
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I heard of these types of programs before but I never knew they were called packers, that will aid my future research into these topics <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Since I’m a complete n00b at packers I hope you don’t mind if I ask a few questions.</p>
<ul>
<li>How easy is it to unpack a packed binary?</li>
<li>How long does it take for a packer to get reverse engineer’d to allow to unpack packed binaries?</li>
<li>Is VMProtect a packer? Can you unpack binaries protected with VMProtect?</li>
</ul>
<p>Also what are your opinions on packers? I’d love to know more about this topic <img src="../../images/emoji/twitter/slight_smile.png%3Fv=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="2" />
</div>
</div>
<div id="post_6" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hunter"><span itemprop="name">hunter</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-22T20:53:01Z" class="post-time">
April 22, 2019, 8:53pm
</time>
<meta itemprop="dateModified" content="2019-04-22T20:53:01Z">
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I’m glad that you enjoyed my topic. I will try to answer your questions as long as my knowledge let me so. Please free feel to add/correct any missing or false information.</p>
<aside class="quote no-group" data-username="c0wm1lk" data-post="5" data-topic="12984">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/c0wm1lk/40/7625_2.png" class="avatar"> c0wm1lk:</div>
<blockquote>
<p>How easy is it to unpack a packed binary?</p>
</blockquote>
</aside>
<p>it depends. is the packer a known and widely used one? for example it’s fairly simple to unpack an upx packed executable. if a custom packer has been applied, sometimes simple unpacking tricks work; like running the exe a little bit and looking for RWE memory regions, PE signature etc. then dumping the region. other times you may need to reverse engineer the whole thing.</p>
<aside class="quote no-group" data-username="c0wm1lk" data-post="5" data-topic="12984">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/c0wm1lk/40/7625_2.png" class="avatar"> c0wm1lk:</div>
<blockquote>
<p>How long does it take for a packer to get reverse engineer’d to allow to unpack packed binaries?</p>
</blockquote>
</aside>
<p>depends on the encryption/packing algorithm used, anti analysis measures if there are any and your reverse engineering skills obviously.</p>
<aside class="quote no-group" data-username="c0wm1lk" data-post="5" data-topic="12984">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/c0wm1lk/40/7625_2.png" class="avatar"> c0wm1lk:</div>
<blockquote>
<p>Is VMProtect a packer? Can you unpack binaries protected with VMProtect?</p>
</blockquote>
</aside>
<p>it is a “protector”. meaning it’s a crypting + anti analysis + anti forensics + maybe virtualizing code etc. whatever needs to protect the code from piracy (remember, purpose of a packer is shrinking the file not protecting it). as to my information there are some unpackers for some versions of vmprotect. newest versions employ code virtualization and a bunch of anti forensics/analysis methods as well. it is not impossible ofc but it would be fairly time consuming i believe.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_7" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/c0wm1lk"><span itemprop="name">c0wm1lk</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-22T21:08:49Z" class="post-time">
April 22, 2019, 9:08pm
</time>
<meta itemprop="dateModified" content="2019-04-22T21:08:49Z">
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hey thanks for your reply! I’m still not 100% sure on how packers work but from what I understand packers are simply programs that have their instructions encoded in some way. (Encrypted file / zipped file / anti RE crap / …). Correct?</p>
<p>And packed files need to unpack their code at some point, does this mean they just save it to memory or do they unpack instructions as they go (and what performance impact would that have)?<br>
If they unpack all their instructions right to memory wouldn’t you just be able to take a copy of the memory and inspect it that way?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="2" />
</div>
</div>
<div id="post_8" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/hunter"><span itemprop="name">hunter</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-22T21:34:57Z" class="post-time">
April 22, 2019, 9:34pm
</time>
<meta itemprop="dateModified" content="2019-04-22T21:34:57Z">
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>the name “packer” is used too broadly nowadays. when they were first introduced their only purpose was to shrink an executable file by using data compression algorithms (like the ones used in winrar, 7zip etc). in those times most antivirus software deployed only static signature based detecion methods. these “packers” come to corrupt the “signatures” on an executable while compressing it and hence a packed executable could evade AV detection more easily. little after that this behavior was noticed and these “application packers” got widely adopted by malware developers. this is how this innocent tool of binary shrinking got weaponized. then some malware developers rolled out their own packers and also introduced encryption features into these “packers”, in order to better evade detection. then the term “packer” evolved into a different and broader meaning than it was before; covering both encryption and compression employment with the purpose of AV evasion. Now they may also contain anti forensics and analysis methods as well. But this is where the term originated.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_9" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-23T12:20:17Z" class="post-time">
April 23, 2019, 12:20pm
</time>
<meta itemprop="dateModified" content="2019-04-23T20:12:39Z">
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>There are many different types of packers out there. The ones that are concerned with malware and are probably the most common ones come with both encryption and compression. These are labelled “run-time” (as opposed to “scan-time”) packers meaning that they will deobfuscate the original code in memory and execute it without touching disk. The reason this is important is because if the deobfuscated malware is dropped to the disk (“scan-time”), it may trigger an anti-virus to scan its exposed code.</p>
<p>In order to unpack in-memory, the obfuscated malware code is contained within what’s known as the “stub” which is responsible for the recovery and initialisation of the original malware. Essentially, the stub is its own functional code - either shellcode or full PE file - basically a manual executable linker.</p>
<p>Using UPX as an example, UPX compresses the original binary and generates a new PE file. This PE file has at least two main sections, <code>.upx0</code> and <code>.upx1</code>. <code>upx0</code> is actually empty in terms of raw “disk” size but its <em>virtual</em> size (in memory) is as big as the original binary’s size. <code>upx1</code> contains both the compressed binary as well as the assembly “stub”. What the stub does is it will locate the compressed code and decompress it back into the <code>upx0</code> in memory (remember the <em>virtual</em> size is big enough to contain the original binary). It will then initialise the original binary by applying relocations(?), rebuilding the import table functions, and then call the <code>.tls</code> functions if they exist. When this is done, it will jump execution to the original binary’s entry point from where it will continue normal execution like nothing happened.</p>
<aside class="quote no-group" data-username="c0wm1lk" data-post="7" data-topic="12984">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/0x00sec.org/c0wm1lk/40/7625_2.png" class="avatar"> c0wm1lk:</div>
<blockquote>
<p>If they unpack all their instructions right to memory wouldn’t you just be able to take a copy of the memory and inspect it that way?</p>
</blockquote>
</aside>
<p>Most of the times with the average packer, you can do this. If we are speaking about protectors, it’s a different story. Parts of the original bytes may be intentionally misplaced or replaced with equivalent code and spread across memory which will provide the same functionality, but results in the original code being fragmented. Some examples of this include API redirection or byte stealing. Protectors like VMProtect may virtualise the code which means that the original code is unrecoverable.</p>
<p>So if you want to get into building these packers, you may need to understand the executable file formats, how they interact with memory, and the Windows operating system.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="5" />
<span class="post-likes">5 Likes</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_10" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/c0wm1lk"><span itemprop="name">c0wm1lk</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-04-24T06:11:52Z" class="post-time">
April 24, 2019, 6:11am
</time>
<meta itemprop="dateModified" content="2019-04-24T06:11:52Z">
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks for both your well written replies, I was able to learn a lot from them!</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_11" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/Arkwed"><span itemprop="name">Arkwed</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-06T00:22:02Z" class="post-time">
May 6, 2019, 12:22am
</time>
<meta itemprop="dateModified" content="2019-05-06T00:22:02Z">
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>For some AV vendors UPX is an indicator of malware(increase the detection ratio). I don’t fully understand why malware developers keep using it. Any idea?</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="1" />
</div>
</div>
<div id="post_12" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/dtm"><span itemprop="name">dtm</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-06T08:53:02Z" class="post-time">
May 6, 2019, 8:53am
</time>
<meta itemprop="dateModified" content="2019-05-06T08:53:02Z">
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>IMHO AV vendors should not be increasing the detection score if an application is packed using classic UPX because it can be trivially unpacked. About malware developers using UPX, I don’t really see any reason for it besides compression. I’ve only ever seen or heard of this in skiddy skid malware builders such as those public .NET RATs, etc. If I were developing (new) malware, I should not need to use a packer however, if I reuse something that is already known and has signatures, I would develop my own packer rather than use something like UPX.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="1" />
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_13" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/5P1D3R"><span itemprop="name">5P1D3R</span></a>
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-07T19:28:41Z" class="post-time">
May 7, 2019, 7:28pm
</time>
<meta itemprop="dateModified" content="2019-05-07T19:28:41Z">
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Pretty easy unpack UPX and simple packers. There are tools that do this. VMProtect is paid for crypter and no easy to reeverse. AV will flag packers so not good for red team</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
<div id="post_14" itemprop="comment" itemscope itemtype="http://schema.org/Comment" class="topic-body crawler-post">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a itemprop="url" href="https://0x00sec.org/u/system"><span itemprop="name">system</span></a>
(system)
Closed
</span>
<link itemprop="mainEntityOfPage" href="12984.html">
<span class="crawler-post-infos">
<time itemprop="datePublished" datetime="2019-05-13T22:55:23Z" class="post-time">
May 13, 2019, 10:55pm
</time>
<meta itemprop="dateModified" content="2019-05-13T22:55:23Z">
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/LikeAction" />
<meta itemprop="userInteractionCount" content="0" />
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
<meta itemprop="interactionType" content="http://schema.org/CommentAction" />
<meta itemprop="userInteractionCount" content="0" />
</div>
</div>
</div>
</div>
<footer class="container wrap">
<nav class="crawler-nav">
<ul>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../index.html" itemprop="url">Home </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../categories.html" itemprop="url">Categories </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="https://0x00sec.org/guidelines" itemprop="url">FAQ/Guidelines </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../tos.html" itemprop="url">Terms of Service </a>
</span>
</li>
<li itemscope itemtype="http://schema.org/SiteNavigationElement">
<span itemprop="name">
<a href="../../privacy.html" itemprop="url">Privacy Policy </a>
</span>
</li>
</ul>
</nav>
<p class="powered-by-link">Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>
<script src="https://instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
</body>
</html>
