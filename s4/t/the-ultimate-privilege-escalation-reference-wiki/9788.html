<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>The Ultimate Privilege Escalation Reference - [Wiki] - Wiki - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="Hi 0x00ers! 
I have noticed that a lot of us have begun participating more regularly in HackTheBox challenges, and so, a lot of us are rooting boxes more frequently. 
In the midst of this learning frenzy, I only thought &amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="9788.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="sO8TdXHxwzouC56ufyyOcoxcR"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="sO8TdXHxwzouC56ufyyOcoxcR"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;The Ultimate Privilege Escalation Reference - [Wiki]&#39;" href="9788.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/the-ultimate-privilege-escalation-reference-wiki/9788" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/the-ultimate-privilege-escalation-reference-wiki/9788" />
<meta property="og:title" content="The Ultimate Privilege Escalation Reference - [Wiki]" />
<meta name="twitter:title" content="The Ultimate Privilege Escalation Reference - [Wiki]" />
<meta property="og:description" content="Hi 0x00ers!  I have noticed that a lot of us have begun participating more regularly in HackTheBox challenges, and so, a lot of us are rooting boxes more frequently.  In the midst of this learning frenzy, I only thought it was right to make a Wiki for Privilege Escalation, for Linux, Windows and any other operating systems you can think of.  This should mimic something like Enumeration for Linux Privilege Escalation, and should not contain every single escalation exploit known to man, but more a..." />
<meta name="twitter:description" content="Hi 0x00ers!  I have noticed that a lot of us have begun participating more regularly in HackTheBox challenges, and so, a lot of us are rooting boxes more frequently.  In the midst of this learning frenzy, I only thought it was right to make a Wiki for Privilege Escalation, for Linux, Windows and any other operating systems you can think of.  This should mimic something like Enumeration for Linux Privilege Escalation, and should not contain every single escalation exploit known to man, but more a..." />
<meta property="og:article:section" content="Wiki" />
<meta property="og:article:section:color" content="3AB54A" />
<meta property="og:article:tag" content="privesc" />
<meta property="og:article:tag" content="escalation" />
<meta property="og:article:tag" content="enumeration" />
<meta property="og:article:tag" content="privilege" />
<meta property="og:article:tag" content="elevation" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="3 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="31 ‚ù§" />
<meta property="article:published_time" content="2020-04-22T09:07:13+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="9788.html">The Ultimate Privilege Escalation Reference - [Wiki]</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/wiki/96.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #3AB54A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Wiki</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/privesc.html' class='discourse-tag' rel="tag">privesc</a>, 
            <a href='../../tag/escalation.html' class='discourse-tag' rel="tag">escalation</a>, 
            <a href='../../tag/enumeration.html' class='discourse-tag' rel="tag">enumeration</a>, 
            <a href='../../tag/privilege.html' class='discourse-tag' rel="tag">privilege</a>, 
            <a href='../../tag/elevation.html' class='discourse-tag' rel="tag">elevation</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='The Ultimate Privilege Escalation Reference - [Wiki]'>
      <link itemprop='url' href='9788.html'>
      <meta itemprop='datePublished' content='2018-11-26T14:23:46Z'>
        <meta itemprop='articleSection' content='Wiki'>
      <meta itemprop='keywords' content='privesc, escalation, enumeration, privilege, elevation'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/pry0cc.html'><span itemprop='name'>pry0cc</span></a>
                (Leader &amp; Offsec Engineer &amp; Forum Daddy)
              </span>

                <link itemprop="mainEntityOfPage" href="9788.html">


              <span class="crawler-post-infos">
                  <time  datetime='2018-11-26T14:23:47Z' class='post-time'>
                    November 26, 2018,  2:23pm
                  </time>
                  <meta itemprop='dateModified' content='2020-04-22T09:07:09Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi 0x00ers!</p>
<p>I have noticed that a lot of us have begun participating more regularly in <a href="../../../external.html?link=https://hackthebox.eu/">HackTheBox</a> challenges, and so, a lot of us are rooting boxes more frequently.</p>
<p>In the midst of this learning frenzy, I only thought it was right to make a Wiki for Privilege Escalation, for Linux, Windows and any other operating systems you can think of.</p>
<p>This should mimic something like <a href="../../../external.html?link=https://0x00sec.org/t/enumeration-for-linux-privilege-escalation/1959/18" class="inline-onebox">Enumeration for Linux Privilege Escalation</a>, and should not contain every single escalation exploit known to man, but more a list of methods and ways to enumerate for privesc. I am going to start down below with some basic things, and if you‚Äôre a member, you can edit this page and add your own methods!</p>
<p>Remember as a community we‚Äôre stronger than ever, and many hands make light work! So if you have something that you use frequently, throw it in! We are going to pin this topic so that everybody can keep an eye on it and work on this.</p>
<p>If this turns out to be a success, we will make other Wiki‚Äôs for things like reverse shells or command injection evasion techniques.</p>
<h1>Wiki</h1>
<hr>
<h2>Linux</h2>
<p>(Sourced from <a href="../../../external.html?link=https://0x00sec.org/t/enumeration-for-linux-privilege-escalation/1959" class="inline-onebox">Enumeration for Linux Privilege Escalation</a> for initial information, thank you <a class="mention" href="../../u/g0jirasan.html">@g0jirasan</a>!)</p>
<h3>Get Your Bearings</h3>
<p>First things first. Always get a good feel for the machine. Its always a good idea to figure out what version you‚Äôre looking at:</p>
<pre><code class="lang-auto">cat /etc/issue
</code></pre>
<p>or</p>
<pre><code class="lang-auto">cat /etc/*-release
</code></pre>
<p>What is the kernel version? Are there known exploits for that version?</p>
<pre><code class="lang-auto">cat /proc/version
</code></pre>
<pre><code class="lang-auto">uname -a
</code></pre>
<pre><code class="lang-auto">rpm -q kernel
</code></pre>
<p>Where are you on the network? What connections are established?</p>
<pre><code class="lang-auto">ifconfig -a
</code></pre>
<pre><code class="lang-auto">netstat -antup
</code></pre>
<pre><code class="lang-auto">iptables -L
</code></pre>
<pre><code class="lang-auto">arp -e
</code></pre>
<p>Check for accidental passwords typed after unsuccessful sudo</p>
<pre><code class="lang-auto">cat ~/.bash_history | grep -A5 sudo
</code></pre>
<p>Check for open <code>tmux</code> sessions (possibly logged into root shells)</p>
<pre><code class="lang-auto">tmux ls
</code></pre>
<p>Find writable files / dirs outside of your home directory</p>
<pre><code class="lang-auto">find / -writable -type f -o -writable -type d 2&gt;/dev/null | grep -Ev "^(/proc|/home/user|/tmp)"
</code></pre>
<p>Check home directories of other users for readable files:</p>
<pre><code class="lang-auto">find /home | grep -Ev "^/home/user"
</code></pre>
<p>Find files that were modified in the last 10min (useful to spot funky stuff going on)</p>
<pre><code class="lang-auto">find / -mmin -10 2&gt;/dev/null | grep -Ev "^/proc"
</code></pre>
<ul>
<li>Check mounts</li>
<li>Grab banners for local ports (using <code>nc</code> or other methods)</li>
<li>Read <code>crontab</code> job files and look for crappy backup scripts</li>
<li>Read service configuration (Especially httpd)</li>
<li>Scroll over <code>ps -ef</code> output and check for passwords passed as command-line arguments</li>
</ul>
<h3>What is running?</h3>
<p>There are numerous local privilege escalation exploits out there in the void. Are there any vulnerable applications or services running that have known exploits?</p>
<p>Which services are being run with root privileges?</p>
<pre><code class="lang-auto">ps -ef | grep root
</code></pre>
<p>or</p>
<pre><code class="lang-auto">ps aux | grep root
</code></pre>
<pre><code class="lang-auto">cat /etc/services
</code></pre>
<p>Any vulnerable applications?</p>
<pre><code class="lang-auto">ls -alh /usr/bin/
</code></pre>
<pre><code class="lang-auto">ls -alh /sbin/
</code></pre>
<p>Any files with SUID/SGID permissions?</p>
<pre><code class="lang-auto">find / -perm -g=s -o -perm -u=s -type f 2&gt;/dev/null
</code></pre>
<p>or, for a faster search in ‚Äúbin‚Äù directories</p>
<pre><code class="lang-auto">for i in `locate -r "bin$"`; do find $i \( -perm -4000 -o -perm -2000 \) -type f 2&gt;/dev/null; done
</code></pre>
<h3>Uploading and running exploit code</h3>
<p>If there is a local privilege escalation exploit available, how will you upload and execute the exploit code on your target?</p>
<p>What languages are supported on the machine?</p>
<pre><code class="lang-auto">find / -name 'language'
</code></pre>
<p>ex: find / -name python*</p>
<p>Is GCC present?</p>
<pre><code class="lang-auto">find / -name gcc
</code></pre>
<p>How can you upload the exploit code? Use <code>find</code> to look for things like:</p>
<p>wget, nc, netcat, tftp, ftp, fetch etc.</p>
<p>If you‚Äôre over ssh, you can use <code>scp</code>.</p>
<h3>Find out what programs are installed with:</h3>
<pre><code class="lang-auto">for item in $(echo "nmap nc perl python ruby gcc wget sudo curl"); do which $item; done
</code></pre>
<h3>Where can you write and execute files?</h3>
<p>You will need to find a place to compile and execute your exploit code</p>
<p>This will locate world writeable and world executable folders</p>
<pre><code class="lang-auto">find /\(-perm -o w -perm -o x\) -type d 2&gt;/dev/null
</code></pre>
<h3>Cracking password hashes</h3>
<p>Can you view /etc/passwd and /etc/shadow ?</p>
<pre><code class="lang-auto">cat /etc/passwd
</code></pre>
<pre><code class="lang-auto">cat /etc/shadow
</code></pre>
<p>If you can, try to crack the hashes you find. You never know!</p>
<p><strong><em>Limited Shell?</em></strong></p>
<p>Give these a shot.</p>
<pre><code class="lang-auto">python -c 'import pty;pty.spawn("/bin/bash")
</code></pre>
<pre><code class="lang-auto">echo os.system('/bin/bash')
</code></pre>
<pre><code class="lang-auto">/usr/bin/script -qc /bin/bash /dev/null
</code></pre>
<p><strong><em>The simplest things are often overlooked</em></strong></p>
<p>If I am ever stuck getting root privileges, its 9 times out of 10 because I am overthinking it. Sometimes the answer is so simple that its easy to overlook it. If you‚Äôre getting stuck, think back to square one and move forward slowly and pay attention to the details. Here are some of simple things that can be overlooked:</p>
<p>Is the account you are using a sudoer? If you have the password for the account, you may be able to use sudo. I have seen many people look over this. Are there other users that are sudoers?</p>
<pre><code class="lang-auto">cat /etc/sudoers
</code></pre>
<pre><code class="lang-auto">sudo -l
</code></pre>
<h3>Linux Enumeration Scripts</h3>
<ul>
<li>Unix-Privesc-Check -  <a href="../../../external.html?link=http://pentestmonkey.net/tools/audit/unix-privesc-check">Main Page</a> - <a href="../../../external.html?link=http://pentestmonkey.net/tools/unix-privesc-check/unix-privesc-check-1.4.tar.gz">Direct Download</a>
</li>
<li>LinEnum.sh - <a href="../../../external.html?link=https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh">Main Page</a> - <a href="../../../external.html?link=https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh">Direct Download</a>
</li>
<li>linux-exploit-suggester-2.pl - <a href="../../../external.html?link=https://github.com/jondonas/linux-exploit-suggester-2">https://github.com/jondonas/linux-exploit-suggester-2</a>
</li>
<li>linux-soft-exploit-suggester.py - <a href="../../../external.html?link=https://github.com/belane/linux-soft-exploit-suggester">https://github.com/belane/linux-soft-exploit-suggester</a>
</li>
</ul>
<h3>Windows Enumeration Scripts</h3>
<ul>
<li>windows-exploit-suggester.py - <a href="../../../external.html?link=https://github.com/GDSSecurity/Windows-Exploit-Suggester">https://github.com/GDSSecurity/Windows-Exploit-Suggester</a>
</li>
<li>PowerUp - <a href="../../../external.html?link=http://www.powershellempire.com/?page_id=378">http://www.powershellempire.com/?page_id=378</a>
</li>
</ul>
<h2>Windows</h2>
<p>Unquoted Service Paths:</p>
<p>Look for services that are being run as administrator by typing sc query in the command line. From there, you can look at their individual properties by typing sc qc SERVICENAME. Check out their properties, they should have something called a service path. If that path is inside quotes you‚Äôre out of luck (this the vulnerability is /unquoted/ service paths). For example, If VulnService has C:/Program Files/Vuln/bin/Vuln.exe, you can create your own Vuln.exe and but it between C:/ and C:/Program Files/Vuln/ it‚Äôll get executed with the privileges of that service instead of the intended Vuln.exe. This is because if there are quotation marks then the service will only use the exact path specified, but otherwise it will search each directory for the executable as it works its way down.</p>
<p>// To be added - could somebody transfer some information from <a href="../../../external.html?link=https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/">https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/</a> ?<br>
//This is also a great resource to add information from! <a href="../../../external.html?link=https://sushant747.gitbooks.io/total-oscp-guide/privilege_escalation_windows.html">https://sushant747.gitbooks.io/total-oscp-guide/privilege_escalation_windows.html</a></p>
<h3>Windows Releases - Security Bulletin</h3>
<ul>
<li>
<p>WinServer 2016</p>
<ul>
<li>Description: Windows Kernel Mode Drivers</li>
<li>MS16-135</li>
</ul>
</li>
<li>
<p>WinServer 2008, 2012, 7, 8, 10</p>
<ul>
<li>Description: Secondary Logon Handle</li>
<li>MS16-032</li>
</ul>
</li>
<li>
<p>WinServer 2008, 7, Vista</p>
<ul>
<li>Description: WebDAV</li>
<li>MS16-016</li>
</ul>
</li>
<li>
<p>WinServer 2003, 2008, 2012, 7, 8</p>
<ul>
<li>Description: Windows Kernel Mode Drivers</li>
<li>MS15-051</li>
</ul>
</li>
<li>
<p>WinServer 2003, 2008, 2012, 7, 8</p>
<ul>
<li>Description: Win32k.sys</li>
<li>MS14-058</li>
</ul>
</li>
<li>
<p>WinServer 2003, 2008, 2012, 7, 8</p>
<ul>
<li>Description: AFD Driver</li>
<li>MS14-040</li>
</ul>
</li>
<li>
<p>WinServer 2003, XP</p>
<ul>
<li>Description: Windows Kernel</li>
<li>MS14-002</li>
</ul>
</li>
<li>
<p>WinServer 2003, 2008, 2012, 7, 8</p>
<ul>
<li>Description: Kernel Mode Driver</li>
<li>MS13-005</li>
</ul>
</li>
<li>
<p>WinServer 2008, 7</p>
<ul>
<li>Description: Task Scheduler</li>
<li>MS10-092</li>
</ul>
</li>
<li>
<p>WinServer 2003, 2008, 7, XP</p>
<ul>
<li>Description: KiTrap0D</li>
<li>MS10-015</li>
</ul>
</li>
<li>
<p>WinServer 2003, XP</p>
<ul>
<li>Description: NDProxy</li>
<li>MS14-002</li>
</ul>
</li>
<li>
<p>WinServer 2003, 2008, 2012, 7, 8</p>
<ul>
<li>Description: Kernel Driver</li>
<li>MS15-061</li>
</ul>
</li>
<li>
<p>WinServer 2003, XP</p>
<ul>
<li>Description: AFD.sys</li>
<li>MS11-080</li>
</ul>
</li>
<li>
<p>WinServer 2003, XP</p>
<ul>
<li>Description: NDISTAPI</li>
<li>MS11-062</li>
</ul>
</li>
<li>
<p>WinServer 2003, 2008, 2012, 7, 8</p>
<ul>
<li>Description: RPC</li>
<li>MS15-076</li>
</ul>
</li>
<li>
<p>WinServer 2003, 2008, 2012, 7, 8</p>
<ul>
<li>Description: Hot Potato</li>
<li>MS16-075</li>
</ul>
</li>
<li>
<p>WinServer 2003, 2008, 7, XP</p>
<ul>
<li>Description: Kernel Driver</li>
<li>MS15-010</li>
</ul>
</li>
<li>
<p>WinServer 2003, 2008, 7, XP</p>
<ul>
<li>Description: AFD.sys</li>
<li>MS11-046</li>
</ul>
</li>
</ul>
<h3>Windows - Unquoted Services</h3>
<p>Find the paths:</p>
<pre><code class="lang-auto">C:\&gt; Ôªøwmic service get name,displayname,pathname,startmode |findstr /i "Auto" |findstr /i /v "C:\Windows\\" |findstr /i /v """
</code></pre>
<p>Identify ‚ÄúWrite‚Äù-Access:</p>
<pre><code class="lang-auto">C:\&gt; Ôªøicacls "C:\Program Files\Some Folder\"
</code></pre>
<p>Restart the service:</p>
<pre><code class="lang-auto">C:\&gt; Ôªøsc stop [service name]
C:\&gt; sc start [service name]
</code></pre>
<h3>Unattended Installs</h3>
<p>A <em>Unattend.xml</em> file is left on Windows machines after Unattended installs if the system isn‚Äôt cleaned properly after the procedure, the file contains all the configuration settings set in the installation process, including local account credentials such as the Administrator‚Äôs. Credentials can also be stored in two other files: <em>sysprep.xml</em> and <em>sysprep.inf</em> and will be either in plain text or encoded in Base64:</p>
<pre><code class="lang-auto">&lt;UserAccounts&gt;
    &lt;LocalAccounts&gt;
        &lt;LocalAccount&gt;
            &lt;Password&gt;
                &lt;Value&gt;dGhpc1Bhc3N3b3JkQWludFNhZmVQYXNzd29yZA==&lt;/Value&gt;
                &lt;PlainText&gt;false&lt;/PlainText&gt;
            &lt;/Password&gt;
            &lt;Description&gt;Local Administrator&lt;/Description&gt;
            &lt;DisplayName&gt;Administrator&lt;/DisplayName&gt;
            &lt;Group&gt;Administrators&lt;/Group&gt;
            &lt;Name&gt;Administrator&lt;/Name&gt;
        &lt;/LocalAccount&gt;
    &lt;/LocalAccounts&gt;
&lt;/UserAccounts&gt;
</code></pre>
<p>Before the password is encoded in Base64 the string ‚ÄúPassword‚Äù is appended to it, so be sure to remove it after decoding the string. Where to find these files:</p>
<pre><code class="lang-auto">C:\Windows\Panther\
C:\Windows\Panther\Unattend\
C:\Windows\System32\
C:\Windows\System32\sysprep\
</code></pre>
<h3>Group Policy Preferences (GPP) Files:</h3>
<p>The SYSVOL folder in a Domain Controller contains a Groups.xml file with stored configuration policies for account management, some of these may contain passwords for Administrator accounts in encrypted form. GPP uses a static public key for encryption so decrypting these credentials is trivial. Example path as seen from a remote SMB share:</p>
<pre><code class="lang-auto">\my_host\policies\{31B2F340-016D-11D2-945F-00C04FB984F9}\machine\preferences\groups\groups.xml
</code></pre>
<p>And its content:</p>
<pre><code class="lang-auto">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Groups clsid="{3125E937-EB16-4b4c-9934-544FC6D24D26}"&gt;
     &lt;User clsid="{DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1}" name="Administrator" image="2" changed="2018-07-18 20:46:06" uid="{EF57DA28-5F69-4530-A59E-AAB58578219D}"&gt;
          &lt;Properties action="U" newName="" fullName="" description="" cpassword="edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ" changeLogon="0" noChange="1" neverExpires="1" acctDisabled="0" userName="Administrator"/&gt;
     &lt;/User&gt;
&lt;/Groups&gt;
</code></pre>
<p>Now it‚Äôs time to decrypt the password found in the <em>cpassword</em> field:</p>
<pre><code class="lang-auto">gpp-decrypt &lt;encrypted_string&gt;
</code></pre>
<p>If you have a meterpreter session running on the machine you can automatize the process with this module:</p>
<pre><code class="lang-auto">use post/windows/gather/credentials/gpp
</code></pre>
<p>Or use the <a href="../../../external.html?link=https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1">Get-GPPPassword</a> script from PowerSploit.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="27" />
              <span class='post-likes'>27 Likes</span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/AlexiBesto.html'><span itemprop='name'>AlexiBesto</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-11-27T07:45:26Z' class='post-time'>
                    November 27, 2018,  7:45am
                  </time>
                  <meta itemprop='dateModified' content='2018-11-27T07:45:26Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thank you very much, this is extremely comprehensive.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/jl3.html'><span itemprop='name'>jl3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-11-27T08:05:42Z' class='post-time'>
                    November 27, 2018,  8:05am
                  </time>
                  <meta itemprop='dateModified' content='2018-11-27T08:05:42Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Checking the version of the running processes are very useful as well.</p>
<pre><code class="lang-auto">rpm -q &lt;package&gt;

apt-cache policy &lt;package&gt;
</code></pre>
<p>accesschk.exe for windows is great:</p>
<pre><code class="lang-auto">accesschk.exe /accepteula -uwcqv "Authenticated Users" *
</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/zSec.html'><span itemprop='name'>zSec</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-11-30T22:18:50Z' class='post-time'>
                    November 30, 2018, 10:18pm
                  </time>
                  <meta itemprop='dateModified' content='2018-11-30T22:18:50Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Sometimes you might have a system where wmic is not available for you.<br>
In this case you can still lookup services manually:</p>
<p>List all services:</p>
<blockquote>
<p>sc query</p>
</blockquote>
<p>Lookup a specific service:</p>
<blockquote>
<p>sc qc SERVICE_NAME</p>
</blockquote>
<p>This will show you the details of a service and also the binary path where you can check if it is unquoted or not.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/pry0cc.html'><span itemprop='name'>pry0cc</span></a>
                (Leader &amp; Offsec Engineer &amp; Forum Daddy)
                  Closed 
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-12-26T14:23:48Z' class='post-time'>
                    December 26, 2018,  2:23pm
                  </time>
                  <meta itemprop='dateModified' content='2018-12-26T14:23:48Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="sO8TdXHxwzouC56ufyyOcoxcR"></script>
  </body>
  
</html>
