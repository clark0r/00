<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Flying to the Moon - Programming - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="No, we are not going to talk about space travelling, or interplanetary missions. No. We are going to talk about Lua. Lua is Portuguese for Moon and it is a very nice scripting language that is usually hidden behind the P&amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="593.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="DILgtoJBt669OjiNSHY8C6ont"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="DILgtoJBt669OjiNSHY8C6ont"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Flying to the Moon&#39;" href="593.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/flying-to-the-moon/593" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/flying-to-the-moon/593" />
<meta property="og:title" content="Flying to the Moon" />
<meta name="twitter:title" content="Flying to the Moon" />
<meta property="og:description" content="No, we are not going to talk about space travelling, or interplanetary missions. No. We are going to talk about Lua. Lua is Portuguese for Moon and it is a very nice scripting language that is usually hidden behind the Python hype.  Anyway, why are we talking about Lua?. Well, I have been planning to write a series of articles about ‚ÄúHow does the hacker‚Äôs tools work?‚Äù, as a response to all those ‚ÄúHow does you use those hacker‚Äôs tools without having a clue of what you are doing?‚Äù. I started talki..." />
<meta name="twitter:description" content="No, we are not going to talk about space travelling, or interplanetary missions. No. We are going to talk about Lua. Lua is Portuguese for Moon and it is a very nice scripting language that is usually hidden behind the Python hype.  Anyway, why are we talking about Lua?. Well, I have been planning to write a series of articles about ‚ÄúHow does the hacker‚Äôs tools work?‚Äù, as a response to all those ‚ÄúHow does you use those hacker‚Äôs tools without having a clue of what you are doing?‚Äù. I started talki..." />
<meta property="og:article:section" content="Programming" />
<meta property="og:article:section:color" content="92278F" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="5 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="19 ‚ù§" />
<meta property="article:published_time" content="2016-06-14T17:04:12+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="593.html">Flying to the Moon</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/programming/61.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #92278F'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Programming</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Flying to the Moon'>
      <link itemprop='url' href='593.html'>
      <meta itemprop='datePublished' content='2016-06-14T17:04:12Z'>
        <meta itemprop='articleSection' content='Programming'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00pf.html'><span itemprop='name'>0x00pf</span></a>
                (pico)
              </span>

                <link itemprop="mainEntityOfPage" href="593.html">


              <span class="crawler-post-infos">
                  <time  datetime='2016-06-14T17:04:12Z' class='post-time'>
                    June 14, 2016,  5:04pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-14T20:49:26Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>No, we are not going to talk about space travelling, or interplanetary missions. No. We are going to talk about <a href="../../../external.html?link=http://www.lua.org/" rel="noopener nofollow ugc">Lua</a>. Lua is Portuguese for <em>Moon</em> and it is a very nice scripting language that is usually hidden behind the Python hype.</p>
<p>Anyway, why are we talking about Lua?. Well, I have been planning to write a series of articles about ‚ÄúHow does the hacker‚Äôs tools work?‚Äù, as a response to all those ‚ÄúHow does you use those hacker‚Äôs tools without having a clue of what you are doing?‚Äù. I started talking about <a href="../../../external.html?link=https://0x00sec.org/t/how-do-those-hackers-tools-work-proxychains/426" rel="noopener nofollow ugc">ProxyChains</a> some weeks ago and this is the second post of the series.</p>
<p>Again. Why Lua?. Ok, two of the most widely used hacker‚Äôs tools are wireshark and nmap‚Ä¶ And know what?.. both use Lua as scripting language. You can write  <a href="../../../external.html?link=https://wiki.wireshark.org/Lua/Examples" rel="noopener nofollow ugc">wireshark dissectors</a>, or sophisticated <a href="../../../external.html?link=https://nmap.org/book/nse.html#nse-ex1" rel="noopener nofollow ugc">recon scripts using NSE</a> (the Nmap Scripting Engine) and for doing both things you will have to write some Lua code.</p>
<h1><a name="p-2884-not-a-language-tutorial-1" class="anchor" href="#p-2884-not-a-language-tutorial-1"></a>Not a Language Tutorial</h1>
<p>If you were expecting a Lua tutorial, I regret to disappoint you. There are very good tutorials on-line, and , on top of that, the language is pretty simple.</p>
<p>So, we are going to see how to add Lua scripting capabilities to our own tools‚Ä¶ the same way that wireshark or nmap does.</p>
<h1><a name="p-2884-embedding-a-scripting-language-2" class="anchor" href="#p-2884-embedding-a-scripting-language-2"></a>Embedding a Scripting Language</h1>
<p>When you embedded a scripting language in your applications, there are always two thing you have to do:</p>
<ul>
<li>Load and run scripting code from external files</li>
<li>Allow the scripting code call functions provided by your application</li>
</ul>
<p>These two things are what we are going to elaborate through this post.</p>
<p>I will be using Lua 5.1 in the examples. I haven‚Äôt tried neither 5.0 nor 5.2. Probably any of them will be OK but I cannot assure that.</p>
<h1><a name="p-2884-embedding-a-lua-interpreter-3" class="anchor" href="#p-2884-embedding-a-lua-interpreter-3"></a>Embedding a Lua Interpreter</h1>
<p>Let‚Äôs start embedding a Lua interpreter in a C application and run an external Lua script. As you will shortly find out this is really simple:</p>
<pre><code class="lang-auto">#include &lt;lua5.1/lauxlib.h&gt;

static lua_State *l;

int
main(int argc, char *argv[])
{
  l = luaL_newstate ();
  luaL_openlibs (l);

  luaL_dofile (l, argv[1]);
  return 0;
}
</code></pre>
<p>The <code>luaL_newstate</code> initiates a new Lua environment. The <code>lua_State</code> var is, somehow, the handler for our Lua interpreter. Once the interpreter is started we need to load a minimal set of libraries. You have to do this if you want to print something on the console, open a file, do some math or manipulate strings. So, you better call <code>luaL_openlibs</code> just before you initialise your Lua environment.</p>
<p>Now, it is time to compile it:</p>
<pre><code>gcc -o test1 test1.c `pkg-config --cflags --libs lua5.1`
</code></pre>
<p>To test this first program, we need a Lua script. So let‚Äôs write the omnipresent <code>Hello World</code> in Lua:</p>
<pre><code class="lang-auto">print ("Hello World")
</code></pre>
<p>Let‚Äôs save it in a file named <code>hello.lua</code></p>
<p>Now we can run our application:</p>
<pre><code>$ ./test1 hello.lua
Hello World
</code></pre>
<p>So far so good.</p>
<h1><a name="p-2884-a-stack-machine-4" class="anchor" href="#p-2884-a-stack-machine-4"></a>A Stack Machine</h1>
<p>Before going further in our trip to the moon, we have to introduce the concept of stack machine. A stack machine is a kind of computer that uses a stack for its operations instead of registers as most of the processors you may know. Check the wiki for details <a href="../../../external.html?link=https://en.wikipedia.org/wiki/Stack_machine" class="inline-onebox" rel="noopener nofollow ugc">Stack machine - Wikipedia</a>.</p>
<p>Lua has been build this way, and all operations and symbols used by a Lua instance have to go in and out of a virtual stack. So, from this point on, we will see how we push data into this stack to communicate with the Lua interpreter and how we pop data from the Lua interpreter to get results.</p>
<p>We will see in a bit all this at work, just be ready to see some <code>push</code>s and <code>pop</code>s in the code to interact with the interpreter.</p>
<blockquote>
<p>Have you ever heard about <a href="../../../external.html?link=https://en.wikipedia.org/wiki/Forth_(programming_language)" rel="noopener nofollow ugc">Forth</a>?. it is a stack-based language used by the <a href="../../../external.html?link=https://en.wikipedia.org/wiki/Open_Firmware" rel="noopener nofollow ugc">Open Firmware</a> project. So if you want to configure some non-x86 machine it will be handy to know a little bit of Forth</p>
</blockquote>
<h1><a name="p-2884-getting-the-value-of-a-variable-5" class="anchor" href="#p-2884-getting-the-value-of-a-variable-5"></a>Getting the value of a variable</h1>
<p>We have just learned how to run Lua scripts from our apps. Now we are going to see how to execute a specific function in a Lua script and how to get values out of that script. To do this test we need a more sophisticated Lua script. Please, welcome <code>sum.lua</code></p>
<pre><code class="lang-auto">function sum (a,b)
	return a+b
end

r = sum (1,2)
</code></pre>
<p>This script defines a function that adds the two numbers it receives as a parameter, and then, in the main script body, it calls that function and stores the result in a global variable named <code>r</code>.</p>
<p>Let‚Äôs see how we can run the sum function from our app and how we can get the value of r.</p>
<pre><code class="lang-auto">#include &lt;stdio.h&gt;

#include &lt;lua5.1/lauxlib.h&gt;

static lua_State *l;

int
main(int argc, char *argv[])
{
  l = luaL_newstate ();
  luaL_openlibs (l);

  luaL_dofile (l, "sum.lua");

  /* Read Global var */
  lua_getglobal (l, "r");
  if (!lua_isnumber (l, -1)) return -1;
  printf ("Script calculation is: %d\n", (int)lua_tonumber(l, -1));
  lua_pop (l, 1);


  return 0;
}

</code></pre>
<p>The beginning of our program initialises the Lua context, as usual, and then it opens and executes the <code>sum.lua</code> file.</p>
<p>The next thing the program does is to get the value of <code>r</code>, the variable set in our Lua script. Any global symbol in the Lua environment can be accessed with the <code>lua_getglobal</code> function. This function will add to the Lua virtual stack the symbol passed as second parameter. In this case the global var <code>r</code>.</p>
<p>Then it checks if the result is actually a number. The <code>lua_isnumber</code> does this test. The second parameter is the index in the virtual stack. The stack pointer points to the next available position in the stack, so the value -1 references the last value pushed into the stack.</p>
<p>Now we know that we have a Lua number in the top of the stack. We have to convert it to a C number before being able to print it in our C program. This is common to most scripting languages out there. They manage their own internal types in order to provide all their magic (<a href="../../../external.html?link=https://en.wikipedia.org/wiki/Duck_typing" rel="noopener nofollow ugc">duck typing</a> for instance) but, when those languages are embedded, a bit of conversion code is always needed. Anyway, <code>lua_tonumber</code> converts the object in the stack to a number.</p>
<p>Finally we have to clean the stack. We have used our global and we do not need it any more, so we can remove it from the stack using <code>lua_pop</code>. The second parameter here, indicates how many objects we want to pop from the stack.</p>
<h1><a name="p-2884-smart-configuration-files-6" class="anchor" href="#p-2884-smart-configuration-files-6"></a>Smart Configuration files</h1>
<p>What we have discussed so far does not look very impressive, but, as suggested in the official Lua documentation, we had already set up the fundamentals for a smart configuration system for our applications.</p>
<p>Let‚Äôs write a very simple Lua script to configure our application</p>
<pre><code class="lang-auto">user = os.getenv("USER")

if user == "root" then
        home_dir = "/root"
else
        home_dir ="/home/"..user
end
</code></pre>
<p>So, this script sets two configuration parameters, a user name and a home folder name. User name is obtained from the current environment and the folder directory is dynamically determined based on the user name. This is the power of using a scripting language to write configuration files. you can run code to produce your configuration on the fly based on, for instance, the current environment.</p>
<p>For completeness, this is a small C program, using this configuration file:</p>
<pre><code class="lang-auto">#include &lt;stdio.h&gt;
#include &lt;lua5.1/lauxlib.h&gt;

static lua_State *l;

int
main(int argc, char *argv[])
{
  l = luaL_newstate ();
  luaL_openlibs (l);

  luaL_dofile (l, "config.lua");
  lua_getglobal (l, "home_dir");
  printf ("Configuration folder is:%s\n", (char*)lua_tostring(l,-1));

  lua_close (l);
  return 0;
}

</code></pre>
<p>You can define more complex data structures that may be more suitable for your current application‚Ä¶ but that is a bit beyond of this already quite long post :). You should go and read the original Lua documentation for all the details and to get to know the <code>tables</code>, a powerful Lua data type.</p>
<h1><a name="p-2884-calling-a-function-7" class="anchor" href="#p-2884-calling-a-function-7"></a>Calling a function</h1>
<p>At this point, we have introduce almost everything needed to call a function. Functions are also global objects (at least for our current knowledge of the environment). We already know how to get them in the stack (<code>lua_getglobal</code>), and we know how to also push data into the stack. This is how we are going to pass parameters.</p>
<p>The last missing part is how to tell Lua that we want it to call a function using all those values in the stack.</p>
<p>Let‚Äôs go back to our sum example and let‚Äôs do some small changes:</p>
<pre><code class="lang-auto">#include &lt;stdio.h&gt;

#include &lt;lua5.1/lauxlib.h&gt;

static lua_State *l;

int
main(int argc, char *argv[])
{
  l = luaL_newstate ();
  luaL_openlibs (l);

  luaL_dofile (l, "sum.lua");

  lua_getglobal (l, "sum");
  lua_pushnumber (l, 10);
  lua_pushnumber (l, 20);
  lua_pcall (l, 2, 1, 0);
  printf ("Result:%d\n", (int)lua_tonumber(l, -1));

  lua_pop (l, 1);
  lua_close (l);
  return 0;
}

</code></pre>
<p>The interface is pretty much the same that the one we used to access the global var, but now, using the <code>lua_pcall</code> function to actually execute the function. This is a summary of how it works:</p>
<ul>
<li>Get the function using <code>lua_getglobal</code></li>
<li>Push the parameters in the stack</li>
<li>Invoke the function using <code>pcall</code>. The second parameter is the number of parameters we are passing to the function. The third parameter is the number of values returned by the function. The forth parameter we will not discuss now.</li>
<li>The return value(s) will be pushed into the virtual stack, so we can get them, and convert to C types as required.</li>
<li>Finally we clean-up the stack removing the return value</li>
</ul>
<p>This may look a bit cumbersome, but it can be easily improved using a vararg function. Check this link for a reference implementation: <a href="../../../external.html?link=https://www.lua.org/pil/25.3.html" class="inline-onebox" rel="noopener nofollow ugc">Programming in Lua : 25.3</a></p>
<h1><a name="p-2884-the-last-piece-8" class="anchor" href="#p-2884-the-last-piece-8"></a>The last piece</h1>
<p>The last piece to complete our Lua interface is to enable our Lua script to call C functions. Adding a C function to the current Lua environment is pretty simple:</p>
<pre><code class="lang-auto">lua_pushcfunction (l, c_func);
lua_setglobal (l, "c_func");
</code></pre>
<p>The code above will add a function named <code>c_func</code> (that we will define right away) to the Lua environment, and creates a global object named <code>c_func</code> that any lua script can actually execute. The C function will look like this:</p>
<pre><code class="lang-auto">int
c_func (lua_State *L)
{
   int x;
   if (lua_gettop(L) &gt;= 0) {
     x = (int) lua_tonumber (L, -1);
     printf ("Received : %d\n", x);
     /* Returning x + 1*/
     lua_pushnumber(L, x + 1);
   }
   return 1;
}
</code></pre>
<p>It should look familiar at this point. The function will receive the current Lua environment as unique parameter. When calling the function from the Lua script, the parameters are automatically pushed into the Lua virtual stack before transferring control to the C function. In the same way, any return value (we can return more than one) have to be pushed into the stack before the C function returns.</p>
<p>So, this function, does the following:</p>
<ul>
<li>Check that there is at least one value in the stack</li>
<li>Takes that value and converts it to a number (yes, you are right, we should check that it is actually a number‚Ä¶ wonder how?)</li>
<li>Then we print the value so we can check the parameter made it to our C function</li>
<li>And finally we push the function return value that, in this case, is the function parameter increased by 1.</li>
</ul>
<p>Now we can write Lua scripts like this (let‚Äôs call it <code>c.lua</code>):</p>
<pre><code class="lang-auto">x = 10
print (c_func(x))
</code></pre>
<p>That will output</p>
<pre><code>$ ./test3 c.lua
Received : 10
11
</code></pre>
<h1><a name="p-2884-conclusions-9" class="anchor" href="#p-2884-conclusions-9"></a>Conclusions</h1>
<p>This is the very basics to get a Lua interpreter integrated into your application, in the same way that wireshark or nmap does. Now, you are a step closer to write your own hacking tools‚Ä¶ or any other tool that requires a scripting language ( <a href="../../../external.html?link=https://en.wikipedia.org/wiki/Category:Lua-scripted_video_games" rel="noopener nofollow ugc">https://en.wikipedia.org/wiki/Category:Lua-scripted_video_games</a> )</p>
<p>Do you have an idea for a hacking tool using an scripting language?.. Let us know!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="7" />
              <span class='post-likes'>7 Likes</span>
            </div>


            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/_py.html'><span itemprop='name'>_py</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-14T17:08:11Z' class='post-time'>
                    June 14, 2016,  5:08pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-14T17:08:11Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Damn! I knew that Lua was used in wireshark, but integrating it into C? Never thought of it that way. Awesome post <a class="mention" href="../../u/0x00pf.html">@0x00pf</a>!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Cromical.html'><span itemprop='name'>Cromical</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-15T19:02:19Z' class='post-time'>
                    June 15, 2016,  7:02pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-15T19:02:19Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Great article! I honestly thought that Lua was used for scripting in video games. And at the end of the article you said [quote=‚Äú0x00pf, post:1, topic:593‚Äù]<br>
Do you have an idea for a hacking tool using an scripting language?.. Let us know!<br>
[/quote]<br>
And just to add on I believe I do‚Ä¶</p>
<p>So how the tool would work is (and it would be scripted in Python for anyone wondering)- is that you would send a link to someone, and when they click on said link all they see is a picture similar to what you see when you press ‚Äúview image‚Äù in Google Images.</p>
<p>Little do they know, perhaps that while viewing this seemingly harmless image. That it is in fact actually logging your IP.</p>
<p>And then you could add on attacking capabilities to the tool from there and so on.</p>
<p>Hope you like the idea! <img src="../../../0x00sec.org/images/emoji/twitter/smileyc164.html?v=9" title=":smiley:" class="emoji" alt=":smiley:"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/oaktree.html'><span itemprop='name'>oaktree</span></a>
                (oaktree)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-15T20:19:26Z' class='post-time'>
                    June 15, 2016,  8:19pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-15T20:26:45Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="Cromical" data-post="3" data-topic="593">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/d.clarkee.co.uk/cromical/48/791_2.png" class="avatar"> Cromical:</div>
<blockquote>
<p>So how the tool would work is (and it would be scripted in Python for anyone wondering)- is that you would send a link to someone, and when they click on said link all they see is a picture similar to what you see when you press ‚Äúview image‚Äù in Google Images.</p>
</blockquote>
</aside>
<p>What if I told you‚Ä¶ this already exists, and is easier to do in PHP‚Ä¶</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/_py.html'><span itemprop='name'>_py</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-15T20:25:18Z' class='post-time'>
                    June 15, 2016,  8:25pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-15T20:25:18Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Then you are a pico hater and you should be ashamed!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/oaktree.html'><span itemprop='name'>oaktree</span></a>
                (oaktree)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-15T20:26:19Z' class='post-time'>
                    June 15, 2016,  8:26pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-15T20:26:19Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I see how this may be unclear, that was meant for Cromical.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/IoTh1nkN0t.html'><span itemprop='name'>IoTh1nkN0t</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-15T22:21:29Z' class='post-time'>
                    June 15, 2016, 10:21pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-15T22:21:29Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Awesome tutorial man ^^<br>
I had been thinking about learning Lua for a while.<br>
<em>Also Ada, however I found out I don‚Äôt have to write missile guiding software, or Nuclear Power Plant driver modules, so I let that one slide.</em></p>
<p>Anyway I think this might be the perfect midway, between C and a scripting language.<br>
It seems to work better than Cython, but that might just be because I hate Python.</p>
<aside class="quote no-group" data-username="0x00pf" data-post="1" data-topic="593">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/d.clarkee.co.uk/0x00pf/48/13708_2.png" class="avatar"> 0x00pf:</div>
<blockquote>
<p>This is the very basics to get a Lua interpreter integrated into your application, in the same way that wireshark or nmap does. Now, you are a step closer to write your own hacking tools‚Ä¶ or any other tool that requires a scripting language ( <a href="../../../external.html?link=https://en.wikipedia.org/wiki/Category:Lua-scripted_video_games" rel="noopener nofollow ugc">https://en.wikipedia.org/wiki/Category:Lua-scripted_video_games</a> )</p>
<p>Do you have an idea for a hacking tool using an scripting language?.. Let us know!</p>
</blockquote>
</aside>
<p>Tons of ideas, after packet forging tutorial part 2.0,<br>
I‚Äôll write a DNS amplification script in Perl ^^</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00_Jinx.html'><span itemprop='name'>0x00_Jinx</span></a>
                (0x00Jinx)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-15T23:23:14Z' class='post-time'>
                    June 15, 2016, 11:23pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-15T23:23:14Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Nice Tutorial man! I wonder though, is there any other languages we can extend with a different language? I mean, we have C extending Python, and now we have Lua extending C, so there has to be more right?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/OilSlick.html'><span itemprop='name'>OilSlick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-15T23:59:16Z' class='post-time'>
                    June 15, 2016, 11:59pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-15T23:59:16Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I think i may have just fell in love with Lua‚Ä¶ Time to play around a bit. My time long spent with python may start to suffer now <img src="../../../0x00sec.org/images/emoji/twitter/winkc164.html?v=9" title=":wink:" class="emoji" alt=":wink:"></p>
<p>Great post!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_10' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00pf.html'><span itemprop='name'>0x00pf</span></a>
                (pico)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-16T12:49:41Z' class='post-time'>
                    June 16, 2016, 12:49pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-16T12:49:41Z'>
              <span itemprop='position'>10</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Sounds interesting <a class="mention" href="../../u/cromical-2.html">@Cromical</a> . As <a class="mention" href="../../u/oaktree.html">@oaktree</a> said, there are many different ways of doing something. I think all of them are valuable in a sense, at least, you will always learn something which is a good thing.</p>
<p>This Python idea looks interesting in the sense that you can build in one single program your webserver (a simple instantiation of SimpleHTTPServer module) and your scripting capabilities.</p>
<p>It would be nice if you make a post out of it!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_11' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00pf.html'><span itemprop='name'>0x00pf</span></a>
                (pico)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-16T12:53:17Z' class='post-time'>
                    June 16, 2016, 12:53pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-16T12:53:17Z'>
              <span itemprop='position'>11</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks <span class="mention">@unh0lys0da</span>. Glad to hear you liked.</p>
<p>I‚Äôm really looking forward to your packet forging articles‚Ä¶ and going the Perl way is really cool!!!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_12' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00pf.html'><span itemprop='name'>0x00pf</span></a>
                (pico)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-16T13:03:20Z' class='post-time'>
                    June 16, 2016,  1:03pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-16T13:03:20Z'>
              <span itemprop='position'>12</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Almost any single scripting language out there have this possibility. I have personally tried:</p>
<ul>
<li>Python</li>
<li>Guile (the GNU scheme version)</li>
<li>Mono (it provides a pretty good interface)</li>
<li>Perl (maybe one of the trickiest)</li>
<li>Java (via JNI‚Ä¶ a lot more verbose that all others)</li>
<li>tcl/tk (also very easy and a quick way to build a <em>standard multiplatform</em> GUI)</li>
<li>Lua (as you already know‚Ä¶ this was actually the last I tried)</li>
</ul>
<p>I haven‚Äôt yet played, at this level, with Rust or Go. Rust seems to be pretty straight forward. For Go, looks possible but, at first glance, looks like there are a bit less information available.</p>
<p>I know it is also possible with Ruby but I never tried myself.</p>
<p>I cannot recall more scripting languages right now <img src="../../../0x00sec.org/images/emoji/twitter/stuck_out_tonguec164.html?v=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_13' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/CtrlAltDelete.html'><span itemprop='name'>CtrlAltDelete</span></a>
                (CTRLtheALTofDELETE)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-16T13:26:53Z' class='post-time'>
                    June 16, 2016,  1:26pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-16T13:26:53Z'>
              <span itemprop='position'>13</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This is awesome <img src="../../../0x00sec.org/images/emoji/twitter/slight_smilec164.html?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> I‚Äôve always liked Lua.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_14' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Cromical.html'><span itemprop='name'>Cromical</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-16T19:41:51Z' class='post-time'>
                    June 16, 2016,  7:41pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-16T19:41:51Z'>
              <span itemprop='position'>14</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="oaktree" data-post="4" data-topic="593">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/d.clarkee.co.uk/oaktree/48/4077_2.png" class="avatar"> oaktree:</div>
<blockquote>
<p>What if I told you‚Ä¶ this already exists, and is easier to do in PHP‚Ä¶</p>
</blockquote>
</aside>
<p>I very well know that. I made my own in PHP. However I think I could better implement it in Python as well as add on new features. Which was the entire gist of that part of my reply.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_15' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Cromical.html'><span itemprop='name'>Cromical</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-06-16T19:42:45Z' class='post-time'>
                    June 16, 2016,  7:42pm
                  </time>
                  <meta itemprop='dateModified' content='2016-06-16T19:42:45Z'>
              <span itemprop='position'>15</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Ah thanks mate! I‚Äôll keep the idea in mind!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_16' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/system.html'><span itemprop='name'>system</span></a>
                (system)
                  Closed 
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-21T00:30:19Z' class='post-time'>
                    January 21, 2018, 12:30am
                  </time>
                  <meta itemprop='dateModified' content='2018-01-21T00:30:19Z'>
              <span itemprop='position'>16</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="DILgtoJBt669OjiNSHY8C6ont"></script>
  </body>
  
</html>
