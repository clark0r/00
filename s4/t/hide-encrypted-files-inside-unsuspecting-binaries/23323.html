<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Hide Encrypted Files inside unsuspecting Binaries - Programming - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="Hiding Encrypted Files within unsuspecting Binaries 
This is pretty basic stuff if youâ€™re are familiar with the ELF binary format as well as basic experience with creating your own basic Trojans with Elf binary injection&amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="23323.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="jmXvweZdwx1yM5GGvvGQewn6l"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="jmXvweZdwx1yM5GGvvGQewn6l"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Hide Encrypted Files inside unsuspecting Binaries&#39;" href="23323.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/optimized/3X/2/2/2299264deb70838a100e5ad3e29ee71d97bbdd5e_2_1024x640.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/optimized/3X/2/2/2299264deb70838a100e5ad3e29ee71d97bbdd5e_2_1024x640.png" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/hide-encrypted-files-inside-unsuspecting-binaries/23323" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/hide-encrypted-files-inside-unsuspecting-binaries/23323" />
<meta property="og:title" content="Hide Encrypted Files inside unsuspecting Binaries" />
<meta name="twitter:title" content="Hide Encrypted Files inside unsuspecting Binaries" />
<meta property="og:description" content="Hiding Encrypted Files within unsuspecting Binaries  This is pretty basic stuff if youâ€™re are familiar with the ELF binary format as well as basic experience with creating your own basic Trojans with Elf binary injection. However With a bit of creativity I have found other ways to use Elf binaries, not just for malicious intent for creating Trojan Horses, but also to hide sensitive data within unsuspecting binary files.  The whole point of this post is to spark creative ideas in others. And also..." />
<meta name="twitter:description" content="Hiding Encrypted Files within unsuspecting Binaries  This is pretty basic stuff if youâ€™re are familiar with the ELF binary format as well as basic experience with creating your own basic Trojans with Elf binary injection. However With a bit of creativity I have found other ways to use Elf binaries, not just for malicious intent for creating Trojan Horses, but also to hide sensitive data within unsuspecting binary files.  The whole point of this post is to spark creative ideas in others. And also..." />
<meta property="og:article:section" content="Programming" />
<meta property="og:article:section:color" content="92278F" />
<meta property="og:article:tag" content="malware" />
<meta property="og:article:tag" content="linux" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins ðŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="11 â¤" />
<meta property="article:published_time" content="2020-09-29T14:14:38+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="23323.html">Hide Encrypted Files inside unsuspecting Binaries</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/programming/61.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #92278F'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Programming</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/malware.html' class='discourse-tag' rel="tag">malware</a>, 
            <a href='../../tag/linux.html' class='discourse-tag' rel="tag">linux</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Hide Encrypted Files inside unsuspecting Binaries'>
      <link itemprop='url' href='23323.html'>
      <meta itemprop='datePublished' content='2020-09-29T14:14:38Z'>
        <meta itemprop='articleSection' content='Programming'>
      <meta itemprop='keywords' content='malware, linux'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/digitalXmage.html'><span itemprop='name'>digitalXmage</span></a>
                (...)
              </span>

                <link itemprop="mainEntityOfPage" href="23323.html">

                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/3X/2/2/2299264deb70838a100e5ad3e29ee71d97bbdd5e.png">

              <span class="crawler-post-infos">
                  <time  datetime='2020-09-29T14:14:38Z' class='post-time'>
                    September 29, 2020,  2:14pm
                  </time>
                  <meta itemprop='dateModified' content='2020-09-29T14:14:38Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><strong>Hiding Encrypted Files within unsuspecting Binaries</strong></p>
<p>This is pretty basic stuff if youâ€™re are familiar with the ELF binary format as well as basic experience with creating your own basic Trojans with Elf binary injection. However With a bit of creativity I have found other ways to use Elf binaries, not just for malicious intent for creating Trojan Horses, but also to hide sensitive data within unsuspecting binary files.</p>
<p>The whole point of this post is to spark creative ideas in others. And also give back to the community, that has given me a lot in return.</p>
<p><strong>Use case</strong></p>
<p>Lets say You have some encrypted files in a directory. Well Itâ€™s good thatâ€™s itâ€™s encrypted and I hope youâ€™ve hidden your private key well! However As an extra level of security, How about hiding those encrypted files inside unsuspecting binary programs? So to any Hacker, They look like regular binary files, and they execute them as expected ,because they are normal executable <img src="../../../0x00sec.org/images/emoji/twitter/winkc164.html?v=9" title=":wink:" class="emoji" alt=":wink:"> . However Inside the executable is a secret encrypted file embedded into the binary of the file.</p>
<p>It reminds me of how Mr robot hides encrypted files within CDâ€™s</p>
<p><strong>The Code</strong></p>
<p><strong>The Structs Used</strong></p>
<pre><code>/*Used for pointing to the mapped binary in memory*/

struct Host
{
     uint8_t *host;
};

/*used as a guide to where the secret file is located in the binary,
* this will be embedded into the .NOTE section for easy reference*/

struct secret_map
{

    Elf64_Addr offset;
    int64_t size;

};
</code></pre>
<p><strong>Writing An Encrypted File into Binary The Algorithm</strong></p>
<ol>
<li>
<p>Read the Encrypted File from the user onto the Heap. Then Find an available Code cave (unused space) big enough for the File, and Write the File to the unused space. Then save the coordinates to the Struct Secret_map (our roadmap).</p>
<pre><code>void write_secret_file()
{
   Elf64_Ehdr *ehdr; Elf64_Phdr *phdr;

 ehdr = (Elf64_Ehdr *)host.host;
 phdr = (Elf64_Phdr *)&amp;host.host[ehdr-&gt;e_phoff];


 /*open key file and mmap to heap*/
 int fd = open(sfile,O_RDONLY);

 struct stat st;
 lstat(sfile,&amp;st);

 char *secret_file = malloc(sizeof(char)*st.st_size);

 /*read file into allocated memory*/
 read(fd,secret_file,st.st_size);


 int cave_offset,cave_length; cave_offset = cave_length = 0;
 for(int i=0;i&lt;ehdr-&gt;e_phnum;i++)
 {
 	/*calculate start*/
 	cave_offset = phdr[i].p_offset + phdr[i].p_filesz;
 	/*next calculate the gap*/
 	cave_length = phdr[i+1].p_offset - cave_offset;

 	if(cave_length&gt;=st.st_size)
 	{
 		printf("[+]Found cave to fit secret file\n");
 		printf("cave offset = %d and length = %d\n",cave_offset,cave_length);


 		/*memcpy secret_file into code cave*/
 		memcpy((host.host+cave_offset),secret_file,st.st_size);
 		printf("[+]Secret file injected into binary\n");

                                /*save coordinates to our roadmap*/
 		map.offset = cave_offset;
 		map.size = st.st_size;
 	//	map.size = cave_length;	

 		break;
 	}

 }
 free(secret_file); }
</code></pre>
</li>
<li>
<p>Then inject the coordinates into the .NOTE segment of the ELF binary, as a roadmap to help locate the Encrypted file for extraction.</p>
<pre><code> /*Save secret file coordinates in struct and write as a roadmap to .Note
 * @offset = address of where secret file is located in binary
* @length = length of bytes of secret file in binary*/
void write_roadmap()

   {

     Elf64_Ehdr *ehdr ; Elf64_Phdr *phdr; Elf64_Shdr *shdr;
     ehdr = (Elf64_Ehdr *)host.host;
	    phdr = (Elf64_Phdr *)&amp;host.host[ehdr-&gt;e_phoff];

    for(int i=0;i&lt;ehdr-&gt;e_phnum;i++)
    {
 	if(phdr[i].p_type==PT_NOTE)
 	{
 
 	
 		if(sizeof(struct secret_map)&lt;=phdr[i].p_filesz)
 		{
 			printf("[+]Secret roadmap struct can fit in .Note\n");
 
 			/*Malloc struct*/
 			struct secret_map *structure = malloc(sizeof(struct secret_map));
 			structure-&gt;offset = map.offset;
 			structure-&gt;size = map.size;
 				
 			/*memcopy struct to start of note*/
 			memcpy((host.host+phdr[i].p_offset),structure,sizeof(struct secret_map));

 			
 			free(structure);

 			printf("[+]Secret roadmap injected into .Note segment\n");
 		}
 		else
 		{
 			printf("[-]Secret roadmap struct to small for .NOTE\n");
 		}
 		
 		break;
 	}	
          }
         }
</code></pre>
</li>
</ol>
<p>Reading An Encrypted File from Binary Algorithm (Extraction)</p>
<ol>
<li>
<p>Check Elf binary to see if there is a roadmap struct, by Reading the .NOTE section. Youâ€™ll know if a roadmap exists or not, as When reading the struct youâ€™ll receive some sort of error.</p>
</li>
<li>
<p>Once you have the roadmap, then use the roadmap to locate where the Encrypted File is in the binary and extract the Encrypted File from the Binary onto the Heap. Then Write the allocated memory into a file. Thus we have extracted the Encrypted File. And then the User can then use their private key to unencrypted the file for whatever use they needed that encrypted File for.</p>
<pre><code>/*Read structure from .Note*/
void read_roadmap()
{
 Elf64_Ehdr *ehdr; Elf64_Phdr *phdr;
 
 ehdr = (Elf64_Ehdr *)host.host;
 phdr = (Elf64_Phdr *)&amp;host.host[ehdr-&gt;e_phoff];

 struct secret_map *structure = malloc(sizeof(struct secret_map));

 for(int i=0;i&lt;ehdr-&gt;e_phnum;i++)
 {
 	if(phdr[i].p_type==PT_NOTE)
 	{
 		memcpy(structure,host.host+phdr[i].p_offset,sizeof(struct secret_map));
 		break;
 	}
 }

 map.offset = structure-&gt;offset;
 map.size = structure-&gt;size;

 printf("[+]Obtained roadmap from .NOTE segment\n");
 
 free(structure);	
 }
void read_secret_file()
{
 /*useing map to obtain the location of secret file*/
 read_roadmap();

 /*mmap some memory enough on the heap to get file from binary into allocated memory*/
 char *buf = malloc(sizeof(char)*map.size);

 /*memcpy into buf*/
 memcpy(buf,host.host+map.offset,map.size);
 
 /*write to a temp "key" file*/
 FILE *fd = fopen(sfile,"a+");

 fwrite(buf,map.size,1,fd); 

 fclose(fd);	

}
</code></pre>
</li>
</ol>
<p><strong>Why Encrypted Files</strong></p>
<p>If you inject Unencrypted Data into a binary File. If you just Open the binary in a text editor such as vim, Itâ€™s actually pretty simple to find any important data in there, as itâ€™s usually in plain English. Which why it is important It should be encrypted Files. Unless youâ€™re are reading/writing the bytes themselves.</p>
<p><strong>Improvements</strong></p>
<ol>
<li>Split the encrypted file and break it apart into smaller code caves, so it makes it harder to piece together.<br>
2. Align the .NOTE section properly to not give any warnings or indication there is something in thereâ€¦</li>
</ol>
<p><strong>Security</strong></p>
<p>This is just a another layer of security and extra step in trying to Hide important data for a hacker. You could say That all they need to find is the roadmap struct within the .note. Which is true, but to anyone else, Know one knows there is a struct located in the .NOTE segment. And even then, in order to read it correctly, youâ€™ll need to understand what type of struct is there, the size etc.</p>
<p>Essentially Creating an Extra step, extra work for the hacker, And depending on the hackerâ€™s skill level, hiding an encrypted File inside an unsuspecting Executable, could be enough to deter them from actually looking and dissecting the binary. Essentially skill level or laziness could stop them from going further, and they may just assume the executable is just an executable with nothing interesting inside.</p>
<p>Remember this is just a basic prototype, there are many ways to make it much harder to find sensitive data.</p>
<p><strong>Notes</strong></p>
<p>This is only works currently with PIE , position independent executable. I plan on improving on this concept to improve security, hiding it better, as well as being able to inject into other types of executable ELF types within Linux. This is just a proof of concept. There are a few potential bugs. But like I say this is just a proof of concept, and spark some more creativity in the community</p>
<p><strong>Demonstration Screenshots</strong></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/3X/2/2/2299264deb70838a100e5ad3e29ee71d97bbdd5e.png" data-download-href="/uploads/short-url/4W4m2L6WopdOARFc2vzvFfV3grY.png?dl=1" title="Screenshot from 2020-09-29 14-13-27" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/optimized/3X/2/2/2299264deb70838a100e5ad3e29ee71d97bbdd5e_2_690x431.png" alt="Screenshot from 2020-09-29 14-13-27" data-base62-sha1="4W4m2L6WopdOARFc2vzvFfV3grY" width="690" height="431" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/2/2/2299264deb70838a100e5ad3e29ee71d97bbdd5e_2_690x431.png, https://0x00sec.s3.amazonaws.com/optimized/3X/2/2/2299264deb70838a100e5ad3e29ee71d97bbdd5e_2_1035x646.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/2/2/2299264deb70838a100e5ad3e29ee71d97bbdd5e.png 2x" data-small-upload="../../../0x00sec.s3.amazonaws.com/optimized/3X/2/2/2299264deb70838a100e5ad3e29ee71d97bbdd5e_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">Screenshot from 2020-09-29 14-13-27</span><span class="informations">1280Ã—800 52.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/3X/4/0/40ce011063333b971acc135b833f5e2d683b192f.png" data-download-href="/uploads/short-url/9fhV2oxe7YZXyTuf3RqCFO6hjNJ.png?dl=1" title="Screenshot from 2020-09-29 14-13-44" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/optimized/3X/4/0/40ce011063333b971acc135b833f5e2d683b192f_2_690x431.png" alt="Screenshot from 2020-09-29 14-13-44" data-base62-sha1="9fhV2oxe7YZXyTuf3RqCFO6hjNJ" width="690" height="431" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/4/0/40ce011063333b971acc135b833f5e2d683b192f_2_690x431.png, https://0x00sec.s3.amazonaws.com/optimized/3X/4/0/40ce011063333b971acc135b833f5e2d683b192f_2_1035x646.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/4/0/40ce011063333b971acc135b833f5e2d683b192f.png 2x" data-small-upload="../../../0x00sec.s3.amazonaws.com/optimized/3X/4/0/40ce011063333b971acc135b833f5e2d683b192f_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">Screenshot from 2020-09-29 14-13-44</span><span class="informations">1280Ã—800 86.2 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/3X/5/1/511017674f821b603729799e5312f4ab744c5b0d.png" data-download-href="/uploads/short-url/bz79lJrABCjHSKJdvheNvggQZXL.png?dl=1" title="Screenshot from 2020-09-29 14-14-56" rel="noopener nofollow ugc"><img src="../../../0x00sec.s3.amazonaws.com/optimized/3X/5/1/511017674f821b603729799e5312f4ab744c5b0d_2_690x431.png" alt="Screenshot from 2020-09-29 14-14-56" data-base62-sha1="bz79lJrABCjHSKJdvheNvggQZXL" width="690" height="431" srcset="https://0x00sec.s3.amazonaws.com/optimized/3X/5/1/511017674f821b603729799e5312f4ab744c5b0d_2_690x431.png, https://0x00sec.s3.amazonaws.com/optimized/3X/5/1/511017674f821b603729799e5312f4ab744c5b0d_2_1035x646.png 1.5x, https://0x00sec.s3.amazonaws.com/original/3X/5/1/511017674f821b603729799e5312f4ab744c5b0d.png 2x" data-small-upload="../../../0x00sec.s3.amazonaws.com/optimized/3X/5/1/511017674f821b603729799e5312f4ab744c5b0d_2_10x10.png"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">Screenshot from 2020-09-29 14-14-56</span><span class="informations">1280Ã—800 50.5 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg></div></a></div></p>
<p><strong>Full Code Available Here</strong></p>
<p>My code only accepts .GPG files, meaning it refuses to inject Files which have not been encrypted with GPG. And again itâ€™s a quick prototype, there are a few bugs, and the error checking isnâ€™t really implemented properly, as itâ€™s a very quick prototype proof of concept</p>
<aside class="onebox allowlistedgeneric">
  <header class="source">
      <img src="../../../external.html?link=https://github.githubassets.com/favicons/favicon.svg" class="site-icon" width="32" height="32">
      <a href="../../../external.html?link=https://github.com/digitalXmage/HideMe" target="_blank" rel="noopener nofollow ugc">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="../../../0x00sec.s3.amazonaws.com/original/3X/8/7/87821f82cacd56abc33104aba5594aa42b038be4.jpeg" class="thumbnail onebox-avatar" width="360" height="360">

<h3><a href="../../../external.html?link=https://github.com/digitalXmage/HideMe" target="_blank" rel="noopener nofollow ugc">digitalXmage/HideMe</a></h3>

<p>Hide Encrypted .gpg Files inside an unsuspecting Binary Executable - digitalXmage/HideMe</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p><strong>Conclusion</strong></p>
<p>I Hope someone has learnt something from this. Or if not, at least open some doors in terms of creativity. This is my first Actual Write up post. Lets Hope itâ€™s not completely uselessâ€¦</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="7" />
              <span class='post-likes'>7 Likes</span>
            </div>


            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/Ninja243.html'><span itemprop='name'>Ninja243</span></a>
                (Mweya Ruider)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2020-09-29T15:55:34Z' class='post-time'>
                    September 29, 2020,  3:55pm
                  </time>
                  <meta itemprop='dateModified' content='2020-09-29T15:55:34Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This is insane!</p>
<p>Thanks for the really well written post!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/digitalXmage.html'><span itemprop='name'>digitalXmage</span></a>
                (...)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2020-09-29T17:19:32Z' class='post-time'>
                    September 29, 2020,  5:19pm
                  </time>
                  <meta itemprop='dateModified' content='2020-09-29T17:19:32Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks! Youâ€™ve made my day <img src="../../../0x00sec.org/images/emoji/twitter/slight_smilec164.html?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/system.html'><span itemprop='name'>system</span></a>
                (system)
                  Closed 
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2021-01-29T06:14:42Z' class='post-time'>
                    January 29, 2021,  6:14am
                  </time>
                  <meta itemprop='dateModified' content='2021-01-29T06:14:42Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="jmXvweZdwx1yM5GGvvGQewn6l"></script>
  </body>
  
</html>
