<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Reverse Engineering Challenge: Disassemble it! - Challenges - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="Are you trying to master the ELF format and you need some stuff to try your new skills?.. well, this is a simple challenge for you to try. 
The Challenge
A colleague that works as Network Engineer for an important compan&amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="987.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="EnDmk1WrbnSQwSEyyo3eM97Fs"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="EnDmk1WrbnSQwSEyyo3eM97Fs"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Reverse Engineering Challenge: Disassemble it!&#39;" href="987.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/reverse-engineering-challenge-disassemble-it/987" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/reverse-engineering-challenge-disassemble-it/987" />
<meta property="og:title" content="Reverse Engineering Challenge: Disassemble it!" />
<meta name="twitter:title" content="Reverse Engineering Challenge: Disassemble it!" />
<meta property="og:description" content="Are you trying to master the ELF format and you need some stuff to try your new skills?.. well, this is a simple challenge for you to try.  The Challenge A colleague that works as Network Engineer for an important company has captured a piece of malware that somebody was trying to use against the company. Your friend tried to take a look at the code using objdump but he couldn‚Äôt get anything so he come to you, an expert hacker, master of the Elfs to help him get the assembly code for that malwar..." />
<meta name="twitter:description" content="Are you trying to master the ELF format and you need some stuff to try your new skills?.. well, this is a simple challenge for you to try.  The Challenge A colleague that works as Network Engineer for an important company has captured a piece of malware that somebody was trying to use against the company. Your friend tried to take a look at the code using objdump but he couldn‚Äôt get anything so he come to you, an expert hacker, master of the Elfs to help him get the assembly code for that malwar..." />
<meta property="og:article:section" content="Reverse Engineering" />
<meta property="og:article:section:color" content="12A89D" />
<meta property="og:article:section" content="Challenges" />
<meta property="og:article:section:color" content="283890" />
<meta property="og:article:tag" content="antiforensics" />
<meta property="og:article:tag" content="elf" />
<meta property="og:article:tag" content="reverseengineering" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="5 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="42 ‚ù§" />
<meta property="article:published_time" content="2016-08-28T17:33:11+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="987.html">Reverse Engineering Challenge: Disassemble it!</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/reverse-engineering/58.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #12A89D'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Reverse Engineering</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/reverse-engineering/challenges/13.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #283890'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Challenges</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/antiforensics.html' class='discourse-tag' rel="tag">antiforensics</a>, 
            <a href='../../tag/elf.html' class='discourse-tag' rel="tag">elf</a>, 
            <a href='../../tag/reverseengineering.html' class='discourse-tag' rel="tag">reverseengineering</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Reverse Engineering Challenge: Disassemble it!'>
      <link itemprop='url' href='987.html'>
      <meta itemprop='datePublished' content='2016-08-28T17:33:11Z'>
        <meta itemprop='articleSection' content='Challenges'>
      <meta itemprop='keywords' content='antiforensics, elf, reverseengineering'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00pf.html'><span itemprop='name'>0x00pf</span></a>
                (pico)
              </span>

                <link itemprop="mainEntityOfPage" href="987.html">


              <span class="crawler-post-infos">
                  <time  datetime='2016-08-28T17:33:11Z' class='post-time'>
                    August 28, 2016,  5:33pm
                  </time>
                  <meta itemprop='dateModified' content='2016-08-29T16:06:01Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Are you trying to master the ELF format and you need some stuff to try your new skills?.. well, this is a simple challenge for you to try.</p>
<h1><a name="p-4815-the-challenge-1" class="anchor" href="#p-4815-the-challenge-1"></a>The Challenge</h1>
<p>A colleague that works as Network Engineer for an important company has captured a piece of malware that somebody was trying to use against the company. Your friend tried to take a look at the code using <code>objdump</code> but he couldn‚Äôt get anything so he come to you, an expert hacker, master of the Elfs to help him get the assembly code for that malware.</p>
<p><em>Note: The binary in this challenge does not contain any malware. You can run it if you want but that is not even necesary</em></p>
<h1><a name="p-4815-your-goal-2" class="anchor" href="#p-4815-your-goal-2"></a>Your Goal</h1>
<p>Fix the binary file. So you  can disassemble it using <code>objdump</code> and figure out the thread for this zero-day malware.</p>
<blockquote>
<p>To probe you fix the binary, post the output of <code>readelf -h</code> in the comments. Use the <code>spoil</code> tag so your solution is not seen by other people trying to solve the challenge. Be free to provide a brief write-up explaining how did you solve the challenge</p>
</blockquote>
<p>To get the binary you will have to copy and paste the text below in a file name  <code>rec01.gz.base64</code> (actually you can name it as you wish‚Ä¶ it is just a name)</p>
<p>Then you have to figure out how to get the binary out of that file.</p>
<p><strong>Hint0:</strong> No idea on how to get the binary file</p>
<div class="spoiler">
<p>Well, this is hint 0 because we have already gave it to you. Check again the file name we have proposed and make a guess</p>
</div>
<p><strong>Hint1:</strong> How to get the binary</p>
<div class="spoiler">
<p><code>cat rec01.gz.base64 | base64 -d | gunzip &gt; rec01</code></p>
</div>
<p><strong>Hint2:</strong> Not sure what to do next?</p>
<div class="spoiler">
<p>Try readlelf on the binary and check the output. There are some complains in there.</p>
</div>
<p><strong>Hint3:</strong> Use this as last resource in case you are really stuck.</p>
<div class="spoiler">
<p>The original program has 9 sections‚Ä¶ Now it should be easy!</p>
</div>
<h3><a name="p-4815-your-secondary-goal-3" class="anchor" href="#p-4815-your-secondary-goal-3"></a>Your Secondary Goal</h3>
<p>Write a program to apply this basic anti-forensic technique to any ELF file <img src="../../images/emoji/twitter/stuck_out_tongue8e5e.png?v=15" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:" loading="lazy" width="20" height="20"><br>
Then you can sell this tool to your colleague company so they can analyse future malwares using this technique.</p>
<p>Hack Fun!</p>
<h1><a name="p-4815-the-challenging-binary-4" class="anchor" href="#p-4815-the-challenging-binary-4"></a>The Challenging Binary</h1>
<pre><code>H4sIACQUw1cAA+1YXWwUVRS+s7vTHWg7u+En1gB11ZJsoSwMLtKSAjtl297FAVugIH+W1l2gSX+S
dqY2IIKORS/Dig/ogw8EjS+YSBpjkBBCp6xSQINpQ6AJEQIRsmWN/Gn573ju7GxtNzHRxAcf9iR3
zz3fPd853525mezMznKpwsYwKGU2tAjRqJYJmHHAwj9wj6QAVowc5gpn5rJotAXG+EAWGuMR8pi/
lGdCqbruTWN8jgW/NlI3yXNYw2NJ9lg6U77Ayk55h+Wrr8thJ/rnlpJF+ZNg2GFULq9BF55+/lA4
5PNPHprWzxv7L1+pvqBWHXPB6okhRwB1U1mCHq803bpYLSY31uDoqmEOk8kHeQ+KN8IKJr1xmvh7
V+k3yPWtHiJnXSxe+JZhGO2u+wNVcVpvLeGwetqIdTGDF2HhaB5cmRjW2OVQBZNhTBbh3kqOagRv
yu2tzDNDUunttgEy2G5DqAaT6+KaELkorhZrxFUhcn4lJvew+quX7DgeUhejZdGdnDK0jAxL5AHW
3LizX34Gq4+eVbKxFuBwp67MS2RhVXcnrgpD3VlsgO5vBlTGUeWUSL4/Nh56wobyAQqSW3HOXCo/
hTVQwh7M9aCQ5oQy8gSsPnheyQppa7gEF1J73YkbQj+0w706QpsM7Co/CTFhPwOKoIc0HneekQuw
+tCujAtpq6mURC6ELA0rIOyHYuopd+I8rb6YCl8gnMHkAlZPFqvbTjuVF7FW4YaK86EiTD0w9Sen
XpiGYJrgsNGDS3qU05LGFlOt7zygp8n1/mF6JTXWQbES3fXuAYhD0arVWJsXz6F3oAer127jwvNS
VCpwhdSrtyXy070vJMALewT93pevREsZTBb+AMnx8mHD6J4Ily5u0LIgN+9EPoT0IKxNIq6PddcR
PWETdMJuoQ00O2j8ymzFfkKdoe+pMt7rl527Hs1W7iTi2o7jErmGyeX49qeGkWCPttBK0cjAenGD
uFF8XazdGBNrBF1cBWfgD6yeM+DOP8bkVjUmd+4exuQKJmeT0/tw3Qfw/T7MnMPGWbkEl9yFg/Lm
DFzYJ0WLsqWShJy/pxwV25UJZsvfgBz/FNrBTsZhI5b4WdAToHdg3fqNtHms68DgCyCqyz44hTrb
4CTq0GAuOHoMa1ZWS9r0fdketKzzF7kCdxqYPJUXCTpWzxhUUF8w2mCEtKkFuPOS7JXITavpdLOp
wpftKp25UHEujW6YydDT9B2X6BMurQMJlgI4CSV98kTXEYcrCD883OdgoS7fpFc4VtUYqWuLFHk2
N3Q0RZ4fj2aHI+2zlda65nBLE5KCtVUryqVXxSBqr2vc0trQHE4+A6gx21YgpsPNTMlxch8xSXwq
jCePDWMKTRB591qeM3E/PTJPDGPk0Wc9SyQY8wGfOwovghGmzynAh5lknd22JblZZfvsoQ8dUXZv
VlB12m8y0BdZtffDeA5OVgcFynh31Bbk8/baRd6z24F5r8pW8nNs63kvACKfBwllPEd5P8LYDrzN
I7yyEZ5IeSLwanhvcBSP6naArkPAm/YvnqMZy1jGMpaxjGUsYxn7f5n5Gm2MN+eVS5Ys8Hhr6pVm
WfH4fcU+/6y5ihkJbwt+3xy/76XCJI6Qr21rm9wq19UjX3OLHPFtaVZ89UpDY3hWQxj55EiHjHyt
LeE6uQ75IltrN7fWNUWQLxnXt7Uh3xstTU2RZvm/2kc2DPp+b7Piv74LJOOCtHxHWpyPRn2TAAta
/KDF/9o+Np8ZG5r1KZb6T08/BiR9MhbS8pk0X2TNU/q9bMDyyTgvrSGXVu9liz8ic+R7StLlpOWn
77/Uqpniu1PfYSw+TstP7y9a/eek4Sn+zDQ8ff9jtI+y+RZ/6d/wU/YnFJ4o78gSAAA=
</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="11" />
              <span class='post-likes'>11 Likes</span>
            </div>


            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/oaktree.html'><span itemprop='name'>oaktree</span></a>
                (oaktree)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-28T18:43:12Z' class='post-time'>
                    August 28, 2016,  6:43pm
                  </time>
                  <meta itemprop='dateModified' content='2016-08-28T18:43:12Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I‚Äôm about as far as making it into a legit binary.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/L3akM3-0day.html'><span itemprop='name'>L3akM3-0day</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-28T21:00:39Z' class='post-time'>
                    August 28, 2016,  9:00pm
                  </time>
                  <meta itemprop='dateModified' content='2016-08-28T21:00:39Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Here is how I solve the Challenge</p>
<p>First Goal : Fix it<br>
Here is how I did to solve the first part</p>
<div class="spoiler">
<p>To Solve the challenge here is what I‚Äôve done</p>
<h1><a name="p-4817-decode-the-string-to-have-the-binary-file-1" class="anchor" href="#p-4817-decode-the-string-to-have-the-binary-file-1"></a>Decode the string to have the binary file</h1>
<p>First thing we need to do is decode the string provided. I copied the string in a file then ran :</p>
<p>cat challenge | base64 --decode &gt; TheZeroDayMalware</p>
<p>I now have a new file called TheZeroDayMalware.</p>
<p>The second thing I‚Äôve done is run file on the new file, here is the output of file :</p>
<p>file ZeroDAy<br>
ZeroDAy: gzip compressed data, last modified: Sun Aug 28 12:41:08 2016, from Unix</p>
<p>Now to have the binary, I just ran gzip -d TheZeroDayMalware</p>
<h1><a name="p-4817-fix-me-please-2" class="anchor" href="#p-4817-fix-me-please-2"></a>Fix Me please <img src="../../images/emoji/twitter/cry8e5e.png?v=15" title=":cry:" class="emoji" alt=":cry:" loading="lazy" width="20" height="20"></h1>
<p>Now that I have a binary file I run the readelf -h to see the header of that file, here is the ouput :</p>
<blockquote>
<p>ELF Header:<br>
Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00<br>
Class:                             ELF64<br>
Data:                              2‚Äôs complement, little endian<br>
Version:                           1 (current)<br>
OS/ABI:                            UNIX - System V<br>
ABI Version:                       0<br>
Type:                              EXEC (Executable file)<br>
Machine:                           Advanced Micro Devices X86-64<br>
Version:                           0x1<br>
Entry point address:               0x40015f<br>
Start of program headers:          64 (bytes into file)<br>
Start of section headers:          4232 (bytes into file)<br>
Flags:                             0x0<br>
Size of this header:               64 (bytes)<br>
Size of program headers:           56 (bytes)<br>
Number of program headers:         4<br>
Size of section headers:           64 (bytes)<br>
Number of section headers:         0 (0)<br>
Section header string table index: 8 &lt;corrupt: out of range&gt;<br>
readelf: Warning: possibly corrupt ELF file header - it has a non-zero section header offset, but no section headers</p>
</blockquote>
<p>The command said the File was corrupted.</p>
<p>The ‚Äúit has a non-zero section header offset, but no section headers‚Äù made me realize that I needed to change<br>
‚ÄúNumber of section headers:         0 (0)‚Äù to something else</p>
<p>I run xxd on the binary file to have the hexdump of the binary</p>
<p>xxd TheZeroDayMalware &gt; HexZeroDay</p>
<p>Now I open it in vim and search for 8 ( = Section header string table index: 8, the last line of readelf -h output )</p>
<blockquote>
<p>0000000: 7f45 4c46 0201 0100 0000 0000 0000 0000  .ELF‚Ä¶<br>
0000010: 0200 3e00 0100 0000 5f01 4000 0000 0000  ..&gt;‚Ä¶_.@‚Ä¶<br>
0000020: 4000 0000 0000 0000 8810 0000 0000 0000  @‚Ä¶<br>
0000030: 0000 0000 4000 3800 0400 4000 0000 0800  ‚Ä¶@.8‚Ä¶@‚Ä¶</p>
</blockquote>
<p>The 4th line contains 0800 : I supposed this line was ‚ÄúSection header string table index‚Äù<br>
The 0000 before 0800 is the ‚ÄúNumber of section headers:         0 (0)‚Äù</p>
<p>I try to change the file header to this :</p>
<blockquote>
<p>0000000: 7f45 4c46 0201 0100 0000 0000 0000 0000  .ELF‚Ä¶<br>
0000010: 0200 3e00 0100 0000 5f01 4000 0000 0000  ..&gt;‚Ä¶_.@‚Ä¶<br>
0000020: 4000 0000 0000 0000 8810 0000 0000 0000  @‚Ä¶<br>
0000030: 0000 0000 4000 3800 0400 4000 0800 0800  ‚Ä¶@.8‚Ä¶@‚Ä¶</p>
</blockquote>
<p>I have changed the Number if section headers But when I ran readelf -h on the new binary I still have an error</p>
<blockquote>
<p>ELF Header:<br>
Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00<br>
Class:                             ELF64<br>
Data:                              2‚Äôs complement, little endian<br>
Version:                           1 (current)<br>
OS/ABI:                            UNIX - System V<br>
ABI Version:                       0<br>
Type:                              EXEC (Executable file)<br>
Machine:                           Advanced Micro Devices X86-64<br>
Version:                           0x1<br>
Entry point address:               0x40015f<br>
Start of program headers:          64 (bytes into file)<br>
Start of section headers:          4232 (bytes into file)<br>
Flags:                             0x0<br>
Size of this header:               64 (bytes)<br>
Size of program headers:           56 (bytes)<br>
Number of program headers:         4<br>
Size of section headers:           64 (bytes)<br>
Number of section headers:         8<br>
Section header string table index: 8 &lt;corrupt: out of range&gt;</p>
</blockquote>
<p>Then I change the Number of section headers to 9 instead of 8</p>
<p>And Voila :</p>
<blockquote>
<p>ELF Header:<br>
Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00<br>
Class:                             ELF64<br>
Data:                              2‚Äôs complement, little endian<br>
Version:                           1 (current)<br>
OS/ABI:                            UNIX - System V<br>
ABI Version:                       0<br>
Type:                              EXEC (Executable file)<br>
Machine:                           Advanced Micro Devices X86-64<br>
Version:                           0x1<br>
Entry point address:               0x40015f<br>
Start of program headers:          64 (bytes into file)<br>
Start of section headers:          4232 (bytes into file)<br>
Flags:                             0x0<br>
Size of this header:               64 (bytes)<br>
Size of program headers:           56 (bytes)<br>
Number of program headers:         4<br>
Size of section headers:           64 (bytes)<br>
Number of section headers:         9<br>
Section header string table index: 8</p>
</blockquote>
</div>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="5" />
              <span class='post-likes'>5 Likes</span>
            </div>


            
          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00pf.html'><span itemprop='name'>0x00pf</span></a>
                (pico)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-28T21:18:37Z' class='post-time'>
                    August 28, 2016,  9:18pm
                  </time>
                  <meta itemprop='dateModified' content='2016-08-28T21:24:09Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Congrats <a class="mention" href="../../u/l3akm3-0day-2.html">@L3akM3-0day</a> <img src="../../../0x00sec.org/images/emoji/twitter/trophyc164.html?v=9" title=":trophy:" class="emoji" alt=":trophy:"> and thanks for the detailed write-up.</p>
<p>Well done!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="4" />
              <span class='post-likes'>4 Likes</span>
            </div>


            
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/oaktree.html'><span itemprop='name'>oaktree</span></a>
                (oaktree)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-28T21:38:22Z' class='post-time'>
                    August 28, 2016,  9:38pm
                  </time>
                  <meta itemprop='dateModified' content='2016-08-28T22:40:59Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>What utility are you using to edit raw binary?</p>
<p>EDIT: Nevermind! I used <span class="spoiler"><code>hexedit</code></span> and solved it!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/_py.html'><span itemprop='name'>_py</span></a>
                
              </span>


                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/1X/6cb08d55b205d143c8bc0f502524f8dc5a8c1e86.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-29T00:57:33Z' class='post-time'>
                    August 29, 2016, 12:57am
                  </time>
                  <meta itemprop='dateModified' content='2016-08-29T08:53:41Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>[spoiler]By readelf-ing the binary it‚Äôs quite obvious that there is something wrong with the number of the section headers. They just can‚Äôt be 0.</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/1X/6cb08d55b205d143c8bc0f502524f8dc5a8c1e86.png" width="690" height="488"></p>
<p>So the next step was to patch the binary so that the ELF header field would be correct. The ELF 64-bit header looks like this:</p>
<p>typedef struct<br>
{<br>
unsigned char e_ident[EI_NIDENT];<br>
Elf64_Half    e_type;<br>
Elf64_Half e_machine;<br>
Elf64_Word    e_version;<br>
Elf64_Addr    e_entry;<br>
Elf64_Off     e_phoff;<br>
Elf64_Off     e_shoff;<br>
Elf64_Word    e_flags;<br>
Elf64_Half    e_ehsize;<br>
Elf64_Half    e_phentsize;<br>
Elf64_Half    e_phnum;<br>
Elf64_Half    e_shentsize;<br>
Elf64_Half    e_shnum;           &lt;‚Äî Number of Section Headers<br>
Elf64_Half    e_shstrndx;<br>
} Elf64_Ehdr;</p>
<p>Using the xxd command, we get a pretty lengthy output  but we only care about the first 64 bytes. Specifically, we care about the 61th and 62th byte just by looking at the struct above. Thus:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/1X/6709bf66be0e1452642ce78984785a4b2f966eb1.png" width="690" height="101"></p>
<p>As you can see the 61th and 62th byte are <strong>0000</strong>. I played around with the number of section headers by using a hex editor but kept getting errors until 9 was proved to be the correct number of section headers and voila:</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/1X/8ca50b0889627265fa7efc3961ce82fbb9522a61.png" width="652" height="500"></p>
<p>No corruption errors!</p>
<p>I‚Äôm hoping to come up with the anti-forensic code soon and I‚Äôll edit the post.</p>
<p><a class="mention" href="../../u/0x00pf.html">@0x00pf</a> I‚Äôd like to ask a question. I‚Äôm not that experienced with ELF yet so I hope I won‚Äôt sound stupid, but how is ‚ÄúStripping‚Äù the number of sections headers considered ‚Äúmalicious‚Äù?[/spoiler]</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="4" />
              <span class='post-likes'>4 Likes</span>
            </div>


            
          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00pf.html'><span itemprop='name'>0x00pf</span></a>
                (pico)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-29T05:41:50Z' class='post-time'>
                    August 29, 2016,  5:41am
                  </time>
                  <meta itemprop='dateModified' content='2016-08-29T05:41:50Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Congrats <a class="mention" href="../../u/_py.html">@_py</a> <img src="../../../0x00sec.org/images/emoji/twitter/trophyc164.html?v=9" title=":trophy:" class="emoji" alt=":trophy:">!</p>
<p>Hope you enjoyed‚Ä¶ but according to your write up it looks like it was too easy‚Ä¶</p>
<div class="spoiler">
<p>Answering your question. Stripping the sections is not really malicious, however, it can be done in a way readelf does not complain and then it is not so-obvious what is going on. Check this example (not gzipped just base64 encoded)</p>
<pre><code>f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAAhQBAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAB
AAAAAAAAAAEAAAAHAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAuAAAAAAAAAC4AAAAAAAAAAAQ
AAAAAAAAuAEAAAC/AQAAAA8Fw0i+pQBAAAAAAAC6EgAAAOjf////uDwAAAC/AAAAAA8FSSBhbHNv
IG5lZWQgYSBmaXgKAA==
</code></pre>
<p>Many anti-forensic techniques are just annoyances to make more difficult the analysis of the sample.</p>
<p>Note that, this simple measurement can be considered an anti-forensic technique because:</p>
<ul>
<li>The program still works normally, despite of having a corrupted header</li>
<li>
<strong>readelf</strong> does not show any section or any symbol in the binary</li>
<li>
<strong>objdump</strong> cannot disassemble the program</li>
<li>
<strong>gdb</strong> refuses to load the program</li>
</ul>
<p>I wanted to make the challenge accessible to everybody, and I think this is the simplest ELF modification that can be done.</p>
</div>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/dtm.html'><span itemprop='name'>dtm</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-29T05:57:42Z' class='post-time'>
                    August 29, 2016,  5:57am
                  </time>
                  <meta itemprop='dateModified' content='2016-08-29T10:27:12Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I don‚Äôt think it was meant to be malicious, probably just a method to obfuscate information to deter the reverse engineer‚Äôs attempts.</p>
<p>EDIT: Forgot to click ‚ÄúReply‚Äù before pico‚Äôs.</p>
<p>Also, here‚Äôs a quick reverse engineer of the disassembly of the main function, so it might be a bit inaccurate:</p>
<pre><code class="lang-auto">size_t count;                           // length of data
const char *buf;                        // pointer to a buffer
unsigned int fd;                        // file descriptor
unsigned int sys_call;                  // syscall number

// main
func_00400144() {
    count = 0xF;                        // length = 15
    buf = 0x4004f6;                     // "Please, fix me!", 0
    fd = 0x1;                           // STDOUT

    ret = func_004001a2();              // printf-like function
    ret ^= ret;                         // 0

    return ret;                         // return 0
}

// this is basically some implementation of printf
func_004001a2() {
    sys_call = 0x1;
    ret_0 = sys_call(fd, buf, count);   // ssize_t ret0 = write(fd, buf, count);

    if (ret_0 &lt; unsigned(0xffffffffffffff7c)) {
        var_0 = -LOW_32BITS(ret0);      // 0x84
        ret_1 = func_004001a9();        // ret_1 = 0x601018; no idea what this value is
        ret_0 = var_0;
        ret_0 |= -1;                    // or 0xffffffffffffffff; return value is -1
    }

    return ret_0;                       // return number of bytes written or -1 on error
}

// no idea what this is; probably needs to be tested in runtime
func_004001a9() {
    return 0x601018;
}
</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/_py.html'><span itemprop='name'>_py</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-29T08:21:57Z' class='post-time'>
                    August 29, 2016,  8:21am
                  </time>
                  <meta itemprop='dateModified' content='2016-08-29T08:29:02Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="0x00pf" data-post="7" data-topic="987">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/d.clarkee.co.uk/0x00pf/48/13708_2.png" class="avatar"> 0x00pf:</div>
<blockquote>
<p>Note that, this simple measurement can be considered an anti-forensic technique because:</p>
<p>The program still works normally, despite of having a corrupted header</p>
<p>readelf does not show any section or any symbol in the binary</p>
<p>objdump cannot disassemble the program</p>
<p>gdb refuses to load the program</p>
</blockquote>
</aside>
<p><a class="mention" href="../../u/0x00pf.html">@0x00pf</a>, indeed I could not load the program or dump the object code and that was actually my first thought of solving it but gdb was refusing to load the program. I actually tried using a breakpoint at the entry point address which was shown in the readelf output but I didn‚Äôt have any luck at all. Also thank you <a class="mention" href="../../u/0x00pf.html">@0x00pf</a> for the challenge. It was my first one and no it wasn‚Äôt that easy to be solved because I haven‚Äôt mastered ELF yet. Though, it made me more familiar with the format itself and this could not be done without your challenge. Props to you mate.</p>
<p><a class="mention" href="../../u/dtm.html">@dtm</a>, I got confused with the ‚Äúmalware‚Äù reference in the challenge description that‚Äôs why I asked but I can totally see how it can be used for obfuscation reasons since I could not disassemble the code with gdb. Do you mind sharing your thoughts about your code? Did you manage to get the object code because as I explained above to pico it wasn‚Äôt possible with the knowledge I had.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_10' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/dtm.html'><span itemprop='name'>dtm</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-29T09:39:11Z' class='post-time'>
                    August 29, 2016,  9:39am
                  </time>
                  <meta itemprop='dateModified' content='2016-08-29T09:39:11Z'>
              <span itemprop='position'>10</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="_py" data-post="9" data-topic="987">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/d.clarkee.co.uk/_py/48/4275_2.png" class="avatar"> _py:</div>
<blockquote>
<p>Do you mind sharing your thoughts about your code?</p>
</blockquote>
</aside>
<p>I‚Äôve edited my response with more comments and fixed some small inaccuracies.</p>
<aside class="quote no-group" data-username="_py" data-post="9" data-topic="987">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/d.clarkee.co.uk/_py/48/4275_2.png" class="avatar"> _py:</div>
<blockquote>
<p>Did you manage to get the object code because as I explained above to pico it wasn‚Äôt possible with the knowledge I had.</p>
</blockquote>
</aside>
<p>Since I had no experience with it, I was required to sneak a peek at the last hint. Other than that, it wasn‚Äôt bad. All I really had to do was to look up the structures of the ELF64 format and I could work it out from there.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_11' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00pf.html'><span itemprop='name'>0x00pf</span></a>
                (pico)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-29T16:08:21Z' class='post-time'>
                    August 29, 2016,  4:08pm
                  </time>
                  <meta itemprop='dateModified' content='2016-08-29T16:08:21Z'>
              <span itemprop='position'>11</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="../../u/_py.html">@_py</a> sorry about the confusion. Malware use to do things like that to avoid analysis. That is what I mentioned.</p>
<p>The challenge writing really needs some improvement <img src="../../../0x00sec.org/images/emoji/twitter/stuck_out_tonguec164.html?v=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>To get some assembly out of the binary you can try radare2</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_12' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/IoTh1nkN0t.html'><span itemprop='name'>IoTh1nkN0t</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-29T16:37:37Z' class='post-time'>
                    August 29, 2016,  4:37pm
                  </time>
                  <meta itemprop='dateModified' content='2016-08-29T16:37:37Z'>
              <span itemprop='position'>12</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Alright here are the two programs i used to fix it:</p>
<div class="spoiler">
<pre><code class="lang-auto">#include &lt;linux/elf.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;fcntl.h&gt;

int get_file_size( int fd )
{
    struct stat _info;
    fstat( fd, &amp;_info );
    return _info.st_size;
}

int main(int argc, char *argv[])
{
    struct elf64_hdr *elf;
    int fd;

    fd = open( argv[1], O_APPEND | O_RDWR, 0 );
    int len = get_file_size( fd );

    elf = mmap(0, len, PROT_READ | PROT_WRITE | PROT_EXEC, MAP_SHARED, fd, 0);
    elf-&gt;e_shoff = 0;

    close(fd);
}
</code></pre>
<pre><code class="lang-auto">#include &lt;linux/elf.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;fcntl.h&gt;

int get_file_size( int fd )
{
    struct stat _info;
    fstat( fd, &amp;_info );
    return _info.st_size;
}

int main(int argc, char *argv[])
{
    struct elf64_hdr *elf;
    int fd;

    fd = open( argv[1], O_APPEND | O_RDWR, 0 );
    int len = get_file_size( fd );

    elf = mmap(0, len, PROT_READ | PROT_WRITE | PROT_EXEC, MAP_SHARED, fd, 0);
    elf-&gt;e_shstrndx = 0;

    close(fd);
}

</code></pre>
</div>
<p>Ok so the spoiler tag is pretty useless here.<br>
Ofcourse this could be put together as one program easily, but I fixed it two steps at a time.</p>
<p>Writing a program that automaticly detects tricks like this will be a bit harder, but I‚Äôll see what I can come up with. ^^</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_13' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00pf.html'><span itemprop='name'>0x00pf</span></a>
                (pico)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-29T16:48:21Z' class='post-time'>
                    August 29, 2016,  4:48pm
                  </time>
                  <meta itemprop='dateModified' content='2016-08-29T16:48:21Z'>
              <span itemprop='position'>13</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Good job. I did exactly the same</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_14' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/_py.html'><span itemprop='name'>_py</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-30T06:10:44Z' class='post-time'>
                    August 30, 2016,  6:10am
                  </time>
                  <meta itemprop='dateModified' content='2016-08-30T06:17:03Z'>
              <span itemprop='position'>14</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><span class="mention">@unh0lys0da</span>, the ‚Äúfix‚Äù for this challenge was to change the number of sections from 0 to 9. This code sample doesn‚Äôt seem to accomplish that unless I‚Äôm too tired.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_15' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/IoTh1nkN0t.html'><span itemprop='name'>IoTh1nkN0t</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-30T08:54:46Z' class='post-time'>
                    August 30, 2016,  8:54am
                  </time>
                  <meta itemprop='dateModified' content='2016-08-30T08:54:46Z'>
              <span itemprop='position'>15</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hm I should do some reading then, but after changing it to 0, it worked for me as well.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_16' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/0x00pf.html'><span itemprop='name'>0x00pf</span></a>
                (pico)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-08-30T16:03:15Z' class='post-time'>
                    August 30, 2016,  4:03pm
                  </time>
                  <meta itemprop='dateModified' content='2016-08-31T05:26:44Z'>
              <span itemprop='position'>16</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="../../u/_py.html">@_py</a> and <span class="mention">@unh0lys0da</span>,</p>
<p>To be honest I haven‚Äôt read the text on <span class="mention">@unh0lys0da</span> post, just looked at the code and I though it was the reply to the secondary goal:</p>
<aside class="quote no-group quote-modified" data-username="0x00pf" data-post="1" data-topic="987">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/d.clarkee.co.uk/0x00pf/48/13708_2.png" class="avatar"> 0x00pf:</div>
<blockquote>
<p>##<span class="hashtag-raw">#Your</span> Secondary Goal</p>
<p>Write a program to apply this basic anti-forensic technique to any ELF file <img src="../../images/emoji/twitter/stuck_out_tongue8e5e.png?v=15" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:" loading="lazy" width="20" height="20"></p>
</blockquote>
</aside>
<p>Actually, this are the two additional things you have to do to remove any warning from the <code>readelf</code> output (in addition to set the number of sections to 0). After that, <code>objdump</code>, will still fail to disassemble the program and <code>readelf</code> will not show any warning.</p>
<p>I really have to be more precise with these writings <img src="../../images/emoji/twitter/blush8e5e.png?v=15" title=":blush:" class="emoji" alt=":blush:" loading="lazy" width="20" height="20"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="EnDmk1WrbnSQwSEyyo3eM97Fs"></script>
  </body>
  
</html>
