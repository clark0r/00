<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Malware Reversing - Burpsuite Keygen - Reverse Engineering - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="DISCLAIMER: The following post contains a virus sample. If you decide to mess with it you do so at your own risk. Do not go running it on your computer, at least use a VM. 
Some random new ‚Äúuser‚Äù called @the_heat_man pos&amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="5167.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="eaySgs8fCPLLoiNHaZwrxU65Y"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="eaySgs8fCPLLoiNHaZwrxU65Y"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Malware Reversing - Burpsuite Keygen&#39;" href="5167.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/d/d3ab0271f8a60ba503685ec62564c6c5731a4208.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/d/d3ab0271f8a60ba503685ec62564c6c5731a4208.png" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/malware-reversing-burpsuite-keygen/5167" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/malware-reversing-burpsuite-keygen/5167" />
<meta property="og:title" content="Malware Reversing - Burpsuite Keygen" />
<meta name="twitter:title" content="Malware Reversing - Burpsuite Keygen" />
<meta property="og:description" content="DISCLAIMER: The following post contains a virus sample. If you decide to mess with it you do so at your own risk. Do not go running it on your computer, at least use a VM.  Some random new ‚Äúuser‚Äù called @the_heat_man posted some files on the forums multiple times (after being deleted by mods) caliming it was a keygen for burpsuite. Many members of these forums were suspicious of it being malware. I, along with @Leeky, @dtm, @Cry0l1t3 and @anon3236228 (please let me know if I missed anyone) decid..." />
<meta name="twitter:description" content="DISCLAIMER: The following post contains a virus sample. If you decide to mess with it you do so at your own risk. Do not go running it on your computer, at least use a VM.  Some random new ‚Äúuser‚Äù called @the_heat_man posted some files on the forums multiple times (after being deleted by mods) caliming it was a keygen for burpsuite. Many members of these forums were suspicious of it being malware. I, along with @Leeky, @dtm, @Cry0l1t3 and @anon3236228 (please let me know if I missed anyone) decid..." />
<meta property="og:article:section" content="Reverse Engineering" />
<meta property="og:article:section:color" content="12A89D" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="7 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="46 ‚ù§" />
<meta property="article:published_time" content="2018-01-30T00:58:51+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="5167.html">Malware Reversing - Burpsuite Keygen</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/reverse-engineering/58.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #12A89D'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Reverse Engineering</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Malware Reversing - Burpsuite Keygen'>
      <link itemprop='url' href='5167.html'>
      <meta itemprop='datePublished' content='2018-01-30T00:58:50Z'>
        <meta itemprop='articleSection' content='Reverse Engineering'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/lkw.html'><span itemprop='name'>lkw</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="5167.html">

                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/2X/d/d3ab0271f8a60ba503685ec62564c6c5731a4208.png">

              <span class="crawler-post-infos">
                  <time  datetime='2018-01-30T00:58:51Z' class='post-time'>
                    January 30, 2018, 12:58am
                  </time>
                  <meta itemprop='dateModified' content='2018-01-30T14:37:15Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>DISCLAIMER: The following post contains a virus sample. If you decide to mess with it you do so at your own risk. Do not go running it on your computer, at least use a VM.</p>
<p>Some random new ‚Äúuser‚Äù called <a class="mention" href="../../u/the_heat_man.html">@the_heat_man</a> posted some files on the forums multiple times (after being deleted by mods) caliming it was a keygen for burpsuite. Many members of these forums were suspicious of it being malware. I, along with <a class="mention" href="../../u/leeky-2.html">@Leeky</a>, <a class="mention" href="../../u/dtm.html">@dtm</a>, <a class="mention" href="../../u/cry0l1t3-2.html">@Cry0l1t3</a> and <a class="mention" href="../../u/anon3236228.html">@anon3236228</a> (please let me know if I missed anyone) decided to reverse engineer it to see if it is. Surprisingly as well as containing a remote access trojan (RAT) it actually contains a working keygen. As such, for legal reasons I have not included a link to the original file.<br>
The following is a writeup of the analysis of the RAT.</p>
<p>The keygen comes with a file called <code>virus.txt</code> which contains what appears to be a <a href="../../../external.html?link=https://www.virustotal.com/#/file/6530b29367de2b0fa42c411f94ae734d745443256431aee0fe221acb7a75c103/detection">link</a> to a virus total scan of the keygen jarfile</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/d/d3ab0271f8a60ba503685ec62564c6c5731a4208.png" width="690" height="338"></p>
<p>However the hash on virus total is different to the actual file, indicating that it‚Äôs a scan of a different file</p>
<p>(NOTE: iirc when I originally visited the page all the scans were clean and the file name matched the file <code>burp-loader-keygen1.7.31.jar</code> . The page says the last analysis was today, so that may have something to do with it.)</p>
<pre><code class="lang-auto">&gt; shasum -a 256 burp-loader-keygen1.7.31.jar
1bf764e77a543def4c623e6e207b1b72999f6550cf49651b88d53f80ae10e4d7  burp-loader-keygen1.7.31.jar
</code></pre>
<p>Jars are stored as zip files so we can extract the jar with unzip.</p>
<pre><code class="lang-auto">&gt; cp burp-loader-keygen1.7.31.jar burp-loader-keygen1.7.31.zip
&gt; unzip burp-loader-keygen1.7.31.zip
Archive:  burp-loader-keygen1.7.31.zip
   creating: META-INF/
 extracting: META-INF/MANIFEST.MF    
   creating: burploader/
 extracting: burploader/Burploader.class  
 extracting: burploader/Data.bin 
</code></pre>
<p>There is a class file which can be decompiled, I will use jad, which is installed on kali.</p>
<pre><code class="lang-auto">&gt; jad burploader/Burploader.class
</code></pre>
<p>Here is the important part of the decompiled java code</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/e/e218b483901d3e89d77e52e4f650c3f0ba10ce27.png" width="690" height="235"></p>
<p>Before this part is a base64 encoding of another jarfile contaning the keygen. That is stored in m. The decode function decodes the base64 and writes it to a file called <code>Data.jar</code><br>
This section of code contains powershell commands to download and run this powershell script <code>http://imonty.cn/wp-includes/pomo/script/dcss/js.js</code><br>
(the extension is .js but it is actually powershell)<br>
and to also run the keygen.</p>
<p>Let‚Äôs download that code and have a look.<br>
<img src="../../../0x00sec.s3.amazonaws.com/original/2X/e/e739b234a72c804332c79139d27c0fdb236f459c.png" width="690" height="227"></p>
<p>This drops two more files into a newly made c:\ProgramData\WindowsNT directory<br>
The files are:</p>
<ul>
<li>
<code>http://imonty.cn/wp-includes/pomo/script/dcss/co.js</code> saved as <code>WindowsNT.ini</code> and</li>
<li>
<code>http://imonty.cn/wp-includes/pomo/script/dcss/co.vbs</code> saved as <code>WindowsNT.vbs</code>
</li>
</ul>
<p>It then runs the visual basic script (co.vbs), so let‚Äôs look at that first</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/4/4b37a9150532ab8464a801fcf513f20ea792e727.png" width="690" height="248"></p>
<p>Here we have obfuscated visual basic code. The easiest method to deobfuscate is to replace the part of the code that executes with something that prints (This may not work in all cases, but it is a very useful technique). Here, clearly, the part that executes the deobfuscated code is the <code>EVAL(ExEcUTE(www))</code>  (circled)</p>
<p>(what this file is actually doing, is to split the long string at every <code>*</code> and then evaluate the expressions in the resulting list, and turning the results of the math expressions into characters. Finally running the resulting string from concatenating those characters)</p>
<p>To print the string instead of executing we can replace the <code>EVAL(ExEcUTE(www))</code>  with <code>wscript.echo www</code> and run it.</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/6/600cdfe12d8514435d17e44c05ba101e2ca430ee.png" width="690" height="200"></p>
<p>What this does is run the other downloaded file, co.js (saved as WindowsNT.ini) in powershell.<br>
So let‚Äôs look at co.js<br>
This file is large, so I have uploaded it <a href="../../../external.html?link=https://gist.githubusercontent.com/lkw657/f2dfae7f73267c8114de039a60efcb51/raw/e7b622c0385b48a3f727cb9b97fbf2b34966a5d5/co.ps1.gz.b64">here</a><br>
I gziped and b64ed the file to make it upload nicely, you should do <code>cat co.ps1.gzip.b64 | base64 -d | gunzip &gt; co.ps1</code> to read it<br>
I have also renamed co.js to co.ps1 to make the <code>./</code> in powershell work easier.</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/5/55150c0af0eede85c6698c6dc82844f95418162f.png" width="690" height="342"></p>
<p><code>iex</code> (alias for invoke-expression) is a function that evaluates powershell code, so we need to replace it with <code>write-output</code> to print it instead, then run the file.</p>
<p>The modified code should look like this</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/f/f4a56c4dc096928c33e5e439c7ef46449cac8d39.png" width="690" height="344"></p>
<p>I was running in a new virtual machine, so I had to allow untrusted powershell scripts to execute.<br>
After running powershell as an administrator:<br>
<img src="../../../0x00sec.s3.amazonaws.com/original/2X/a/a953bb037049e97546dc469680206f9926df023c.png" width="690" height="130"></p>
<pre><code class="lang-auto">PS E:\burp\burploader&gt; ./co.ps1 &gt; co.2.ps1
</code></pre>
<p>I uploaded the resulting file <a href="../../../external.html?link=https://gist.githubusercontent.com/lkw657/aa4cb19b3b7b5ccd55c846a59b3c07bf/raw/572ae9cff6747c45c2880f655139c4aebe0ff266/co.2.ps1.gz.b64">here</a><br>
We have yet another layer of obfusication.</p>
<p>The beginning of this fie looks like this</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/7/793ebfca37846be873a16c5fb6bacbe7b0c34483.png" width="690" height="342"></p>
<p>This time it calls <code>Invoke-Expression</code> instead of <code>iex</code>, replace it with <code>write-output</code> .</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/0/0f4a5d13eed014334e794d2b67e584ab803b4467.png" width="690" height="343"></p>
<p>Now run it.</p>
<pre><code class="lang-auto">PS E:\burp\burploader&gt; ./co.2.ps1 &gt; co.3.ps1
</code></pre>
<p><a href="../../../external.html?link=https://gist.githubusercontent.com/lkw657/bbbf4df3c2aa92f59cdd856643409d0f/raw/171f282ad627db264f279ca10644cda285acb284/co.3.ps1.gz.b64">File</a></p>
<p>The first thing to notice is that the new file has three sections separated by blank lines. I made the mistake of missing the first section and couldn‚Äôt find some needed code later (this was found by <a class="mention" href="../../u/leeky-2.html">@leeky</a> and <a class="mention" href="../../u/dtm.html">@dtm</a>). Instead of trying to deobfusicate the whole file at once (like I did) I learnt that it would have been better to split it 3 smaller files and do them one at a time.</p>
<p><strong>First section:</strong><br>
The <strong>end</strong> of the section looks like this.</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/2/231b72f34ddacdaaabf67bb54a513a0ae47583ce.png" width="690" height="343"></p>
<p>We don‚Äôt have something that looks as nice as <code>invoke-expression</code> this time, however since the execution will be done last it is most likely that the call will be on one of the ends, the left with the deobfusicated code as an arguement, or the right, with the code piped into the standard input.<br>
In this case the left just consists of a bracket, so let‚Äôs check the rightmost statement after a pipe (circled).<br>
<code>.( $PsHOmE[21]+$PShOMe[30]+'X')</code> Interesting. let‚Äôs see what <code>$PsHOmE[21]+$PShOMe[30]+'X'</code> evaluates to.</p>
<pre><code class="lang-auto">PS E:\burp\burploader&gt; $PsHOmE[21]+$PShOMe[30]+'X'
ieX
</code></pre>
<p>so we need to replace the <code>.( $PsHOmE[21]+$PShOMe[30]+'X')</code> with <code>write-output</code></p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/1/1fcee38e286e4e8ce19d6cdcd3f24bcf7bbc3c7e.png" width="690" height="344"></p>
<p>The result is more obfusicated code.</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/6/62388ad1dd2c30fdb4233ecb27d30119d1bd82e4.png" width="690" height="344"></p>
<p>Let‚Äôs repeat the same idea. What is <code>.( $eNv:PuBliC[13]+$eNv:pUBLiC[5]+'x')</code> at the beginning</p>
<pre><code class="lang-auto">PS E:\burp\burploader&gt; $eNv:PuBliC[13]+$eNv:pUBLiC[5]+'x'
iex
</code></pre>
<p>so replace it with <code>write-output</code></p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/7/79196fd4a26902a5a7cc525c50553a0e7a301d94.png" width="690" height="342"></p>
<p>After executing there is more obsusication, so do it again on the new file replacing<br>
<code>&amp; ($pShoME[21]+$pShoME[34]+'X')</code> at the end with <code>write-output</code><br>
And again with <code> &amp;( $pShoME[21]+$pSHOMe[30]+'X')</code> at the beginning</p>
<p><strong>Second section:</strong><br>
(starts with [String]::JoIN(‚Äô‚Äô,( [Char[]]( 127 ,105 )</p>
<p>The <em>end</em> of the second section looks like this</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/5/5635b2b6d50acf0a692ce58b37e561d83bb1714c.png" width="689" height="343"></p>
<p>Replace <code>.((gV '*mDR*').nAme[3,11,2]-joIn'')</code> at the end with <code>write-output</code><br>
It‚Äôs still obfusicated. So, look at the end <code>.( $pShoME[4]+$PsHoMe[30]+'X')</code> , replace with <code>write-output</code> and then execute.<br>
And then we need to do this again, replacing <code>&amp;( ([sTrINg]$verbosePREFerencE)[1,3]+'x'-JOIN'')</code> near the beginning with <code>write-output</code><br>
And one last time, replacing <code>. ( $Env:comsPec[4,15,25]-JOiN'')</code> at the end with <code>write-output</code></p>
<p><strong>Third section:</strong><br>
The start of the third section looks like this</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/7/7afd8246410e455425ab93de21db25f6310b608a.png" width="690" height="340"></p>
<p>Replace <code>.( $PsHome[4]+$PShoME[34]+'X')</code> at the beginning with <code>write-output</code> and execute.<br>
This section now looks pretty readable, particually if we replace the function names.</p>
<p>This is as far as we can get with this method. The function names must be found through manual analysis and unmangling the variable names and content must be done through another method, such as manual or writing a script.</p>
<p>The output of concatenating all this back together is <a href="../../../external.html?link=https://gist.githubusercontent.com/lkw657/becdb839139901fcc907fc39605a890d/raw/70e685f6ec0917aad7a6662132f967577bd72e3e/final1.ps1.b64">here</a><br>
<a href="../../../external.html?link=https://gist.githubusercontent.com/lkw657/4244014b5c091325feb3b40e0a3c786f/raw/3476aa131dcbb7fc244691dd5ed90a4af724b854/final2.ps1.b64">Here</a> is a modification of the code I made without the messy variables and making up names for some of the functions.</p>
<p>Virustotal does not detect the powershell script as a virus <a href="../../../external.html?link=https://www.virustotal.com/#/file/6f38fe65cad067a73888552cdb9817a37329863d8732b4e930938f619ca504fe/detection">here</a></p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/4/4ca6b607b6497d7409c65541f2ee516bffbe06c7.png" width="689" height="337"></p>
<p>Some heuristics, however, detect the dropper <a href="../../../external.html?link=https://www.virustotal.com/#/file/1bf764e77a543def4c623e6e207b1b72999f6550cf49651b88d53f80ae10e4d7/detection">here</a></p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/2/277249b80c5e1c8aa15a7d47c94673f496890d39.png" width="689" height="338"></p>
<p>The first section just contains variables, however the names and values are very mangled.</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/7/7a62bacf91f3e02cb08bd7541442ab27542e935a.png" width="690" height="342"></p>
<p>From analysing the functions we worked out that the variable <code>$dragon_middle</code> contains domains that the RAT will try to connect to (going through them until it can connect to one). The variables <code>$private</code> and <code>$public</code> contain encryption and decryption keys for data that is transfered by the RAT. <a class="mention" href="../../u/leeky-2.html">@Leeky</a> pulled these out by looping over the arrays and printing the contents. The results are <a href="../../../external.html?link=https://gist.githubusercontent.com/lkw657/61905786d99565ba8df087f208b4310a/raw/3c3250bd30e68e286d0a06f371719f49583a1b92/variables.txt">here</a></p>
<p><a class="mention" href="../../u/cry0l1t3-2.html">@Cry0l1t3</a> Went through the domains and highlighted <a href="../../../external.html?link=https://gist.githubusercontent.com/lkw657/db14c27dd42f83ad62ec64de6862249a/raw/3ff41837eeeeda4acf909f64910e4f5ae33a222a/domain">this one</a> for having a different host than all the others.</p>
<p><a class="mention" href="../../u/dtm.html">@dtm</a> made a more complete list of variables <a href="../../../external.html?link=https://gist.githubusercontent.com/lkw657/9d81fac2ca10126eceb5119eae92b30e/raw/6791d90b9c4929a9029c8070c04632696ce33d15/variables.txt">here</a> I don‚Äôt know enough about windows to say how this was produced. But based on the format I think he used a command to print the environment (correct me if I‚Äôm wrong).<br>
While it doesn‚Äôt have all the elements in <code>$dragon_middle</code> it contains some other interesting variables such as the serivces it uses to find the victim‚Äôs ip <code>https://api.ipify.org/</code> and country <code>http://apinotes.com/ipaddress/ip.php?ip=</code>.</p>
<p>He also made a <a href="../../../external.html?link=https://gist.githubusercontent.com/lkw657/e9c13ddb9cf3955384f3b39f22f97d6d/raw/ae674ac8401597c759e15ee7f79ea78ee520557d/packets.pcap.b64">packet capture</a> of it trying to contact a server.</p>
<p>The second section contains the code for encryption and decryption, and the 3rd section contains the rest of the code.</p>
<p>The RAT uses RSA to communicate to a server. Weirdly, I think the public key and private key have been named the wrong way around.</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/a/a61dd874d78afd34eb9a51fd1e98f3b0b8ac259e.png" width="690" height="343"><br>
<img src="../../../0x00sec.s3.amazonaws.com/original/2X/e/eb81eb6730ee8fe4c6a7d49d82d03bb7fba56fb7.png" width="690" height="181"></p>
<p>The public key and private key have different moduli which indicates they are most likely from different key pairs.<br>
Messages sent to the server are encrypted with the server‚Äôs public key (<code>$secret</code> in the code) and decrypted by the server‚Äôs private key (stored on the server)<br>
Messages sent to the RAT are encrypted with the RAT‚Äôs public key (on the server) and decrypted with the RATs private key (<code>$public</code> in the code)<br>
In theory if this were done properly the message to the server wouldn‚Äôt be able to be decrypted (of course the RAT could be modified to just print it). However the keys use small primes and are thus weak.</p>
<p>When the RAT starts, the first thing it tries to do is gain persistence.</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/e/ea2da49cf919afa8605832199f33b71acfe5d1c0.png" width="690" height="295"></p>
<p>It does this by adding the location of the vbs file to the registry in the key <code>HKCU:SOFTWARE\Microsoft\Windows\CurrentVersion\Run\DifenderUpdate</code> It then scedules the script at that location to be run on login.<br>
I am not sure what the first part of the persistence function is doing. I think it looks like it is disabling protections in Word‚Äôs protected view, but I‚Äôm not sure why that would be needed.</p>
<p>Next the rat checks for debuggers by checking the names of running processes against a list of debuggers and other tools. If one is found it shuts down the computer</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/0/0bb2e06c08ed69b3304ff444ffb1c6dbc0e9c98b.png" width="690" height="118"></p>
<p>It then tries to connect to one of the servers listed in <code>$dragon_middle</code>. Whenever the code errors in future it will also do this again (presumably because it thinks that server may be down or blocked)</p>
<p>Next it tries to register with the server before accepting and handling commands</p>
<p><img src="../../../0x00sec.s3.amazonaws.com/original/2X/9/98a2fb41522a3cfb800a2bbdf01fdec3eef33ae8.png" width="690" height="161"><br>
<img src="../../../0x00sec.s3.amazonaws.com/original/2X/c/ce20d97d5d6f22c98935c37f17d196d8459963e7.png" width="690" height="343"><br>
<img src="../../../0x00sec.s3.amazonaws.com/original/2X/6/60bed19a4cc5dc67d039ad92c34e31e692ec1863.png" width="689" height="189"></p>
<p>The following commands are accepted</p>
<ul>
<li>reboot<br>
reboots the computer</li>
<li>shutdown<br>
shuts down the computer</li>
<li>clean<br>
tries to wipe as much as possible from C:, D:, E:\ and F:\ before rebooting</li>
<li>screenshot<br>
takes a screenshot and sends it to the server</li>
<li>upload<br>
transfers a file from the server to the victim</li>
</ul>
<p>If the command is not one of those it tries to execute it in powershell</p>
<p>I ran the keygen with the default execution policy (remember when I had to change it) and checked for the c:\ProgramData\WindowsNT directory to see if the RAT managed to run. The directory was not created so it seems it‚Äôs possible that it could be blocked by windows.</p>
<p>##<span class="hashtag">#Adendum:</span><br>
I mentioned that the crypto is weak, this is how you break it.<br>
I‚Äôm not going to cover the basics of how RSA works here, but there is an 0x00sec tutorial <a href="../../../external.html?link=https://0x00sec.org/t/encryption-101-rsa-001-the-maths-behind-it/1921">here</a> and <a href="../../../external.html?link=https://en.wikipedia.org/wiki/RSA_(cryptosystem)">wikipedia</a> has a lot of good info</p>
<p>In RSA two primes <code>p</code> and <code>q</code> are used to calculate <code>n = p*q</code> the primes used should be kept secret. They are also used to calculate <code>Œª(n) = Œª(p*q) = lcm(p-1, q-1)</code>. The public exponent <code>e</code> and the private exponent <code>d</code> are related to each other by the following equation <code>d == e^(-1) (mod Œª(n))</code>.</p>
<p>In the case of the RAT <code>n</code> is small (as the result of using small primes) so it can easily be factored into <code>p</code> and  <code>q</code>. They can then be used to calculate <code>Œª(n)</code> and then the last equation can be used to calculate <code>d</code> from <code>e</code>.</p>
<p>Using sage math</p>
<pre><code class="lang-auto"># from $private variable in rat
e = 959
n = 713

# factor n
# list(factor(n)) returns prime factors as a list of tuples of (factor, amount)
# we just want the factors
p, q = [a[0] for a in list(factor(n))]

# calculate Œª(n) 
l = lcm(p-1, q-1)

# calculate d
print('d = {}'.format(inverse_mod(e, l)))
</code></pre>
<p>gives <code>d = 149</code></p>
<p>With the server‚Äôs private key we can write a script to decrypt messages sent to the server. If we use the same process to get the RAT‚Äôs public key we could MiTM the traffic between the RAT and the server.</p>
<p>Here is a decryption script in python</p>
<pre><code class="lang-auto">def decrypt(ciphertext):
    key = 149
    n = 713
    decrypted = []
    for i in range(0, len(ciphertext)):
        num = int(ciphertext[i])
        t = pow(num, key, n)
        decrypted.append(chr(t))
    return ''.join(decrypted)

nums = input().split()
print(decrypt([int(i) for i in nums]))
</code></pre>
<p>In <a class="mention" href="../../u/dtm.html">@dtm</a>‚Äôs pcap the following is sent to the server</p>
<pre><code class="lang-auto">340 362 396 383 105 598 219 362 581 362 518 73 35 73 504 220 515 665 504 515 515 35 515 518 133 335 316 665 515 665 220 665 316 181 665 335 515 38 335 335 335 316 362 663 362 145 180 396 637 383 219 362 581 362 180 383 432 432 145 219 367 362 590
</code></pre>
<p>Running that through the script gives the decryption as</p>
<pre><code class="lang-auto">{"TOKEN":"70e0a413a11e17db9313439c3b1fbbb9","ACTION":"COMMAND"}
</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="21" />
              <span class='post-likes'>21 Likes</span>
            </div>


            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/dtm.html'><span itemprop='name'>dtm</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-30T02:38:29Z' class='post-time'>
                    January 30, 2018,  2:38am
                  </time>
                  <meta itemprop='dateModified' content='2018-01-30T02:38:29Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote group-VIP" data-username="lkw" data-post="1" data-topic="5167">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/d.clarkee.co.uk/lkw/48/6369_2.png" class="avatar"> lkw:</div>
<blockquote>
<p><a class="mention" href="../../u/dtm.html">@dtm</a> made a more complete list of variables here I don‚Äôt know enough about windows to say how this was produced. But based on the format I think he used a command to print the environment (correct me if I‚Äôm wrong).</p>
</blockquote>
</aside>
<p>IIRC, the command was</p>
<pre><code class="lang-auto">Get-Variable | format-list Name, Value &gt;dump.txt
</code></pre>
<p>which does, unfortunately, truncate the variables. If you want the full values, you can use this (generates ugly unformated output):</p>
<pre><code class="lang-auto">Get-Variable | Select -Expand Value &gt;dump.txt
</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/termhn.html'><span itemprop='name'>termhn</span></a>
                (Gray Olson)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-30T16:56:08Z' class='post-time'>
                    January 30, 2018,  4:56pm
                  </time>
                  <meta itemprop='dateModified' content='2018-01-30T16:56:08Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Fun little read. Nice job <img src="../../../0x00sec.org/images/emoji/twitter/slight_smilec164.html?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/pry0cc.html'><span itemprop='name'>pry0cc</span></a>
                (Leader &amp; Offsec Engineer &amp; Forum Daddy)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-30T22:39:06Z' class='post-time'>
                    January 30, 2018, 10:39pm
                  </time>
                  <meta itemprop='dateModified' content='2018-01-30T22:39:06Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This is amazing. This is what an awesome hacking community like this does. Good job everybody involved!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="6" />
              <span class='post-likes'>6 Likes</span>
            </div>


            
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/W0lf.html'><span itemprop='name'>W0lf</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-30T23:36:05Z' class='post-time'>
                    January 30, 2018, 11:36pm
                  </time>
                  <meta itemprop='dateModified' content='2018-01-30T23:36:05Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I used this as a tutorial to learn about reversing obfuscation code. Great write up sorry i cant help beyond that</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/SecurityFlaw.html'><span itemprop='name'>SecurityFlaw</span></a>
                (SecurityFlaw)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-01-31T02:13:32Z' class='post-time'>
                    January 31, 2018,  2:13am
                  </time>
                  <meta itemprop='dateModified' content='2018-01-31T02:13:32Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Great work guys!<br>
Nice stuff!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_17' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/fraq.html'><span itemprop='name'>fraq</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-02-02T16:52:14Z' class='post-time'>
                    February 2, 2018,  4:52pm
                  </time>
                  <meta itemprop='dateModified' content='2018-02-02T17:21:19Z'>
              <span itemprop='position'>17</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This was an absolutely amazing example of catching malware in the wild and reversing it. However, I‚Äôd like to address what i‚Äôm seeing in the comments:</p>
<p>Let‚Äôs discuss the work that <a class="mention" href="../../u/lkw.html">@lkw</a> and friends performed here and <em>not</em> use this as a support thread to ask for help with the malware you discovered. Take this example and reverse your own, share your progress, and we‚Äôll discuss it there.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="5" />
              <span class='post-likes'>5 Likes</span>
            </div>


            
          </div>
          <div id='post_19' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/byakuganIII.html'><span itemprop='name'>byakuganIII</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-02-02T18:35:41Z' class='post-time'>
                    February 2, 2018,  6:35pm
                  </time>
                  <meta itemprop='dateModified' content='2018-02-02T18:35:41Z'>
              <span itemprop='position'>19</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Yes this was an absolutely amazing malware reversing/analysis and I learned a lot of stuff from it specially reversing obfuscation scripts, and I‚Äôm sorry if my previous comment bother you guys and I didn‚Äôt mean to ask for support by any means, all I want was to discover if this man edit the original file or it was already malware.<br>
and even if I tried to reverse it I absolutely have zero knowledge with java and how to reverse it.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_20' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/fraq.html'><span itemprop='name'>fraq</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-02-02T18:38:29Z' class='post-time'>
                    February 2, 2018,  6:38pm
                  </time>
                  <meta itemprop='dateModified' content='2018-02-02T18:38:29Z'>
              <span itemprop='position'>20</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This is a good chance to go as far as you can, document your work, share it, and just ask, ‚ÄúHey, what‚Äôs my next step?‚Äù We love those kinds of journeys and helping people out!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_21' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/lkw.html'><span itemprop='name'>lkw</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-02-02T19:27:58Z' class='post-time'>
                    February 2, 2018,  7:27pm
                  </time>
                  <meta itemprop='dateModified' content='2018-02-02T19:27:58Z'>
              <span itemprop='position'>21</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>We didn‚Äôt spend as much time analyzing the keygen that it dropped, however I think it is probably not infected (I didn‚Äôt see anything obviously bad in my quick looks). I have seen the keygen on the internet without the malware dropper. I think it is likely that the malware author found the keygen and decided to wrap it in the dropper and redistribute it.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_23' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/system.html'><span itemprop='name'>system</span></a>
                (system)
                  Closed 
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-03-01T00:59:03Z' class='post-time'>
                    March 1, 2018, 12:59am
                  </time>
                  <meta itemprop='dateModified' content='2018-03-01T00:59:03Z'>
              <span itemprop='position'>23</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="eaySgs8fCPLLoiNHaZwrxU65Y"></script>
  </body>
  
</html>
