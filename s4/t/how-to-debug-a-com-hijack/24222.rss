<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>How to debug a com hijack</title>
    <link>https://d.clarkee.co.uk/t/how-to-debug-a-com-hijack/24222</link>
    <description>Hi. 
I am trying to get this working: https://github.com/nccgroup/acCOMplice
I compiled the dll and did the com hijacking by hand (I tried the tools too but I want to understand the whole thing a bit more and they did not do the job anyways...).
So as far as I understood the Code the whole thing works the following way:
I look for a HKCR key which has no corresponding HKCU key. And write my own dll into the HKCU key I created (with the same CLSID). The dll i used is taken from the github page I linked above.
But no matter which key I hijack the neither the key nor the COM directory (which is created by the dll code to contain the log file) show up. Since The new HKCU key seems to break the explorer.exe I am assuming that it is at least recognised by windows. 
My question is: Is there a way to debug (e.g. in windbg) the calls of explorer.exe to my dll? And what am I doing wrong in the process I explained above?

greetings</description>
    
    <lastBuildDate>Mon, 22 Mar 2021 12:51:21 +0000</lastBuildDate>
    <category>Questions</category>
    <atom:link href="https://d.clarkee.co.uk/t/how-to-debug-a-com-hijack/24222.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>How to debug a com hijack</title>
        <dc:creator><![CDATA[system]]></dc:creator>
        <description><![CDATA[
            <p>This topic was automatically closed after 121 days. New replies are no longer allowed.</p>
          <p><a href="https://d.clarkee.co.uk/t/how-to-debug-a-com-hijack/24222/3">Read full topic</a></p>
        ]]></description>
        <link>https://d.clarkee.co.uk/t/how-to-debug-a-com-hijack/24222/3</link>
        <pubDate>Thu, 15 Apr 2021 06:22:59 +0000</pubDate>
        <guid isPermaLink="false">d.clarkee.co.uk-post-24222-3</guid>
        <source url="https://d.clarkee.co.uk/t/how-to-debug-a-com-hijack/24222.rss">How to debug a com hijack</source>
      </item>
      <item>
        <title>How to debug a com hijack</title>
        <dc:creator><![CDATA[CQR.ADS]]></dc:creator>
        <description><![CDATA[
            <ol>
<li>Setup and launch virtual machine with windows under native windows.</li>
<li>Download necessary files to virtual windows.</li>
<li>Install <a href="https://systemexplorer.net/" rel="noopener nofollow ugc">system explorer</a> at virtual windows.</li>
<li>Open tab “events” at system explorer.</li>
<li>Compile and launch your code, if see unusual behavior at events tab, log and analyze it.</li>
</ol>
          <p><a href="https://d.clarkee.co.uk/t/how-to-debug-a-com-hijack/24222/2">Read full topic</a></p>
        ]]></description>
        <link>https://d.clarkee.co.uk/t/how-to-debug-a-com-hijack/24222/2</link>
        <pubDate>Mon, 22 Mar 2021 12:51:21 +0000</pubDate>
        <guid isPermaLink="false">d.clarkee.co.uk-post-24222-2</guid>
        <source url="https://d.clarkee.co.uk/t/how-to-debug-a-com-hijack/24222.rss">How to debug a com hijack</source>
      </item>
      <item>
        <title>How to debug a com hijack</title>
        <dc:creator><![CDATA[cherry]]></dc:creator>
        <description><![CDATA[
            <p>Hi.<br>
I am trying to get this working: <a href="https://github.com/nccgroup/acCOMplice" rel="noopener nofollow ugc">https://github.com/nccgroup/acCOMplice</a><br>
I compiled the dll and did the com hijacking by hand (I tried the tools too but I want to understand the whole thing a bit more and they did not do the job anyways…).<br>
So as far as I understood the Code the whole thing works the following way:<br>
I look for a HKCR key which has no corresponding HKCU key. And write my own dll into the HKCU key I created (with the same CLSID). The dll i used is taken from the github page I linked above.<br>
But no matter which key I hijack the neither the key nor the COM directory (which is created by the dll code to contain the log file) show up. Since The new HKCU key seems to break the explorer.exe I am assuming that it is at least recognised by windows.<br>
My question is: Is there a way to debug (e.g. in windbg) the calls of explorer.exe to my dll? And what am I doing wrong in the process I explained above?</p>
<p>greetings</p>
          <p><a href="https://d.clarkee.co.uk/t/how-to-debug-a-com-hijack/24222/1">Read full topic</a></p>
        ]]></description>
        <link>https://d.clarkee.co.uk/t/how-to-debug-a-com-hijack/24222/1</link>
        <pubDate>Mon, 14 Dec 2020 14:22:59 +0000</pubDate>
        <guid isPermaLink="false">d.clarkee.co.uk-post-24222-1</guid>
        <source url="https://d.clarkee.co.uk/t/how-to-debug-a-com-hijack/24222.rss">How to debug a com hijack</source>
      </item>
  </channel>
</rss>
