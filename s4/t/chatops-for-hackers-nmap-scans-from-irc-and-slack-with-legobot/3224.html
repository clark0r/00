<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Chatops for hackers: Nmap scans from IRC and Slack with Legobot - Programming - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="Running Nmap from Chat with Legobot
Chatops for hackers! 
For those of you who saw my shenanigans in IRC earlier, this is the promised post on what I was doing. For those who missed it or don‚Äôt hang out in IRC, shame! Th&amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="3224.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="8DERyMyT97S3wtfDW9i74qa3e"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="8DERyMyT97S3wtfDW9i74qa3e"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Chatops for hackers: Nmap scans from IRC and Slack with Legobot&#39;" href="3224.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:image" content="https://d.clarkee.co.uk/uploads/default/original/2X/2/27a5373af868edade07624e8205c46e79c247445.jpeg" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/chatops-for-hackers-nmap-scans-from-irc-and-slack-with-legobot/3224" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/chatops-for-hackers-nmap-scans-from-irc-and-slack-with-legobot/3224" />
<meta property="og:title" content="Chatops for hackers: Nmap scans from IRC and Slack with Legobot" />
<meta name="twitter:title" content="Chatops for hackers: Nmap scans from IRC and Slack with Legobot" />
<meta property="og:description" content="Running Nmap from Chat with Legobot Chatops for hackers!  For those of you who saw my shenanigans in IRC earlier, this is the promised post on what I was doing. For those who missed it or don‚Äôt hang out in IRC, shame! This is an announcement of a new package I released today, description of how to use it, and solicitation for feedback. We‚Äôre going to talk about running Nmap from chat mediums such as Slack and IRC.  Required Skills Understanding of nmap and python will be helpful for this, but no..." />
<meta name="twitter:description" content="Running Nmap from Chat with Legobot Chatops for hackers!  For those of you who saw my shenanigans in IRC earlier, this is the promised post on what I was doing. For those who missed it or don‚Äôt hang out in IRC, shame! This is an announcement of a new package I released today, description of how to use it, and solicitation for feedback. We‚Äôre going to talk about running Nmap from chat mediums such as Slack and IRC.  Required Skills Understanding of nmap and python will be helpful for this, but no..." />
<meta property="og:article:section" content="Programming" />
<meta property="og:article:section:color" content="92278F" />
<meta property="og:article:tag" content="recon" />
<meta property="og:article:tag" content="nmap" />
<meta property="og:article:tag" content="chatops" />
<meta property="og:article:tag" content="python" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="17 ‚ù§" />
<meta property="article:published_time" content="2017-08-07T03:32:14+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="3224.html">Chatops for hackers: Nmap scans from IRC and Slack with Legobot</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/programming/61.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #92278F'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Programming</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/recon.html' class='discourse-tag' rel="tag">recon</a>, 
            <a href='../../tag/nmap.html' class='discourse-tag' rel="tag">nmap</a>, 
            <a href='../../tag/chatops.html' class='discourse-tag' rel="tag">chatops</a>, 
            <a href='../../tag/python.html' class='discourse-tag' rel="tag">python</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Chatops for hackers: Nmap scans from IRC and Slack with Legobot'>
      <link itemprop='url' href='3224.html'>
      <meta itemprop='datePublished' content='2017-08-07T03:32:14Z'>
        <meta itemprop='articleSection' content='Programming'>
      <meta itemprop='keywords' content='recon, nmap, chatops, python'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/fraq.html'><span itemprop='name'>fraq</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="3224.html">


              <span class="crawler-post-infos">
                  <time  datetime='2017-08-07T03:32:14Z' class='post-time'>
                    August 7, 2017,  3:32am
                  </time>
                  <meta itemprop='dateModified' content='2017-08-07T03:32:14Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <h1><a name="p-14251-running-nmap-from-chat-with-legobot-1" class="anchor" href="#p-14251-running-nmap-from-chat-with-legobot-1"></a>Running Nmap from Chat with Legobot</h1>
<p><em>Chatops for hackers!</em></p>
<p>For those of you who saw my shenanigans in IRC earlier, this is the promised post on what I was doing. For those who missed it or don‚Äôt hang out in IRC, shame! This is an announcement of a new package I released today, description of how to use it, and solicitation for feedback. We‚Äôre going to talk about running Nmap from chat mediums such as Slack and IRC.</p>
<h4><a name="p-14251-required-skills-2" class="anchor" href="#p-14251-required-skills-2"></a>Required Skills</h4>
<p>Understanding of nmap and python will be helpful for this, but not essential.</p>
<h4><a name="p-14251-disclaimer-3" class="anchor" href="#p-14251-disclaimer-3"></a>Disclaimer</h4>
<p>If you leave this bot in an IRC or Slack with other people, whoever sends it a scan command will launch a scan from your IP. You don‚Äôt want that.</p>
<hr>
<h1><a name="p-14251-introduction-4" class="anchor" href="#p-14251-introduction-4"></a>Introduction</h1>
<p><a href="../../../external.html?link=https://nmap.org/" rel="noopener nofollow ugc">Nmap</a> is a favorite tool among securitry professionals and system administrators alike, providing a powerful and comparatively simple* tool for testing network connections, listening services, and more.</p>
<p>Chatops, as defined quite well by Atlassian:</p>
<blockquote>
<p>ChatOps is a collaboration model that connects people, tools, process, and automation into a transparent workflow</p>
</blockquote>
<p>For the hacker unacquainted wth ChatOps and what that might mean, one of the major principles of ChatOps involves consolidating flow of information to a single location. You may have many sources of information (we‚Äôll call them signal), and going out to the various sources of the signals  to gather information for analysis can result in a lot of work.</p>
<p><em>*Try writing your own port scanner that does what Nmap does.</em></p>
<p>Now imagine yourself in a team context, where you need to generate the information, collect it, share it, and then process it with everyone, you can see the need for what we call a ‚Äúshared context‚Äù for information. Imagine Alice and Bob are on a red team. Alice runs an nmap scan and Bob runs some work in SQLmap. Those results should automatically come back to chat so that both Alice and Bob can see all the information generated.</p>
<h4><a name="p-14251-but-why-5" class="anchor" href="#p-14251-but-why-5"></a>But why?</h4>
<p>Applying ChatOps to red team and blue team operations means invoking security tools from chat, consolidating information, reducing turnaround time for iterating to the next step in attack or analysis, improving analysis by improving access to information, and ultimately looking really freaking cool by pwning a box from a couple commands on irc</p>
<h1><a name="p-14251-the-framework-6" class="anchor" href="#p-14251-the-framework-6"></a>The Framework</h1>
<p>Now that I‚Äôve hopefully sold you on that one area of ChatOps (there are many more good reasons to adopt it), let‚Äôs look at the framework we‚Äôll use for this.</p>
<p>A couple of years ago, I started <a href="../../../external.html?link=https://github.com/bbriggs/Legobot" rel="noopener nofollow ugc">Legobot</a> with a friend. Over time, it has grown into my own favorite tool for integrating any task I want into chat and a generally useful ChatOps framework. I‚Äôve used for tracking pull requests from FOSS communities, keeping people up to date on version numbers, publishing Gists on Github, querying Kubernetes for deployment status of applications at work, keeping track of karma points in a community, and managing queue rotations for on-call engineers. I love it. I won‚Äôt dig too deep into how Legobot works here, though. This post is about an nmap plugin I wrote for it.</p>
<h1><a name="p-14251-the-plugin-lego-7" class="anchor" href="#p-14251-the-plugin-lego-7"></a>The plugin (Lego)</h1>
<p>What better name for a plugin to Legobot than a Lego? Our lego here is a wrapper for <a href="../../../external.html?link=http://xael.org/pages/python-nmap-en.html" rel="noopener nofollow ugc">python-nmap</a>. Python-nmap is crazy easy to use, Python 3 compatible, and results are easily parsable. In other words, a perfect candidate.</p>
<aside class="onebox githubrepo" data-onebox-src="../../../external.html?link=https://github.com/Legobot/legos.nmap">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/Legobot/legos.nmap" target="_blank" rel="noopener nofollow ugc">github.com</a>
  </header>

  <article class="onebox-body">
    <div class="github-row" data-github-private-repo="false">
  <img width="690" height="344" src="../../../external.html?link=https://opengraph.githubassets.com/51c86a2d45090aff5b05df8e3202922b/Legobot/legos.nmap" class="thumbnail">

  <h3><a href="../../../external.html?link=https://github.com/Legobot/legos.nmap" target="_blank" rel="noopener nofollow ugc">GitHub - Legobot/legos.nmap: Run nmap scans right from legobot</a></h3>

    <p><span class="github-repo-description">Run nmap scans right from legobot</span></p>
</div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>In order to make it easy to add or modify scan behavior for the intrepid hacker, I have used what I call a ‚Äúdispatcher‚Äù pattern that allows the programmer to drop in a new <code>argv[1]</code> parameter to be executed without much trouble.</p>
<pre data-code-wrap="python"><code class="lang-python">    def _dispatcher(self, message):
        command = message['text'].split()[1]
        commands = {'simple': self._basic_scan, 'os': self._os_detect}
        if command in commands:
            commands[command](message)
            return True
        else:
            self.reply(message, 'Command not supported. RTFM.',
                       self._handle_opts(message))
            return False
</code></pre>
<p>After extracting the command from the message, we compare that with the commands in the <code>commands</code> dict. The value for each of those keys is the corresponding method that handles whatever command we‚Äôre asking for. Therefore, adding a new command is a matter of adding a new key and value to the dictionary in <code>self._dispatcher()</code> and adding the corresponding method to handle it.</p>
<h1><a name="p-14251-usage-8" class="anchor" href="#p-14251-usage-8"></a>Usage</h1>
<p>Now to see it in action.</p>
<p>OS detection (bot must be running as root):</p>
<pre><code class="lang-auto">‚Äú22:34‚Äù     fraq ‚ï° !nmap os 127.0.0.1
‚Äú22:34‚Äù mmp-test ‚ï° Host: 127.0.0.1 | tcp [22, 25, 445, 587, 6969, 8081, 8443] |OS best guess (100% confidence): Apple macOS 10.12 (Sierra) (Darwin 16.0.0) |
</code></pre>
<p>Simple scans:</p>
<pre><code class="lang-auto">‚Äú21:25‚Äù            fraq ‚ï° !nmap 127.0.0.1 22-1024
‚Äú21:26‚Äù        mmp-test ‚ï° Host: localhost | tcp  [22, 25, 445, 587] |
</code></pre>
<p>All host arguments can accept ranges in the same way the nmap CLI can.<br>
Over the next little bit I will continue to improve this. I have successfully tested running built-in nmap scripts as well. I also plan to allow for raw nmap queries</p>
<h2><a name="p-14251-conclusion-9" class="anchor" href="#p-14251-conclusion-9"></a>Conclusion</h2>
<p>While on the surface, this paper is about using nmap from Legobot, which is cool but simple, it‚Äôs really about introducing security type people to the sort of possibilities offered by chat as a medium for getting crap done and not just talking.</p>
<p>I‚Äôve long championed the sharing of techniques and principles between Ops and Infosec. In this instance, I feel that for group engagements or blue-team work, ChatOps can be a powerful method for working faster and more accurately.</p>
<p>Launching commands and receiving input in chat lets everyone collaborate and participate in real-time. Additionally, wrapping commands with shorthand like this provides less opportunity for error by simplfying the invocation. Finally, by abstracting the data you‚Äôre after from the tool you‚Äôre using (not a technique we did here), you can change magic in the middle without users having to change workflows. Example: 'who is google.com` could use nmap, dig, or nslookup on the backend. As long as information is presented back to the user with a consistent format, it doesn‚Äôt matter.</p>
<p>I hope you enjoyed this and that it gets you thinking about all the cool things you can do with bots (and hopefully use Legobot to do them!)</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="10" />
              <span class='post-likes'>10 Likes</span>
            </div>


            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/ohxeighty.html'><span itemprop='name'>ohxeighty</span></a>
                (Andrew Yu)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-07T04:13:03Z' class='post-time'>
                    August 7, 2017,  4:13am
                  </time>
                  <meta itemprop='dateModified' content='2017-08-07T04:13:03Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>ahhh abstraction, I‚Äôm getting assignment flashbacks</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/oaktree.html'><span itemprop='name'>oaktree</span></a>
                (oaktree)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-07T18:41:37Z' class='post-time'>
                    August 7, 2017,  6:41pm
                  </time>
                  <meta itemprop='dateModified' content='2017-08-07T18:41:37Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Love this. Want me to weaponize pine too and then we can have an IRC bot arms race? (Only for giggles, obviously)</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/fraq.html'><span itemprop='name'>fraq</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-07T18:42:06Z' class='post-time'>
                    August 7, 2017,  6:42pm
                  </time>
                  <meta itemprop='dateModified' content='2017-08-07T18:42:06Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>How could we not do that?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/fraq.html'><span itemprop='name'>fraq</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-11T13:54:52Z' class='post-time'>
                    August 11, 2017,  1:54pm
                  </time>
                  <meta itemprop='dateModified' content='2017-08-11T13:54:52Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Update: We‚Äôll be talking a little about devops for hackers tonight on the show. Makes sure to tune in and download the podcast!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/pry0cc.html'><span itemprop='name'>pry0cc</span></a>
                (Leader &amp; Offsec Engineer &amp; Forum Daddy)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-16T10:32:47Z' class='post-time'>
                    August 16, 2017, 10:32am
                  </time>
                  <meta itemprop='dateModified' content='2017-08-16T10:32:47Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>After some thinking. Chatops for hackers hasn‚Äôt been done before. It‚Äôs a new concept. We should pioneer this concept, and make a kickass bot for hacking.</p>
<p>Think everything we do on a CTF, in a chat bot automated. Are you in?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>


            
          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/fraq.html'><span itemprop='name'>fraq</span></a>
                
              </span>


                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/2X/8/8c53d39cff05a290a56f68adaedff917d18760ac.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-17T01:49:28Z' class='post-time'>
                    August 17, 2017,  1:49am
                  </time>
                  <meta itemprop='dateModified' content='2017-08-17T01:49:28Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>WE ARE A GO FOR LAUNCH</p>
<aside class="onebox githubissue">
  <header class="source">
      <a href="../../../external.html?link=https://github.com/Legobot/Legobot/issues/158" target="_blank" rel="noopener nofollow ugc">github.com/Legobot/Legobot</a>
  </header>
  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Legobot/Legobot/issues/158" target="_blank" rel="noopener nofollow ugc">Add support for high-level access of shells</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2017-08-16" data-time="21:27:49" data-timezone="UTC">09:27PM - 16 Aug 17 UTC</span>
      </div>

        <div class="date">
          closed <span class="discourse-local-date" data-format="ll" data-date="2020-03-17" data-time="23:07:37" data-timezone="UTC">11:07PM - 17 Mar 20 UTC</span>
        </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/pry0cc" target="_blank" rel="noopener nofollow ugc">
          <img alt="pry0cc" src="../../../0x00sec.s3.amazonaws.com/original/2X/8/8c53d39cff05a290a56f68adaedff917d18760ac.png" class="onebox-avatar-inline" width="20" height="20">
          pry0cc
        </a>
      </div>
    </div>
  </div>
</div>

<div class="github-row">
  <p class="github-content">When a shell is initiated, we should be able to access the shell in some sort of terminal multiplexer via SSH,...</p>
</div>

<div class="labels">
    <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">Needs diagnosis</span>
    <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">OffSec toolkit</span>
    <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">Plugin Request</span>
    <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">Priority: Normal</span>
    <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">help wanted</span>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="8DERyMyT97S3wtfDW9i74qa3e"></script>
  </body>
  
</html>
